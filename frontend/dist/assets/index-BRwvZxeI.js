function dx(s,i){for(var r=0;r<i.length;r++){const o=i[r];if(typeof o!="string"&&!Array.isArray(o)){for(const d in o)if(d!=="default"&&!(d in s)){const f=Object.getOwnPropertyDescriptor(o,d);f&&Object.defineProperty(s,d,f.get?f:{enumerable:!0,get:()=>o[d]})}}}return Object.freeze(Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}))}(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))o(d);new MutationObserver(d=>{for(const f of d)if(f.type==="childList")for(const p of f.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&o(p)}).observe(document,{childList:!0,subtree:!0});function r(d){const f={};return d.integrity&&(f.integrity=d.integrity),d.referrerPolicy&&(f.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?f.credentials="include":d.crossOrigin==="anonymous"?f.credentials="omit":f.credentials="same-origin",f}function o(d){if(d.ep)return;d.ep=!0;const f=r(d);fetch(d.href,f)}})();function Sf(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var jo={exports:{}},Va={},So={exports:{}},Re={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Cu;function cx(){if(Cu)return Re;Cu=1;var s=Symbol.for("react.element"),i=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),d=Symbol.for("react.profiler"),f=Symbol.for("react.provider"),p=Symbol.for("react.context"),x=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),v=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),b=Symbol.iterator;function y(O){return O===null||typeof O!="object"?null:(O=b&&O[b]||O["@@iterator"],typeof O=="function"?O:null)}var j={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},k=Object.assign,_={};function C(O,U,ae){this.props=O,this.context=U,this.refs=_,this.updater=ae||j}C.prototype.isReactComponent={},C.prototype.setState=function(O,U){if(typeof O!="object"&&typeof O!="function"&&O!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,O,U,"setState")},C.prototype.forceUpdate=function(O){this.updater.enqueueForceUpdate(this,O,"forceUpdate")};function L(){}L.prototype=C.prototype;function D(O,U,ae){this.props=O,this.context=U,this.refs=_,this.updater=ae||j}var I=D.prototype=new L;I.constructor=D,k(I,C.prototype),I.isPureReactComponent=!0;var P=Array.isArray,w=Object.prototype.hasOwnProperty,A={current:null},N={key:!0,ref:!0,__self:!0,__source:!0};function W(O,U,ae){var me,be={},je=null,V=null;if(U!=null)for(me in U.ref!==void 0&&(V=U.ref),U.key!==void 0&&(je=""+U.key),U)w.call(U,me)&&!N.hasOwnProperty(me)&&(be[me]=U[me]);var q=arguments.length-2;if(q===1)be.children=ae;else if(1<q){for(var re=Array(q),Je=0;Je<q;Je++)re[Je]=arguments[Je+2];be.children=re}if(O&&O.defaultProps)for(me in q=O.defaultProps,q)be[me]===void 0&&(be[me]=q[me]);return{$$typeof:s,type:O,key:je,ref:V,props:be,_owner:A.current}}function F(O,U){return{$$typeof:s,type:O.type,key:U,ref:O.ref,props:O.props,_owner:O._owner}}function Z(O){return typeof O=="object"&&O!==null&&O.$$typeof===s}function ce(O){var U={"=":"=0",":":"=2"};return"$"+O.replace(/[=:]/g,function(ae){return U[ae]})}var xe=/\/+/g;function z(O,U){return typeof O=="object"&&O!==null&&O.key!=null?ce(""+O.key):U.toString(36)}function X(O,U,ae,me,be){var je=typeof O;(je==="undefined"||je==="boolean")&&(O=null);var V=!1;if(O===null)V=!0;else switch(je){case"string":case"number":V=!0;break;case"object":switch(O.$$typeof){case s:case i:V=!0}}if(V)return V=O,be=be(V),O=me===""?"."+z(V,0):me,P(be)?(ae="",O!=null&&(ae=O.replace(xe,"$&/")+"/"),X(be,U,ae,"",function(Je){return Je})):be!=null&&(Z(be)&&(be=F(be,ae+(!be.key||V&&V.key===be.key?"":(""+be.key).replace(xe,"$&/")+"/")+O)),U.push(be)),1;if(V=0,me=me===""?".":me+":",P(O))for(var q=0;q<O.length;q++){je=O[q];var re=me+z(je,q);V+=X(je,U,ae,re,be)}else if(re=y(O),typeof re=="function")for(O=re.call(O),q=0;!(je=O.next()).done;)je=je.value,re=me+z(je,q++),V+=X(je,U,ae,re,be);else if(je==="object")throw U=String(O),Error("Objects are not valid as a React child (found: "+(U==="[object Object]"?"object with keys {"+Object.keys(O).join(", ")+"}":U)+"). If you meant to render a collection of children, use an array instead.");return V}function de(O,U,ae){if(O==null)return O;var me=[],be=0;return X(O,me,"","",function(je){return U.call(ae,je,be++)}),me}function oe(O){if(O._status===-1){var U=O._result;U=U(),U.then(function(ae){(O._status===0||O._status===-1)&&(O._status=1,O._result=ae)},function(ae){(O._status===0||O._status===-1)&&(O._status=2,O._result=ae)}),O._status===-1&&(O._status=0,O._result=U)}if(O._status===1)return O._result.default;throw O._result}var ve={current:null},Y={transition:null},se={ReactCurrentDispatcher:ve,ReactCurrentBatchConfig:Y,ReactCurrentOwner:A};function J(){throw Error("act(...) is not supported in production builds of React.")}return Re.Children={map:de,forEach:function(O,U,ae){de(O,function(){U.apply(this,arguments)},ae)},count:function(O){var U=0;return de(O,function(){U++}),U},toArray:function(O){return de(O,function(U){return U})||[]},only:function(O){if(!Z(O))throw Error("React.Children.only expected to receive a single React element child.");return O}},Re.Component=C,Re.Fragment=r,Re.Profiler=d,Re.PureComponent=D,Re.StrictMode=o,Re.Suspense=m,Re.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=se,Re.act=J,Re.cloneElement=function(O,U,ae){if(O==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+O+".");var me=k({},O.props),be=O.key,je=O.ref,V=O._owner;if(U!=null){if(U.ref!==void 0&&(je=U.ref,V=A.current),U.key!==void 0&&(be=""+U.key),O.type&&O.type.defaultProps)var q=O.type.defaultProps;for(re in U)w.call(U,re)&&!N.hasOwnProperty(re)&&(me[re]=U[re]===void 0&&q!==void 0?q[re]:U[re])}var re=arguments.length-2;if(re===1)me.children=ae;else if(1<re){q=Array(re);for(var Je=0;Je<re;Je++)q[Je]=arguments[Je+2];me.children=q}return{$$typeof:s,type:O.type,key:be,ref:je,props:me,_owner:V}},Re.createContext=function(O){return O={$$typeof:p,_currentValue:O,_currentValue2:O,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},O.Provider={$$typeof:f,_context:O},O.Consumer=O},Re.createElement=W,Re.createFactory=function(O){var U=W.bind(null,O);return U.type=O,U},Re.createRef=function(){return{current:null}},Re.forwardRef=function(O){return{$$typeof:x,render:O}},Re.isValidElement=Z,Re.lazy=function(O){return{$$typeof:g,_payload:{_status:-1,_result:O},_init:oe}},Re.memo=function(O,U){return{$$typeof:v,type:O,compare:U===void 0?null:U}},Re.startTransition=function(O){var U=Y.transition;Y.transition={};try{O()}finally{Y.transition=U}},Re.unstable_act=J,Re.useCallback=function(O,U){return ve.current.useCallback(O,U)},Re.useContext=function(O){return ve.current.useContext(O)},Re.useDebugValue=function(){},Re.useDeferredValue=function(O){return ve.current.useDeferredValue(O)},Re.useEffect=function(O,U){return ve.current.useEffect(O,U)},Re.useId=function(){return ve.current.useId()},Re.useImperativeHandle=function(O,U,ae){return ve.current.useImperativeHandle(O,U,ae)},Re.useInsertionEffect=function(O,U){return ve.current.useInsertionEffect(O,U)},Re.useLayoutEffect=function(O,U){return ve.current.useLayoutEffect(O,U)},Re.useMemo=function(O,U){return ve.current.useMemo(O,U)},Re.useReducer=function(O,U,ae){return ve.current.useReducer(O,U,ae)},Re.useRef=function(O){return ve.current.useRef(O)},Re.useState=function(O){return ve.current.useState(O)},Re.useSyncExternalStore=function(O,U,ae){return ve.current.useSyncExternalStore(O,U,ae)},Re.useTransition=function(){return ve.current.useTransition()},Re.version="18.3.1",Re}var _u;function Fo(){return _u||(_u=1,So.exports=cx()),So.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wu;function ux(){if(wu)return Va;wu=1;var s=Fo(),i=Symbol.for("react.element"),r=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,d=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,f={key:!0,ref:!0,__self:!0,__source:!0};function p(x,m,v){var g,b={},y=null,j=null;v!==void 0&&(y=""+v),m.key!==void 0&&(y=""+m.key),m.ref!==void 0&&(j=m.ref);for(g in m)o.call(m,g)&&!f.hasOwnProperty(g)&&(b[g]=m[g]);if(x&&x.defaultProps)for(g in m=x.defaultProps,m)b[g]===void 0&&(b[g]=m[g]);return{$$typeof:i,type:x,key:y,ref:j,props:b,_owner:d.current}}return Va.Fragment=r,Va.jsx=p,Va.jsxs=p,Va}var Eu;function fx(){return Eu||(Eu=1,jo.exports=ux()),jo.exports}var e=fx(),ml={},ko={exports:{}},wt={},No={exports:{}},Co={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ru;function hx(){return Ru||(Ru=1,(function(s){function i(Y,se){var J=Y.length;Y.push(se);e:for(;0<J;){var O=J-1>>>1,U=Y[O];if(0<d(U,se))Y[O]=se,Y[J]=U,J=O;else break e}}function r(Y){return Y.length===0?null:Y[0]}function o(Y){if(Y.length===0)return null;var se=Y[0],J=Y.pop();if(J!==se){Y[0]=J;e:for(var O=0,U=Y.length,ae=U>>>1;O<ae;){var me=2*(O+1)-1,be=Y[me],je=me+1,V=Y[je];if(0>d(be,J))je<U&&0>d(V,be)?(Y[O]=V,Y[je]=J,O=je):(Y[O]=be,Y[me]=J,O=me);else if(je<U&&0>d(V,J))Y[O]=V,Y[je]=J,O=je;else break e}}return se}function d(Y,se){var J=Y.sortIndex-se.sortIndex;return J!==0?J:Y.id-se.id}if(typeof performance=="object"&&typeof performance.now=="function"){var f=performance;s.unstable_now=function(){return f.now()}}else{var p=Date,x=p.now();s.unstable_now=function(){return p.now()-x}}var m=[],v=[],g=1,b=null,y=3,j=!1,k=!1,_=!1,C=typeof setTimeout=="function"?setTimeout:null,L=typeof clearTimeout=="function"?clearTimeout:null,D=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function I(Y){for(var se=r(v);se!==null;){if(se.callback===null)o(v);else if(se.startTime<=Y)o(v),se.sortIndex=se.expirationTime,i(m,se);else break;se=r(v)}}function P(Y){if(_=!1,I(Y),!k)if(r(m)!==null)k=!0,oe(w);else{var se=r(v);se!==null&&ve(P,se.startTime-Y)}}function w(Y,se){k=!1,_&&(_=!1,L(W),W=-1),j=!0;var J=y;try{for(I(se),b=r(m);b!==null&&(!(b.expirationTime>se)||Y&&!ce());){var O=b.callback;if(typeof O=="function"){b.callback=null,y=b.priorityLevel;var U=O(b.expirationTime<=se);se=s.unstable_now(),typeof U=="function"?b.callback=U:b===r(m)&&o(m),I(se)}else o(m);b=r(m)}if(b!==null)var ae=!0;else{var me=r(v);me!==null&&ve(P,me.startTime-se),ae=!1}return ae}finally{b=null,y=J,j=!1}}var A=!1,N=null,W=-1,F=5,Z=-1;function ce(){return!(s.unstable_now()-Z<F)}function xe(){if(N!==null){var Y=s.unstable_now();Z=Y;var se=!0;try{se=N(!0,Y)}finally{se?z():(A=!1,N=null)}}else A=!1}var z;if(typeof D=="function")z=function(){D(xe)};else if(typeof MessageChannel<"u"){var X=new MessageChannel,de=X.port2;X.port1.onmessage=xe,z=function(){de.postMessage(null)}}else z=function(){C(xe,0)};function oe(Y){N=Y,A||(A=!0,z())}function ve(Y,se){W=C(function(){Y(s.unstable_now())},se)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(Y){Y.callback=null},s.unstable_continueExecution=function(){k||j||(k=!0,oe(w))},s.unstable_forceFrameRate=function(Y){0>Y||125<Y?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):F=0<Y?Math.floor(1e3/Y):5},s.unstable_getCurrentPriorityLevel=function(){return y},s.unstable_getFirstCallbackNode=function(){return r(m)},s.unstable_next=function(Y){switch(y){case 1:case 2:case 3:var se=3;break;default:se=y}var J=y;y=se;try{return Y()}finally{y=J}},s.unstable_pauseExecution=function(){},s.unstable_requestPaint=function(){},s.unstable_runWithPriority=function(Y,se){switch(Y){case 1:case 2:case 3:case 4:case 5:break;default:Y=3}var J=y;y=Y;try{return se()}finally{y=J}},s.unstable_scheduleCallback=function(Y,se,J){var O=s.unstable_now();switch(typeof J=="object"&&J!==null?(J=J.delay,J=typeof J=="number"&&0<J?O+J:O):J=O,Y){case 1:var U=-1;break;case 2:U=250;break;case 5:U=1073741823;break;case 4:U=1e4;break;default:U=5e3}return U=J+U,Y={id:g++,callback:se,priorityLevel:Y,startTime:J,expirationTime:U,sortIndex:-1},J>O?(Y.sortIndex=J,i(v,Y),r(m)===null&&Y===r(v)&&(_?(L(W),W=-1):_=!0,ve(P,J-O))):(Y.sortIndex=U,i(m,Y),k||j||(k=!0,oe(w))),Y},s.unstable_shouldYield=ce,s.unstable_wrapCallback=function(Y){var se=y;return function(){var J=y;y=se;try{return Y.apply(this,arguments)}finally{y=J}}}})(Co)),Co}var Au;function px(){return Au||(Au=1,No.exports=hx()),No.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Tu;function xx(){if(Tu)return wt;Tu=1;var s=Fo(),i=px();function r(t){for(var n="https://reactjs.org/docs/error-decoder.html?invariant="+t,a=1;a<arguments.length;a++)n+="&args[]="+encodeURIComponent(arguments[a]);return"Minified React error #"+t+"; visit "+n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,d={};function f(t,n){p(t,n),p(t+"Capture",n)}function p(t,n){for(d[t]=n,t=0;t<n.length;t++)o.add(n[t])}var x=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),m=Object.prototype.hasOwnProperty,v=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,g={},b={};function y(t){return m.call(b,t)?!0:m.call(g,t)?!1:v.test(t)?b[t]=!0:(g[t]=!0,!1)}function j(t,n,a,l){if(a!==null&&a.type===0)return!1;switch(typeof n){case"function":case"symbol":return!0;case"boolean":return l?!1:a!==null?!a.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function k(t,n,a,l){if(n===null||typeof n>"u"||j(t,n,a,l))return!0;if(l)return!1;if(a!==null)switch(a.type){case 3:return!n;case 4:return n===!1;case 5:return isNaN(n);case 6:return isNaN(n)||1>n}return!1}function _(t,n,a,l,c,h,S){this.acceptsBooleans=n===2||n===3||n===4,this.attributeName=l,this.attributeNamespace=c,this.mustUseProperty=a,this.propertyName=t,this.type=n,this.sanitizeURL=h,this.removeEmptyString=S}var C={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){C[t]=new _(t,0,!1,t,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var n=t[0];C[n]=new _(n,1,!1,t[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(t){C[t]=new _(t,2,!1,t.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){C[t]=new _(t,2,!1,t,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){C[t]=new _(t,3,!1,t.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(t){C[t]=new _(t,3,!0,t,null,!1,!1)}),["capture","download"].forEach(function(t){C[t]=new _(t,4,!1,t,null,!1,!1)}),["cols","rows","size","span"].forEach(function(t){C[t]=new _(t,6,!1,t,null,!1,!1)}),["rowSpan","start"].forEach(function(t){C[t]=new _(t,5,!1,t.toLowerCase(),null,!1,!1)});var L=/[\-:]([a-z])/g;function D(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var n=t.replace(L,D);C[n]=new _(n,1,!1,t,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var n=t.replace(L,D);C[n]=new _(n,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(t){var n=t.replace(L,D);C[n]=new _(n,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(t){C[t]=new _(t,1,!1,t.toLowerCase(),null,!1,!1)}),C.xlinkHref=new _("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(t){C[t]=new _(t,1,!1,t.toLowerCase(),null,!0,!0)});function I(t,n,a,l){var c=C.hasOwnProperty(n)?C[n]:null;(c!==null?c.type!==0:l||!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N")&&(k(n,a,c,l)&&(a=null),l||c===null?y(n)&&(a===null?t.removeAttribute(n):t.setAttribute(n,""+a)):c.mustUseProperty?t[c.propertyName]=a===null?c.type===3?!1:"":a:(n=c.attributeName,l=c.attributeNamespace,a===null?t.removeAttribute(n):(c=c.type,a=c===3||c===4&&a===!0?"":""+a,l?t.setAttributeNS(l,n,a):t.setAttribute(n,a))))}var P=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),A=Symbol.for("react.portal"),N=Symbol.for("react.fragment"),W=Symbol.for("react.strict_mode"),F=Symbol.for("react.profiler"),Z=Symbol.for("react.provider"),ce=Symbol.for("react.context"),xe=Symbol.for("react.forward_ref"),z=Symbol.for("react.suspense"),X=Symbol.for("react.suspense_list"),de=Symbol.for("react.memo"),oe=Symbol.for("react.lazy"),ve=Symbol.for("react.offscreen"),Y=Symbol.iterator;function se(t){return t===null||typeof t!="object"?null:(t=Y&&t[Y]||t["@@iterator"],typeof t=="function"?t:null)}var J=Object.assign,O;function U(t){if(O===void 0)try{throw Error()}catch(a){var n=a.stack.trim().match(/\n( *(at )?)/);O=n&&n[1]||""}return`
`+O+t}var ae=!1;function me(t,n){if(!t||ae)return"";ae=!0;var a=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(n)if(n=function(){throw Error()},Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(n,[])}catch(K){var l=K}Reflect.construct(t,[],n)}else{try{n.call()}catch(K){l=K}t.call(n.prototype)}else{try{throw Error()}catch(K){l=K}t()}}catch(K){if(K&&l&&typeof K.stack=="string"){for(var c=K.stack.split(`
`),h=l.stack.split(`
`),S=c.length-1,E=h.length-1;1<=S&&0<=E&&c[S]!==h[E];)E--;for(;1<=S&&0<=E;S--,E--)if(c[S]!==h[E]){if(S!==1||E!==1)do if(S--,E--,0>E||c[S]!==h[E]){var B=`
`+c[S].replace(" at new "," at ");return t.displayName&&B.includes("<anonymous>")&&(B=B.replace("<anonymous>",t.displayName)),B}while(1<=S&&0<=E);break}}}finally{ae=!1,Error.prepareStackTrace=a}return(t=t?t.displayName||t.name:"")?U(t):""}function be(t){switch(t.tag){case 5:return U(t.type);case 16:return U("Lazy");case 13:return U("Suspense");case 19:return U("SuspenseList");case 0:case 2:case 15:return t=me(t.type,!1),t;case 11:return t=me(t.type.render,!1),t;case 1:return t=me(t.type,!0),t;default:return""}}function je(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case N:return"Fragment";case A:return"Portal";case F:return"Profiler";case W:return"StrictMode";case z:return"Suspense";case X:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case ce:return(t.displayName||"Context")+".Consumer";case Z:return(t._context.displayName||"Context")+".Provider";case xe:var n=t.render;return t=t.displayName,t||(t=n.displayName||n.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case de:return n=t.displayName||null,n!==null?n:je(t.type)||"Memo";case oe:n=t._payload,t=t._init;try{return je(t(n))}catch{}}return null}function V(t){var n=t.type;switch(t.tag){case 24:return"Cache";case 9:return(n.displayName||"Context")+".Consumer";case 10:return(n._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=n.render,t=t.displayName||t.name||"",n.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return n;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return je(n);case 8:return n===W?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n}return null}function q(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function re(t){var n=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(n==="checkbox"||n==="radio")}function Je(t){var n=re(t)?"checked":"value",a=Object.getOwnPropertyDescriptor(t.constructor.prototype,n),l=""+t[n];if(!t.hasOwnProperty(n)&&typeof a<"u"&&typeof a.get=="function"&&typeof a.set=="function"){var c=a.get,h=a.set;return Object.defineProperty(t,n,{configurable:!0,get:function(){return c.call(this)},set:function(S){l=""+S,h.call(this,S)}}),Object.defineProperty(t,n,{enumerable:a.enumerable}),{getValue:function(){return l},setValue:function(S){l=""+S},stopTracking:function(){t._valueTracker=null,delete t[n]}}}}function Xe(t){t._valueTracker||(t._valueTracker=Je(t))}function jt(t){if(!t)return!1;var n=t._valueTracker;if(!n)return!0;var a=n.getValue(),l="";return t&&(l=re(t)?t.checked?"true":"false":t.value),t=l,t!==a?(n.setValue(t),!0):!1}function mt(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function es(t,n){var a=n.checked;return J({},n,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:a??t._wrapperState.initialChecked})}function lt(t,n){var a=n.defaultValue==null?"":n.defaultValue,l=n.checked!=null?n.checked:n.defaultChecked;a=q(n.value!=null?n.value:a),t._wrapperState={initialChecked:l,initialValue:a,controlled:n.type==="checkbox"||n.type==="radio"?n.checked!=null:n.value!=null}}function sn(t,n){n=n.checked,n!=null&&I(t,"checked",n,!1)}function Pt(t,n){sn(t,n);var a=q(n.value),l=n.type;if(a!=null)l==="number"?(a===0&&t.value===""||t.value!=a)&&(t.value=""+a):t.value!==""+a&&(t.value=""+a);else if(l==="submit"||l==="reset"){t.removeAttribute("value");return}n.hasOwnProperty("value")?Se(t,n.type,a):n.hasOwnProperty("defaultValue")&&Se(t,n.type,q(n.defaultValue)),n.checked==null&&n.defaultChecked!=null&&(t.defaultChecked=!!n.defaultChecked)}function Q(t,n,a){if(n.hasOwnProperty("value")||n.hasOwnProperty("defaultValue")){var l=n.type;if(!(l!=="submit"&&l!=="reset"||n.value!==void 0&&n.value!==null))return;n=""+t._wrapperState.initialValue,a||n===t.value||(t.value=n),t.defaultValue=n}a=t.name,a!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,a!==""&&(t.name=a)}function Se(t,n,a){(n!=="number"||mt(t.ownerDocument)!==t)&&(a==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+a&&(t.defaultValue=""+a))}var Oe=Array.isArray;function Tt(t,n,a,l){if(t=t.options,n){n={};for(var c=0;c<a.length;c++)n["$"+a[c]]=!0;for(a=0;a<t.length;a++)c=n.hasOwnProperty("$"+t[a].value),t[a].selected!==c&&(t[a].selected=c),c&&l&&(t[a].defaultSelected=!0)}else{for(a=""+q(a),n=null,c=0;c<t.length;c++){if(t[c].value===a){t[c].selected=!0,l&&(t[c].defaultSelected=!0);return}n!==null||t[c].disabled||(n=t[c])}n!==null&&(n.selected=!0)}}function an(t,n){if(n.dangerouslySetInnerHTML!=null)throw Error(r(91));return J({},n,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function ln(t,n){var a=n.value;if(a==null){if(a=n.children,n=n.defaultValue,a!=null){if(n!=null)throw Error(r(92));if(Oe(a)){if(1<a.length)throw Error(r(93));a=a[0]}n=a}n==null&&(n=""),a=n}t._wrapperState={initialValue:q(a)}}function ts(t,n){var a=q(n.value),l=q(n.defaultValue);a!=null&&(a=""+a,a!==t.value&&(t.value=a),n.defaultValue==null&&t.defaultValue!==a&&(t.defaultValue=a)),l!=null&&(t.defaultValue=""+l)}function li(t){var n=t.textContent;n===t._wrapperState.initialValue&&n!==""&&n!==null&&(t.value=n)}function Ns(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function la(t,n){return t==null||t==="http://www.w3.org/1999/xhtml"?Ns(n):t==="http://www.w3.org/2000/svg"&&n==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Cs,ri=(function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(n,a,l,c){MSApp.execUnsafeLocalFunction(function(){return t(n,a,l,c)})}:t})(function(t,n){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=n;else{for(Cs=Cs||document.createElement("div"),Cs.innerHTML="<svg>"+n.valueOf().toString()+"</svg>",n=Cs.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;n.firstChild;)t.appendChild(n.firstChild)}});function ns(t,n){if(n){var a=t.firstChild;if(a&&a===t.lastChild&&a.nodeType===3){a.nodeValue=n;return}}t.textContent=n}var ss={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Pl=["Webkit","ms","Moz","O"];Object.keys(ss).forEach(function(t){Pl.forEach(function(n){n=n+t.charAt(0).toUpperCase()+t.substring(1),ss[n]=ss[t]})});function oi(t,n,a){return n==null||typeof n=="boolean"||n===""?"":a||typeof n!="number"||n===0||ss.hasOwnProperty(t)&&ss[t]?(""+n).trim():n+"px"}function di(t,n){t=t.style;for(var a in n)if(n.hasOwnProperty(a)){var l=a.indexOf("--")===0,c=oi(a,n[a],l);a==="float"&&(a="cssFloat"),l?t.setProperty(a,c):t[a]=c}}var Bl=J({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function _s(t,n){if(n){if(Bl[t]&&(n.children!=null||n.dangerouslySetInnerHTML!=null))throw Error(r(137,t));if(n.dangerouslySetInnerHTML!=null){if(n.children!=null)throw Error(r(60));if(typeof n.dangerouslySetInnerHTML!="object"||!("__html"in n.dangerouslySetInnerHTML))throw Error(r(61))}if(n.style!=null&&typeof n.style!="object")throw Error(r(62))}}function ws(t,n){if(t.indexOf("-")===-1)return typeof n.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ra=null;function Es(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Rs=null,R=null,ie=null;function Me(t){if(t=Ra(t)){if(typeof Rs!="function")throw Error(r(280));var n=t.stateNode;n&&(n=zi(n),Rs(t.stateNode,t.type,n))}}function Gt(t){R?ie?ie.push(t):ie=[t]:R=t}function ut(){if(R){var t=R,n=ie;if(ie=R=null,Me(t),n)for(t=0;t<n.length;t++)Me(n[t])}}function Cn(t,n){return t(n)}function as(){}var oa=!1;function _n(t,n,a){if(oa)return t(n,a);oa=!0;try{return Cn(t,n,a)}finally{oa=!1,(R!==null||ie!==null)&&(as(),ut())}}function is(t,n){var a=t.stateNode;if(a===null)return null;var l=zi(a);if(l===null)return null;a=l[n];e:switch(n){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(l=!l.disabled)||(t=t.type,l=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!l;break e;default:t=!1}if(t)return null;if(a&&typeof a!="function")throw Error(r(231,n,typeof a));return a}var Ol=!1;if(x)try{var da={};Object.defineProperty(da,"passive",{get:function(){Ol=!0}}),window.addEventListener("test",da,da),window.removeEventListener("test",da,da)}catch{Ol=!1}function xh(t,n,a,l,c,h,S,E,B){var K=Array.prototype.slice.call(arguments,3);try{n.apply(a,K)}catch(te){this.onError(te)}}var ca=!1,ci=null,ui=!1,Wl=null,gh={onError:function(t){ca=!0,ci=t}};function mh(t,n,a,l,c,h,S,E,B){ca=!1,ci=null,xh.apply(gh,arguments)}function yh(t,n,a,l,c,h,S,E,B){if(mh.apply(this,arguments),ca){if(ca){var K=ci;ca=!1,ci=null}else throw Error(r(198));ui||(ui=!0,Wl=K)}}function ls(t){var n=t,a=t;if(t.alternate)for(;n.return;)n=n.return;else{t=n;do n=t,(n.flags&4098)!==0&&(a=n.return),t=n.return;while(t)}return n.tag===3?a:null}function qo(t){if(t.tag===13){var n=t.memoizedState;if(n===null&&(t=t.alternate,t!==null&&(n=t.memoizedState)),n!==null)return n.dehydrated}return null}function Jo(t){if(ls(t)!==t)throw Error(r(188))}function vh(t){var n=t.alternate;if(!n){if(n=ls(t),n===null)throw Error(r(188));return n!==t?null:t}for(var a=t,l=n;;){var c=a.return;if(c===null)break;var h=c.alternate;if(h===null){if(l=c.return,l!==null){a=l;continue}break}if(c.child===h.child){for(h=c.child;h;){if(h===a)return Jo(c),t;if(h===l)return Jo(c),n;h=h.sibling}throw Error(r(188))}if(a.return!==l.return)a=c,l=h;else{for(var S=!1,E=c.child;E;){if(E===a){S=!0,a=c,l=h;break}if(E===l){S=!0,l=c,a=h;break}E=E.sibling}if(!S){for(E=h.child;E;){if(E===a){S=!0,a=h,l=c;break}if(E===l){S=!0,l=h,a=c;break}E=E.sibling}if(!S)throw Error(r(189))}}if(a.alternate!==l)throw Error(r(190))}if(a.tag!==3)throw Error(r(188));return a.stateNode.current===a?t:n}function Ko(t){return t=vh(t),t!==null?Yo(t):null}function Yo(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var n=Yo(t);if(n!==null)return n;t=t.sibling}return null}var Zo=i.unstable_scheduleCallback,Xo=i.unstable_cancelCallback,bh=i.unstable_shouldYield,jh=i.unstable_requestPaint,Ge=i.unstable_now,Sh=i.unstable_getCurrentPriorityLevel,$l=i.unstable_ImmediatePriority,ed=i.unstable_UserBlockingPriority,fi=i.unstable_NormalPriority,kh=i.unstable_LowPriority,td=i.unstable_IdlePriority,hi=null,rn=null;function Nh(t){if(rn&&typeof rn.onCommitFiberRoot=="function")try{rn.onCommitFiberRoot(hi,t,void 0,(t.current.flags&128)===128)}catch{}}var qt=Math.clz32?Math.clz32:wh,Ch=Math.log,_h=Math.LN2;function wh(t){return t>>>=0,t===0?32:31-(Ch(t)/_h|0)|0}var pi=64,xi=4194304;function ua(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function gi(t,n){var a=t.pendingLanes;if(a===0)return 0;var l=0,c=t.suspendedLanes,h=t.pingedLanes,S=a&268435455;if(S!==0){var E=S&~c;E!==0?l=ua(E):(h&=S,h!==0&&(l=ua(h)))}else S=a&~c,S!==0?l=ua(S):h!==0&&(l=ua(h));if(l===0)return 0;if(n!==0&&n!==l&&(n&c)===0&&(c=l&-l,h=n&-n,c>=h||c===16&&(h&4194240)!==0))return n;if((l&4)!==0&&(l|=a&16),n=t.entangledLanes,n!==0)for(t=t.entanglements,n&=l;0<n;)a=31-qt(n),c=1<<a,l|=t[a],n&=~c;return l}function Eh(t,n){switch(t){case 1:case 2:case 4:return n+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Rh(t,n){for(var a=t.suspendedLanes,l=t.pingedLanes,c=t.expirationTimes,h=t.pendingLanes;0<h;){var S=31-qt(h),E=1<<S,B=c[S];B===-1?((E&a)===0||(E&l)!==0)&&(c[S]=Eh(E,n)):B<=n&&(t.expiredLanes|=E),h&=~E}}function Ml(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function nd(){var t=pi;return pi<<=1,(pi&4194240)===0&&(pi=64),t}function Fl(t){for(var n=[],a=0;31>a;a++)n.push(t);return n}function fa(t,n,a){t.pendingLanes|=n,n!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,n=31-qt(n),t[n]=a}function Ah(t,n){var a=t.pendingLanes&~n;t.pendingLanes=n,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=n,t.mutableReadLanes&=n,t.entangledLanes&=n,n=t.entanglements;var l=t.eventTimes;for(t=t.expirationTimes;0<a;){var c=31-qt(a),h=1<<c;n[c]=0,l[c]=-1,t[c]=-1,a&=~h}}function Ul(t,n){var a=t.entangledLanes|=n;for(t=t.entanglements;a;){var l=31-qt(a),c=1<<l;c&n|t[l]&n&&(t[l]|=n),a&=~c}}var De=0;function sd(t){return t&=-t,1<t?4<t?(t&268435455)!==0?16:536870912:4:1}var ad,Vl,id,ld,rd,Hl=!1,mi=[],wn=null,En=null,Rn=null,ha=new Map,pa=new Map,An=[],Th="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function od(t,n){switch(t){case"focusin":case"focusout":wn=null;break;case"dragenter":case"dragleave":En=null;break;case"mouseover":case"mouseout":Rn=null;break;case"pointerover":case"pointerout":ha.delete(n.pointerId);break;case"gotpointercapture":case"lostpointercapture":pa.delete(n.pointerId)}}function xa(t,n,a,l,c,h){return t===null||t.nativeEvent!==h?(t={blockedOn:n,domEventName:a,eventSystemFlags:l,nativeEvent:h,targetContainers:[c]},n!==null&&(n=Ra(n),n!==null&&Vl(n)),t):(t.eventSystemFlags|=l,n=t.targetContainers,c!==null&&n.indexOf(c)===-1&&n.push(c),t)}function zh(t,n,a,l,c){switch(n){case"focusin":return wn=xa(wn,t,n,a,l,c),!0;case"dragenter":return En=xa(En,t,n,a,l,c),!0;case"mouseover":return Rn=xa(Rn,t,n,a,l,c),!0;case"pointerover":var h=c.pointerId;return ha.set(h,xa(ha.get(h)||null,t,n,a,l,c)),!0;case"gotpointercapture":return h=c.pointerId,pa.set(h,xa(pa.get(h)||null,t,n,a,l,c)),!0}return!1}function dd(t){var n=rs(t.target);if(n!==null){var a=ls(n);if(a!==null){if(n=a.tag,n===13){if(n=qo(a),n!==null){t.blockedOn=n,rd(t.priority,function(){id(a)});return}}else if(n===3&&a.stateNode.current.memoizedState.isDehydrated){t.blockedOn=a.tag===3?a.stateNode.containerInfo:null;return}}}t.blockedOn=null}function yi(t){if(t.blockedOn!==null)return!1;for(var n=t.targetContainers;0<n.length;){var a=Gl(t.domEventName,t.eventSystemFlags,n[0],t.nativeEvent);if(a===null){a=t.nativeEvent;var l=new a.constructor(a.type,a);ra=l,a.target.dispatchEvent(l),ra=null}else return n=Ra(a),n!==null&&Vl(n),t.blockedOn=a,!1;n.shift()}return!0}function cd(t,n,a){yi(t)&&a.delete(n)}function Dh(){Hl=!1,wn!==null&&yi(wn)&&(wn=null),En!==null&&yi(En)&&(En=null),Rn!==null&&yi(Rn)&&(Rn=null),ha.forEach(cd),pa.forEach(cd)}function ga(t,n){t.blockedOn===n&&(t.blockedOn=null,Hl||(Hl=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,Dh)))}function ma(t){function n(c){return ga(c,t)}if(0<mi.length){ga(mi[0],t);for(var a=1;a<mi.length;a++){var l=mi[a];l.blockedOn===t&&(l.blockedOn=null)}}for(wn!==null&&ga(wn,t),En!==null&&ga(En,t),Rn!==null&&ga(Rn,t),ha.forEach(n),pa.forEach(n),a=0;a<An.length;a++)l=An[a],l.blockedOn===t&&(l.blockedOn=null);for(;0<An.length&&(a=An[0],a.blockedOn===null);)dd(a),a.blockedOn===null&&An.shift()}var As=P.ReactCurrentBatchConfig,vi=!0;function Lh(t,n,a,l){var c=De,h=As.transition;As.transition=null;try{De=1,Ql(t,n,a,l)}finally{De=c,As.transition=h}}function Ih(t,n,a,l){var c=De,h=As.transition;As.transition=null;try{De=4,Ql(t,n,a,l)}finally{De=c,As.transition=h}}function Ql(t,n,a,l){if(vi){var c=Gl(t,n,a,l);if(c===null)cr(t,n,l,bi,a),od(t,l);else if(zh(c,t,n,a,l))l.stopPropagation();else if(od(t,l),n&4&&-1<Th.indexOf(t)){for(;c!==null;){var h=Ra(c);if(h!==null&&ad(h),h=Gl(t,n,a,l),h===null&&cr(t,n,l,bi,a),h===c)break;c=h}c!==null&&l.stopPropagation()}else cr(t,n,l,null,a)}}var bi=null;function Gl(t,n,a,l){if(bi=null,t=Es(l),t=rs(t),t!==null)if(n=ls(t),n===null)t=null;else if(a=n.tag,a===13){if(t=qo(n),t!==null)return t;t=null}else if(a===3){if(n.stateNode.current.memoizedState.isDehydrated)return n.tag===3?n.stateNode.containerInfo:null;t=null}else n!==t&&(t=null);return bi=t,null}function ud(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Sh()){case $l:return 1;case ed:return 4;case fi:case kh:return 16;case td:return 536870912;default:return 16}default:return 16}}var Tn=null,ql=null,ji=null;function fd(){if(ji)return ji;var t,n=ql,a=n.length,l,c="value"in Tn?Tn.value:Tn.textContent,h=c.length;for(t=0;t<a&&n[t]===c[t];t++);var S=a-t;for(l=1;l<=S&&n[a-l]===c[h-l];l++);return ji=c.slice(t,1<l?1-l:void 0)}function Si(t){var n=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&n===13&&(t=13)):t=n,t===10&&(t=13),32<=t||t===13?t:0}function ki(){return!0}function hd(){return!1}function zt(t){function n(a,l,c,h,S){this._reactName=a,this._targetInst=c,this.type=l,this.nativeEvent=h,this.target=S,this.currentTarget=null;for(var E in t)t.hasOwnProperty(E)&&(a=t[E],this[E]=a?a(h):h[E]);return this.isDefaultPrevented=(h.defaultPrevented!=null?h.defaultPrevented:h.returnValue===!1)?ki:hd,this.isPropagationStopped=hd,this}return J(n.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():typeof a.returnValue!="unknown"&&(a.returnValue=!1),this.isDefaultPrevented=ki)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():typeof a.cancelBubble!="unknown"&&(a.cancelBubble=!0),this.isPropagationStopped=ki)},persist:function(){},isPersistent:ki}),n}var Ts={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Jl=zt(Ts),ya=J({},Ts,{view:0,detail:0}),Ph=zt(ya),Kl,Yl,va,Ni=J({},ya,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Xl,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==va&&(va&&t.type==="mousemove"?(Kl=t.screenX-va.screenX,Yl=t.screenY-va.screenY):Yl=Kl=0,va=t),Kl)},movementY:function(t){return"movementY"in t?t.movementY:Yl}}),pd=zt(Ni),Bh=J({},Ni,{dataTransfer:0}),Oh=zt(Bh),Wh=J({},ya,{relatedTarget:0}),Zl=zt(Wh),$h=J({},Ts,{animationName:0,elapsedTime:0,pseudoElement:0}),Mh=zt($h),Fh=J({},Ts,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Uh=zt(Fh),Vh=J({},Ts,{data:0}),xd=zt(Vh),Hh={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Qh={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Gh={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function qh(t){var n=this.nativeEvent;return n.getModifierState?n.getModifierState(t):(t=Gh[t])?!!n[t]:!1}function Xl(){return qh}var Jh=J({},ya,{key:function(t){if(t.key){var n=Hh[t.key]||t.key;if(n!=="Unidentified")return n}return t.type==="keypress"?(t=Si(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?Qh[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Xl,charCode:function(t){return t.type==="keypress"?Si(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Si(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),Kh=zt(Jh),Yh=J({},Ni,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),gd=zt(Yh),Zh=J({},ya,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Xl}),Xh=zt(Zh),ep=J({},Ts,{propertyName:0,elapsedTime:0,pseudoElement:0}),tp=zt(ep),np=J({},Ni,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),sp=zt(np),ap=[9,13,27,32],er=x&&"CompositionEvent"in window,ba=null;x&&"documentMode"in document&&(ba=document.documentMode);var ip=x&&"TextEvent"in window&&!ba,md=x&&(!er||ba&&8<ba&&11>=ba),yd=" ",vd=!1;function bd(t,n){switch(t){case"keyup":return ap.indexOf(n.keyCode)!==-1;case"keydown":return n.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function jd(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var zs=!1;function lp(t,n){switch(t){case"compositionend":return jd(n);case"keypress":return n.which!==32?null:(vd=!0,yd);case"textInput":return t=n.data,t===yd&&vd?null:t;default:return null}}function rp(t,n){if(zs)return t==="compositionend"||!er&&bd(t,n)?(t=fd(),ji=ql=Tn=null,zs=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(n.ctrlKey||n.altKey||n.metaKey)||n.ctrlKey&&n.altKey){if(n.char&&1<n.char.length)return n.char;if(n.which)return String.fromCharCode(n.which)}return null;case"compositionend":return md&&n.locale!=="ko"?null:n.data;default:return null}}var op={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Sd(t){var n=t&&t.nodeName&&t.nodeName.toLowerCase();return n==="input"?!!op[t.type]:n==="textarea"}function kd(t,n,a,l){Gt(l),n=Ri(n,"onChange"),0<n.length&&(a=new Jl("onChange","change",null,a,l),t.push({event:a,listeners:n}))}var ja=null,Sa=null;function dp(t){Md(t,0)}function Ci(t){var n=Bs(t);if(jt(n))return t}function cp(t,n){if(t==="change")return n}var Nd=!1;if(x){var tr;if(x){var nr="oninput"in document;if(!nr){var Cd=document.createElement("div");Cd.setAttribute("oninput","return;"),nr=typeof Cd.oninput=="function"}tr=nr}else tr=!1;Nd=tr&&(!document.documentMode||9<document.documentMode)}function _d(){ja&&(ja.detachEvent("onpropertychange",wd),Sa=ja=null)}function wd(t){if(t.propertyName==="value"&&Ci(Sa)){var n=[];kd(n,Sa,t,Es(t)),_n(dp,n)}}function up(t,n,a){t==="focusin"?(_d(),ja=n,Sa=a,ja.attachEvent("onpropertychange",wd)):t==="focusout"&&_d()}function fp(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Ci(Sa)}function hp(t,n){if(t==="click")return Ci(n)}function pp(t,n){if(t==="input"||t==="change")return Ci(n)}function xp(t,n){return t===n&&(t!==0||1/t===1/n)||t!==t&&n!==n}var Jt=typeof Object.is=="function"?Object.is:xp;function ka(t,n){if(Jt(t,n))return!0;if(typeof t!="object"||t===null||typeof n!="object"||n===null)return!1;var a=Object.keys(t),l=Object.keys(n);if(a.length!==l.length)return!1;for(l=0;l<a.length;l++){var c=a[l];if(!m.call(n,c)||!Jt(t[c],n[c]))return!1}return!0}function Ed(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Rd(t,n){var a=Ed(t);t=0;for(var l;a;){if(a.nodeType===3){if(l=t+a.textContent.length,t<=n&&l>=n)return{node:a,offset:n-t};t=l}e:{for(;a;){if(a.nextSibling){a=a.nextSibling;break e}a=a.parentNode}a=void 0}a=Ed(a)}}function Ad(t,n){return t&&n?t===n?!0:t&&t.nodeType===3?!1:n&&n.nodeType===3?Ad(t,n.parentNode):"contains"in t?t.contains(n):t.compareDocumentPosition?!!(t.compareDocumentPosition(n)&16):!1:!1}function Td(){for(var t=window,n=mt();n instanceof t.HTMLIFrameElement;){try{var a=typeof n.contentWindow.location.href=="string"}catch{a=!1}if(a)t=n.contentWindow;else break;n=mt(t.document)}return n}function sr(t){var n=t&&t.nodeName&&t.nodeName.toLowerCase();return n&&(n==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||n==="textarea"||t.contentEditable==="true")}function gp(t){var n=Td(),a=t.focusedElem,l=t.selectionRange;if(n!==a&&a&&a.ownerDocument&&Ad(a.ownerDocument.documentElement,a)){if(l!==null&&sr(a)){if(n=l.start,t=l.end,t===void 0&&(t=n),"selectionStart"in a)a.selectionStart=n,a.selectionEnd=Math.min(t,a.value.length);else if(t=(n=a.ownerDocument||document)&&n.defaultView||window,t.getSelection){t=t.getSelection();var c=a.textContent.length,h=Math.min(l.start,c);l=l.end===void 0?h:Math.min(l.end,c),!t.extend&&h>l&&(c=l,l=h,h=c),c=Rd(a,h);var S=Rd(a,l);c&&S&&(t.rangeCount!==1||t.anchorNode!==c.node||t.anchorOffset!==c.offset||t.focusNode!==S.node||t.focusOffset!==S.offset)&&(n=n.createRange(),n.setStart(c.node,c.offset),t.removeAllRanges(),h>l?(t.addRange(n),t.extend(S.node,S.offset)):(n.setEnd(S.node,S.offset),t.addRange(n)))}}for(n=[],t=a;t=t.parentNode;)t.nodeType===1&&n.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof a.focus=="function"&&a.focus(),a=0;a<n.length;a++)t=n[a],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var mp=x&&"documentMode"in document&&11>=document.documentMode,Ds=null,ar=null,Na=null,ir=!1;function zd(t,n,a){var l=a.window===a?a.document:a.nodeType===9?a:a.ownerDocument;ir||Ds==null||Ds!==mt(l)||(l=Ds,"selectionStart"in l&&sr(l)?l={start:l.selectionStart,end:l.selectionEnd}:(l=(l.ownerDocument&&l.ownerDocument.defaultView||window).getSelection(),l={anchorNode:l.anchorNode,anchorOffset:l.anchorOffset,focusNode:l.focusNode,focusOffset:l.focusOffset}),Na&&ka(Na,l)||(Na=l,l=Ri(ar,"onSelect"),0<l.length&&(n=new Jl("onSelect","select",null,n,a),t.push({event:n,listeners:l}),n.target=Ds)))}function _i(t,n){var a={};return a[t.toLowerCase()]=n.toLowerCase(),a["Webkit"+t]="webkit"+n,a["Moz"+t]="moz"+n,a}var Ls={animationend:_i("Animation","AnimationEnd"),animationiteration:_i("Animation","AnimationIteration"),animationstart:_i("Animation","AnimationStart"),transitionend:_i("Transition","TransitionEnd")},lr={},Dd={};x&&(Dd=document.createElement("div").style,"AnimationEvent"in window||(delete Ls.animationend.animation,delete Ls.animationiteration.animation,delete Ls.animationstart.animation),"TransitionEvent"in window||delete Ls.transitionend.transition);function wi(t){if(lr[t])return lr[t];if(!Ls[t])return t;var n=Ls[t],a;for(a in n)if(n.hasOwnProperty(a)&&a in Dd)return lr[t]=n[a];return t}var Ld=wi("animationend"),Id=wi("animationiteration"),Pd=wi("animationstart"),Bd=wi("transitionend"),Od=new Map,Wd="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function zn(t,n){Od.set(t,n),f(n,[t])}for(var rr=0;rr<Wd.length;rr++){var or=Wd[rr],yp=or.toLowerCase(),vp=or[0].toUpperCase()+or.slice(1);zn(yp,"on"+vp)}zn(Ld,"onAnimationEnd"),zn(Id,"onAnimationIteration"),zn(Pd,"onAnimationStart"),zn("dblclick","onDoubleClick"),zn("focusin","onFocus"),zn("focusout","onBlur"),zn(Bd,"onTransitionEnd"),p("onMouseEnter",["mouseout","mouseover"]),p("onMouseLeave",["mouseout","mouseover"]),p("onPointerEnter",["pointerout","pointerover"]),p("onPointerLeave",["pointerout","pointerover"]),f("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),f("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),f("onBeforeInput",["compositionend","keypress","textInput","paste"]),f("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),f("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),f("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ca="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),bp=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ca));function $d(t,n,a){var l=t.type||"unknown-event";t.currentTarget=a,yh(l,n,void 0,t),t.currentTarget=null}function Md(t,n){n=(n&4)!==0;for(var a=0;a<t.length;a++){var l=t[a],c=l.event;l=l.listeners;e:{var h=void 0;if(n)for(var S=l.length-1;0<=S;S--){var E=l[S],B=E.instance,K=E.currentTarget;if(E=E.listener,B!==h&&c.isPropagationStopped())break e;$d(c,E,K),h=B}else for(S=0;S<l.length;S++){if(E=l[S],B=E.instance,K=E.currentTarget,E=E.listener,B!==h&&c.isPropagationStopped())break e;$d(c,E,K),h=B}}}if(ui)throw t=Wl,ui=!1,Wl=null,t}function Pe(t,n){var a=n[gr];a===void 0&&(a=n[gr]=new Set);var l=t+"__bubble";a.has(l)||(Fd(n,t,2,!1),a.add(l))}function dr(t,n,a){var l=0;n&&(l|=4),Fd(a,t,l,n)}var Ei="_reactListening"+Math.random().toString(36).slice(2);function _a(t){if(!t[Ei]){t[Ei]=!0,o.forEach(function(a){a!=="selectionchange"&&(bp.has(a)||dr(a,!1,t),dr(a,!0,t))});var n=t.nodeType===9?t:t.ownerDocument;n===null||n[Ei]||(n[Ei]=!0,dr("selectionchange",!1,n))}}function Fd(t,n,a,l){switch(ud(n)){case 1:var c=Lh;break;case 4:c=Ih;break;default:c=Ql}a=c.bind(null,n,a,t),c=void 0,!Ol||n!=="touchstart"&&n!=="touchmove"&&n!=="wheel"||(c=!0),l?c!==void 0?t.addEventListener(n,a,{capture:!0,passive:c}):t.addEventListener(n,a,!0):c!==void 0?t.addEventListener(n,a,{passive:c}):t.addEventListener(n,a,!1)}function cr(t,n,a,l,c){var h=l;if((n&1)===0&&(n&2)===0&&l!==null)e:for(;;){if(l===null)return;var S=l.tag;if(S===3||S===4){var E=l.stateNode.containerInfo;if(E===c||E.nodeType===8&&E.parentNode===c)break;if(S===4)for(S=l.return;S!==null;){var B=S.tag;if((B===3||B===4)&&(B=S.stateNode.containerInfo,B===c||B.nodeType===8&&B.parentNode===c))return;S=S.return}for(;E!==null;){if(S=rs(E),S===null)return;if(B=S.tag,B===5||B===6){l=h=S;continue e}E=E.parentNode}}l=l.return}_n(function(){var K=h,te=Es(a),ne=[];e:{var ee=Od.get(t);if(ee!==void 0){var ue=Jl,he=t;switch(t){case"keypress":if(Si(a)===0)break e;case"keydown":case"keyup":ue=Kh;break;case"focusin":he="focus",ue=Zl;break;case"focusout":he="blur",ue=Zl;break;case"beforeblur":case"afterblur":ue=Zl;break;case"click":if(a.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ue=pd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ue=Oh;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ue=Xh;break;case Ld:case Id:case Pd:ue=Mh;break;case Bd:ue=tp;break;case"scroll":ue=Ph;break;case"wheel":ue=sp;break;case"copy":case"cut":case"paste":ue=Uh;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ue=gd}var ge=(n&4)!==0,qe=!ge&&t==="scroll",H=ge?ee!==null?ee+"Capture":null:ee;ge=[];for(var $=K,G;$!==null;){G=$;var le=G.stateNode;if(G.tag===5&&le!==null&&(G=le,H!==null&&(le=is($,H),le!=null&&ge.push(wa($,le,G)))),qe)break;$=$.return}0<ge.length&&(ee=new ue(ee,he,null,a,te),ne.push({event:ee,listeners:ge}))}}if((n&7)===0){e:{if(ee=t==="mouseover"||t==="pointerover",ue=t==="mouseout"||t==="pointerout",ee&&a!==ra&&(he=a.relatedTarget||a.fromElement)&&(rs(he)||he[pn]))break e;if((ue||ee)&&(ee=te.window===te?te:(ee=te.ownerDocument)?ee.defaultView||ee.parentWindow:window,ue?(he=a.relatedTarget||a.toElement,ue=K,he=he?rs(he):null,he!==null&&(qe=ls(he),he!==qe||he.tag!==5&&he.tag!==6)&&(he=null)):(ue=null,he=K),ue!==he)){if(ge=pd,le="onMouseLeave",H="onMouseEnter",$="mouse",(t==="pointerout"||t==="pointerover")&&(ge=gd,le="onPointerLeave",H="onPointerEnter",$="pointer"),qe=ue==null?ee:Bs(ue),G=he==null?ee:Bs(he),ee=new ge(le,$+"leave",ue,a,te),ee.target=qe,ee.relatedTarget=G,le=null,rs(te)===K&&(ge=new ge(H,$+"enter",he,a,te),ge.target=G,ge.relatedTarget=qe,le=ge),qe=le,ue&&he)t:{for(ge=ue,H=he,$=0,G=ge;G;G=Is(G))$++;for(G=0,le=H;le;le=Is(le))G++;for(;0<$-G;)ge=Is(ge),$--;for(;0<G-$;)H=Is(H),G--;for(;$--;){if(ge===H||H!==null&&ge===H.alternate)break t;ge=Is(ge),H=Is(H)}ge=null}else ge=null;ue!==null&&Ud(ne,ee,ue,ge,!1),he!==null&&qe!==null&&Ud(ne,qe,he,ge,!0)}}e:{if(ee=K?Bs(K):window,ue=ee.nodeName&&ee.nodeName.toLowerCase(),ue==="select"||ue==="input"&&ee.type==="file")var ye=cp;else if(Sd(ee))if(Nd)ye=pp;else{ye=fp;var ke=up}else(ue=ee.nodeName)&&ue.toLowerCase()==="input"&&(ee.type==="checkbox"||ee.type==="radio")&&(ye=hp);if(ye&&(ye=ye(t,K))){kd(ne,ye,a,te);break e}ke&&ke(t,ee,K),t==="focusout"&&(ke=ee._wrapperState)&&ke.controlled&&ee.type==="number"&&Se(ee,"number",ee.value)}switch(ke=K?Bs(K):window,t){case"focusin":(Sd(ke)||ke.contentEditable==="true")&&(Ds=ke,ar=K,Na=null);break;case"focusout":Na=ar=Ds=null;break;case"mousedown":ir=!0;break;case"contextmenu":case"mouseup":case"dragend":ir=!1,zd(ne,a,te);break;case"selectionchange":if(mp)break;case"keydown":case"keyup":zd(ne,a,te)}var Ne;if(er)e:{switch(t){case"compositionstart":var Ce="onCompositionStart";break e;case"compositionend":Ce="onCompositionEnd";break e;case"compositionupdate":Ce="onCompositionUpdate";break e}Ce=void 0}else zs?bd(t,a)&&(Ce="onCompositionEnd"):t==="keydown"&&a.keyCode===229&&(Ce="onCompositionStart");Ce&&(md&&a.locale!=="ko"&&(zs||Ce!=="onCompositionStart"?Ce==="onCompositionEnd"&&zs&&(Ne=fd()):(Tn=te,ql="value"in Tn?Tn.value:Tn.textContent,zs=!0)),ke=Ri(K,Ce),0<ke.length&&(Ce=new xd(Ce,t,null,a,te),ne.push({event:Ce,listeners:ke}),Ne?Ce.data=Ne:(Ne=jd(a),Ne!==null&&(Ce.data=Ne)))),(Ne=ip?lp(t,a):rp(t,a))&&(K=Ri(K,"onBeforeInput"),0<K.length&&(te=new xd("onBeforeInput","beforeinput",null,a,te),ne.push({event:te,listeners:K}),te.data=Ne))}Md(ne,n)})}function wa(t,n,a){return{instance:t,listener:n,currentTarget:a}}function Ri(t,n){for(var a=n+"Capture",l=[];t!==null;){var c=t,h=c.stateNode;c.tag===5&&h!==null&&(c=h,h=is(t,a),h!=null&&l.unshift(wa(t,h,c)),h=is(t,n),h!=null&&l.push(wa(t,h,c))),t=t.return}return l}function Is(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Ud(t,n,a,l,c){for(var h=n._reactName,S=[];a!==null&&a!==l;){var E=a,B=E.alternate,K=E.stateNode;if(B!==null&&B===l)break;E.tag===5&&K!==null&&(E=K,c?(B=is(a,h),B!=null&&S.unshift(wa(a,B,E))):c||(B=is(a,h),B!=null&&S.push(wa(a,B,E)))),a=a.return}S.length!==0&&t.push({event:n,listeners:S})}var jp=/\r\n?/g,Sp=/\u0000|\uFFFD/g;function Vd(t){return(typeof t=="string"?t:""+t).replace(jp,`
`).replace(Sp,"")}function Ai(t,n,a){if(n=Vd(n),Vd(t)!==n&&a)throw Error(r(425))}function Ti(){}var ur=null,fr=null;function hr(t,n){return t==="textarea"||t==="noscript"||typeof n.children=="string"||typeof n.children=="number"||typeof n.dangerouslySetInnerHTML=="object"&&n.dangerouslySetInnerHTML!==null&&n.dangerouslySetInnerHTML.__html!=null}var pr=typeof setTimeout=="function"?setTimeout:void 0,kp=typeof clearTimeout=="function"?clearTimeout:void 0,Hd=typeof Promise=="function"?Promise:void 0,Np=typeof queueMicrotask=="function"?queueMicrotask:typeof Hd<"u"?function(t){return Hd.resolve(null).then(t).catch(Cp)}:pr;function Cp(t){setTimeout(function(){throw t})}function xr(t,n){var a=n,l=0;do{var c=a.nextSibling;if(t.removeChild(a),c&&c.nodeType===8)if(a=c.data,a==="/$"){if(l===0){t.removeChild(c),ma(n);return}l--}else a!=="$"&&a!=="$?"&&a!=="$!"||l++;a=c}while(a);ma(n)}function Dn(t){for(;t!=null;t=t.nextSibling){var n=t.nodeType;if(n===1||n===3)break;if(n===8){if(n=t.data,n==="$"||n==="$!"||n==="$?")break;if(n==="/$")return null}}return t}function Qd(t){t=t.previousSibling;for(var n=0;t;){if(t.nodeType===8){var a=t.data;if(a==="$"||a==="$!"||a==="$?"){if(n===0)return t;n--}else a==="/$"&&n++}t=t.previousSibling}return null}var Ps=Math.random().toString(36).slice(2),on="__reactFiber$"+Ps,Ea="__reactProps$"+Ps,pn="__reactContainer$"+Ps,gr="__reactEvents$"+Ps,_p="__reactListeners$"+Ps,wp="__reactHandles$"+Ps;function rs(t){var n=t[on];if(n)return n;for(var a=t.parentNode;a;){if(n=a[pn]||a[on]){if(a=n.alternate,n.child!==null||a!==null&&a.child!==null)for(t=Qd(t);t!==null;){if(a=t[on])return a;t=Qd(t)}return n}t=a,a=t.parentNode}return null}function Ra(t){return t=t[on]||t[pn],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Bs(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(r(33))}function zi(t){return t[Ea]||null}var mr=[],Os=-1;function Ln(t){return{current:t}}function Be(t){0>Os||(t.current=mr[Os],mr[Os]=null,Os--)}function Le(t,n){Os++,mr[Os]=t.current,t.current=n}var In={},ft=Ln(In),St=Ln(!1),os=In;function Ws(t,n){var a=t.type.contextTypes;if(!a)return In;var l=t.stateNode;if(l&&l.__reactInternalMemoizedUnmaskedChildContext===n)return l.__reactInternalMemoizedMaskedChildContext;var c={},h;for(h in a)c[h]=n[h];return l&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=n,t.__reactInternalMemoizedMaskedChildContext=c),c}function kt(t){return t=t.childContextTypes,t!=null}function Di(){Be(St),Be(ft)}function Gd(t,n,a){if(ft.current!==In)throw Error(r(168));Le(ft,n),Le(St,a)}function qd(t,n,a){var l=t.stateNode;if(n=n.childContextTypes,typeof l.getChildContext!="function")return a;l=l.getChildContext();for(var c in l)if(!(c in n))throw Error(r(108,V(t)||"Unknown",c));return J({},a,l)}function Li(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||In,os=ft.current,Le(ft,t),Le(St,St.current),!0}function Jd(t,n,a){var l=t.stateNode;if(!l)throw Error(r(169));a?(t=qd(t,n,os),l.__reactInternalMemoizedMergedChildContext=t,Be(St),Be(ft),Le(ft,t)):Be(St),Le(St,a)}var xn=null,Ii=!1,yr=!1;function Kd(t){xn===null?xn=[t]:xn.push(t)}function Ep(t){Ii=!0,Kd(t)}function Pn(){if(!yr&&xn!==null){yr=!0;var t=0,n=De;try{var a=xn;for(De=1;t<a.length;t++){var l=a[t];do l=l(!0);while(l!==null)}xn=null,Ii=!1}catch(c){throw xn!==null&&(xn=xn.slice(t+1)),Zo($l,Pn),c}finally{De=n,yr=!1}}return null}var $s=[],Ms=0,Pi=null,Bi=0,Bt=[],Ot=0,ds=null,gn=1,mn="";function cs(t,n){$s[Ms++]=Bi,$s[Ms++]=Pi,Pi=t,Bi=n}function Yd(t,n,a){Bt[Ot++]=gn,Bt[Ot++]=mn,Bt[Ot++]=ds,ds=t;var l=gn;t=mn;var c=32-qt(l)-1;l&=~(1<<c),a+=1;var h=32-qt(n)+c;if(30<h){var S=c-c%5;h=(l&(1<<S)-1).toString(32),l>>=S,c-=S,gn=1<<32-qt(n)+c|a<<c|l,mn=h+t}else gn=1<<h|a<<c|l,mn=t}function vr(t){t.return!==null&&(cs(t,1),Yd(t,1,0))}function br(t){for(;t===Pi;)Pi=$s[--Ms],$s[Ms]=null,Bi=$s[--Ms],$s[Ms]=null;for(;t===ds;)ds=Bt[--Ot],Bt[Ot]=null,mn=Bt[--Ot],Bt[Ot]=null,gn=Bt[--Ot],Bt[Ot]=null}var Dt=null,Lt=null,We=!1,Kt=null;function Zd(t,n){var a=Ft(5,null,null,0);a.elementType="DELETED",a.stateNode=n,a.return=t,n=t.deletions,n===null?(t.deletions=[a],t.flags|=16):n.push(a)}function Xd(t,n){switch(t.tag){case 5:var a=t.type;return n=n.nodeType!==1||a.toLowerCase()!==n.nodeName.toLowerCase()?null:n,n!==null?(t.stateNode=n,Dt=t,Lt=Dn(n.firstChild),!0):!1;case 6:return n=t.pendingProps===""||n.nodeType!==3?null:n,n!==null?(t.stateNode=n,Dt=t,Lt=null,!0):!1;case 13:return n=n.nodeType!==8?null:n,n!==null?(a=ds!==null?{id:gn,overflow:mn}:null,t.memoizedState={dehydrated:n,treeContext:a,retryLane:1073741824},a=Ft(18,null,null,0),a.stateNode=n,a.return=t,t.child=a,Dt=t,Lt=null,!0):!1;default:return!1}}function jr(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Sr(t){if(We){var n=Lt;if(n){var a=n;if(!Xd(t,n)){if(jr(t))throw Error(r(418));n=Dn(a.nextSibling);var l=Dt;n&&Xd(t,n)?Zd(l,a):(t.flags=t.flags&-4097|2,We=!1,Dt=t)}}else{if(jr(t))throw Error(r(418));t.flags=t.flags&-4097|2,We=!1,Dt=t}}}function ec(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Dt=t}function Oi(t){if(t!==Dt)return!1;if(!We)return ec(t),We=!0,!1;var n;if((n=t.tag!==3)&&!(n=t.tag!==5)&&(n=t.type,n=n!=="head"&&n!=="body"&&!hr(t.type,t.memoizedProps)),n&&(n=Lt)){if(jr(t))throw tc(),Error(r(418));for(;n;)Zd(t,n),n=Dn(n.nextSibling)}if(ec(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(r(317));e:{for(t=t.nextSibling,n=0;t;){if(t.nodeType===8){var a=t.data;if(a==="/$"){if(n===0){Lt=Dn(t.nextSibling);break e}n--}else a!=="$"&&a!=="$!"&&a!=="$?"||n++}t=t.nextSibling}Lt=null}}else Lt=Dt?Dn(t.stateNode.nextSibling):null;return!0}function tc(){for(var t=Lt;t;)t=Dn(t.nextSibling)}function Fs(){Lt=Dt=null,We=!1}function kr(t){Kt===null?Kt=[t]:Kt.push(t)}var Rp=P.ReactCurrentBatchConfig;function Aa(t,n,a){if(t=a.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(a._owner){if(a=a._owner,a){if(a.tag!==1)throw Error(r(309));var l=a.stateNode}if(!l)throw Error(r(147,t));var c=l,h=""+t;return n!==null&&n.ref!==null&&typeof n.ref=="function"&&n.ref._stringRef===h?n.ref:(n=function(S){var E=c.refs;S===null?delete E[h]:E[h]=S},n._stringRef=h,n)}if(typeof t!="string")throw Error(r(284));if(!a._owner)throw Error(r(290,t))}return t}function Wi(t,n){throw t=Object.prototype.toString.call(n),Error(r(31,t==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":t))}function nc(t){var n=t._init;return n(t._payload)}function sc(t){function n(H,$){if(t){var G=H.deletions;G===null?(H.deletions=[$],H.flags|=16):G.push($)}}function a(H,$){if(!t)return null;for(;$!==null;)n(H,$),$=$.sibling;return null}function l(H,$){for(H=new Map;$!==null;)$.key!==null?H.set($.key,$):H.set($.index,$),$=$.sibling;return H}function c(H,$){return H=Vn(H,$),H.index=0,H.sibling=null,H}function h(H,$,G){return H.index=G,t?(G=H.alternate,G!==null?(G=G.index,G<$?(H.flags|=2,$):G):(H.flags|=2,$)):(H.flags|=1048576,$)}function S(H){return t&&H.alternate===null&&(H.flags|=2),H}function E(H,$,G,le){return $===null||$.tag!==6?($=xo(G,H.mode,le),$.return=H,$):($=c($,G),$.return=H,$)}function B(H,$,G,le){var ye=G.type;return ye===N?te(H,$,G.props.children,le,G.key):$!==null&&($.elementType===ye||typeof ye=="object"&&ye!==null&&ye.$$typeof===oe&&nc(ye)===$.type)?(le=c($,G.props),le.ref=Aa(H,$,G),le.return=H,le):(le=dl(G.type,G.key,G.props,null,H.mode,le),le.ref=Aa(H,$,G),le.return=H,le)}function K(H,$,G,le){return $===null||$.tag!==4||$.stateNode.containerInfo!==G.containerInfo||$.stateNode.implementation!==G.implementation?($=go(G,H.mode,le),$.return=H,$):($=c($,G.children||[]),$.return=H,$)}function te(H,$,G,le,ye){return $===null||$.tag!==7?($=ys(G,H.mode,le,ye),$.return=H,$):($=c($,G),$.return=H,$)}function ne(H,$,G){if(typeof $=="string"&&$!==""||typeof $=="number")return $=xo(""+$,H.mode,G),$.return=H,$;if(typeof $=="object"&&$!==null){switch($.$$typeof){case w:return G=dl($.type,$.key,$.props,null,H.mode,G),G.ref=Aa(H,null,$),G.return=H,G;case A:return $=go($,H.mode,G),$.return=H,$;case oe:var le=$._init;return ne(H,le($._payload),G)}if(Oe($)||se($))return $=ys($,H.mode,G,null),$.return=H,$;Wi(H,$)}return null}function ee(H,$,G,le){var ye=$!==null?$.key:null;if(typeof G=="string"&&G!==""||typeof G=="number")return ye!==null?null:E(H,$,""+G,le);if(typeof G=="object"&&G!==null){switch(G.$$typeof){case w:return G.key===ye?B(H,$,G,le):null;case A:return G.key===ye?K(H,$,G,le):null;case oe:return ye=G._init,ee(H,$,ye(G._payload),le)}if(Oe(G)||se(G))return ye!==null?null:te(H,$,G,le,null);Wi(H,G)}return null}function ue(H,$,G,le,ye){if(typeof le=="string"&&le!==""||typeof le=="number")return H=H.get(G)||null,E($,H,""+le,ye);if(typeof le=="object"&&le!==null){switch(le.$$typeof){case w:return H=H.get(le.key===null?G:le.key)||null,B($,H,le,ye);case A:return H=H.get(le.key===null?G:le.key)||null,K($,H,le,ye);case oe:var ke=le._init;return ue(H,$,G,ke(le._payload),ye)}if(Oe(le)||se(le))return H=H.get(G)||null,te($,H,le,ye,null);Wi($,le)}return null}function he(H,$,G,le){for(var ye=null,ke=null,Ne=$,Ce=$=0,it=null;Ne!==null&&Ce<G.length;Ce++){Ne.index>Ce?(it=Ne,Ne=null):it=Ne.sibling;var ze=ee(H,Ne,G[Ce],le);if(ze===null){Ne===null&&(Ne=it);break}t&&Ne&&ze.alternate===null&&n(H,Ne),$=h(ze,$,Ce),ke===null?ye=ze:ke.sibling=ze,ke=ze,Ne=it}if(Ce===G.length)return a(H,Ne),We&&cs(H,Ce),ye;if(Ne===null){for(;Ce<G.length;Ce++)Ne=ne(H,G[Ce],le),Ne!==null&&($=h(Ne,$,Ce),ke===null?ye=Ne:ke.sibling=Ne,ke=Ne);return We&&cs(H,Ce),ye}for(Ne=l(H,Ne);Ce<G.length;Ce++)it=ue(Ne,H,Ce,G[Ce],le),it!==null&&(t&&it.alternate!==null&&Ne.delete(it.key===null?Ce:it.key),$=h(it,$,Ce),ke===null?ye=it:ke.sibling=it,ke=it);return t&&Ne.forEach(function(Hn){return n(H,Hn)}),We&&cs(H,Ce),ye}function ge(H,$,G,le){var ye=se(G);if(typeof ye!="function")throw Error(r(150));if(G=ye.call(G),G==null)throw Error(r(151));for(var ke=ye=null,Ne=$,Ce=$=0,it=null,ze=G.next();Ne!==null&&!ze.done;Ce++,ze=G.next()){Ne.index>Ce?(it=Ne,Ne=null):it=Ne.sibling;var Hn=ee(H,Ne,ze.value,le);if(Hn===null){Ne===null&&(Ne=it);break}t&&Ne&&Hn.alternate===null&&n(H,Ne),$=h(Hn,$,Ce),ke===null?ye=Hn:ke.sibling=Hn,ke=Hn,Ne=it}if(ze.done)return a(H,Ne),We&&cs(H,Ce),ye;if(Ne===null){for(;!ze.done;Ce++,ze=G.next())ze=ne(H,ze.value,le),ze!==null&&($=h(ze,$,Ce),ke===null?ye=ze:ke.sibling=ze,ke=ze);return We&&cs(H,Ce),ye}for(Ne=l(H,Ne);!ze.done;Ce++,ze=G.next())ze=ue(Ne,H,Ce,ze.value,le),ze!==null&&(t&&ze.alternate!==null&&Ne.delete(ze.key===null?Ce:ze.key),$=h(ze,$,Ce),ke===null?ye=ze:ke.sibling=ze,ke=ze);return t&&Ne.forEach(function(ox){return n(H,ox)}),We&&cs(H,Ce),ye}function qe(H,$,G,le){if(typeof G=="object"&&G!==null&&G.type===N&&G.key===null&&(G=G.props.children),typeof G=="object"&&G!==null){switch(G.$$typeof){case w:e:{for(var ye=G.key,ke=$;ke!==null;){if(ke.key===ye){if(ye=G.type,ye===N){if(ke.tag===7){a(H,ke.sibling),$=c(ke,G.props.children),$.return=H,H=$;break e}}else if(ke.elementType===ye||typeof ye=="object"&&ye!==null&&ye.$$typeof===oe&&nc(ye)===ke.type){a(H,ke.sibling),$=c(ke,G.props),$.ref=Aa(H,ke,G),$.return=H,H=$;break e}a(H,ke);break}else n(H,ke);ke=ke.sibling}G.type===N?($=ys(G.props.children,H.mode,le,G.key),$.return=H,H=$):(le=dl(G.type,G.key,G.props,null,H.mode,le),le.ref=Aa(H,$,G),le.return=H,H=le)}return S(H);case A:e:{for(ke=G.key;$!==null;){if($.key===ke)if($.tag===4&&$.stateNode.containerInfo===G.containerInfo&&$.stateNode.implementation===G.implementation){a(H,$.sibling),$=c($,G.children||[]),$.return=H,H=$;break e}else{a(H,$);break}else n(H,$);$=$.sibling}$=go(G,H.mode,le),$.return=H,H=$}return S(H);case oe:return ke=G._init,qe(H,$,ke(G._payload),le)}if(Oe(G))return he(H,$,G,le);if(se(G))return ge(H,$,G,le);Wi(H,G)}return typeof G=="string"&&G!==""||typeof G=="number"?(G=""+G,$!==null&&$.tag===6?(a(H,$.sibling),$=c($,G),$.return=H,H=$):(a(H,$),$=xo(G,H.mode,le),$.return=H,H=$),S(H)):a(H,$)}return qe}var Us=sc(!0),ac=sc(!1),$i=Ln(null),Mi=null,Vs=null,Nr=null;function Cr(){Nr=Vs=Mi=null}function _r(t){var n=$i.current;Be($i),t._currentValue=n}function wr(t,n,a){for(;t!==null;){var l=t.alternate;if((t.childLanes&n)!==n?(t.childLanes|=n,l!==null&&(l.childLanes|=n)):l!==null&&(l.childLanes&n)!==n&&(l.childLanes|=n),t===a)break;t=t.return}}function Hs(t,n){Mi=t,Nr=Vs=null,t=t.dependencies,t!==null&&t.firstContext!==null&&((t.lanes&n)!==0&&(Nt=!0),t.firstContext=null)}function Wt(t){var n=t._currentValue;if(Nr!==t)if(t={context:t,memoizedValue:n,next:null},Vs===null){if(Mi===null)throw Error(r(308));Vs=t,Mi.dependencies={lanes:0,firstContext:t}}else Vs=Vs.next=t;return n}var us=null;function Er(t){us===null?us=[t]:us.push(t)}function ic(t,n,a,l){var c=n.interleaved;return c===null?(a.next=a,Er(n)):(a.next=c.next,c.next=a),n.interleaved=a,yn(t,l)}function yn(t,n){t.lanes|=n;var a=t.alternate;for(a!==null&&(a.lanes|=n),a=t,t=t.return;t!==null;)t.childLanes|=n,a=t.alternate,a!==null&&(a.childLanes|=n),a=t,t=t.return;return a.tag===3?a.stateNode:null}var Bn=!1;function Rr(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function lc(t,n){t=t.updateQueue,n.updateQueue===t&&(n.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function vn(t,n){return{eventTime:t,lane:n,tag:0,payload:null,callback:null,next:null}}function On(t,n,a){var l=t.updateQueue;if(l===null)return null;if(l=l.shared,(Te&2)!==0){var c=l.pending;return c===null?n.next=n:(n.next=c.next,c.next=n),l.pending=n,yn(t,a)}return c=l.interleaved,c===null?(n.next=n,Er(l)):(n.next=c.next,c.next=n),l.interleaved=n,yn(t,a)}function Fi(t,n,a){if(n=n.updateQueue,n!==null&&(n=n.shared,(a&4194240)!==0)){var l=n.lanes;l&=t.pendingLanes,a|=l,n.lanes=a,Ul(t,a)}}function rc(t,n){var a=t.updateQueue,l=t.alternate;if(l!==null&&(l=l.updateQueue,a===l)){var c=null,h=null;if(a=a.firstBaseUpdate,a!==null){do{var S={eventTime:a.eventTime,lane:a.lane,tag:a.tag,payload:a.payload,callback:a.callback,next:null};h===null?c=h=S:h=h.next=S,a=a.next}while(a!==null);h===null?c=h=n:h=h.next=n}else c=h=n;a={baseState:l.baseState,firstBaseUpdate:c,lastBaseUpdate:h,shared:l.shared,effects:l.effects},t.updateQueue=a;return}t=a.lastBaseUpdate,t===null?a.firstBaseUpdate=n:t.next=n,a.lastBaseUpdate=n}function Ui(t,n,a,l){var c=t.updateQueue;Bn=!1;var h=c.firstBaseUpdate,S=c.lastBaseUpdate,E=c.shared.pending;if(E!==null){c.shared.pending=null;var B=E,K=B.next;B.next=null,S===null?h=K:S.next=K,S=B;var te=t.alternate;te!==null&&(te=te.updateQueue,E=te.lastBaseUpdate,E!==S&&(E===null?te.firstBaseUpdate=K:E.next=K,te.lastBaseUpdate=B))}if(h!==null){var ne=c.baseState;S=0,te=K=B=null,E=h;do{var ee=E.lane,ue=E.eventTime;if((l&ee)===ee){te!==null&&(te=te.next={eventTime:ue,lane:0,tag:E.tag,payload:E.payload,callback:E.callback,next:null});e:{var he=t,ge=E;switch(ee=n,ue=a,ge.tag){case 1:if(he=ge.payload,typeof he=="function"){ne=he.call(ue,ne,ee);break e}ne=he;break e;case 3:he.flags=he.flags&-65537|128;case 0:if(he=ge.payload,ee=typeof he=="function"?he.call(ue,ne,ee):he,ee==null)break e;ne=J({},ne,ee);break e;case 2:Bn=!0}}E.callback!==null&&E.lane!==0&&(t.flags|=64,ee=c.effects,ee===null?c.effects=[E]:ee.push(E))}else ue={eventTime:ue,lane:ee,tag:E.tag,payload:E.payload,callback:E.callback,next:null},te===null?(K=te=ue,B=ne):te=te.next=ue,S|=ee;if(E=E.next,E===null){if(E=c.shared.pending,E===null)break;ee=E,E=ee.next,ee.next=null,c.lastBaseUpdate=ee,c.shared.pending=null}}while(!0);if(te===null&&(B=ne),c.baseState=B,c.firstBaseUpdate=K,c.lastBaseUpdate=te,n=c.shared.interleaved,n!==null){c=n;do S|=c.lane,c=c.next;while(c!==n)}else h===null&&(c.shared.lanes=0);ps|=S,t.lanes=S,t.memoizedState=ne}}function oc(t,n,a){if(t=n.effects,n.effects=null,t!==null)for(n=0;n<t.length;n++){var l=t[n],c=l.callback;if(c!==null){if(l.callback=null,l=a,typeof c!="function")throw Error(r(191,c));c.call(l)}}}var Ta={},dn=Ln(Ta),za=Ln(Ta),Da=Ln(Ta);function fs(t){if(t===Ta)throw Error(r(174));return t}function Ar(t,n){switch(Le(Da,n),Le(za,t),Le(dn,Ta),t=n.nodeType,t){case 9:case 11:n=(n=n.documentElement)?n.namespaceURI:la(null,"");break;default:t=t===8?n.parentNode:n,n=t.namespaceURI||null,t=t.tagName,n=la(n,t)}Be(dn),Le(dn,n)}function Qs(){Be(dn),Be(za),Be(Da)}function dc(t){fs(Da.current);var n=fs(dn.current),a=la(n,t.type);n!==a&&(Le(za,t),Le(dn,a))}function Tr(t){za.current===t&&(Be(dn),Be(za))}var Fe=Ln(0);function Vi(t){for(var n=t;n!==null;){if(n.tag===13){var a=n.memoizedState;if(a!==null&&(a=a.dehydrated,a===null||a.data==="$?"||a.data==="$!"))return n}else if(n.tag===19&&n.memoizedProps.revealOrder!==void 0){if((n.flags&128)!==0)return n}else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return null;n=n.return}n.sibling.return=n.return,n=n.sibling}return null}var zr=[];function Dr(){for(var t=0;t<zr.length;t++)zr[t]._workInProgressVersionPrimary=null;zr.length=0}var Hi=P.ReactCurrentDispatcher,Lr=P.ReactCurrentBatchConfig,hs=0,Ue=null,et=null,st=null,Qi=!1,La=!1,Ia=0,Ap=0;function ht(){throw Error(r(321))}function Ir(t,n){if(n===null)return!1;for(var a=0;a<n.length&&a<t.length;a++)if(!Jt(t[a],n[a]))return!1;return!0}function Pr(t,n,a,l,c,h){if(hs=h,Ue=n,n.memoizedState=null,n.updateQueue=null,n.lanes=0,Hi.current=t===null||t.memoizedState===null?Lp:Ip,t=a(l,c),La){h=0;do{if(La=!1,Ia=0,25<=h)throw Error(r(301));h+=1,st=et=null,n.updateQueue=null,Hi.current=Pp,t=a(l,c)}while(La)}if(Hi.current=Ji,n=et!==null&&et.next!==null,hs=0,st=et=Ue=null,Qi=!1,n)throw Error(r(300));return t}function Br(){var t=Ia!==0;return Ia=0,t}function cn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return st===null?Ue.memoizedState=st=t:st=st.next=t,st}function $t(){if(et===null){var t=Ue.alternate;t=t!==null?t.memoizedState:null}else t=et.next;var n=st===null?Ue.memoizedState:st.next;if(n!==null)st=n,et=t;else{if(t===null)throw Error(r(310));et=t,t={memoizedState:et.memoizedState,baseState:et.baseState,baseQueue:et.baseQueue,queue:et.queue,next:null},st===null?Ue.memoizedState=st=t:st=st.next=t}return st}function Pa(t,n){return typeof n=="function"?n(t):n}function Or(t){var n=$t(),a=n.queue;if(a===null)throw Error(r(311));a.lastRenderedReducer=t;var l=et,c=l.baseQueue,h=a.pending;if(h!==null){if(c!==null){var S=c.next;c.next=h.next,h.next=S}l.baseQueue=c=h,a.pending=null}if(c!==null){h=c.next,l=l.baseState;var E=S=null,B=null,K=h;do{var te=K.lane;if((hs&te)===te)B!==null&&(B=B.next={lane:0,action:K.action,hasEagerState:K.hasEagerState,eagerState:K.eagerState,next:null}),l=K.hasEagerState?K.eagerState:t(l,K.action);else{var ne={lane:te,action:K.action,hasEagerState:K.hasEagerState,eagerState:K.eagerState,next:null};B===null?(E=B=ne,S=l):B=B.next=ne,Ue.lanes|=te,ps|=te}K=K.next}while(K!==null&&K!==h);B===null?S=l:B.next=E,Jt(l,n.memoizedState)||(Nt=!0),n.memoizedState=l,n.baseState=S,n.baseQueue=B,a.lastRenderedState=l}if(t=a.interleaved,t!==null){c=t;do h=c.lane,Ue.lanes|=h,ps|=h,c=c.next;while(c!==t)}else c===null&&(a.lanes=0);return[n.memoizedState,a.dispatch]}function Wr(t){var n=$t(),a=n.queue;if(a===null)throw Error(r(311));a.lastRenderedReducer=t;var l=a.dispatch,c=a.pending,h=n.memoizedState;if(c!==null){a.pending=null;var S=c=c.next;do h=t(h,S.action),S=S.next;while(S!==c);Jt(h,n.memoizedState)||(Nt=!0),n.memoizedState=h,n.baseQueue===null&&(n.baseState=h),a.lastRenderedState=h}return[h,l]}function cc(){}function uc(t,n){var a=Ue,l=$t(),c=n(),h=!Jt(l.memoizedState,c);if(h&&(l.memoizedState=c,Nt=!0),l=l.queue,$r(pc.bind(null,a,l,t),[t]),l.getSnapshot!==n||h||st!==null&&st.memoizedState.tag&1){if(a.flags|=2048,Ba(9,hc.bind(null,a,l,c,n),void 0,null),at===null)throw Error(r(349));(hs&30)!==0||fc(a,n,c)}return c}function fc(t,n,a){t.flags|=16384,t={getSnapshot:n,value:a},n=Ue.updateQueue,n===null?(n={lastEffect:null,stores:null},Ue.updateQueue=n,n.stores=[t]):(a=n.stores,a===null?n.stores=[t]:a.push(t))}function hc(t,n,a,l){n.value=a,n.getSnapshot=l,xc(n)&&gc(t)}function pc(t,n,a){return a(function(){xc(n)&&gc(t)})}function xc(t){var n=t.getSnapshot;t=t.value;try{var a=n();return!Jt(t,a)}catch{return!0}}function gc(t){var n=yn(t,1);n!==null&&en(n,t,1,-1)}function mc(t){var n=cn();return typeof t=="function"&&(t=t()),n.memoizedState=n.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Pa,lastRenderedState:t},n.queue=t,t=t.dispatch=Dp.bind(null,Ue,t),[n.memoizedState,t]}function Ba(t,n,a,l){return t={tag:t,create:n,destroy:a,deps:l,next:null},n=Ue.updateQueue,n===null?(n={lastEffect:null,stores:null},Ue.updateQueue=n,n.lastEffect=t.next=t):(a=n.lastEffect,a===null?n.lastEffect=t.next=t:(l=a.next,a.next=t,t.next=l,n.lastEffect=t)),t}function yc(){return $t().memoizedState}function Gi(t,n,a,l){var c=cn();Ue.flags|=t,c.memoizedState=Ba(1|n,a,void 0,l===void 0?null:l)}function qi(t,n,a,l){var c=$t();l=l===void 0?null:l;var h=void 0;if(et!==null){var S=et.memoizedState;if(h=S.destroy,l!==null&&Ir(l,S.deps)){c.memoizedState=Ba(n,a,h,l);return}}Ue.flags|=t,c.memoizedState=Ba(1|n,a,h,l)}function vc(t,n){return Gi(8390656,8,t,n)}function $r(t,n){return qi(2048,8,t,n)}function bc(t,n){return qi(4,2,t,n)}function jc(t,n){return qi(4,4,t,n)}function Sc(t,n){if(typeof n=="function")return t=t(),n(t),function(){n(null)};if(n!=null)return t=t(),n.current=t,function(){n.current=null}}function kc(t,n,a){return a=a!=null?a.concat([t]):null,qi(4,4,Sc.bind(null,n,t),a)}function Mr(){}function Nc(t,n){var a=$t();n=n===void 0?null:n;var l=a.memoizedState;return l!==null&&n!==null&&Ir(n,l[1])?l[0]:(a.memoizedState=[t,n],t)}function Cc(t,n){var a=$t();n=n===void 0?null:n;var l=a.memoizedState;return l!==null&&n!==null&&Ir(n,l[1])?l[0]:(t=t(),a.memoizedState=[t,n],t)}function _c(t,n,a){return(hs&21)===0?(t.baseState&&(t.baseState=!1,Nt=!0),t.memoizedState=a):(Jt(a,n)||(a=nd(),Ue.lanes|=a,ps|=a,t.baseState=!0),n)}function Tp(t,n){var a=De;De=a!==0&&4>a?a:4,t(!0);var l=Lr.transition;Lr.transition={};try{t(!1),n()}finally{De=a,Lr.transition=l}}function wc(){return $t().memoizedState}function zp(t,n,a){var l=Fn(t);if(a={lane:l,action:a,hasEagerState:!1,eagerState:null,next:null},Ec(t))Rc(n,a);else if(a=ic(t,n,a,l),a!==null){var c=vt();en(a,t,l,c),Ac(a,n,l)}}function Dp(t,n,a){var l=Fn(t),c={lane:l,action:a,hasEagerState:!1,eagerState:null,next:null};if(Ec(t))Rc(n,c);else{var h=t.alternate;if(t.lanes===0&&(h===null||h.lanes===0)&&(h=n.lastRenderedReducer,h!==null))try{var S=n.lastRenderedState,E=h(S,a);if(c.hasEagerState=!0,c.eagerState=E,Jt(E,S)){var B=n.interleaved;B===null?(c.next=c,Er(n)):(c.next=B.next,B.next=c),n.interleaved=c;return}}catch{}finally{}a=ic(t,n,c,l),a!==null&&(c=vt(),en(a,t,l,c),Ac(a,n,l))}}function Ec(t){var n=t.alternate;return t===Ue||n!==null&&n===Ue}function Rc(t,n){La=Qi=!0;var a=t.pending;a===null?n.next=n:(n.next=a.next,a.next=n),t.pending=n}function Ac(t,n,a){if((a&4194240)!==0){var l=n.lanes;l&=t.pendingLanes,a|=l,n.lanes=a,Ul(t,a)}}var Ji={readContext:Wt,useCallback:ht,useContext:ht,useEffect:ht,useImperativeHandle:ht,useInsertionEffect:ht,useLayoutEffect:ht,useMemo:ht,useReducer:ht,useRef:ht,useState:ht,useDebugValue:ht,useDeferredValue:ht,useTransition:ht,useMutableSource:ht,useSyncExternalStore:ht,useId:ht,unstable_isNewReconciler:!1},Lp={readContext:Wt,useCallback:function(t,n){return cn().memoizedState=[t,n===void 0?null:n],t},useContext:Wt,useEffect:vc,useImperativeHandle:function(t,n,a){return a=a!=null?a.concat([t]):null,Gi(4194308,4,Sc.bind(null,n,t),a)},useLayoutEffect:function(t,n){return Gi(4194308,4,t,n)},useInsertionEffect:function(t,n){return Gi(4,2,t,n)},useMemo:function(t,n){var a=cn();return n=n===void 0?null:n,t=t(),a.memoizedState=[t,n],t},useReducer:function(t,n,a){var l=cn();return n=a!==void 0?a(n):n,l.memoizedState=l.baseState=n,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:n},l.queue=t,t=t.dispatch=zp.bind(null,Ue,t),[l.memoizedState,t]},useRef:function(t){var n=cn();return t={current:t},n.memoizedState=t},useState:mc,useDebugValue:Mr,useDeferredValue:function(t){return cn().memoizedState=t},useTransition:function(){var t=mc(!1),n=t[0];return t=Tp.bind(null,t[1]),cn().memoizedState=t,[n,t]},useMutableSource:function(){},useSyncExternalStore:function(t,n,a){var l=Ue,c=cn();if(We){if(a===void 0)throw Error(r(407));a=a()}else{if(a=n(),at===null)throw Error(r(349));(hs&30)!==0||fc(l,n,a)}c.memoizedState=a;var h={value:a,getSnapshot:n};return c.queue=h,vc(pc.bind(null,l,h,t),[t]),l.flags|=2048,Ba(9,hc.bind(null,l,h,a,n),void 0,null),a},useId:function(){var t=cn(),n=at.identifierPrefix;if(We){var a=mn,l=gn;a=(l&~(1<<32-qt(l)-1)).toString(32)+a,n=":"+n+"R"+a,a=Ia++,0<a&&(n+="H"+a.toString(32)),n+=":"}else a=Ap++,n=":"+n+"r"+a.toString(32)+":";return t.memoizedState=n},unstable_isNewReconciler:!1},Ip={readContext:Wt,useCallback:Nc,useContext:Wt,useEffect:$r,useImperativeHandle:kc,useInsertionEffect:bc,useLayoutEffect:jc,useMemo:Cc,useReducer:Or,useRef:yc,useState:function(){return Or(Pa)},useDebugValue:Mr,useDeferredValue:function(t){var n=$t();return _c(n,et.memoizedState,t)},useTransition:function(){var t=Or(Pa)[0],n=$t().memoizedState;return[t,n]},useMutableSource:cc,useSyncExternalStore:uc,useId:wc,unstable_isNewReconciler:!1},Pp={readContext:Wt,useCallback:Nc,useContext:Wt,useEffect:$r,useImperativeHandle:kc,useInsertionEffect:bc,useLayoutEffect:jc,useMemo:Cc,useReducer:Wr,useRef:yc,useState:function(){return Wr(Pa)},useDebugValue:Mr,useDeferredValue:function(t){var n=$t();return et===null?n.memoizedState=t:_c(n,et.memoizedState,t)},useTransition:function(){var t=Wr(Pa)[0],n=$t().memoizedState;return[t,n]},useMutableSource:cc,useSyncExternalStore:uc,useId:wc,unstable_isNewReconciler:!1};function Yt(t,n){if(t&&t.defaultProps){n=J({},n),t=t.defaultProps;for(var a in t)n[a]===void 0&&(n[a]=t[a]);return n}return n}function Fr(t,n,a,l){n=t.memoizedState,a=a(l,n),a=a==null?n:J({},n,a),t.memoizedState=a,t.lanes===0&&(t.updateQueue.baseState=a)}var Ki={isMounted:function(t){return(t=t._reactInternals)?ls(t)===t:!1},enqueueSetState:function(t,n,a){t=t._reactInternals;var l=vt(),c=Fn(t),h=vn(l,c);h.payload=n,a!=null&&(h.callback=a),n=On(t,h,c),n!==null&&(en(n,t,c,l),Fi(n,t,c))},enqueueReplaceState:function(t,n,a){t=t._reactInternals;var l=vt(),c=Fn(t),h=vn(l,c);h.tag=1,h.payload=n,a!=null&&(h.callback=a),n=On(t,h,c),n!==null&&(en(n,t,c,l),Fi(n,t,c))},enqueueForceUpdate:function(t,n){t=t._reactInternals;var a=vt(),l=Fn(t),c=vn(a,l);c.tag=2,n!=null&&(c.callback=n),n=On(t,c,l),n!==null&&(en(n,t,l,a),Fi(n,t,l))}};function Tc(t,n,a,l,c,h,S){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(l,h,S):n.prototype&&n.prototype.isPureReactComponent?!ka(a,l)||!ka(c,h):!0}function zc(t,n,a){var l=!1,c=In,h=n.contextType;return typeof h=="object"&&h!==null?h=Wt(h):(c=kt(n)?os:ft.current,l=n.contextTypes,h=(l=l!=null)?Ws(t,c):In),n=new n(a,h),t.memoizedState=n.state!==null&&n.state!==void 0?n.state:null,n.updater=Ki,t.stateNode=n,n._reactInternals=t,l&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=c,t.__reactInternalMemoizedMaskedChildContext=h),n}function Dc(t,n,a,l){t=n.state,typeof n.componentWillReceiveProps=="function"&&n.componentWillReceiveProps(a,l),typeof n.UNSAFE_componentWillReceiveProps=="function"&&n.UNSAFE_componentWillReceiveProps(a,l),n.state!==t&&Ki.enqueueReplaceState(n,n.state,null)}function Ur(t,n,a,l){var c=t.stateNode;c.props=a,c.state=t.memoizedState,c.refs={},Rr(t);var h=n.contextType;typeof h=="object"&&h!==null?c.context=Wt(h):(h=kt(n)?os:ft.current,c.context=Ws(t,h)),c.state=t.memoizedState,h=n.getDerivedStateFromProps,typeof h=="function"&&(Fr(t,n,h,a),c.state=t.memoizedState),typeof n.getDerivedStateFromProps=="function"||typeof c.getSnapshotBeforeUpdate=="function"||typeof c.UNSAFE_componentWillMount!="function"&&typeof c.componentWillMount!="function"||(n=c.state,typeof c.componentWillMount=="function"&&c.componentWillMount(),typeof c.UNSAFE_componentWillMount=="function"&&c.UNSAFE_componentWillMount(),n!==c.state&&Ki.enqueueReplaceState(c,c.state,null),Ui(t,a,c,l),c.state=t.memoizedState),typeof c.componentDidMount=="function"&&(t.flags|=4194308)}function Gs(t,n){try{var a="",l=n;do a+=be(l),l=l.return;while(l);var c=a}catch(h){c=`
Error generating stack: `+h.message+`
`+h.stack}return{value:t,source:n,stack:c,digest:null}}function Vr(t,n,a){return{value:t,source:null,stack:a??null,digest:n??null}}function Hr(t,n){try{console.error(n.value)}catch(a){setTimeout(function(){throw a})}}var Bp=typeof WeakMap=="function"?WeakMap:Map;function Lc(t,n,a){a=vn(-1,a),a.tag=3,a.payload={element:null};var l=n.value;return a.callback=function(){sl||(sl=!0,lo=l),Hr(t,n)},a}function Ic(t,n,a){a=vn(-1,a),a.tag=3;var l=t.type.getDerivedStateFromError;if(typeof l=="function"){var c=n.value;a.payload=function(){return l(c)},a.callback=function(){Hr(t,n)}}var h=t.stateNode;return h!==null&&typeof h.componentDidCatch=="function"&&(a.callback=function(){Hr(t,n),typeof l!="function"&&($n===null?$n=new Set([this]):$n.add(this));var S=n.stack;this.componentDidCatch(n.value,{componentStack:S!==null?S:""})}),a}function Pc(t,n,a){var l=t.pingCache;if(l===null){l=t.pingCache=new Bp;var c=new Set;l.set(n,c)}else c=l.get(n),c===void 0&&(c=new Set,l.set(n,c));c.has(a)||(c.add(a),t=Yp.bind(null,t,n,a),n.then(t,t))}function Bc(t){do{var n;if((n=t.tag===13)&&(n=t.memoizedState,n=n!==null?n.dehydrated!==null:!0),n)return t;t=t.return}while(t!==null);return null}function Oc(t,n,a,l,c){return(t.mode&1)===0?(t===n?t.flags|=65536:(t.flags|=128,a.flags|=131072,a.flags&=-52805,a.tag===1&&(a.alternate===null?a.tag=17:(n=vn(-1,1),n.tag=2,On(a,n,1))),a.lanes|=1),t):(t.flags|=65536,t.lanes=c,t)}var Op=P.ReactCurrentOwner,Nt=!1;function yt(t,n,a,l){n.child=t===null?ac(n,null,a,l):Us(n,t.child,a,l)}function Wc(t,n,a,l,c){a=a.render;var h=n.ref;return Hs(n,c),l=Pr(t,n,a,l,h,c),a=Br(),t!==null&&!Nt?(n.updateQueue=t.updateQueue,n.flags&=-2053,t.lanes&=~c,bn(t,n,c)):(We&&a&&vr(n),n.flags|=1,yt(t,n,l,c),n.child)}function $c(t,n,a,l,c){if(t===null){var h=a.type;return typeof h=="function"&&!po(h)&&h.defaultProps===void 0&&a.compare===null&&a.defaultProps===void 0?(n.tag=15,n.type=h,Mc(t,n,h,l,c)):(t=dl(a.type,null,l,n,n.mode,c),t.ref=n.ref,t.return=n,n.child=t)}if(h=t.child,(t.lanes&c)===0){var S=h.memoizedProps;if(a=a.compare,a=a!==null?a:ka,a(S,l)&&t.ref===n.ref)return bn(t,n,c)}return n.flags|=1,t=Vn(h,l),t.ref=n.ref,t.return=n,n.child=t}function Mc(t,n,a,l,c){if(t!==null){var h=t.memoizedProps;if(ka(h,l)&&t.ref===n.ref)if(Nt=!1,n.pendingProps=l=h,(t.lanes&c)!==0)(t.flags&131072)!==0&&(Nt=!0);else return n.lanes=t.lanes,bn(t,n,c)}return Qr(t,n,a,l,c)}function Fc(t,n,a){var l=n.pendingProps,c=l.children,h=t!==null?t.memoizedState:null;if(l.mode==="hidden")if((n.mode&1)===0)n.memoizedState={baseLanes:0,cachePool:null,transitions:null},Le(Js,It),It|=a;else{if((a&1073741824)===0)return t=h!==null?h.baseLanes|a:a,n.lanes=n.childLanes=1073741824,n.memoizedState={baseLanes:t,cachePool:null,transitions:null},n.updateQueue=null,Le(Js,It),It|=t,null;n.memoizedState={baseLanes:0,cachePool:null,transitions:null},l=h!==null?h.baseLanes:a,Le(Js,It),It|=l}else h!==null?(l=h.baseLanes|a,n.memoizedState=null):l=a,Le(Js,It),It|=l;return yt(t,n,c,a),n.child}function Uc(t,n){var a=n.ref;(t===null&&a!==null||t!==null&&t.ref!==a)&&(n.flags|=512,n.flags|=2097152)}function Qr(t,n,a,l,c){var h=kt(a)?os:ft.current;return h=Ws(n,h),Hs(n,c),a=Pr(t,n,a,l,h,c),l=Br(),t!==null&&!Nt?(n.updateQueue=t.updateQueue,n.flags&=-2053,t.lanes&=~c,bn(t,n,c)):(We&&l&&vr(n),n.flags|=1,yt(t,n,a,c),n.child)}function Vc(t,n,a,l,c){if(kt(a)){var h=!0;Li(n)}else h=!1;if(Hs(n,c),n.stateNode===null)Zi(t,n),zc(n,a,l),Ur(n,a,l,c),l=!0;else if(t===null){var S=n.stateNode,E=n.memoizedProps;S.props=E;var B=S.context,K=a.contextType;typeof K=="object"&&K!==null?K=Wt(K):(K=kt(a)?os:ft.current,K=Ws(n,K));var te=a.getDerivedStateFromProps,ne=typeof te=="function"||typeof S.getSnapshotBeforeUpdate=="function";ne||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(E!==l||B!==K)&&Dc(n,S,l,K),Bn=!1;var ee=n.memoizedState;S.state=ee,Ui(n,l,S,c),B=n.memoizedState,E!==l||ee!==B||St.current||Bn?(typeof te=="function"&&(Fr(n,a,te,l),B=n.memoizedState),(E=Bn||Tc(n,a,E,l,ee,B,K))?(ne||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount()),typeof S.componentDidMount=="function"&&(n.flags|=4194308)):(typeof S.componentDidMount=="function"&&(n.flags|=4194308),n.memoizedProps=l,n.memoizedState=B),S.props=l,S.state=B,S.context=K,l=E):(typeof S.componentDidMount=="function"&&(n.flags|=4194308),l=!1)}else{S=n.stateNode,lc(t,n),E=n.memoizedProps,K=n.type===n.elementType?E:Yt(n.type,E),S.props=K,ne=n.pendingProps,ee=S.context,B=a.contextType,typeof B=="object"&&B!==null?B=Wt(B):(B=kt(a)?os:ft.current,B=Ws(n,B));var ue=a.getDerivedStateFromProps;(te=typeof ue=="function"||typeof S.getSnapshotBeforeUpdate=="function")||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(E!==ne||ee!==B)&&Dc(n,S,l,B),Bn=!1,ee=n.memoizedState,S.state=ee,Ui(n,l,S,c);var he=n.memoizedState;E!==ne||ee!==he||St.current||Bn?(typeof ue=="function"&&(Fr(n,a,ue,l),he=n.memoizedState),(K=Bn||Tc(n,a,K,l,ee,he,B)||!1)?(te||typeof S.UNSAFE_componentWillUpdate!="function"&&typeof S.componentWillUpdate!="function"||(typeof S.componentWillUpdate=="function"&&S.componentWillUpdate(l,he,B),typeof S.UNSAFE_componentWillUpdate=="function"&&S.UNSAFE_componentWillUpdate(l,he,B)),typeof S.componentDidUpdate=="function"&&(n.flags|=4),typeof S.getSnapshotBeforeUpdate=="function"&&(n.flags|=1024)):(typeof S.componentDidUpdate!="function"||E===t.memoizedProps&&ee===t.memoizedState||(n.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||E===t.memoizedProps&&ee===t.memoizedState||(n.flags|=1024),n.memoizedProps=l,n.memoizedState=he),S.props=l,S.state=he,S.context=B,l=K):(typeof S.componentDidUpdate!="function"||E===t.memoizedProps&&ee===t.memoizedState||(n.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||E===t.memoizedProps&&ee===t.memoizedState||(n.flags|=1024),l=!1)}return Gr(t,n,a,l,h,c)}function Gr(t,n,a,l,c,h){Uc(t,n);var S=(n.flags&128)!==0;if(!l&&!S)return c&&Jd(n,a,!1),bn(t,n,h);l=n.stateNode,Op.current=n;var E=S&&typeof a.getDerivedStateFromError!="function"?null:l.render();return n.flags|=1,t!==null&&S?(n.child=Us(n,t.child,null,h),n.child=Us(n,null,E,h)):yt(t,n,E,h),n.memoizedState=l.state,c&&Jd(n,a,!0),n.child}function Hc(t){var n=t.stateNode;n.pendingContext?Gd(t,n.pendingContext,n.pendingContext!==n.context):n.context&&Gd(t,n.context,!1),Ar(t,n.containerInfo)}function Qc(t,n,a,l,c){return Fs(),kr(c),n.flags|=256,yt(t,n,a,l),n.child}var qr={dehydrated:null,treeContext:null,retryLane:0};function Jr(t){return{baseLanes:t,cachePool:null,transitions:null}}function Gc(t,n,a){var l=n.pendingProps,c=Fe.current,h=!1,S=(n.flags&128)!==0,E;if((E=S)||(E=t!==null&&t.memoizedState===null?!1:(c&2)!==0),E?(h=!0,n.flags&=-129):(t===null||t.memoizedState!==null)&&(c|=1),Le(Fe,c&1),t===null)return Sr(n),t=n.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?((n.mode&1)===0?n.lanes=1:t.data==="$!"?n.lanes=8:n.lanes=1073741824,null):(S=l.children,t=l.fallback,h?(l=n.mode,h=n.child,S={mode:"hidden",children:S},(l&1)===0&&h!==null?(h.childLanes=0,h.pendingProps=S):h=cl(S,l,0,null),t=ys(t,l,a,null),h.return=n,t.return=n,h.sibling=t,n.child=h,n.child.memoizedState=Jr(a),n.memoizedState=qr,t):Kr(n,S));if(c=t.memoizedState,c!==null&&(E=c.dehydrated,E!==null))return Wp(t,n,S,l,E,c,a);if(h){h=l.fallback,S=n.mode,c=t.child,E=c.sibling;var B={mode:"hidden",children:l.children};return(S&1)===0&&n.child!==c?(l=n.child,l.childLanes=0,l.pendingProps=B,n.deletions=null):(l=Vn(c,B),l.subtreeFlags=c.subtreeFlags&14680064),E!==null?h=Vn(E,h):(h=ys(h,S,a,null),h.flags|=2),h.return=n,l.return=n,l.sibling=h,n.child=l,l=h,h=n.child,S=t.child.memoizedState,S=S===null?Jr(a):{baseLanes:S.baseLanes|a,cachePool:null,transitions:S.transitions},h.memoizedState=S,h.childLanes=t.childLanes&~a,n.memoizedState=qr,l}return h=t.child,t=h.sibling,l=Vn(h,{mode:"visible",children:l.children}),(n.mode&1)===0&&(l.lanes=a),l.return=n,l.sibling=null,t!==null&&(a=n.deletions,a===null?(n.deletions=[t],n.flags|=16):a.push(t)),n.child=l,n.memoizedState=null,l}function Kr(t,n){return n=cl({mode:"visible",children:n},t.mode,0,null),n.return=t,t.child=n}function Yi(t,n,a,l){return l!==null&&kr(l),Us(n,t.child,null,a),t=Kr(n,n.pendingProps.children),t.flags|=2,n.memoizedState=null,t}function Wp(t,n,a,l,c,h,S){if(a)return n.flags&256?(n.flags&=-257,l=Vr(Error(r(422))),Yi(t,n,S,l)):n.memoizedState!==null?(n.child=t.child,n.flags|=128,null):(h=l.fallback,c=n.mode,l=cl({mode:"visible",children:l.children},c,0,null),h=ys(h,c,S,null),h.flags|=2,l.return=n,h.return=n,l.sibling=h,n.child=l,(n.mode&1)!==0&&Us(n,t.child,null,S),n.child.memoizedState=Jr(S),n.memoizedState=qr,h);if((n.mode&1)===0)return Yi(t,n,S,null);if(c.data==="$!"){if(l=c.nextSibling&&c.nextSibling.dataset,l)var E=l.dgst;return l=E,h=Error(r(419)),l=Vr(h,l,void 0),Yi(t,n,S,l)}if(E=(S&t.childLanes)!==0,Nt||E){if(l=at,l!==null){switch(S&-S){case 4:c=2;break;case 16:c=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:c=32;break;case 536870912:c=268435456;break;default:c=0}c=(c&(l.suspendedLanes|S))!==0?0:c,c!==0&&c!==h.retryLane&&(h.retryLane=c,yn(t,c),en(l,t,c,-1))}return ho(),l=Vr(Error(r(421))),Yi(t,n,S,l)}return c.data==="$?"?(n.flags|=128,n.child=t.child,n=Zp.bind(null,t),c._reactRetry=n,null):(t=h.treeContext,Lt=Dn(c.nextSibling),Dt=n,We=!0,Kt=null,t!==null&&(Bt[Ot++]=gn,Bt[Ot++]=mn,Bt[Ot++]=ds,gn=t.id,mn=t.overflow,ds=n),n=Kr(n,l.children),n.flags|=4096,n)}function qc(t,n,a){t.lanes|=n;var l=t.alternate;l!==null&&(l.lanes|=n),wr(t.return,n,a)}function Yr(t,n,a,l,c){var h=t.memoizedState;h===null?t.memoizedState={isBackwards:n,rendering:null,renderingStartTime:0,last:l,tail:a,tailMode:c}:(h.isBackwards=n,h.rendering=null,h.renderingStartTime=0,h.last=l,h.tail=a,h.tailMode=c)}function Jc(t,n,a){var l=n.pendingProps,c=l.revealOrder,h=l.tail;if(yt(t,n,l.children,a),l=Fe.current,(l&2)!==0)l=l&1|2,n.flags|=128;else{if(t!==null&&(t.flags&128)!==0)e:for(t=n.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&qc(t,a,n);else if(t.tag===19)qc(t,a,n);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===n)break e;for(;t.sibling===null;){if(t.return===null||t.return===n)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}l&=1}if(Le(Fe,l),(n.mode&1)===0)n.memoizedState=null;else switch(c){case"forwards":for(a=n.child,c=null;a!==null;)t=a.alternate,t!==null&&Vi(t)===null&&(c=a),a=a.sibling;a=c,a===null?(c=n.child,n.child=null):(c=a.sibling,a.sibling=null),Yr(n,!1,c,a,h);break;case"backwards":for(a=null,c=n.child,n.child=null;c!==null;){if(t=c.alternate,t!==null&&Vi(t)===null){n.child=c;break}t=c.sibling,c.sibling=a,a=c,c=t}Yr(n,!0,a,null,h);break;case"together":Yr(n,!1,null,null,void 0);break;default:n.memoizedState=null}return n.child}function Zi(t,n){(n.mode&1)===0&&t!==null&&(t.alternate=null,n.alternate=null,n.flags|=2)}function bn(t,n,a){if(t!==null&&(n.dependencies=t.dependencies),ps|=n.lanes,(a&n.childLanes)===0)return null;if(t!==null&&n.child!==t.child)throw Error(r(153));if(n.child!==null){for(t=n.child,a=Vn(t,t.pendingProps),n.child=a,a.return=n;t.sibling!==null;)t=t.sibling,a=a.sibling=Vn(t,t.pendingProps),a.return=n;a.sibling=null}return n.child}function $p(t,n,a){switch(n.tag){case 3:Hc(n),Fs();break;case 5:dc(n);break;case 1:kt(n.type)&&Li(n);break;case 4:Ar(n,n.stateNode.containerInfo);break;case 10:var l=n.type._context,c=n.memoizedProps.value;Le($i,l._currentValue),l._currentValue=c;break;case 13:if(l=n.memoizedState,l!==null)return l.dehydrated!==null?(Le(Fe,Fe.current&1),n.flags|=128,null):(a&n.child.childLanes)!==0?Gc(t,n,a):(Le(Fe,Fe.current&1),t=bn(t,n,a),t!==null?t.sibling:null);Le(Fe,Fe.current&1);break;case 19:if(l=(a&n.childLanes)!==0,(t.flags&128)!==0){if(l)return Jc(t,n,a);n.flags|=128}if(c=n.memoizedState,c!==null&&(c.rendering=null,c.tail=null,c.lastEffect=null),Le(Fe,Fe.current),l)break;return null;case 22:case 23:return n.lanes=0,Fc(t,n,a)}return bn(t,n,a)}var Kc,Zr,Yc,Zc;Kc=function(t,n){for(var a=n.child;a!==null;){if(a.tag===5||a.tag===6)t.appendChild(a.stateNode);else if(a.tag!==4&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===n)break;for(;a.sibling===null;){if(a.return===null||a.return===n)return;a=a.return}a.sibling.return=a.return,a=a.sibling}},Zr=function(){},Yc=function(t,n,a,l){var c=t.memoizedProps;if(c!==l){t=n.stateNode,fs(dn.current);var h=null;switch(a){case"input":c=es(t,c),l=es(t,l),h=[];break;case"select":c=J({},c,{value:void 0}),l=J({},l,{value:void 0}),h=[];break;case"textarea":c=an(t,c),l=an(t,l),h=[];break;default:typeof c.onClick!="function"&&typeof l.onClick=="function"&&(t.onclick=Ti)}_s(a,l);var S;a=null;for(K in c)if(!l.hasOwnProperty(K)&&c.hasOwnProperty(K)&&c[K]!=null)if(K==="style"){var E=c[K];for(S in E)E.hasOwnProperty(S)&&(a||(a={}),a[S]="")}else K!=="dangerouslySetInnerHTML"&&K!=="children"&&K!=="suppressContentEditableWarning"&&K!=="suppressHydrationWarning"&&K!=="autoFocus"&&(d.hasOwnProperty(K)?h||(h=[]):(h=h||[]).push(K,null));for(K in l){var B=l[K];if(E=c!=null?c[K]:void 0,l.hasOwnProperty(K)&&B!==E&&(B!=null||E!=null))if(K==="style")if(E){for(S in E)!E.hasOwnProperty(S)||B&&B.hasOwnProperty(S)||(a||(a={}),a[S]="");for(S in B)B.hasOwnProperty(S)&&E[S]!==B[S]&&(a||(a={}),a[S]=B[S])}else a||(h||(h=[]),h.push(K,a)),a=B;else K==="dangerouslySetInnerHTML"?(B=B?B.__html:void 0,E=E?E.__html:void 0,B!=null&&E!==B&&(h=h||[]).push(K,B)):K==="children"?typeof B!="string"&&typeof B!="number"||(h=h||[]).push(K,""+B):K!=="suppressContentEditableWarning"&&K!=="suppressHydrationWarning"&&(d.hasOwnProperty(K)?(B!=null&&K==="onScroll"&&Pe("scroll",t),h||E===B||(h=[])):(h=h||[]).push(K,B))}a&&(h=h||[]).push("style",a);var K=h;(n.updateQueue=K)&&(n.flags|=4)}},Zc=function(t,n,a,l){a!==l&&(n.flags|=4)};function Oa(t,n){if(!We)switch(t.tailMode){case"hidden":n=t.tail;for(var a=null;n!==null;)n.alternate!==null&&(a=n),n=n.sibling;a===null?t.tail=null:a.sibling=null;break;case"collapsed":a=t.tail;for(var l=null;a!==null;)a.alternate!==null&&(l=a),a=a.sibling;l===null?n||t.tail===null?t.tail=null:t.tail.sibling=null:l.sibling=null}}function pt(t){var n=t.alternate!==null&&t.alternate.child===t.child,a=0,l=0;if(n)for(var c=t.child;c!==null;)a|=c.lanes|c.childLanes,l|=c.subtreeFlags&14680064,l|=c.flags&14680064,c.return=t,c=c.sibling;else for(c=t.child;c!==null;)a|=c.lanes|c.childLanes,l|=c.subtreeFlags,l|=c.flags,c.return=t,c=c.sibling;return t.subtreeFlags|=l,t.childLanes=a,n}function Mp(t,n,a){var l=n.pendingProps;switch(br(n),n.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return pt(n),null;case 1:return kt(n.type)&&Di(),pt(n),null;case 3:return l=n.stateNode,Qs(),Be(St),Be(ft),Dr(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(t===null||t.child===null)&&(Oi(n)?n.flags|=4:t===null||t.memoizedState.isDehydrated&&(n.flags&256)===0||(n.flags|=1024,Kt!==null&&(co(Kt),Kt=null))),Zr(t,n),pt(n),null;case 5:Tr(n);var c=fs(Da.current);if(a=n.type,t!==null&&n.stateNode!=null)Yc(t,n,a,l,c),t.ref!==n.ref&&(n.flags|=512,n.flags|=2097152);else{if(!l){if(n.stateNode===null)throw Error(r(166));return pt(n),null}if(t=fs(dn.current),Oi(n)){l=n.stateNode,a=n.type;var h=n.memoizedProps;switch(l[on]=n,l[Ea]=h,t=(n.mode&1)!==0,a){case"dialog":Pe("cancel",l),Pe("close",l);break;case"iframe":case"object":case"embed":Pe("load",l);break;case"video":case"audio":for(c=0;c<Ca.length;c++)Pe(Ca[c],l);break;case"source":Pe("error",l);break;case"img":case"image":case"link":Pe("error",l),Pe("load",l);break;case"details":Pe("toggle",l);break;case"input":lt(l,h),Pe("invalid",l);break;case"select":l._wrapperState={wasMultiple:!!h.multiple},Pe("invalid",l);break;case"textarea":ln(l,h),Pe("invalid",l)}_s(a,h),c=null;for(var S in h)if(h.hasOwnProperty(S)){var E=h[S];S==="children"?typeof E=="string"?l.textContent!==E&&(h.suppressHydrationWarning!==!0&&Ai(l.textContent,E,t),c=["children",E]):typeof E=="number"&&l.textContent!==""+E&&(h.suppressHydrationWarning!==!0&&Ai(l.textContent,E,t),c=["children",""+E]):d.hasOwnProperty(S)&&E!=null&&S==="onScroll"&&Pe("scroll",l)}switch(a){case"input":Xe(l),Q(l,h,!0);break;case"textarea":Xe(l),li(l);break;case"select":case"option":break;default:typeof h.onClick=="function"&&(l.onclick=Ti)}l=c,n.updateQueue=l,l!==null&&(n.flags|=4)}else{S=c.nodeType===9?c:c.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Ns(a)),t==="http://www.w3.org/1999/xhtml"?a==="script"?(t=S.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof l.is=="string"?t=S.createElement(a,{is:l.is}):(t=S.createElement(a),a==="select"&&(S=t,l.multiple?S.multiple=!0:l.size&&(S.size=l.size))):t=S.createElementNS(t,a),t[on]=n,t[Ea]=l,Kc(t,n,!1,!1),n.stateNode=t;e:{switch(S=ws(a,l),a){case"dialog":Pe("cancel",t),Pe("close",t),c=l;break;case"iframe":case"object":case"embed":Pe("load",t),c=l;break;case"video":case"audio":for(c=0;c<Ca.length;c++)Pe(Ca[c],t);c=l;break;case"source":Pe("error",t),c=l;break;case"img":case"image":case"link":Pe("error",t),Pe("load",t),c=l;break;case"details":Pe("toggle",t),c=l;break;case"input":lt(t,l),c=es(t,l),Pe("invalid",t);break;case"option":c=l;break;case"select":t._wrapperState={wasMultiple:!!l.multiple},c=J({},l,{value:void 0}),Pe("invalid",t);break;case"textarea":ln(t,l),c=an(t,l),Pe("invalid",t);break;default:c=l}_s(a,c),E=c;for(h in E)if(E.hasOwnProperty(h)){var B=E[h];h==="style"?di(t,B):h==="dangerouslySetInnerHTML"?(B=B?B.__html:void 0,B!=null&&ri(t,B)):h==="children"?typeof B=="string"?(a!=="textarea"||B!=="")&&ns(t,B):typeof B=="number"&&ns(t,""+B):h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&h!=="autoFocus"&&(d.hasOwnProperty(h)?B!=null&&h==="onScroll"&&Pe("scroll",t):B!=null&&I(t,h,B,S))}switch(a){case"input":Xe(t),Q(t,l,!1);break;case"textarea":Xe(t),li(t);break;case"option":l.value!=null&&t.setAttribute("value",""+q(l.value));break;case"select":t.multiple=!!l.multiple,h=l.value,h!=null?Tt(t,!!l.multiple,h,!1):l.defaultValue!=null&&Tt(t,!!l.multiple,l.defaultValue,!0);break;default:typeof c.onClick=="function"&&(t.onclick=Ti)}switch(a){case"button":case"input":case"select":case"textarea":l=!!l.autoFocus;break e;case"img":l=!0;break e;default:l=!1}}l&&(n.flags|=4)}n.ref!==null&&(n.flags|=512,n.flags|=2097152)}return pt(n),null;case 6:if(t&&n.stateNode!=null)Zc(t,n,t.memoizedProps,l);else{if(typeof l!="string"&&n.stateNode===null)throw Error(r(166));if(a=fs(Da.current),fs(dn.current),Oi(n)){if(l=n.stateNode,a=n.memoizedProps,l[on]=n,(h=l.nodeValue!==a)&&(t=Dt,t!==null))switch(t.tag){case 3:Ai(l.nodeValue,a,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Ai(l.nodeValue,a,(t.mode&1)!==0)}h&&(n.flags|=4)}else l=(a.nodeType===9?a:a.ownerDocument).createTextNode(l),l[on]=n,n.stateNode=l}return pt(n),null;case 13:if(Be(Fe),l=n.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(We&&Lt!==null&&(n.mode&1)!==0&&(n.flags&128)===0)tc(),Fs(),n.flags|=98560,h=!1;else if(h=Oi(n),l!==null&&l.dehydrated!==null){if(t===null){if(!h)throw Error(r(318));if(h=n.memoizedState,h=h!==null?h.dehydrated:null,!h)throw Error(r(317));h[on]=n}else Fs(),(n.flags&128)===0&&(n.memoizedState=null),n.flags|=4;pt(n),h=!1}else Kt!==null&&(co(Kt),Kt=null),h=!0;if(!h)return n.flags&65536?n:null}return(n.flags&128)!==0?(n.lanes=a,n):(l=l!==null,l!==(t!==null&&t.memoizedState!==null)&&l&&(n.child.flags|=8192,(n.mode&1)!==0&&(t===null||(Fe.current&1)!==0?tt===0&&(tt=3):ho())),n.updateQueue!==null&&(n.flags|=4),pt(n),null);case 4:return Qs(),Zr(t,n),t===null&&_a(n.stateNode.containerInfo),pt(n),null;case 10:return _r(n.type._context),pt(n),null;case 17:return kt(n.type)&&Di(),pt(n),null;case 19:if(Be(Fe),h=n.memoizedState,h===null)return pt(n),null;if(l=(n.flags&128)!==0,S=h.rendering,S===null)if(l)Oa(h,!1);else{if(tt!==0||t!==null&&(t.flags&128)!==0)for(t=n.child;t!==null;){if(S=Vi(t),S!==null){for(n.flags|=128,Oa(h,!1),l=S.updateQueue,l!==null&&(n.updateQueue=l,n.flags|=4),n.subtreeFlags=0,l=a,a=n.child;a!==null;)h=a,t=l,h.flags&=14680066,S=h.alternate,S===null?(h.childLanes=0,h.lanes=t,h.child=null,h.subtreeFlags=0,h.memoizedProps=null,h.memoizedState=null,h.updateQueue=null,h.dependencies=null,h.stateNode=null):(h.childLanes=S.childLanes,h.lanes=S.lanes,h.child=S.child,h.subtreeFlags=0,h.deletions=null,h.memoizedProps=S.memoizedProps,h.memoizedState=S.memoizedState,h.updateQueue=S.updateQueue,h.type=S.type,t=S.dependencies,h.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),a=a.sibling;return Le(Fe,Fe.current&1|2),n.child}t=t.sibling}h.tail!==null&&Ge()>Ks&&(n.flags|=128,l=!0,Oa(h,!1),n.lanes=4194304)}else{if(!l)if(t=Vi(S),t!==null){if(n.flags|=128,l=!0,a=t.updateQueue,a!==null&&(n.updateQueue=a,n.flags|=4),Oa(h,!0),h.tail===null&&h.tailMode==="hidden"&&!S.alternate&&!We)return pt(n),null}else 2*Ge()-h.renderingStartTime>Ks&&a!==1073741824&&(n.flags|=128,l=!0,Oa(h,!1),n.lanes=4194304);h.isBackwards?(S.sibling=n.child,n.child=S):(a=h.last,a!==null?a.sibling=S:n.child=S,h.last=S)}return h.tail!==null?(n=h.tail,h.rendering=n,h.tail=n.sibling,h.renderingStartTime=Ge(),n.sibling=null,a=Fe.current,Le(Fe,l?a&1|2:a&1),n):(pt(n),null);case 22:case 23:return fo(),l=n.memoizedState!==null,t!==null&&t.memoizedState!==null!==l&&(n.flags|=8192),l&&(n.mode&1)!==0?(It&1073741824)!==0&&(pt(n),n.subtreeFlags&6&&(n.flags|=8192)):pt(n),null;case 24:return null;case 25:return null}throw Error(r(156,n.tag))}function Fp(t,n){switch(br(n),n.tag){case 1:return kt(n.type)&&Di(),t=n.flags,t&65536?(n.flags=t&-65537|128,n):null;case 3:return Qs(),Be(St),Be(ft),Dr(),t=n.flags,(t&65536)!==0&&(t&128)===0?(n.flags=t&-65537|128,n):null;case 5:return Tr(n),null;case 13:if(Be(Fe),t=n.memoizedState,t!==null&&t.dehydrated!==null){if(n.alternate===null)throw Error(r(340));Fs()}return t=n.flags,t&65536?(n.flags=t&-65537|128,n):null;case 19:return Be(Fe),null;case 4:return Qs(),null;case 10:return _r(n.type._context),null;case 22:case 23:return fo(),null;case 24:return null;default:return null}}var Xi=!1,xt=!1,Up=typeof WeakSet=="function"?WeakSet:Set,fe=null;function qs(t,n){var a=t.ref;if(a!==null)if(typeof a=="function")try{a(null)}catch(l){He(t,n,l)}else a.current=null}function Xr(t,n,a){try{a()}catch(l){He(t,n,l)}}var Xc=!1;function Vp(t,n){if(ur=vi,t=Td(),sr(t)){if("selectionStart"in t)var a={start:t.selectionStart,end:t.selectionEnd};else e:{a=(a=t.ownerDocument)&&a.defaultView||window;var l=a.getSelection&&a.getSelection();if(l&&l.rangeCount!==0){a=l.anchorNode;var c=l.anchorOffset,h=l.focusNode;l=l.focusOffset;try{a.nodeType,h.nodeType}catch{a=null;break e}var S=0,E=-1,B=-1,K=0,te=0,ne=t,ee=null;t:for(;;){for(var ue;ne!==a||c!==0&&ne.nodeType!==3||(E=S+c),ne!==h||l!==0&&ne.nodeType!==3||(B=S+l),ne.nodeType===3&&(S+=ne.nodeValue.length),(ue=ne.firstChild)!==null;)ee=ne,ne=ue;for(;;){if(ne===t)break t;if(ee===a&&++K===c&&(E=S),ee===h&&++te===l&&(B=S),(ue=ne.nextSibling)!==null)break;ne=ee,ee=ne.parentNode}ne=ue}a=E===-1||B===-1?null:{start:E,end:B}}else a=null}a=a||{start:0,end:0}}else a=null;for(fr={focusedElem:t,selectionRange:a},vi=!1,fe=n;fe!==null;)if(n=fe,t=n.child,(n.subtreeFlags&1028)!==0&&t!==null)t.return=n,fe=t;else for(;fe!==null;){n=fe;try{var he=n.alternate;if((n.flags&1024)!==0)switch(n.tag){case 0:case 11:case 15:break;case 1:if(he!==null){var ge=he.memoizedProps,qe=he.memoizedState,H=n.stateNode,$=H.getSnapshotBeforeUpdate(n.elementType===n.type?ge:Yt(n.type,ge),qe);H.__reactInternalSnapshotBeforeUpdate=$}break;case 3:var G=n.stateNode.containerInfo;G.nodeType===1?G.textContent="":G.nodeType===9&&G.documentElement&&G.removeChild(G.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(r(163))}}catch(le){He(n,n.return,le)}if(t=n.sibling,t!==null){t.return=n.return,fe=t;break}fe=n.return}return he=Xc,Xc=!1,he}function Wa(t,n,a){var l=n.updateQueue;if(l=l!==null?l.lastEffect:null,l!==null){var c=l=l.next;do{if((c.tag&t)===t){var h=c.destroy;c.destroy=void 0,h!==void 0&&Xr(n,a,h)}c=c.next}while(c!==l)}}function el(t,n){if(n=n.updateQueue,n=n!==null?n.lastEffect:null,n!==null){var a=n=n.next;do{if((a.tag&t)===t){var l=a.create;a.destroy=l()}a=a.next}while(a!==n)}}function eo(t){var n=t.ref;if(n!==null){var a=t.stateNode;switch(t.tag){case 5:t=a;break;default:t=a}typeof n=="function"?n(t):n.current=t}}function eu(t){var n=t.alternate;n!==null&&(t.alternate=null,eu(n)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(n=t.stateNode,n!==null&&(delete n[on],delete n[Ea],delete n[gr],delete n[_p],delete n[wp])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function tu(t){return t.tag===5||t.tag===3||t.tag===4}function nu(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||tu(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function to(t,n,a){var l=t.tag;if(l===5||l===6)t=t.stateNode,n?a.nodeType===8?a.parentNode.insertBefore(t,n):a.insertBefore(t,n):(a.nodeType===8?(n=a.parentNode,n.insertBefore(t,a)):(n=a,n.appendChild(t)),a=a._reactRootContainer,a!=null||n.onclick!==null||(n.onclick=Ti));else if(l!==4&&(t=t.child,t!==null))for(to(t,n,a),t=t.sibling;t!==null;)to(t,n,a),t=t.sibling}function no(t,n,a){var l=t.tag;if(l===5||l===6)t=t.stateNode,n?a.insertBefore(t,n):a.appendChild(t);else if(l!==4&&(t=t.child,t!==null))for(no(t,n,a),t=t.sibling;t!==null;)no(t,n,a),t=t.sibling}var rt=null,Zt=!1;function Wn(t,n,a){for(a=a.child;a!==null;)su(t,n,a),a=a.sibling}function su(t,n,a){if(rn&&typeof rn.onCommitFiberUnmount=="function")try{rn.onCommitFiberUnmount(hi,a)}catch{}switch(a.tag){case 5:xt||qs(a,n);case 6:var l=rt,c=Zt;rt=null,Wn(t,n,a),rt=l,Zt=c,rt!==null&&(Zt?(t=rt,a=a.stateNode,t.nodeType===8?t.parentNode.removeChild(a):t.removeChild(a)):rt.removeChild(a.stateNode));break;case 18:rt!==null&&(Zt?(t=rt,a=a.stateNode,t.nodeType===8?xr(t.parentNode,a):t.nodeType===1&&xr(t,a),ma(t)):xr(rt,a.stateNode));break;case 4:l=rt,c=Zt,rt=a.stateNode.containerInfo,Zt=!0,Wn(t,n,a),rt=l,Zt=c;break;case 0:case 11:case 14:case 15:if(!xt&&(l=a.updateQueue,l!==null&&(l=l.lastEffect,l!==null))){c=l=l.next;do{var h=c,S=h.destroy;h=h.tag,S!==void 0&&((h&2)!==0||(h&4)!==0)&&Xr(a,n,S),c=c.next}while(c!==l)}Wn(t,n,a);break;case 1:if(!xt&&(qs(a,n),l=a.stateNode,typeof l.componentWillUnmount=="function"))try{l.props=a.memoizedProps,l.state=a.memoizedState,l.componentWillUnmount()}catch(E){He(a,n,E)}Wn(t,n,a);break;case 21:Wn(t,n,a);break;case 22:a.mode&1?(xt=(l=xt)||a.memoizedState!==null,Wn(t,n,a),xt=l):Wn(t,n,a);break;default:Wn(t,n,a)}}function au(t){var n=t.updateQueue;if(n!==null){t.updateQueue=null;var a=t.stateNode;a===null&&(a=t.stateNode=new Up),n.forEach(function(l){var c=Xp.bind(null,t,l);a.has(l)||(a.add(l),l.then(c,c))})}}function Xt(t,n){var a=n.deletions;if(a!==null)for(var l=0;l<a.length;l++){var c=a[l];try{var h=t,S=n,E=S;e:for(;E!==null;){switch(E.tag){case 5:rt=E.stateNode,Zt=!1;break e;case 3:rt=E.stateNode.containerInfo,Zt=!0;break e;case 4:rt=E.stateNode.containerInfo,Zt=!0;break e}E=E.return}if(rt===null)throw Error(r(160));su(h,S,c),rt=null,Zt=!1;var B=c.alternate;B!==null&&(B.return=null),c.return=null}catch(K){He(c,n,K)}}if(n.subtreeFlags&12854)for(n=n.child;n!==null;)iu(n,t),n=n.sibling}function iu(t,n){var a=t.alternate,l=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Xt(n,t),un(t),l&4){try{Wa(3,t,t.return),el(3,t)}catch(ge){He(t,t.return,ge)}try{Wa(5,t,t.return)}catch(ge){He(t,t.return,ge)}}break;case 1:Xt(n,t),un(t),l&512&&a!==null&&qs(a,a.return);break;case 5:if(Xt(n,t),un(t),l&512&&a!==null&&qs(a,a.return),t.flags&32){var c=t.stateNode;try{ns(c,"")}catch(ge){He(t,t.return,ge)}}if(l&4&&(c=t.stateNode,c!=null)){var h=t.memoizedProps,S=a!==null?a.memoizedProps:h,E=t.type,B=t.updateQueue;if(t.updateQueue=null,B!==null)try{E==="input"&&h.type==="radio"&&h.name!=null&&sn(c,h),ws(E,S);var K=ws(E,h);for(S=0;S<B.length;S+=2){var te=B[S],ne=B[S+1];te==="style"?di(c,ne):te==="dangerouslySetInnerHTML"?ri(c,ne):te==="children"?ns(c,ne):I(c,te,ne,K)}switch(E){case"input":Pt(c,h);break;case"textarea":ts(c,h);break;case"select":var ee=c._wrapperState.wasMultiple;c._wrapperState.wasMultiple=!!h.multiple;var ue=h.value;ue!=null?Tt(c,!!h.multiple,ue,!1):ee!==!!h.multiple&&(h.defaultValue!=null?Tt(c,!!h.multiple,h.defaultValue,!0):Tt(c,!!h.multiple,h.multiple?[]:"",!1))}c[Ea]=h}catch(ge){He(t,t.return,ge)}}break;case 6:if(Xt(n,t),un(t),l&4){if(t.stateNode===null)throw Error(r(162));c=t.stateNode,h=t.memoizedProps;try{c.nodeValue=h}catch(ge){He(t,t.return,ge)}}break;case 3:if(Xt(n,t),un(t),l&4&&a!==null&&a.memoizedState.isDehydrated)try{ma(n.containerInfo)}catch(ge){He(t,t.return,ge)}break;case 4:Xt(n,t),un(t);break;case 13:Xt(n,t),un(t),c=t.child,c.flags&8192&&(h=c.memoizedState!==null,c.stateNode.isHidden=h,!h||c.alternate!==null&&c.alternate.memoizedState!==null||(io=Ge())),l&4&&au(t);break;case 22:if(te=a!==null&&a.memoizedState!==null,t.mode&1?(xt=(K=xt)||te,Xt(n,t),xt=K):Xt(n,t),un(t),l&8192){if(K=t.memoizedState!==null,(t.stateNode.isHidden=K)&&!te&&(t.mode&1)!==0)for(fe=t,te=t.child;te!==null;){for(ne=fe=te;fe!==null;){switch(ee=fe,ue=ee.child,ee.tag){case 0:case 11:case 14:case 15:Wa(4,ee,ee.return);break;case 1:qs(ee,ee.return);var he=ee.stateNode;if(typeof he.componentWillUnmount=="function"){l=ee,a=ee.return;try{n=l,he.props=n.memoizedProps,he.state=n.memoizedState,he.componentWillUnmount()}catch(ge){He(l,a,ge)}}break;case 5:qs(ee,ee.return);break;case 22:if(ee.memoizedState!==null){ou(ne);continue}}ue!==null?(ue.return=ee,fe=ue):ou(ne)}te=te.sibling}e:for(te=null,ne=t;;){if(ne.tag===5){if(te===null){te=ne;try{c=ne.stateNode,K?(h=c.style,typeof h.setProperty=="function"?h.setProperty("display","none","important"):h.display="none"):(E=ne.stateNode,B=ne.memoizedProps.style,S=B!=null&&B.hasOwnProperty("display")?B.display:null,E.style.display=oi("display",S))}catch(ge){He(t,t.return,ge)}}}else if(ne.tag===6){if(te===null)try{ne.stateNode.nodeValue=K?"":ne.memoizedProps}catch(ge){He(t,t.return,ge)}}else if((ne.tag!==22&&ne.tag!==23||ne.memoizedState===null||ne===t)&&ne.child!==null){ne.child.return=ne,ne=ne.child;continue}if(ne===t)break e;for(;ne.sibling===null;){if(ne.return===null||ne.return===t)break e;te===ne&&(te=null),ne=ne.return}te===ne&&(te=null),ne.sibling.return=ne.return,ne=ne.sibling}}break;case 19:Xt(n,t),un(t),l&4&&au(t);break;case 21:break;default:Xt(n,t),un(t)}}function un(t){var n=t.flags;if(n&2){try{e:{for(var a=t.return;a!==null;){if(tu(a)){var l=a;break e}a=a.return}throw Error(r(160))}switch(l.tag){case 5:var c=l.stateNode;l.flags&32&&(ns(c,""),l.flags&=-33);var h=nu(t);no(t,h,c);break;case 3:case 4:var S=l.stateNode.containerInfo,E=nu(t);to(t,E,S);break;default:throw Error(r(161))}}catch(B){He(t,t.return,B)}t.flags&=-3}n&4096&&(t.flags&=-4097)}function Hp(t,n,a){fe=t,lu(t)}function lu(t,n,a){for(var l=(t.mode&1)!==0;fe!==null;){var c=fe,h=c.child;if(c.tag===22&&l){var S=c.memoizedState!==null||Xi;if(!S){var E=c.alternate,B=E!==null&&E.memoizedState!==null||xt;E=Xi;var K=xt;if(Xi=S,(xt=B)&&!K)for(fe=c;fe!==null;)S=fe,B=S.child,S.tag===22&&S.memoizedState!==null?du(c):B!==null?(B.return=S,fe=B):du(c);for(;h!==null;)fe=h,lu(h),h=h.sibling;fe=c,Xi=E,xt=K}ru(t)}else(c.subtreeFlags&8772)!==0&&h!==null?(h.return=c,fe=h):ru(t)}}function ru(t){for(;fe!==null;){var n=fe;if((n.flags&8772)!==0){var a=n.alternate;try{if((n.flags&8772)!==0)switch(n.tag){case 0:case 11:case 15:xt||el(5,n);break;case 1:var l=n.stateNode;if(n.flags&4&&!xt)if(a===null)l.componentDidMount();else{var c=n.elementType===n.type?a.memoizedProps:Yt(n.type,a.memoizedProps);l.componentDidUpdate(c,a.memoizedState,l.__reactInternalSnapshotBeforeUpdate)}var h=n.updateQueue;h!==null&&oc(n,h,l);break;case 3:var S=n.updateQueue;if(S!==null){if(a=null,n.child!==null)switch(n.child.tag){case 5:a=n.child.stateNode;break;case 1:a=n.child.stateNode}oc(n,S,a)}break;case 5:var E=n.stateNode;if(a===null&&n.flags&4){a=E;var B=n.memoizedProps;switch(n.type){case"button":case"input":case"select":case"textarea":B.autoFocus&&a.focus();break;case"img":B.src&&(a.src=B.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(n.memoizedState===null){var K=n.alternate;if(K!==null){var te=K.memoizedState;if(te!==null){var ne=te.dehydrated;ne!==null&&ma(ne)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(r(163))}xt||n.flags&512&&eo(n)}catch(ee){He(n,n.return,ee)}}if(n===t){fe=null;break}if(a=n.sibling,a!==null){a.return=n.return,fe=a;break}fe=n.return}}function ou(t){for(;fe!==null;){var n=fe;if(n===t){fe=null;break}var a=n.sibling;if(a!==null){a.return=n.return,fe=a;break}fe=n.return}}function du(t){for(;fe!==null;){var n=fe;try{switch(n.tag){case 0:case 11:case 15:var a=n.return;try{el(4,n)}catch(B){He(n,a,B)}break;case 1:var l=n.stateNode;if(typeof l.componentDidMount=="function"){var c=n.return;try{l.componentDidMount()}catch(B){He(n,c,B)}}var h=n.return;try{eo(n)}catch(B){He(n,h,B)}break;case 5:var S=n.return;try{eo(n)}catch(B){He(n,S,B)}}}catch(B){He(n,n.return,B)}if(n===t){fe=null;break}var E=n.sibling;if(E!==null){E.return=n.return,fe=E;break}fe=n.return}}var Qp=Math.ceil,tl=P.ReactCurrentDispatcher,so=P.ReactCurrentOwner,Mt=P.ReactCurrentBatchConfig,Te=0,at=null,Ke=null,ot=0,It=0,Js=Ln(0),tt=0,$a=null,ps=0,nl=0,ao=0,Ma=null,Ct=null,io=0,Ks=1/0,jn=null,sl=!1,lo=null,$n=null,al=!1,Mn=null,il=0,Fa=0,ro=null,ll=-1,rl=0;function vt(){return(Te&6)!==0?Ge():ll!==-1?ll:ll=Ge()}function Fn(t){return(t.mode&1)===0?1:(Te&2)!==0&&ot!==0?ot&-ot:Rp.transition!==null?(rl===0&&(rl=nd()),rl):(t=De,t!==0||(t=window.event,t=t===void 0?16:ud(t.type)),t)}function en(t,n,a,l){if(50<Fa)throw Fa=0,ro=null,Error(r(185));fa(t,a,l),((Te&2)===0||t!==at)&&(t===at&&((Te&2)===0&&(nl|=a),tt===4&&Un(t,ot)),_t(t,l),a===1&&Te===0&&(n.mode&1)===0&&(Ks=Ge()+500,Ii&&Pn()))}function _t(t,n){var a=t.callbackNode;Rh(t,n);var l=gi(t,t===at?ot:0);if(l===0)a!==null&&Xo(a),t.callbackNode=null,t.callbackPriority=0;else if(n=l&-l,t.callbackPriority!==n){if(a!=null&&Xo(a),n===1)t.tag===0?Ep(uu.bind(null,t)):Kd(uu.bind(null,t)),Np(function(){(Te&6)===0&&Pn()}),a=null;else{switch(sd(l)){case 1:a=$l;break;case 4:a=ed;break;case 16:a=fi;break;case 536870912:a=td;break;default:a=fi}a=vu(a,cu.bind(null,t))}t.callbackPriority=n,t.callbackNode=a}}function cu(t,n){if(ll=-1,rl=0,(Te&6)!==0)throw Error(r(327));var a=t.callbackNode;if(Ys()&&t.callbackNode!==a)return null;var l=gi(t,t===at?ot:0);if(l===0)return null;if((l&30)!==0||(l&t.expiredLanes)!==0||n)n=ol(t,l);else{n=l;var c=Te;Te|=2;var h=hu();(at!==t||ot!==n)&&(jn=null,Ks=Ge()+500,gs(t,n));do try{Jp();break}catch(E){fu(t,E)}while(!0);Cr(),tl.current=h,Te=c,Ke!==null?n=0:(at=null,ot=0,n=tt)}if(n!==0){if(n===2&&(c=Ml(t),c!==0&&(l=c,n=oo(t,c))),n===1)throw a=$a,gs(t,0),Un(t,l),_t(t,Ge()),a;if(n===6)Un(t,l);else{if(c=t.current.alternate,(l&30)===0&&!Gp(c)&&(n=ol(t,l),n===2&&(h=Ml(t),h!==0&&(l=h,n=oo(t,h))),n===1))throw a=$a,gs(t,0),Un(t,l),_t(t,Ge()),a;switch(t.finishedWork=c,t.finishedLanes=l,n){case 0:case 1:throw Error(r(345));case 2:ms(t,Ct,jn);break;case 3:if(Un(t,l),(l&130023424)===l&&(n=io+500-Ge(),10<n)){if(gi(t,0)!==0)break;if(c=t.suspendedLanes,(c&l)!==l){vt(),t.pingedLanes|=t.suspendedLanes&c;break}t.timeoutHandle=pr(ms.bind(null,t,Ct,jn),n);break}ms(t,Ct,jn);break;case 4:if(Un(t,l),(l&4194240)===l)break;for(n=t.eventTimes,c=-1;0<l;){var S=31-qt(l);h=1<<S,S=n[S],S>c&&(c=S),l&=~h}if(l=c,l=Ge()-l,l=(120>l?120:480>l?480:1080>l?1080:1920>l?1920:3e3>l?3e3:4320>l?4320:1960*Qp(l/1960))-l,10<l){t.timeoutHandle=pr(ms.bind(null,t,Ct,jn),l);break}ms(t,Ct,jn);break;case 5:ms(t,Ct,jn);break;default:throw Error(r(329))}}}return _t(t,Ge()),t.callbackNode===a?cu.bind(null,t):null}function oo(t,n){var a=Ma;return t.current.memoizedState.isDehydrated&&(gs(t,n).flags|=256),t=ol(t,n),t!==2&&(n=Ct,Ct=a,n!==null&&co(n)),t}function co(t){Ct===null?Ct=t:Ct.push.apply(Ct,t)}function Gp(t){for(var n=t;;){if(n.flags&16384){var a=n.updateQueue;if(a!==null&&(a=a.stores,a!==null))for(var l=0;l<a.length;l++){var c=a[l],h=c.getSnapshot;c=c.value;try{if(!Jt(h(),c))return!1}catch{return!1}}}if(a=n.child,n.subtreeFlags&16384&&a!==null)a.return=n,n=a;else{if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return!0;n=n.return}n.sibling.return=n.return,n=n.sibling}}return!0}function Un(t,n){for(n&=~ao,n&=~nl,t.suspendedLanes|=n,t.pingedLanes&=~n,t=t.expirationTimes;0<n;){var a=31-qt(n),l=1<<a;t[a]=-1,n&=~l}}function uu(t){if((Te&6)!==0)throw Error(r(327));Ys();var n=gi(t,0);if((n&1)===0)return _t(t,Ge()),null;var a=ol(t,n);if(t.tag!==0&&a===2){var l=Ml(t);l!==0&&(n=l,a=oo(t,l))}if(a===1)throw a=$a,gs(t,0),Un(t,n),_t(t,Ge()),a;if(a===6)throw Error(r(345));return t.finishedWork=t.current.alternate,t.finishedLanes=n,ms(t,Ct,jn),_t(t,Ge()),null}function uo(t,n){var a=Te;Te|=1;try{return t(n)}finally{Te=a,Te===0&&(Ks=Ge()+500,Ii&&Pn())}}function xs(t){Mn!==null&&Mn.tag===0&&(Te&6)===0&&Ys();var n=Te;Te|=1;var a=Mt.transition,l=De;try{if(Mt.transition=null,De=1,t)return t()}finally{De=l,Mt.transition=a,Te=n,(Te&6)===0&&Pn()}}function fo(){It=Js.current,Be(Js)}function gs(t,n){t.finishedWork=null,t.finishedLanes=0;var a=t.timeoutHandle;if(a!==-1&&(t.timeoutHandle=-1,kp(a)),Ke!==null)for(a=Ke.return;a!==null;){var l=a;switch(br(l),l.tag){case 1:l=l.type.childContextTypes,l!=null&&Di();break;case 3:Qs(),Be(St),Be(ft),Dr();break;case 5:Tr(l);break;case 4:Qs();break;case 13:Be(Fe);break;case 19:Be(Fe);break;case 10:_r(l.type._context);break;case 22:case 23:fo()}a=a.return}if(at=t,Ke=t=Vn(t.current,null),ot=It=n,tt=0,$a=null,ao=nl=ps=0,Ct=Ma=null,us!==null){for(n=0;n<us.length;n++)if(a=us[n],l=a.interleaved,l!==null){a.interleaved=null;var c=l.next,h=a.pending;if(h!==null){var S=h.next;h.next=c,l.next=S}a.pending=l}us=null}return t}function fu(t,n){do{var a=Ke;try{if(Cr(),Hi.current=Ji,Qi){for(var l=Ue.memoizedState;l!==null;){var c=l.queue;c!==null&&(c.pending=null),l=l.next}Qi=!1}if(hs=0,st=et=Ue=null,La=!1,Ia=0,so.current=null,a===null||a.return===null){tt=1,$a=n,Ke=null;break}e:{var h=t,S=a.return,E=a,B=n;if(n=ot,E.flags|=32768,B!==null&&typeof B=="object"&&typeof B.then=="function"){var K=B,te=E,ne=te.tag;if((te.mode&1)===0&&(ne===0||ne===11||ne===15)){var ee=te.alternate;ee?(te.updateQueue=ee.updateQueue,te.memoizedState=ee.memoizedState,te.lanes=ee.lanes):(te.updateQueue=null,te.memoizedState=null)}var ue=Bc(S);if(ue!==null){ue.flags&=-257,Oc(ue,S,E,h,n),ue.mode&1&&Pc(h,K,n),n=ue,B=K;var he=n.updateQueue;if(he===null){var ge=new Set;ge.add(B),n.updateQueue=ge}else he.add(B);break e}else{if((n&1)===0){Pc(h,K,n),ho();break e}B=Error(r(426))}}else if(We&&E.mode&1){var qe=Bc(S);if(qe!==null){(qe.flags&65536)===0&&(qe.flags|=256),Oc(qe,S,E,h,n),kr(Gs(B,E));break e}}h=B=Gs(B,E),tt!==4&&(tt=2),Ma===null?Ma=[h]:Ma.push(h),h=S;do{switch(h.tag){case 3:h.flags|=65536,n&=-n,h.lanes|=n;var H=Lc(h,B,n);rc(h,H);break e;case 1:E=B;var $=h.type,G=h.stateNode;if((h.flags&128)===0&&(typeof $.getDerivedStateFromError=="function"||G!==null&&typeof G.componentDidCatch=="function"&&($n===null||!$n.has(G)))){h.flags|=65536,n&=-n,h.lanes|=n;var le=Ic(h,E,n);rc(h,le);break e}}h=h.return}while(h!==null)}xu(a)}catch(ye){n=ye,Ke===a&&a!==null&&(Ke=a=a.return);continue}break}while(!0)}function hu(){var t=tl.current;return tl.current=Ji,t===null?Ji:t}function ho(){(tt===0||tt===3||tt===2)&&(tt=4),at===null||(ps&268435455)===0&&(nl&268435455)===0||Un(at,ot)}function ol(t,n){var a=Te;Te|=2;var l=hu();(at!==t||ot!==n)&&(jn=null,gs(t,n));do try{qp();break}catch(c){fu(t,c)}while(!0);if(Cr(),Te=a,tl.current=l,Ke!==null)throw Error(r(261));return at=null,ot=0,tt}function qp(){for(;Ke!==null;)pu(Ke)}function Jp(){for(;Ke!==null&&!bh();)pu(Ke)}function pu(t){var n=yu(t.alternate,t,It);t.memoizedProps=t.pendingProps,n===null?xu(t):Ke=n,so.current=null}function xu(t){var n=t;do{var a=n.alternate;if(t=n.return,(n.flags&32768)===0){if(a=Mp(a,n,It),a!==null){Ke=a;return}}else{if(a=Fp(a,n),a!==null){a.flags&=32767,Ke=a;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{tt=6,Ke=null;return}}if(n=n.sibling,n!==null){Ke=n;return}Ke=n=t}while(n!==null);tt===0&&(tt=5)}function ms(t,n,a){var l=De,c=Mt.transition;try{Mt.transition=null,De=1,Kp(t,n,a,l)}finally{Mt.transition=c,De=l}return null}function Kp(t,n,a,l){do Ys();while(Mn!==null);if((Te&6)!==0)throw Error(r(327));a=t.finishedWork;var c=t.finishedLanes;if(a===null)return null;if(t.finishedWork=null,t.finishedLanes=0,a===t.current)throw Error(r(177));t.callbackNode=null,t.callbackPriority=0;var h=a.lanes|a.childLanes;if(Ah(t,h),t===at&&(Ke=at=null,ot=0),(a.subtreeFlags&2064)===0&&(a.flags&2064)===0||al||(al=!0,vu(fi,function(){return Ys(),null})),h=(a.flags&15990)!==0,(a.subtreeFlags&15990)!==0||h){h=Mt.transition,Mt.transition=null;var S=De;De=1;var E=Te;Te|=4,so.current=null,Vp(t,a),iu(a,t),gp(fr),vi=!!ur,fr=ur=null,t.current=a,Hp(a),jh(),Te=E,De=S,Mt.transition=h}else t.current=a;if(al&&(al=!1,Mn=t,il=c),h=t.pendingLanes,h===0&&($n=null),Nh(a.stateNode),_t(t,Ge()),n!==null)for(l=t.onRecoverableError,a=0;a<n.length;a++)c=n[a],l(c.value,{componentStack:c.stack,digest:c.digest});if(sl)throw sl=!1,t=lo,lo=null,t;return(il&1)!==0&&t.tag!==0&&Ys(),h=t.pendingLanes,(h&1)!==0?t===ro?Fa++:(Fa=0,ro=t):Fa=0,Pn(),null}function Ys(){if(Mn!==null){var t=sd(il),n=Mt.transition,a=De;try{if(Mt.transition=null,De=16>t?16:t,Mn===null)var l=!1;else{if(t=Mn,Mn=null,il=0,(Te&6)!==0)throw Error(r(331));var c=Te;for(Te|=4,fe=t.current;fe!==null;){var h=fe,S=h.child;if((fe.flags&16)!==0){var E=h.deletions;if(E!==null){for(var B=0;B<E.length;B++){var K=E[B];for(fe=K;fe!==null;){var te=fe;switch(te.tag){case 0:case 11:case 15:Wa(8,te,h)}var ne=te.child;if(ne!==null)ne.return=te,fe=ne;else for(;fe!==null;){te=fe;var ee=te.sibling,ue=te.return;if(eu(te),te===K){fe=null;break}if(ee!==null){ee.return=ue,fe=ee;break}fe=ue}}}var he=h.alternate;if(he!==null){var ge=he.child;if(ge!==null){he.child=null;do{var qe=ge.sibling;ge.sibling=null,ge=qe}while(ge!==null)}}fe=h}}if((h.subtreeFlags&2064)!==0&&S!==null)S.return=h,fe=S;else e:for(;fe!==null;){if(h=fe,(h.flags&2048)!==0)switch(h.tag){case 0:case 11:case 15:Wa(9,h,h.return)}var H=h.sibling;if(H!==null){H.return=h.return,fe=H;break e}fe=h.return}}var $=t.current;for(fe=$;fe!==null;){S=fe;var G=S.child;if((S.subtreeFlags&2064)!==0&&G!==null)G.return=S,fe=G;else e:for(S=$;fe!==null;){if(E=fe,(E.flags&2048)!==0)try{switch(E.tag){case 0:case 11:case 15:el(9,E)}}catch(ye){He(E,E.return,ye)}if(E===S){fe=null;break e}var le=E.sibling;if(le!==null){le.return=E.return,fe=le;break e}fe=E.return}}if(Te=c,Pn(),rn&&typeof rn.onPostCommitFiberRoot=="function")try{rn.onPostCommitFiberRoot(hi,t)}catch{}l=!0}return l}finally{De=a,Mt.transition=n}}return!1}function gu(t,n,a){n=Gs(a,n),n=Lc(t,n,1),t=On(t,n,1),n=vt(),t!==null&&(fa(t,1,n),_t(t,n))}function He(t,n,a){if(t.tag===3)gu(t,t,a);else for(;n!==null;){if(n.tag===3){gu(n,t,a);break}else if(n.tag===1){var l=n.stateNode;if(typeof n.type.getDerivedStateFromError=="function"||typeof l.componentDidCatch=="function"&&($n===null||!$n.has(l))){t=Gs(a,t),t=Ic(n,t,1),n=On(n,t,1),t=vt(),n!==null&&(fa(n,1,t),_t(n,t));break}}n=n.return}}function Yp(t,n,a){var l=t.pingCache;l!==null&&l.delete(n),n=vt(),t.pingedLanes|=t.suspendedLanes&a,at===t&&(ot&a)===a&&(tt===4||tt===3&&(ot&130023424)===ot&&500>Ge()-io?gs(t,0):ao|=a),_t(t,n)}function mu(t,n){n===0&&((t.mode&1)===0?n=1:(n=xi,xi<<=1,(xi&130023424)===0&&(xi=4194304)));var a=vt();t=yn(t,n),t!==null&&(fa(t,n,a),_t(t,a))}function Zp(t){var n=t.memoizedState,a=0;n!==null&&(a=n.retryLane),mu(t,a)}function Xp(t,n){var a=0;switch(t.tag){case 13:var l=t.stateNode,c=t.memoizedState;c!==null&&(a=c.retryLane);break;case 19:l=t.stateNode;break;default:throw Error(r(314))}l!==null&&l.delete(n),mu(t,a)}var yu;yu=function(t,n,a){if(t!==null)if(t.memoizedProps!==n.pendingProps||St.current)Nt=!0;else{if((t.lanes&a)===0&&(n.flags&128)===0)return Nt=!1,$p(t,n,a);Nt=(t.flags&131072)!==0}else Nt=!1,We&&(n.flags&1048576)!==0&&Yd(n,Bi,n.index);switch(n.lanes=0,n.tag){case 2:var l=n.type;Zi(t,n),t=n.pendingProps;var c=Ws(n,ft.current);Hs(n,a),c=Pr(null,n,l,t,c,a);var h=Br();return n.flags|=1,typeof c=="object"&&c!==null&&typeof c.render=="function"&&c.$$typeof===void 0?(n.tag=1,n.memoizedState=null,n.updateQueue=null,kt(l)?(h=!0,Li(n)):h=!1,n.memoizedState=c.state!==null&&c.state!==void 0?c.state:null,Rr(n),c.updater=Ki,n.stateNode=c,c._reactInternals=n,Ur(n,l,t,a),n=Gr(null,n,l,!0,h,a)):(n.tag=0,We&&h&&vr(n),yt(null,n,c,a),n=n.child),n;case 16:l=n.elementType;e:{switch(Zi(t,n),t=n.pendingProps,c=l._init,l=c(l._payload),n.type=l,c=n.tag=tx(l),t=Yt(l,t),c){case 0:n=Qr(null,n,l,t,a);break e;case 1:n=Vc(null,n,l,t,a);break e;case 11:n=Wc(null,n,l,t,a);break e;case 14:n=$c(null,n,l,Yt(l.type,t),a);break e}throw Error(r(306,l,""))}return n;case 0:return l=n.type,c=n.pendingProps,c=n.elementType===l?c:Yt(l,c),Qr(t,n,l,c,a);case 1:return l=n.type,c=n.pendingProps,c=n.elementType===l?c:Yt(l,c),Vc(t,n,l,c,a);case 3:e:{if(Hc(n),t===null)throw Error(r(387));l=n.pendingProps,h=n.memoizedState,c=h.element,lc(t,n),Ui(n,l,null,a);var S=n.memoizedState;if(l=S.element,h.isDehydrated)if(h={element:l,isDehydrated:!1,cache:S.cache,pendingSuspenseBoundaries:S.pendingSuspenseBoundaries,transitions:S.transitions},n.updateQueue.baseState=h,n.memoizedState=h,n.flags&256){c=Gs(Error(r(423)),n),n=Qc(t,n,l,a,c);break e}else if(l!==c){c=Gs(Error(r(424)),n),n=Qc(t,n,l,a,c);break e}else for(Lt=Dn(n.stateNode.containerInfo.firstChild),Dt=n,We=!0,Kt=null,a=ac(n,null,l,a),n.child=a;a;)a.flags=a.flags&-3|4096,a=a.sibling;else{if(Fs(),l===c){n=bn(t,n,a);break e}yt(t,n,l,a)}n=n.child}return n;case 5:return dc(n),t===null&&Sr(n),l=n.type,c=n.pendingProps,h=t!==null?t.memoizedProps:null,S=c.children,hr(l,c)?S=null:h!==null&&hr(l,h)&&(n.flags|=32),Uc(t,n),yt(t,n,S,a),n.child;case 6:return t===null&&Sr(n),null;case 13:return Gc(t,n,a);case 4:return Ar(n,n.stateNode.containerInfo),l=n.pendingProps,t===null?n.child=Us(n,null,l,a):yt(t,n,l,a),n.child;case 11:return l=n.type,c=n.pendingProps,c=n.elementType===l?c:Yt(l,c),Wc(t,n,l,c,a);case 7:return yt(t,n,n.pendingProps,a),n.child;case 8:return yt(t,n,n.pendingProps.children,a),n.child;case 12:return yt(t,n,n.pendingProps.children,a),n.child;case 10:e:{if(l=n.type._context,c=n.pendingProps,h=n.memoizedProps,S=c.value,Le($i,l._currentValue),l._currentValue=S,h!==null)if(Jt(h.value,S)){if(h.children===c.children&&!St.current){n=bn(t,n,a);break e}}else for(h=n.child,h!==null&&(h.return=n);h!==null;){var E=h.dependencies;if(E!==null){S=h.child;for(var B=E.firstContext;B!==null;){if(B.context===l){if(h.tag===1){B=vn(-1,a&-a),B.tag=2;var K=h.updateQueue;if(K!==null){K=K.shared;var te=K.pending;te===null?B.next=B:(B.next=te.next,te.next=B),K.pending=B}}h.lanes|=a,B=h.alternate,B!==null&&(B.lanes|=a),wr(h.return,a,n),E.lanes|=a;break}B=B.next}}else if(h.tag===10)S=h.type===n.type?null:h.child;else if(h.tag===18){if(S=h.return,S===null)throw Error(r(341));S.lanes|=a,E=S.alternate,E!==null&&(E.lanes|=a),wr(S,a,n),S=h.sibling}else S=h.child;if(S!==null)S.return=h;else for(S=h;S!==null;){if(S===n){S=null;break}if(h=S.sibling,h!==null){h.return=S.return,S=h;break}S=S.return}h=S}yt(t,n,c.children,a),n=n.child}return n;case 9:return c=n.type,l=n.pendingProps.children,Hs(n,a),c=Wt(c),l=l(c),n.flags|=1,yt(t,n,l,a),n.child;case 14:return l=n.type,c=Yt(l,n.pendingProps),c=Yt(l.type,c),$c(t,n,l,c,a);case 15:return Mc(t,n,n.type,n.pendingProps,a);case 17:return l=n.type,c=n.pendingProps,c=n.elementType===l?c:Yt(l,c),Zi(t,n),n.tag=1,kt(l)?(t=!0,Li(n)):t=!1,Hs(n,a),zc(n,l,c),Ur(n,l,c,a),Gr(null,n,l,!0,t,a);case 19:return Jc(t,n,a);case 22:return Fc(t,n,a)}throw Error(r(156,n.tag))};function vu(t,n){return Zo(t,n)}function ex(t,n,a,l){this.tag=t,this.key=a,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=n,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=l,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ft(t,n,a,l){return new ex(t,n,a,l)}function po(t){return t=t.prototype,!(!t||!t.isReactComponent)}function tx(t){if(typeof t=="function")return po(t)?1:0;if(t!=null){if(t=t.$$typeof,t===xe)return 11;if(t===de)return 14}return 2}function Vn(t,n){var a=t.alternate;return a===null?(a=Ft(t.tag,n,t.key,t.mode),a.elementType=t.elementType,a.type=t.type,a.stateNode=t.stateNode,a.alternate=t,t.alternate=a):(a.pendingProps=n,a.type=t.type,a.flags=0,a.subtreeFlags=0,a.deletions=null),a.flags=t.flags&14680064,a.childLanes=t.childLanes,a.lanes=t.lanes,a.child=t.child,a.memoizedProps=t.memoizedProps,a.memoizedState=t.memoizedState,a.updateQueue=t.updateQueue,n=t.dependencies,a.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext},a.sibling=t.sibling,a.index=t.index,a.ref=t.ref,a}function dl(t,n,a,l,c,h){var S=2;if(l=t,typeof t=="function")po(t)&&(S=1);else if(typeof t=="string")S=5;else e:switch(t){case N:return ys(a.children,c,h,n);case W:S=8,c|=8;break;case F:return t=Ft(12,a,n,c|2),t.elementType=F,t.lanes=h,t;case z:return t=Ft(13,a,n,c),t.elementType=z,t.lanes=h,t;case X:return t=Ft(19,a,n,c),t.elementType=X,t.lanes=h,t;case ve:return cl(a,c,h,n);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Z:S=10;break e;case ce:S=9;break e;case xe:S=11;break e;case de:S=14;break e;case oe:S=16,l=null;break e}throw Error(r(130,t==null?t:typeof t,""))}return n=Ft(S,a,n,c),n.elementType=t,n.type=l,n.lanes=h,n}function ys(t,n,a,l){return t=Ft(7,t,l,n),t.lanes=a,t}function cl(t,n,a,l){return t=Ft(22,t,l,n),t.elementType=ve,t.lanes=a,t.stateNode={isHidden:!1},t}function xo(t,n,a){return t=Ft(6,t,null,n),t.lanes=a,t}function go(t,n,a){return n=Ft(4,t.children!==null?t.children:[],t.key,n),n.lanes=a,n.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},n}function nx(t,n,a,l,c){this.tag=n,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Fl(0),this.expirationTimes=Fl(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Fl(0),this.identifierPrefix=l,this.onRecoverableError=c,this.mutableSourceEagerHydrationData=null}function mo(t,n,a,l,c,h,S,E,B){return t=new nx(t,n,a,E,B),n===1?(n=1,h===!0&&(n|=8)):n=0,h=Ft(3,null,null,n),t.current=h,h.stateNode=t,h.memoizedState={element:l,isDehydrated:a,cache:null,transitions:null,pendingSuspenseBoundaries:null},Rr(h),t}function sx(t,n,a){var l=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:A,key:l==null?null:""+l,children:t,containerInfo:n,implementation:a}}function bu(t){if(!t)return In;t=t._reactInternals;e:{if(ls(t)!==t||t.tag!==1)throw Error(r(170));var n=t;do{switch(n.tag){case 3:n=n.stateNode.context;break e;case 1:if(kt(n.type)){n=n.stateNode.__reactInternalMemoizedMergedChildContext;break e}}n=n.return}while(n!==null);throw Error(r(171))}if(t.tag===1){var a=t.type;if(kt(a))return qd(t,a,n)}return n}function ju(t,n,a,l,c,h,S,E,B){return t=mo(a,l,!0,t,c,h,S,E,B),t.context=bu(null),a=t.current,l=vt(),c=Fn(a),h=vn(l,c),h.callback=n??null,On(a,h,c),t.current.lanes=c,fa(t,c,l),_t(t,l),t}function ul(t,n,a,l){var c=n.current,h=vt(),S=Fn(c);return a=bu(a),n.context===null?n.context=a:n.pendingContext=a,n=vn(h,S),n.payload={element:t},l=l===void 0?null:l,l!==null&&(n.callback=l),t=On(c,n,S),t!==null&&(en(t,c,S,h),Fi(t,c,S)),S}function fl(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Su(t,n){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var a=t.retryLane;t.retryLane=a!==0&&a<n?a:n}}function yo(t,n){Su(t,n),(t=t.alternate)&&Su(t,n)}function ax(){return null}var ku=typeof reportError=="function"?reportError:function(t){console.error(t)};function vo(t){this._internalRoot=t}hl.prototype.render=vo.prototype.render=function(t){var n=this._internalRoot;if(n===null)throw Error(r(409));ul(t,n,null,null)},hl.prototype.unmount=vo.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var n=t.containerInfo;xs(function(){ul(null,t,null,null)}),n[pn]=null}};function hl(t){this._internalRoot=t}hl.prototype.unstable_scheduleHydration=function(t){if(t){var n=ld();t={blockedOn:null,target:t,priority:n};for(var a=0;a<An.length&&n!==0&&n<An[a].priority;a++);An.splice(a,0,t),a===0&&dd(t)}};function bo(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function pl(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Nu(){}function ix(t,n,a,l,c){if(c){if(typeof l=="function"){var h=l;l=function(){var K=fl(S);h.call(K)}}var S=ju(n,l,t,0,null,!1,!1,"",Nu);return t._reactRootContainer=S,t[pn]=S.current,_a(t.nodeType===8?t.parentNode:t),xs(),S}for(;c=t.lastChild;)t.removeChild(c);if(typeof l=="function"){var E=l;l=function(){var K=fl(B);E.call(K)}}var B=mo(t,0,!1,null,null,!1,!1,"",Nu);return t._reactRootContainer=B,t[pn]=B.current,_a(t.nodeType===8?t.parentNode:t),xs(function(){ul(n,B,a,l)}),B}function xl(t,n,a,l,c){var h=a._reactRootContainer;if(h){var S=h;if(typeof c=="function"){var E=c;c=function(){var B=fl(S);E.call(B)}}ul(n,S,t,c)}else S=ix(a,n,t,c,l);return fl(S)}ad=function(t){switch(t.tag){case 3:var n=t.stateNode;if(n.current.memoizedState.isDehydrated){var a=ua(n.pendingLanes);a!==0&&(Ul(n,a|1),_t(n,Ge()),(Te&6)===0&&(Ks=Ge()+500,Pn()))}break;case 13:xs(function(){var l=yn(t,1);if(l!==null){var c=vt();en(l,t,1,c)}}),yo(t,1)}},Vl=function(t){if(t.tag===13){var n=yn(t,134217728);if(n!==null){var a=vt();en(n,t,134217728,a)}yo(t,134217728)}},id=function(t){if(t.tag===13){var n=Fn(t),a=yn(t,n);if(a!==null){var l=vt();en(a,t,n,l)}yo(t,n)}},ld=function(){return De},rd=function(t,n){var a=De;try{return De=t,n()}finally{De=a}},Rs=function(t,n,a){switch(n){case"input":if(Pt(t,a),n=a.name,a.type==="radio"&&n!=null){for(a=t;a.parentNode;)a=a.parentNode;for(a=a.querySelectorAll("input[name="+JSON.stringify(""+n)+'][type="radio"]'),n=0;n<a.length;n++){var l=a[n];if(l!==t&&l.form===t.form){var c=zi(l);if(!c)throw Error(r(90));jt(l),Pt(l,c)}}}break;case"textarea":ts(t,a);break;case"select":n=a.value,n!=null&&Tt(t,!!a.multiple,n,!1)}},Cn=uo,as=xs;var lx={usingClientEntryPoint:!1,Events:[Ra,Bs,zi,Gt,ut,uo]},Ua={findFiberByHostInstance:rs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},rx={bundleType:Ua.bundleType,version:Ua.version,rendererPackageName:Ua.rendererPackageName,rendererConfig:Ua.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:P.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Ko(t),t===null?null:t.stateNode},findFiberByHostInstance:Ua.findFiberByHostInstance||ax,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var gl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!gl.isDisabled&&gl.supportsFiber)try{hi=gl.inject(rx),rn=gl}catch{}}return wt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=lx,wt.createPortal=function(t,n){var a=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!bo(n))throw Error(r(200));return sx(t,n,null,a)},wt.createRoot=function(t,n){if(!bo(t))throw Error(r(299));var a=!1,l="",c=ku;return n!=null&&(n.unstable_strictMode===!0&&(a=!0),n.identifierPrefix!==void 0&&(l=n.identifierPrefix),n.onRecoverableError!==void 0&&(c=n.onRecoverableError)),n=mo(t,1,!1,null,null,a,!1,l,c),t[pn]=n.current,_a(t.nodeType===8?t.parentNode:t),new vo(n)},wt.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var n=t._reactInternals;if(n===void 0)throw typeof t.render=="function"?Error(r(188)):(t=Object.keys(t).join(","),Error(r(268,t)));return t=Ko(n),t=t===null?null:t.stateNode,t},wt.flushSync=function(t){return xs(t)},wt.hydrate=function(t,n,a){if(!pl(n))throw Error(r(200));return xl(null,t,n,!0,a)},wt.hydrateRoot=function(t,n,a){if(!bo(t))throw Error(r(405));var l=a!=null&&a.hydratedSources||null,c=!1,h="",S=ku;if(a!=null&&(a.unstable_strictMode===!0&&(c=!0),a.identifierPrefix!==void 0&&(h=a.identifierPrefix),a.onRecoverableError!==void 0&&(S=a.onRecoverableError)),n=ju(n,null,t,1,a??null,c,!1,h,S),t[pn]=n.current,_a(t),l)for(t=0;t<l.length;t++)a=l[t],c=a._getVersion,c=c(a._source),n.mutableSourceEagerHydrationData==null?n.mutableSourceEagerHydrationData=[a,c]:n.mutableSourceEagerHydrationData.push(a,c);return new hl(n)},wt.render=function(t,n,a){if(!pl(n))throw Error(r(200));return xl(null,t,n,!1,a)},wt.unmountComponentAtNode=function(t){if(!pl(t))throw Error(r(40));return t._reactRootContainer?(xs(function(){xl(null,null,t,!1,function(){t._reactRootContainer=null,t[pn]=null})}),!0):!1},wt.unstable_batchedUpdates=uo,wt.unstable_renderSubtreeIntoContainer=function(t,n,a,l){if(!pl(a))throw Error(r(200));if(t==null||t._reactInternals===void 0)throw Error(r(38));return xl(t,n,a,!1,l)},wt.version="18.3.1-next-f1338f8080-20240426",wt}var zu;function kf(){if(zu)return ko.exports;zu=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(i){console.error(i)}}return s(),ko.exports=xx(),ko.exports}var Du;function gx(){if(Du)return ml;Du=1;var s=kf();return ml.createRoot=s.createRoot,ml.hydrateRoot=s.hydrateRoot,ml}var mx=gx();const yx=Sf(mx);var u=Fo();const vx=Sf(u),bx=dx({__proto__:null,default:vx},[u]);kf();/**
 * @remix-run/router v1.23.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function El(){return El=Object.assign?Object.assign.bind():function(s){for(var i=1;i<arguments.length;i++){var r=arguments[i];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(s[o]=r[o])}return s},El.apply(this,arguments)}var Kn;(function(s){s.Pop="POP",s.Push="PUSH",s.Replace="REPLACE"})(Kn||(Kn={}));const Lu="popstate";function jx(s){s===void 0&&(s={});function i(o,d){let{pathname:f,search:p,hash:x}=o.location;return Po("",{pathname:f,search:p,hash:x},d.state&&d.state.usr||null,d.state&&d.state.key||"default")}function r(o,d){return typeof d=="string"?d:Cf(d)}return kx(i,r,null,s)}function At(s,i){if(s===!1||s===null||typeof s>"u")throw new Error(i)}function Nf(s,i){if(!s){typeof console<"u"&&console.warn(i);try{throw new Error(i)}catch{}}}function Sx(){return Math.random().toString(36).substr(2,8)}function Iu(s,i){return{usr:s.state,key:s.key,idx:i}}function Po(s,i,r,o){return r===void 0&&(r=null),El({pathname:typeof s=="string"?s:s.pathname,search:"",hash:""},typeof i=="string"?zl(i):i,{state:r,key:i&&i.key||o||Sx()})}function Cf(s){let{pathname:i="/",search:r="",hash:o=""}=s;return r&&r!=="?"&&(i+=r.charAt(0)==="?"?r:"?"+r),o&&o!=="#"&&(i+=o.charAt(0)==="#"?o:"#"+o),i}function zl(s){let i={};if(s){let r=s.indexOf("#");r>=0&&(i.hash=s.substr(r),s=s.substr(0,r));let o=s.indexOf("?");o>=0&&(i.search=s.substr(o),s=s.substr(0,o)),s&&(i.pathname=s)}return i}function kx(s,i,r,o){o===void 0&&(o={});let{window:d=document.defaultView,v5Compat:f=!1}=o,p=d.history,x=Kn.Pop,m=null,v=g();v==null&&(v=0,p.replaceState(El({},p.state,{idx:v}),""));function g(){return(p.state||{idx:null}).idx}function b(){x=Kn.Pop;let C=g(),L=C==null?null:C-v;v=C,m&&m({action:x,location:_.location,delta:L})}function y(C,L){x=Kn.Push;let D=Po(_.location,C,L);v=g()+1;let I=Iu(D,v),P=_.createHref(D);try{p.pushState(I,"",P)}catch(w){if(w instanceof DOMException&&w.name==="DataCloneError")throw w;d.location.assign(P)}f&&m&&m({action:x,location:_.location,delta:1})}function j(C,L){x=Kn.Replace;let D=Po(_.location,C,L);v=g();let I=Iu(D,v),P=_.createHref(D);p.replaceState(I,"",P),f&&m&&m({action:x,location:_.location,delta:0})}function k(C){let L=d.location.origin!=="null"?d.location.origin:d.location.href,D=typeof C=="string"?C:Cf(C);return D=D.replace(/ $/,"%20"),At(L,"No window.location.(origin|href) available to create URL for href: "+D),new URL(D,L)}let _={get action(){return x},get location(){return s(d,p)},listen(C){if(m)throw new Error("A history only accepts one active listener");return d.addEventListener(Lu,b),m=C,()=>{d.removeEventListener(Lu,b),m=null}},createHref(C){return i(d,C)},createURL:k,encodeLocation(C){let L=k(C);return{pathname:L.pathname,search:L.search,hash:L.hash}},push:y,replace:j,go(C){return p.go(C)}};return _}var Pu;(function(s){s.data="data",s.deferred="deferred",s.redirect="redirect",s.error="error"})(Pu||(Pu={}));function Nx(s,i,r){return r===void 0&&(r="/"),Cx(s,i,r)}function Cx(s,i,r,o){let d=typeof i=="string"?zl(i):i,f=Ef(d.pathname||"/",r);if(f==null)return null;let p=_f(s);_x(p);let x=null;for(let m=0;x==null&&m<p.length;++m){let v=Ox(f);x=Ix(p[m],v)}return x}function _f(s,i,r,o){i===void 0&&(i=[]),r===void 0&&(r=[]),o===void 0&&(o="");let d=(f,p,x)=>{let m={relativePath:x===void 0?f.path||"":x,caseSensitive:f.caseSensitive===!0,childrenIndex:p,route:f};m.relativePath.startsWith("/")&&(At(m.relativePath.startsWith(o),'Absolute route path "'+m.relativePath+'" nested under path '+('"'+o+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),m.relativePath=m.relativePath.slice(o.length));let v=ta([o,m.relativePath]),g=r.concat(m);f.children&&f.children.length>0&&(At(f.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+v+'".')),_f(f.children,i,g,v)),!(f.path==null&&!f.index)&&i.push({path:v,score:Dx(v,f.index),routesMeta:g})};return s.forEach((f,p)=>{var x;if(f.path===""||!((x=f.path)!=null&&x.includes("?")))d(f,p);else for(let m of wf(f.path))d(f,p,m)}),i}function wf(s){let i=s.split("/");if(i.length===0)return[];let[r,...o]=i,d=r.endsWith("?"),f=r.replace(/\?$/,"");if(o.length===0)return d?[f,""]:[f];let p=wf(o.join("/")),x=[];return x.push(...p.map(m=>m===""?f:[f,m].join("/"))),d&&x.push(...p),x.map(m=>s.startsWith("/")&&m===""?"/":m)}function _x(s){s.sort((i,r)=>i.score!==r.score?r.score-i.score:Lx(i.routesMeta.map(o=>o.childrenIndex),r.routesMeta.map(o=>o.childrenIndex)))}const wx=/^:[\w-]+$/,Ex=3,Rx=2,Ax=1,Tx=10,zx=-2,Bu=s=>s==="*";function Dx(s,i){let r=s.split("/"),o=r.length;return r.some(Bu)&&(o+=zx),i&&(o+=Rx),r.filter(d=>!Bu(d)).reduce((d,f)=>d+(wx.test(f)?Ex:f===""?Ax:Tx),o)}function Lx(s,i){return s.length===i.length&&s.slice(0,-1).every((o,d)=>o===i[d])?s[s.length-1]-i[i.length-1]:0}function Ix(s,i,r){let{routesMeta:o}=s,d={},f="/",p=[];for(let x=0;x<o.length;++x){let m=o[x],v=x===o.length-1,g=f==="/"?i:i.slice(f.length)||"/",b=Px({path:m.relativePath,caseSensitive:m.caseSensitive,end:v},g),y=m.route;if(!b)return null;Object.assign(d,b.params),p.push({params:d,pathname:ta([f,b.pathname]),pathnameBase:Wx(ta([f,b.pathnameBase])),route:y}),b.pathnameBase!=="/"&&(f=ta([f,b.pathnameBase]))}return p}function Px(s,i){typeof s=="string"&&(s={path:s,caseSensitive:!1,end:!0});let[r,o]=Bx(s.path,s.caseSensitive,s.end),d=i.match(r);if(!d)return null;let f=d[0],p=f.replace(/(.)\/+$/,"$1"),x=d.slice(1);return{params:o.reduce((v,g,b)=>{let{paramName:y,isOptional:j}=g;if(y==="*"){let _=x[b]||"";p=f.slice(0,f.length-_.length).replace(/(.)\/+$/,"$1")}const k=x[b];return j&&!k?v[y]=void 0:v[y]=(k||"").replace(/%2F/g,"/"),v},{}),pathname:f,pathnameBase:p,pattern:s}}function Bx(s,i,r){i===void 0&&(i=!1),r===void 0&&(r=!0),Nf(s==="*"||!s.endsWith("*")||s.endsWith("/*"),'Route path "'+s+'" will be treated as if it were '+('"'+s.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+s.replace(/\*$/,"/*")+'".'));let o=[],d="^"+s.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(p,x,m)=>(o.push({paramName:x,isOptional:m!=null}),m?"/?([^\\/]+)?":"/([^\\/]+)"));return s.endsWith("*")?(o.push({paramName:"*"}),d+=s==="*"||s==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?d+="\\/*$":s!==""&&s!=="/"&&(d+="(?:(?=\\/|$))"),[new RegExp(d,i?void 0:"i"),o]}function Ox(s){try{return s.split("/").map(i=>decodeURIComponent(i).replace(/\//g,"%2F")).join("/")}catch(i){return Nf(!1,'The URL path "'+s+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+i+").")),s}}function Ef(s,i){if(i==="/")return s;if(!s.toLowerCase().startsWith(i.toLowerCase()))return null;let r=i.endsWith("/")?i.length-1:i.length,o=s.charAt(r);return o&&o!=="/"?null:s.slice(r)||"/"}const ta=s=>s.join("/").replace(/\/\/+/g,"/"),Wx=s=>s.replace(/\/+$/,"").replace(/^\/*/,"/");function $x(s){return s!=null&&typeof s.status=="number"&&typeof s.statusText=="string"&&typeof s.internal=="boolean"&&"data"in s}const Rf=["post","put","patch","delete"];new Set(Rf);const Mx=["get",...Rf];new Set(Mx);/**
 * React Router v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Rl(){return Rl=Object.assign?Object.assign.bind():function(s){for(var i=1;i<arguments.length;i++){var r=arguments[i];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(s[o]=r[o])}return s},Rl.apply(this,arguments)}const Fx=u.createContext(null),Ux=u.createContext(null),Af=u.createContext(null),Dl=u.createContext(null),ni=u.createContext({outlet:null,matches:[],isDataRoute:!1}),Tf=u.createContext(null);function Uo(){return u.useContext(Dl)!=null}function Vx(){return Uo()||At(!1),u.useContext(Dl).location}function zf(){let{matches:s}=u.useContext(ni),i=s[s.length-1];return i?i.params:{}}function Hx(s,i){return Qx(s,i)}function Qx(s,i,r,o){Uo()||At(!1);let{navigator:d}=u.useContext(Af),{matches:f}=u.useContext(ni),p=f[f.length-1],x=p?p.params:{};p&&p.pathname;let m=p?p.pathnameBase:"/";p&&p.route;let v=Vx(),g;if(i){var b;let C=typeof i=="string"?zl(i):i;m==="/"||(b=C.pathname)!=null&&b.startsWith(m)||At(!1),g=C}else g=v;let y=g.pathname||"/",j=y;if(m!=="/"){let C=m.replace(/^\//,"").split("/");j="/"+y.replace(/^\//,"").split("/").slice(C.length).join("/")}let k=Nx(s,{pathname:j}),_=Yx(k&&k.map(C=>Object.assign({},C,{params:Object.assign({},x,C.params),pathname:ta([m,d.encodeLocation?d.encodeLocation(C.pathname).pathname:C.pathname]),pathnameBase:C.pathnameBase==="/"?m:ta([m,d.encodeLocation?d.encodeLocation(C.pathnameBase).pathname:C.pathnameBase])})),f,r,o);return i&&_?u.createElement(Dl.Provider,{value:{location:Rl({pathname:"/",search:"",hash:"",state:null,key:"default"},g),navigationType:Kn.Pop}},_):_}function Gx(){let s=tg(),i=$x(s)?s.status+" "+s.statusText:s instanceof Error?s.message:JSON.stringify(s),r=s instanceof Error?s.stack:null,d={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return u.createElement(u.Fragment,null,u.createElement("h2",null,"Unexpected Application Error!"),u.createElement("h3",{style:{fontStyle:"italic"}},i),r?u.createElement("pre",{style:d},r):null,null)}const qx=u.createElement(Gx,null);class Jx extends u.Component{constructor(i){super(i),this.state={location:i.location,revalidation:i.revalidation,error:i.error}}static getDerivedStateFromError(i){return{error:i}}static getDerivedStateFromProps(i,r){return r.location!==i.location||r.revalidation!=="idle"&&i.revalidation==="idle"?{error:i.error,location:i.location,revalidation:i.revalidation}:{error:i.error!==void 0?i.error:r.error,location:r.location,revalidation:i.revalidation||r.revalidation}}componentDidCatch(i,r){console.error("React Router caught the following error during render",i,r)}render(){return this.state.error!==void 0?u.createElement(ni.Provider,{value:this.props.routeContext},u.createElement(Tf.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Kx(s){let{routeContext:i,match:r,children:o}=s,d=u.useContext(Fx);return d&&d.static&&d.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(d.staticContext._deepestRenderedBoundaryId=r.route.id),u.createElement(ni.Provider,{value:i},o)}function Yx(s,i,r,o){var d;if(i===void 0&&(i=[]),r===void 0&&(r=null),o===void 0&&(o=null),s==null){var f;if(!r)return null;if(r.errors)s=r.matches;else if((f=o)!=null&&f.v7_partialHydration&&i.length===0&&!r.initialized&&r.matches.length>0)s=r.matches;else return null}let p=s,x=(d=r)==null?void 0:d.errors;if(x!=null){let g=p.findIndex(b=>b.route.id&&(x==null?void 0:x[b.route.id])!==void 0);g>=0||At(!1),p=p.slice(0,Math.min(p.length,g+1))}let m=!1,v=-1;if(r&&o&&o.v7_partialHydration)for(let g=0;g<p.length;g++){let b=p[g];if((b.route.HydrateFallback||b.route.hydrateFallbackElement)&&(v=g),b.route.id){let{loaderData:y,errors:j}=r,k=b.route.loader&&y[b.route.id]===void 0&&(!j||j[b.route.id]===void 0);if(b.route.lazy||k){m=!0,v>=0?p=p.slice(0,v+1):p=[p[0]];break}}}return p.reduceRight((g,b,y)=>{let j,k=!1,_=null,C=null;r&&(j=x&&b.route.id?x[b.route.id]:void 0,_=b.route.errorElement||qx,m&&(v<0&&y===0?(ng("route-fallback"),k=!0,C=null):v===y&&(k=!0,C=b.route.hydrateFallbackElement||null)));let L=i.concat(p.slice(0,y+1)),D=()=>{let I;return j?I=_:k?I=C:b.route.Component?I=u.createElement(b.route.Component,null):b.route.element?I=b.route.element:I=g,u.createElement(Kx,{match:b,routeContext:{outlet:g,matches:L,isDataRoute:r!=null},children:I})};return r&&(b.route.ErrorBoundary||b.route.errorElement||y===0)?u.createElement(Jx,{location:r.location,revalidation:r.revalidation,component:_,error:j,children:D(),routeContext:{outlet:null,matches:L,isDataRoute:!0}}):D()},null)}var Df=(function(s){return s.UseBlocker="useBlocker",s.UseLoaderData="useLoaderData",s.UseActionData="useActionData",s.UseRouteError="useRouteError",s.UseNavigation="useNavigation",s.UseRouteLoaderData="useRouteLoaderData",s.UseMatches="useMatches",s.UseRevalidator="useRevalidator",s.UseNavigateStable="useNavigate",s.UseRouteId="useRouteId",s})(Df||{});function Zx(s){let i=u.useContext(Ux);return i||At(!1),i}function Xx(s){let i=u.useContext(ni);return i||At(!1),i}function eg(s){let i=Xx(),r=i.matches[i.matches.length-1];return r.route.id||At(!1),r.route.id}function tg(){var s;let i=u.useContext(Tf),r=Zx(Df.UseRouteError),o=eg();return i!==void 0?i:(s=r.errors)==null?void 0:s[o]}const Ou={};function ng(s,i,r){Ou[s]||(Ou[s]=!0)}function sg(s,i){s==null||s.v7_startTransition,s==null||s.v7_relativeSplatPath}function Bo(s){At(!1)}function ag(s){let{basename:i="/",children:r=null,location:o,navigationType:d=Kn.Pop,navigator:f,static:p=!1,future:x}=s;Uo()&&At(!1);let m=i.replace(/^\/*/,"/"),v=u.useMemo(()=>({basename:m,navigator:f,static:p,future:Rl({v7_relativeSplatPath:!1},x)}),[m,x,f,p]);typeof o=="string"&&(o=zl(o));let{pathname:g="/",search:b="",hash:y="",state:j=null,key:k="default"}=o,_=u.useMemo(()=>{let C=Ef(g,m);return C==null?null:{location:{pathname:C,search:b,hash:y,state:j,key:k},navigationType:d}},[m,g,b,y,j,k,d]);return _==null?null:u.createElement(Af.Provider,{value:v},u.createElement(Dl.Provider,{children:r,value:_}))}function ig(s){let{children:i,location:r}=s;return Hx(Oo(i),r)}new Promise(()=>{});function Oo(s,i){i===void 0&&(i=[]);let r=[];return u.Children.forEach(s,(o,d)=>{if(!u.isValidElement(o))return;let f=[...i,d];if(o.type===u.Fragment){r.push.apply(r,Oo(o.props.children,f));return}o.type!==Bo&&At(!1),!o.props.index||!o.props.children||At(!1);let p={id:o.props.id||f.join("-"),caseSensitive:o.props.caseSensitive,element:o.props.element,Component:o.props.Component,index:o.props.index,path:o.props.path,loader:o.props.loader,action:o.props.action,errorElement:o.props.errorElement,ErrorBoundary:o.props.ErrorBoundary,hasErrorBoundary:o.props.ErrorBoundary!=null||o.props.errorElement!=null,shouldRevalidate:o.props.shouldRevalidate,handle:o.props.handle,lazy:o.props.lazy};o.props.children&&(p.children=Oo(o.props.children,f)),r.push(p)}),r}/**
 * React Router DOM v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const lg="6";try{window.__reactRouterVersion=lg}catch{}const rg="startTransition",Wu=bx[rg];function og(s){let{basename:i,children:r,future:o,window:d}=s,f=u.useRef();f.current==null&&(f.current=jx({window:d,v5Compat:!0}));let p=f.current,[x,m]=u.useState({action:p.action,location:p.location}),{v7_startTransition:v}=o||{},g=u.useCallback(b=>{v&&Wu?Wu(()=>m(b)):m(b)},[m,v]);return u.useLayoutEffect(()=>p.listen(g),[p,g]),u.useEffect(()=>sg(o),[o]),u.createElement(ag,{basename:i,children:r,location:x.location,navigationType:x.action,navigator:p,future:o})}var $u;(function(s){s.UseScrollRestoration="useScrollRestoration",s.UseSubmit="useSubmit",s.UseSubmitFetcher="useSubmitFetcher",s.UseFetcher="useFetcher",s.useViewTransitionState="useViewTransitionState"})($u||($u={}));var Mu;(function(s){s.UseFetcher="useFetcher",s.UseFetchers="useFetchers",s.UseScrollRestoration="useScrollRestoration"})(Mu||(Mu={}));let dg={data:""},cg=s=>{if(typeof window=="object"){let i=(s?s.querySelector("#_goober"):window._goober)||Object.assign(document.createElement("style"),{innerHTML:" ",id:"_goober"});return i.nonce=window.__nonce__,i.parentNode||(s||document.head).appendChild(i),i.firstChild}return s||dg},ug=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,fg=/\/\*[^]*?\*\/|  +/g,Fu=/\n+/g,Jn=(s,i)=>{let r="",o="",d="";for(let f in s){let p=s[f];f[0]=="@"?f[1]=="i"?r=f+" "+p+";":o+=f[1]=="f"?Jn(p,f):f+"{"+Jn(p,f[1]=="k"?"":i)+"}":typeof p=="object"?o+=Jn(p,i?i.replace(/([^,])+/g,x=>f.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,m=>/&/.test(m)?m.replace(/&/g,x):x?x+" "+m:m)):f):p!=null&&(f=/^--/.test(f)?f:f.replace(/[A-Z]/g,"-$&").toLowerCase(),d+=Jn.p?Jn.p(f,p):f+":"+p+";")}return r+(i&&d?i+"{"+d+"}":d)+o},Sn={},Lf=s=>{if(typeof s=="object"){let i="";for(let r in s)i+=r+Lf(s[r]);return i}return s},hg=(s,i,r,o,d)=>{let f=Lf(s),p=Sn[f]||(Sn[f]=(m=>{let v=0,g=11;for(;v<m.length;)g=101*g+m.charCodeAt(v++)>>>0;return"go"+g})(f));if(!Sn[p]){let m=f!==s?s:(v=>{let g,b,y=[{}];for(;g=ug.exec(v.replace(fg,""));)g[4]?y.shift():g[3]?(b=g[3].replace(Fu," ").trim(),y.unshift(y[0][b]=y[0][b]||{})):y[0][g[1]]=g[2].replace(Fu," ").trim();return y[0]})(s);Sn[p]=Jn(d?{["@keyframes "+p]:m}:m,r?"":"."+p)}let x=r&&Sn.g?Sn.g:null;return r&&(Sn.g=Sn[p]),((m,v,g,b)=>{b?v.data=v.data.replace(b,m):v.data.indexOf(m)===-1&&(v.data=g?m+v.data:v.data+m)})(Sn[p],i,o,x),p},pg=(s,i,r)=>s.reduce((o,d,f)=>{let p=i[f];if(p&&p.call){let x=p(r),m=x&&x.props&&x.props.className||/^go/.test(x)&&x;p=m?"."+m:x&&typeof x=="object"?x.props?"":Jn(x,""):x===!1?"":x}return o+d+(p??"")},"");function Ll(s){let i=this||{},r=s.call?s(i.p):s;return hg(r.unshift?r.raw?pg(r,[].slice.call(arguments,1),i.p):r.reduce((o,d)=>Object.assign(o,d&&d.call?d(i.p):d),{}):r,cg(i.target),i.g,i.o,i.k)}let If,Wo,$o;Ll.bind({g:1});let kn=Ll.bind({k:1});function xg(s,i,r,o){Jn.p=i,If=s,Wo=r,$o=o}function Xn(s,i){let r=this||{};return function(){let o=arguments;function d(f,p){let x=Object.assign({},f),m=x.className||d.className;r.p=Object.assign({theme:Wo&&Wo()},x),r.o=/ *go\d+/.test(m),x.className=Ll.apply(r,o)+(m?" "+m:"");let v=s;return s[0]&&(v=x.as||s,delete x.as),$o&&v[0]&&$o(x),If(v,x)}return d}}var gg=s=>typeof s=="function",Al=(s,i)=>gg(s)?s(i):s,mg=(()=>{let s=0;return()=>(++s).toString()})(),Pf=(()=>{let s;return()=>{if(s===void 0&&typeof window<"u"){let i=matchMedia("(prefers-reduced-motion: reduce)");s=!i||i.matches}return s}})(),yg=20,Vo="default",Bf=(s,i)=>{let{toastLimit:r}=s.settings;switch(i.type){case 0:return{...s,toasts:[i.toast,...s.toasts].slice(0,r)};case 1:return{...s,toasts:s.toasts.map(p=>p.id===i.toast.id?{...p,...i.toast}:p)};case 2:let{toast:o}=i;return Bf(s,{type:s.toasts.find(p=>p.id===o.id)?1:0,toast:o});case 3:let{toastId:d}=i;return{...s,toasts:s.toasts.map(p=>p.id===d||d===void 0?{...p,dismissed:!0,visible:!1}:p)};case 4:return i.toastId===void 0?{...s,toasts:[]}:{...s,toasts:s.toasts.filter(p=>p.id!==i.toastId)};case 5:return{...s,pausedAt:i.time};case 6:let f=i.time-(s.pausedAt||0);return{...s,pausedAt:void 0,toasts:s.toasts.map(p=>({...p,pauseDuration:p.pauseDuration+f}))}}},wl=[],Of={toasts:[],pausedAt:void 0,settings:{toastLimit:yg}},fn={},Wf=(s,i=Vo)=>{fn[i]=Bf(fn[i]||Of,s),wl.forEach(([r,o])=>{r===i&&o(fn[i])})},$f=s=>Object.keys(fn).forEach(i=>Wf(s,i)),vg=s=>Object.keys(fn).find(i=>fn[i].toasts.some(r=>r.id===s)),Il=(s=Vo)=>i=>{Wf(i,s)},bg={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},jg=(s={},i=Vo)=>{let[r,o]=u.useState(fn[i]||Of),d=u.useRef(fn[i]);u.useEffect(()=>(d.current!==fn[i]&&o(fn[i]),wl.push([i,o]),()=>{let p=wl.findIndex(([x])=>x===i);p>-1&&wl.splice(p,1)}),[i]);let f=r.toasts.map(p=>{var x,m,v;return{...s,...s[p.type],...p,removeDelay:p.removeDelay||((x=s[p.type])==null?void 0:x.removeDelay)||(s==null?void 0:s.removeDelay),duration:p.duration||((m=s[p.type])==null?void 0:m.duration)||(s==null?void 0:s.duration)||bg[p.type],style:{...s.style,...(v=s[p.type])==null?void 0:v.style,...p.style}}});return{...r,toasts:f}},Sg=(s,i="blank",r)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:i,ariaProps:{role:"status","aria-live":"polite"},message:s,pauseDuration:0,...r,id:(r==null?void 0:r.id)||mg()}),si=s=>(i,r)=>{let o=Sg(i,s,r);return Il(o.toasterId||vg(o.id))({type:2,toast:o}),o.id},nt=(s,i)=>si("blank")(s,i);nt.error=si("error");nt.success=si("success");nt.loading=si("loading");nt.custom=si("custom");nt.dismiss=(s,i)=>{let r={type:3,toastId:s};i?Il(i)(r):$f(r)};nt.dismissAll=s=>nt.dismiss(void 0,s);nt.remove=(s,i)=>{let r={type:4,toastId:s};i?Il(i)(r):$f(r)};nt.removeAll=s=>nt.remove(void 0,s);nt.promise=(s,i,r)=>{let o=nt.loading(i.loading,{...r,...r==null?void 0:r.loading});return typeof s=="function"&&(s=s()),s.then(d=>{let f=i.success?Al(i.success,d):void 0;return f?nt.success(f,{id:o,...r,...r==null?void 0:r.success}):nt.dismiss(o),d}).catch(d=>{let f=i.error?Al(i.error,d):void 0;f?nt.error(f,{id:o,...r,...r==null?void 0:r.error}):nt.dismiss(o)}),s};var kg=1e3,Ng=(s,i="default")=>{let{toasts:r,pausedAt:o}=jg(s,i),d=u.useRef(new Map).current,f=u.useCallback((b,y=kg)=>{if(d.has(b))return;let j=setTimeout(()=>{d.delete(b),p({type:4,toastId:b})},y);d.set(b,j)},[]);u.useEffect(()=>{if(o)return;let b=Date.now(),y=r.map(j=>{if(j.duration===1/0)return;let k=(j.duration||0)+j.pauseDuration-(b-j.createdAt);if(k<0){j.visible&&nt.dismiss(j.id);return}return setTimeout(()=>nt.dismiss(j.id,i),k)});return()=>{y.forEach(j=>j&&clearTimeout(j))}},[r,o,i]);let p=u.useCallback(Il(i),[i]),x=u.useCallback(()=>{p({type:5,time:Date.now()})},[p]),m=u.useCallback((b,y)=>{p({type:1,toast:{id:b,height:y}})},[p]),v=u.useCallback(()=>{o&&p({type:6,time:Date.now()})},[o,p]),g=u.useCallback((b,y)=>{let{reverseOrder:j=!1,gutter:k=8,defaultPosition:_}=y||{},C=r.filter(I=>(I.position||_)===(b.position||_)&&I.height),L=C.findIndex(I=>I.id===b.id),D=C.filter((I,P)=>P<L&&I.visible).length;return C.filter(I=>I.visible).slice(...j?[D+1]:[0,D]).reduce((I,P)=>I+(P.height||0)+k,0)},[r]);return u.useEffect(()=>{r.forEach(b=>{if(b.dismissed)f(b.id,b.removeDelay);else{let y=d.get(b.id);y&&(clearTimeout(y),d.delete(b.id))}})},[r,f]),{toasts:r,handlers:{updateHeight:m,startPause:x,endPause:v,calculateOffset:g}}},Cg=kn`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,_g=kn`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,wg=kn`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,Eg=Xn("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${s=>s.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${Cg} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${_g} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${s=>s.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${wg} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,Rg=kn`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,Ag=Xn("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${s=>s.secondary||"#e0e0e0"};
  border-right-color: ${s=>s.primary||"#616161"};
  animation: ${Rg} 1s linear infinite;
`,Tg=kn`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,zg=kn`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,Dg=Xn("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${s=>s.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${Tg} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${zg} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${s=>s.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,Lg=Xn("div")`
  position: absolute;
`,Ig=Xn("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,Pg=kn`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,Bg=Xn("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${Pg} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,Og=({toast:s})=>{let{icon:i,type:r,iconTheme:o}=s;return i!==void 0?typeof i=="string"?u.createElement(Bg,null,i):i:r==="blank"?null:u.createElement(Ig,null,u.createElement(Ag,{...o}),r!=="loading"&&u.createElement(Lg,null,r==="error"?u.createElement(Eg,{...o}):u.createElement(Dg,{...o})))},Wg=s=>`
0% {transform: translate3d(0,${s*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,$g=s=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${s*-150}%,-1px) scale(.6); opacity:0;}
`,Mg="0%{opacity:0;} 100%{opacity:1;}",Fg="0%{opacity:1;} 100%{opacity:0;}",Ug=Xn("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,Vg=Xn("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,Hg=(s,i)=>{let r=s.includes("top")?1:-1,[o,d]=Pf()?[Mg,Fg]:[Wg(r),$g(r)];return{animation:i?`${kn(o)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${kn(d)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},Qg=u.memo(({toast:s,position:i,style:r,children:o})=>{let d=s.height?Hg(s.position||i||"top-center",s.visible):{opacity:0},f=u.createElement(Og,{toast:s}),p=u.createElement(Vg,{...s.ariaProps},Al(s.message,s));return u.createElement(Ug,{className:s.className,style:{...d,...r,...s.style}},typeof o=="function"?o({icon:f,message:p}):u.createElement(u.Fragment,null,f,p))});xg(u.createElement);var Gg=({id:s,className:i,style:r,onHeightUpdate:o,children:d})=>{let f=u.useCallback(p=>{if(p){let x=()=>{let m=p.getBoundingClientRect().height;o(s,m)};x(),new MutationObserver(x).observe(p,{subtree:!0,childList:!0,characterData:!0})}},[s,o]);return u.createElement("div",{ref:f,className:i,style:r},d)},qg=(s,i)=>{let r=s.includes("top"),o=r?{top:0}:{bottom:0},d=s.includes("center")?{justifyContent:"center"}:s.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:Pf()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${i*(r?1:-1)}px)`,...o,...d}},Jg=Ll`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,yl=16,Ya=({reverseOrder:s,position:i="top-center",toastOptions:r,gutter:o,children:d,toasterId:f,containerStyle:p,containerClassName:x})=>{let{toasts:m,handlers:v}=Ng(r,f);return u.createElement("div",{"data-rht-toaster":f||"",style:{position:"fixed",zIndex:9999,top:yl,left:yl,right:yl,bottom:yl,pointerEvents:"none",...p},className:x,onMouseEnter:v.startPause,onMouseLeave:v.endPause},m.map(g=>{let b=g.position||i,y=v.calculateOffset(g,{reverseOrder:s,gutter:o,defaultPosition:i}),j=qg(b,y);return u.createElement(Gg,{id:g.id,key:g.id,onHeightUpdate:v.updateHeight,className:g.visible?Jg:"",style:j},g.type==="custom"?Al(g.message,g):d?d(g):u.createElement(Qg,{toast:g,position:b}))}))},T=nt;const Mf=u.createContext(null);function Kg({children:s}){const[i,r]=u.useState(null),[o,d]=u.useState(()=>localStorage.getItem("nexthara_token")),[f,p]=u.useState(!0);u.useEffect(()=>{if(o)try{const b=JSON.parse(atob(o.split(".")[1]));b.exp*1e3>Date.now()?r({id:b.id,name:b.name,email:b.email,role:b.bank_role||b.role,bank:b.bank,portal:b.portal||"internal",organization_id:b.organization_id,org_name:b.org_name,branch_id:b.branch_id,bank_id:b.bank_id,bank_role:b.bank_role,bank_name:b.bank_name}):(localStorage.removeItem("nexthara_token"),d(null))}catch{localStorage.removeItem("nexthara_token"),d(null)}p(!1)},[o]);async function x(b,y){const j=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:b,password:y})}),k=await j.json();if(!j.ok)throw new Error(k.error||"Login failed");return localStorage.setItem("nexthara_token",k.token),d(k.token),r({...k.user,portal:"internal"}),k.user}async function m(b,y){const j=await fetch("/api/agent/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:b,password:y})}),k=await j.json();if(!j.ok)throw new Error(k.error||"Login failed");return localStorage.setItem("nexthara_token",k.token),d(k.token),r(k.user),k.user}async function v(b,y){const j=await fetch("/api/bank-admin/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:b,password:y})}),k=await j.json();if(!j.ok)throw new Error(k.error||"Login failed");return localStorage.setItem("nexthara_token",k.token),d(k.token),r(k.user),k.user}const g=u.useCallback(()=>{localStorage.removeItem("nexthara_token"),d(null),r(null)},[]);return e.jsx(Mf.Provider,{value:{user:i,token:o,login:x,agentLogin:m,bankAdminLogin:v,logout:g,isAuthenticated:!!i,loading:f},children:s})}function ks(){return u.useContext(Mf)}function ai({height:s=32,dark:i=!1,style:r={}}){const o=i?"#ffffff":"#1a1d4d",d=i?"#ffffff":"#31b672";return e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1864 841.9",style:{height:s,width:"auto",display:"block",...r},children:[e.jsxs("g",{fill:o,children:[e.jsx("path",{d:"M295.7,549.5v-220.5h48.3l112.1,193.9h3.6v-193.9h28.4v220.5h-48.9l-112.1-193.9h-3.6v193.9h-27.8Z"}),e.jsx("path",{d:"M489.9,551.3h-51.8l-112.1-193.9h-.8v193.9h-31.4v-224.1h51.1l112.1,193.9h.8v-193.9h32v224.1h0ZM440.2,547.7h46.1v-217h-24.8v193.9h-6.4l-112.1-193.9h-45.5v217h24.2v-193.9h6.4l112.1,193.9h0Z"}),e.jsx("path",{d:"M511.7,471.6v-5.4c0-41.7,24.8-83.4,78.8-83.4s77,38.4,77,78.5v13h-128.1c1.8,31.7,18.1,55.3,52.9,55.3s42-13,45.3-28.1h27.2c-7,33.5-34.4,53.5-72.5,53.5-56.8,0-80.6-42.6-80.6-83.4h0ZM540.7,452.5h98.5c-3.6-27.5-19.6-44.4-48.6-44.4s-45.3,17.8-49.8,44.4h0Z"}),e.jsx("path",{d:"M592.3,556.7c-57,0-82.4-42.8-82.4-85.2v-5.4c0-22.5,6.9-43.2,19.5-58.5,14.5-17.5,35.6-26.7,61.1-26.7s45.3,8.6,59.5,24.8c12.5,14.3,19.4,34,19.4,55.5v14.8h-128c3.4,44.9,33.3,51.7,51,51.7,26,0,40.7-13.4,43.6-26.7l.3-1.4h30.8l-.4,2.1c-7.1,34.4-34.9,54.9-74.2,54.9h0ZM590.5,384.5c-53.2,0-77.1,41-77.1,81.6v5.4c0,21.5,6.6,41.4,18.6,55.8,14,16.8,34.8,25.8,60.2,25.8,36.7,0,62.8-18.6,70.3-49.9h-23.6c-3.9,14.2-19.6,28.1-46.7,28.1s-52.6-20.8-54.6-57v-1.9c-.1,0,128.1,0,128.1,0v-11.2c0-38.2-23.3-76.8-75.2-76.8h0ZM641.2,454.3h-102.6l.4-2.1c5-29.6,23.4-45.9,51.6-45.9s46.5,16.3,50.4,46l.3,2h0ZM542.8,450.8h94.3c-4.2-26.7-20.3-40.8-46.6-40.8s-42.5,14.5-47.7,40.8h0Z"}),e.jsx("path",{d:"M939.4,551.3c-36,0-58.6-13.6-58.6-56.8v-84.6h-27.8v-21.8h27.8v-30.1h27.8v30.1h55.6v21.8h-55.6v88.2c0,17.2,10,27.2,27.2,27.2h28.4v26h-24.8Z"}),e.jsx("path",{d:"M966,553.1h-26.5c-41.2,0-60.4-18.6-60.4-58.6v-82.8h-27.8v-25.3h27.8v-30.1h31.4v30.1h55.6v25.3h-55.6v86.4c0,16.2,9.3,25.4,25.4,25.4h30.2v29.5h0ZM854.8,408.2h27.8v86.4c0,38,17.5,55,56.8,55h23v-22.4h-26.6c-18.1,0-29-10.8-29-29v-90h55.6v-18.2h-55.6v-30.1h-24.2v30.1h-27.8v18.2h0Z"}),e.jsx("path",{d:"M999.2,549.5v-220.5h29v87.6c8.8-21.1,25.4-33.2,51.3-33.2h1.2c38.7,0,58.6,26.6,58.6,74v92.1h-29v-98.2c0-26.3-16.3-41.4-39.6-41.4s-42.6,18.7-42.6,46.5v93h-29,0Z"}),e.jsx("path",{d:"M1141.2,551.3h-32.6v-100c0-24.4-14.5-39.6-37.8-39.6s-40.8,17.6-40.8,44.7v94.8h-32.6v-224.1h32.6v81.6c10-18.1,26.7-27.2,49.6-27.2h1.2c38.9,0,60.4,26.9,60.4,75.8v93.9h0ZM1112.2,547.7h25.4v-90.4c0-47.2-19.7-72.2-56.8-72.2h-1.2c-24.2,0-40.9,10.8-49.7,32.1l-3.4,8.3v-94.8h-25.4v217h25.4v-91.3c0-28.9,17.8-48.3,44.4-48.3s41.3,16.9,41.3,43.2v96.4Z"}),e.jsx("path",{d:"M1166.6,501.2c0-34.1,23.9-52,65.8-52h40.8v-3.9c0-22-11.8-33.5-33.8-33.5s-40.8.9-54.1,1.8v-25.4c13-1.2,29.9-1.8,44.4-1.8,49.5,0,71.3,16,71.3,61v102.1h-23v-32c-6.9,23.9-24.8,36.2-52.9,36.2s-58.6-19-58.6-52.6h0ZM1273.2,489.7v-18.7h-42c-23.3,0-36.2,12.4-36.2,30.2s13,29.6,36.2,29.6,40.8-9.7,42-41.1h0Z"}),e.jsx("path",{d:"M1225.2,555.5c-37.8,0-60.4-20.3-60.4-54.4s24-53.7,67.6-53.7h39v-2.1c0-21.1-10.8-31.8-32.1-31.8s-40.8.9-53.9,1.8h-1.9c0,.1,0-28.8,0-28.8h1.6c12.2-1.3,28.9-2,44.6-2,51.9,0,73.1,18.2,73.1,62.8v103.9h-26.5v-24c-8.8,18.7-26,28.2-51.1,28.2h0ZM1232.4,451c-41.9,0-64.1,17.4-64.1,50.2s20.7,50.8,56.8,50.8,44.4-11.8,51.2-35l3.5-12v42.7h19.4v-100.3c0-42.6-19.5-59.2-69.5-59.2s-30.7.6-42.6,1.7v21.8c13.4-.9,34.1-1.7,52.3-1.7s35.6,12.2,35.6,35.3v5.7h-42.6ZM1231.2,532.6c-23.5,0-38-12-38-31.4s14.6-32,38-32h43.8v20.6c-1.1,27.2-17,42.8-43.8,42.8ZM1231.2,472.8c-21.3,0-34.5,10.9-34.5,28.4s12.9,27.8,34.5,27.8,38.9-5.1,40.2-39.3v-16.9h-40.2Z"}),e.jsx("path",{d:"M1330,549.5v-161.3h23v48.3c5.1-34.4,25.4-50.1,61-50.1h5.4v26h-10.3c-32.3,0-50.2,17.8-50.2,49.8v87.3h-29,0Z"}),e.jsx("path",{d:"M1360.8,551.3h-32.6v-164.9h26.5v34.9c8.4-24.7,27.9-36.7,59.2-36.7h7.2v29.5h-12.1c-31.2,0-48.4,17.1-48.4,48.1v89.1h0ZM1331.8,547.7h25.4v-85.5c0-33.3,18.4-51.6,51.9-51.6h8.5v-22.4h-3.7c-35.5,0-54.3,15.5-59.3,48.6l-3.6-.3v-46.5h-19.4v157.8h0Z"}),e.jsx("path",{d:"M1433.9,501.2c0-34.1,23.9-52,65.8-52h40.8v-3.9c0-22-11.8-33.5-33.8-33.5s-40.8.9-54.1,1.8v-25.4c13-1.2,29.9-1.8,44.4-1.8,49.5,0,71.3,16,71.3,61v102.1h-23v-32c-6.9,23.9-24.8,36.2-52.9,36.2s-58.6-19-58.6-52.6h0ZM1540.5,489.7v-18.7h-42c-23.3,0-36.2,12.4-36.2,30.2s13,29.6,36.2,29.6,40.8-9.7,42-41.1h0Z"}),e.jsx("path",{d:"M1492.5,555.5c-37.8,0-60.4-20.3-60.4-54.4s24-53.7,67.6-53.7h39v-2.1c0-21.1-10.8-31.8-32.1-31.8s-40.8.9-53.9,1.8h-1.9c0,.1,0-28.8,0-28.8h1.6c12.2-1.3,28.9-2,44.6-2,51.9,0,73.1,18.2,73.1,62.8v103.9h-26.5v-24c-8.8,18.7-26,28.2-51.1,28.2h0ZM1499.7,451c-41.9,0-64.1,17.4-64.1,50.2s20.7,50.8,56.8,50.8,44.4-11.8,51.2-35l3.5-12v42.7h19.4v-100.3c0-42.6-19.5-59.2-69.5-59.2s-30.7.6-42.6,1.7v21.8c13.4-.9,34.1-1.7,52.3-1.7s35.6,12.2,35.6,35.3v5.7h-42.6ZM1498.5,532.6c-23.5,0-38-12-38-31.4s14.6-32,38-32h43.8v20.6c-1.1,27.2-17,42.8-43.8,42.8ZM1498.5,472.8c-21.3,0-34.5,10.9-34.5,28.4s12.9,27.8,34.5,27.8,38.9-5.1,40.2-39.3v-16.9h-40.2Z"})]}),e.jsxs("g",{fill:o,children:[e.jsx("path",{d:"M474.6,653.9v-30.5h10.5c3.5,0,6.1.7,7.9,2.1,1.8,1.4,2.7,3.5,2.7,6.2s-.4,2.7-1.1,3.8c-.8,1.1-1.9,2-3.3,2.6,1.6.5,2.9,1.3,3.8,2.5.9,1.2,1.4,2.7,1.4,4.5,0,2.9-.9,5.1-2.8,6.6s-4.5,2.3-7.9,2.3h-11.1ZM479.9,636.2h5.2c1.6,0,2.9-.4,3.9-1.1s1.4-1.8,1.4-3.2-.4-2.6-1.3-3.3c-.9-.7-2.2-1-4-1h-5.2v8.6ZM479.9,640.1v9.5h5.9c1.7,0,3-.4,3.9-1.2.9-.8,1.4-2,1.4-3.4,0-3.2-1.6-4.8-4.9-4.9h-6.3Z"}),e.jsx("path",{d:"M526.4,640.3h-12.5v9.4h14.7v4.2h-20v-30.5h19.8v4.3h-14.5v8.4h12.5v4.2h0Z"}),e.jsx("path",{d:"M578.1,627.6h-9.5v26.3h-5.3v-26.3h-9.4v-4.3h24.2v4.3h0Z"}),e.jsx("path",{d:"M613.3,653.9h-5.3v-13.6h-13.7v13.6h-5.3v-30.5h5.3v12.7h13.7v-12.7h5.3v30.5Z"}),e.jsx("path",{d:"M644.3,640.3h-12.5v9.4h14.7v4.2h-20v-30.5h19.8v4.3h-14.5v8.4h12.5v4.2h0Z"}),e.jsx("path",{d:"M699.4,653.9h-5.3l-13.6-21.7v21.7h-5.3v-30.5h5.3l13.7,21.8v-21.8h5.3v30.5Z"}),e.jsx("path",{d:"M730.4,640.3h-12.5v9.4h14.7v4.2h-20v-30.5h19.8v4.3h-14.5v8.4h12.5v4.2h0Z"}),e.jsx("path",{d:"M754.2,634.4l6.4-11h6.1l-9.2,15.2,9.4,15.4h-6.2l-6.6-11.2-6.6,11.2h-6.2l9.5-15.4-9.2-15.2h6.1l6.4,11Z"}),e.jsx("path",{d:"M799.9,627.6h-9.5v26.3h-5.3v-26.3h-9.4v-4.3h24.2v4.3h0Z"}),e.jsx("path",{d:"M843,646c0-1.3-.5-2.4-1.4-3.1s-2.7-1.5-5.1-2.2c-2.5-.7-4.4-1.6-5.9-2.5-2.8-1.8-4.2-4-4.2-6.8s1-4.5,3-6.1c2-1.6,4.6-2.4,7.8-2.4s4,.4,5.7,1.2c1.7.8,3,1.9,3.9,3.3,1,1.5,1.4,3,1.4,4.8h-5.3c0-1.6-.5-2.8-1.5-3.8-1-.9-2.4-1.3-4.3-1.3s-3.1.4-4,1.1c-1,.7-1.4,1.8-1.4,3.1s.5,2,1.5,2.8c1,.8,2.7,1.5,5.1,2.2,2.4.7,4.3,1.5,5.7,2.4,1.4.9,2.5,1.9,3.2,3.1s1,2.5,1,4.1c0,2.5-1,4.6-2.9,6.1s-4.6,2.3-7.9,2.3-4.2-.4-6.1-1.2c-1.8-.8-3.3-2-4.3-3.4s-1.5-3.1-1.5-5h5.3c0,1.7.6,3.1,1.7,4,1.2,1,2.8,1.4,4.9,1.4s3.2-.4,4.2-1.1c.9-.8,1.4-1.7,1.4-3h0Z"}),e.jsx("path",{d:"M882,627.6h-9.5v26.3h-5.3v-26.3h-9.4v-4.3h24.2v4.3h0Z"}),e.jsx("path",{d:"M907.4,646.8h-11.8l-2.5,7.1h-5.5l11.5-30.5h4.8l11.6,30.5h-5.5l-2.5-7.1h0ZM897.1,642.5h8.9l-4.4-12.7-4.4,12.7Z"}),e.jsx("path",{d:"M937,642.2h-5.9v11.8h-5.3v-30.5h10.7c3.5,0,6.2.8,8.2,2.4,1.9,1.6,2.9,3.9,2.9,6.9s-.5,3.8-1.5,5.1c-1,1.4-2.4,2.4-4.1,3.2l6.9,12.7v.3h-5.7l-6.1-11.8h0ZM931.1,637.9h5.5c1.8,0,3.2-.5,4.2-1.3,1-.9,1.5-2.1,1.5-3.7s-.5-2.9-1.4-3.8c-.9-.9-2.3-1.4-4.2-1.4h-5.6v10.2h0Z"}),e.jsx("path",{d:"M1001.5,639.4c0,3-.5,5.6-1.5,7.9-1,2.3-2.5,4-4.4,5.2-1.9,1.2-4.1,1.8-6.6,1.8s-4.7-.6-6.6-1.8c-1.9-1.2-3.4-2.9-4.5-5.2s-1.6-4.8-1.6-7.7v-1.7c0-3,.5-5.6,1.6-7.9,1.1-2.3,2.5-4,4.5-5.2,1.9-1.2,4.1-1.8,6.6-1.8s4.7.6,6.6,1.8c1.9,1.2,3.4,2.9,4.5,5.2,1,2.2,1.6,4.9,1.6,7.8v1.7h0ZM996.2,637.8c0-3.4-.6-6-1.9-7.8-1.3-1.8-3.1-2.7-5.4-2.7s-4.1.9-5.4,2.7-2,4.3-2,7.6v1.8c0,3.4.7,6,2,7.8s3.1,2.8,5.5,2.8,4.2-.9,5.4-2.7c1.3-1.8,1.9-4.4,1.9-7.8v-1.6h0Z"}),e.jsx("path",{d:"M1031.2,641h-12.3v13h-5.3v-30.5h19.4v4.3h-14.1v9.1h12.3v4.2h0Z"}),e.jsx("path",{d:"M1071.7,637.8l7-14.5h5.9l-10.2,19.3v11.2h-5.3v-11.2l-10.3-19.3h5.9l7,14.5h0Z"}),e.jsx("path",{d:"M1118.5,639.4c0,3-.5,5.6-1.6,7.9-1,2.3-2.5,4-4.4,5.2-1.9,1.2-4.1,1.8-6.6,1.8s-4.7-.6-6.6-1.8c-1.9-1.2-3.4-2.9-4.5-5.2-1.1-2.2-1.6-4.8-1.6-7.7v-1.7c0-3,.5-5.6,1.6-7.9,1.1-2.3,2.6-4,4.5-5.2,1.9-1.2,4.1-1.8,6.6-1.8s4.7.6,6.6,1.8c1.9,1.2,3.4,2.9,4.5,5.2,1.1,2.2,1.6,4.9,1.6,7.8v1.7h0ZM1113.2,637.8c0-3.4-.6-6-1.9-7.8s-3.1-2.7-5.4-2.7-4.1.9-5.4,2.7-2,4.3-2,7.6v1.8c0,3.4.7,6,2,7.8,1.3,1.8,3.1,2.8,5.4,2.8s4.2-.9,5.4-2.7c1.3-1.8,1.9-4.4,1.9-7.8v-1.6h0Z"}),e.jsx("path",{d:"M1153,623.3v20.4c0,3.2-1,5.8-3.1,7.7-2.1,1.9-4.8,2.8-8.3,2.8s-6.3-.9-8.3-2.8c-2.1-1.9-3.1-4.5-3.1-7.8v-20.4h5.3v20.4c0,2,.5,3.6,1.6,4.7s2.6,1.6,4.6,1.6c4.1,0,6.1-2.2,6.1-6.5v-20.3h5.3,0Z"}),e.jsx("path",{d:"M1176.8,642.2h-5.9v11.8h-5.3v-30.5h10.7c3.5,0,6.2.8,8.2,2.4,1.9,1.6,2.9,3.9,2.9,6.9s-.5,3.8-1.5,5.1c-1,1.4-2.4,2.4-4.1,3.2l6.9,12.7v.3h-5.7l-6.1-11.8h0ZM1170.9,637.9h5.5c1.8,0,3.2-.5,4.2-1.3,1-.9,1.5-2.1,1.5-3.7s-.5-2.9-1.4-3.8c-.9-.9-2.3-1.4-4.2-1.4h-5.6v10.2h0Z"}),e.jsx("path",{d:"M1234.4,641h-12.3v13h-5.3v-30.5h19.4v4.3h-14.1v9.1h12.3v4.2h0Z"}),e.jsx("path",{d:"M1260.4,646.8h-11.8l-2.5,7.1h-5.5l11.5-30.5h4.8l11.6,30.5h-5.5l-2.5-7.1h0ZM1250.1,642.5h8.8l-4.4-12.7-4.4,12.7h0Z"}),e.jsx("path",{d:"M1285.7,623.3l8.8,23.4,8.8-23.4h6.9v30.5h-5.3v-10.1l.5-13.5-9,23.5h-3.8l-9-23.5.5,13.5v10.1h-5.3v-30.5h6.9Z"}),e.jsx("path",{d:"M1328.9,653.9h-5.3v-30.5h5.3v30.5Z"}),e.jsx("path",{d:"M1347.6,649.7h13.9v4.2h-19.2v-30.5h5.3v26.3Z"}),e.jsx("path",{d:"M1376.5,637.8l7-14.5h5.9l-10.2,19.3v11.2h-5.3v-11.2l-10.3-19.3h5.9l7,14.5h0Z"})]}),e.jsxs("g",{fill:d,children:[e.jsx("path",{d:"M818.2,555.9c-41.8-39.9-83.9-40.1-126.3-.4-4.8-4.2-9.7-8.4-15.3-13.3,19-22.2,41.6-41.3,41.7-73.6,0-31.9-22-50.8-41-73.7,4.9-4.4,9.7-8.7,15.3-13.7,19.4,17.5,31.2,44.8,63.1,44.7,31.3-.1,43.5-25.9,63-44.1,4.8,4.2,9.3,8.1,16.1,14-54.8,47.8-57.7,97.2,1.8,147.8-5,2.8-7.8,4.1-10.4,5.8-2.5,1.7-4.7,3.9-7.9,6.5h0Z"}),e.jsx("path",{d:"M937.1,255.5c-23.6,20.4-25.8,43-6.7,67.8-2.5,2.4-5,4.8-7.9,7.5-11-11.4-20.1-24.5-37.4-26.1-17.1-1.7-28.4,9.2-41.7,18.3-2.1-2.9-4.2-5.6-6.6-8.9,10.4-9.5,25.7-14.5,27.2-31.6,1.5-16.8-11.7-24.7-20.5-36.1,2.5-2.4,4.8-4.6,8.3-7.9,22.9,31.9,49.2,36,79.5,6.6,1.2,2.8,1.8,4.4,2.6,5.9.8,1.4,1.8,2.8,3.1,4.6h0Z"}),e.jsx("path",{d:"M773.5,187.6c12,12,24.3,12.4,37,1.1,1.4,1.2,2.8,2.5,4.4,4-5.7,6.4-12.5,11.8-12.8,21.3-.2,9.4,6.1,15.1,11.5,21.9-1.5,1.3-2.9,2.5-4.6,3.9-5.6-5.3-8.8-13.4-18.2-13.6-9.2-.2-13,7.3-18.8,12.5-1.4-1.3-2.7-2.4-4.6-4.2,16.4-13.6,17.6-28.1.6-43.4,1.5-.8,2.3-1.1,3.1-1.6.8-.5,1.4-1.1,2.4-1.8h0Z"})]})]})}const Yg=[{key:"leads",icon:"fa-funnel-dollar",label:"Leads"},{key:"events",icon:"fa-calendar-alt",label:"Events"},{key:"dashboard",icon:"fa-th-large",label:"Cases"},{key:"applications",icon:"fa-file-alt",label:"Applications"},{key:"pipeline",icon:"fa-stream",label:"Pipeline"},{key:"leads-analytics",icon:"fa-chart-line",label:"Reports"},{key:"users",icon:"fa-users",label:"Users"}],Zg=[{key:"dashboard",icon:"fa-th-large",label:"Dashboard"},{key:"applications",icon:"fa-file-alt",label:"Applications"},{key:"queries",icon:"fa-question-circle",label:"Queries"},{key:"sanctions",icon:"fa-check-double",label:"Sanctions"},{key:"disbursements",icon:"fa-money-bill-wave",label:"Disbursements"},{key:"reports",icon:"fa-chart-bar",label:"Reports"}];function Uu({activeView:s,onViewChange:i}){const{user:r,logout:o}=ks(),d=(r==null?void 0:r.role)==="bank_user"?Zg:Yg,f=r!=null&&r.name?r.name.split(" ").map(x=>x[0]).join("").toUpperCase().slice(0,2):"?",p=(r==null?void 0:r.role)==="super_admin"?"Super Admin":r!=null&&r.bank?`${r.bank} User`:"Bank User";return e.jsxs("header",{className:"top-bar",children:[e.jsxs("div",{className:"top-bar-upper",children:[e.jsxs("div",{className:"brand",children:[e.jsx(ai,{height:32,dark:!0}),e.jsx("div",{className:"brand-text",children:e.jsx("span",{children:(r==null?void 0:r.role)==="bank_user"?"Bank Partner Portal":"Bank Application Status Portal"})})]}),e.jsxs("div",{className:"header-right",children:[e.jsxs("button",{className:"notif-btn",title:"Notifications",children:[e.jsx("i",{className:"fas fa-bell"}),e.jsx("span",{className:"badge-count",children:"5"})]}),e.jsxs("div",{className:"user-profile",children:[e.jsx("div",{className:"user-avatar",children:f}),e.jsxs("div",{className:"user-info",children:[e.jsx("div",{className:"name",children:(r==null?void 0:r.name)||"User"}),e.jsx("div",{className:"role",children:p})]}),e.jsx("i",{className:"fas fa-chevron-down",style:{fontSize:10,opacity:.7,color:"white"}})]}),e.jsx("button",{className:"notif-btn",title:"Sign out",onClick:o,style:{marginLeft:-8},children:e.jsx("i",{className:"fas fa-sign-out-alt"})})]})]}),e.jsx("nav",{className:"top-bar-nav",children:d.map(x=>e.jsxs("div",{className:`nav-item ${s===x.key||x.key==="events"&&s==="events-analytics"?"active":""}`,onClick:()=>i(x.key),children:[e.jsx("i",{className:`fas ${x.icon}`})," ",x.label]},x.key))})]})}const Ze="/api/applications";function Ff(){return localStorage.getItem("nexthara_token")}function Uf(){localStorage.removeItem("nexthara_token"),window.dispatchEvent(new Event("nexthara_logout"))}async function M(s,i={}){const r=Ff(),o={"Content-Type":"application/json"};r&&(o.Authorization=`Bearer ${r}`);const d=await fetch(s,{headers:o,...i});if(d.status===401)throw Uf(),new Error("Session expired. Please log in again.");if(!d.ok){const f=await d.json().catch(()=>({error:"Request failed"}));throw new Error(f.error||"Request failed")}return d.json()}const Ae={getApplications(s={}){const i=new URLSearchParams(s).toString();return M(`${Ze}?${i}`)},getStats(){return M(`${Ze}/stats`)},getPipeline(){return M(`${Ze}/pipeline`)},getSidebarCounts(){return M(`${Ze}/sidebar-counts`)},getApplication(s){return M(`${Ze}/${s}`)},createApplication(s){return M(Ze,{method:"POST",body:JSON.stringify(s)})},updateApplication(s,i){return M(`${Ze}/${s}`,{method:"PUT",body:JSON.stringify(i)})},deleteApplication(s){return M(`${Ze}/${s}`,{method:"DELETE"})}},Xa={getUsers(){return M("/api/users")},createUser(s){return M("/api/users",{method:"POST",body:JSON.stringify(s)})},updateUser(s,i){return M(`/api/users/${s}`,{method:"PUT",body:JSON.stringify(i)})},deleteUser(s){return M(`/api/users/${s}`,{method:"DELETE"})}},bt={getDocuments(s){return M(`${Ze}/${s}/documents`)},addDocument(s,i){return M(`${Ze}/${s}/documents`,{method:"POST",body:JSON.stringify(i)})},updateDocument(s,i,r){return M(`${Ze}/${s}/documents/${i}`,{method:"PUT",body:JSON.stringify(r)})},deleteDocument(s,i){return M(`${Ze}/${s}/documents/${i}`,{method:"DELETE"})},async uploadFile(s,i,r={}){const o=Ff(),d=new FormData;d.append("file",i),r.doc_name&&d.append("doc_name",r.doc_name),r.doc_category&&d.append("doc_category",r.doc_category),r.owner&&d.append("owner",r.owner),r.label&&d.append("label",r.label);const f=await fetch(`${Ze}/${s}/documents/upload`,{method:"POST",headers:o?{Authorization:`Bearer ${o}`}:{},body:d});if(f.status===401)throw Uf(),new Error("Session expired");if(!f.ok){const p=await f.json().catch(()=>({error:"Upload failed"}));throw new Error(p.error)}return f.json()},fileUrl(s,i,r=!1){return`${Ze}/${s}/documents/${i}/file${r?"?download=1":""}`}},gt={getLeads(s={}){const i=new URLSearchParams(s).toString();return M(`/api/leads?${i}`)},getStats(){return M("/api/leads/stats")},getAnalytics(){return M("/api/leads/analytics")},getQueues(){return M("/api/leads/queues")},getLead(s){return M(`/api/leads/${s}`)},createLead(s){return M("/api/leads",{method:"POST",body:JSON.stringify(s)})},updateLead(s,i){return M(`/api/leads/${s}`,{method:"PATCH",body:JSON.stringify(i)})},saveQualification(s,i){return M(`/api/leads/${s}/qualification`,{method:"POST",body:JSON.stringify(i)})},markQualified(s){return M(`/api/leads/${s}/mark-qualified`,{method:"POST",body:JSON.stringify({})})},addNote(s,i){return M(`/api/leads/${s}/note`,{method:"POST",body:JSON.stringify({note_text:i})})},logCall(s,i){return M(`/api/leads/${s}/call-log`,{method:"POST",body:JSON.stringify(i)})},setFollowup(s,i){return M(`/api/leads/${s}/followup`,{method:"POST",body:JSON.stringify(i)})},completeFollowup(s,i){return M(`/api/leads/${s}/followup/${i}/complete`,{method:"POST",body:JSON.stringify({})})},convert(s,i){return M(`/api/leads/${s}/convert`,{method:"POST",body:JSON.stringify(i)})},drop(s,i,r="DROPPED"){return M(`/api/leads/${s}/drop`,{method:"POST",body:JSON.stringify({reason:i,stage:r})})},mergeLead(s,i,r){return M("/api/leads/merge",{method:"POST",body:JSON.stringify({primary_id:s,duplicate_id:i,reason:r})})},getCampaignAnalytics(){return M("/api/leads/campaign-analytics")}},ei={getPacks(s){return M(`${Ze}/${s}/packs`)},createPack(s,i={}){return M(`${Ze}/${s}/packs`,{method:"POST",body:JSON.stringify(i)})}},Qn={getNextActions(s){return M(`/api/communication/cases/${s}/next-actions`)},createNextAction(s,i){return M(`/api/communication/cases/${s}/next-actions`,{method:"POST",body:JSON.stringify(i)})},updateNextAction(s,i){return M(`/api/communication/next-actions/${s}`,{method:"PUT",body:JSON.stringify(i)})},getReminderJobs(s){return M(`/api/communication/cases/${s}/reminder-jobs`)},sendReminder(s,i={}){return M(`/api/communication/cases/${s}/reminder-jobs`,{method:"POST",body:JSON.stringify(i)})},getMessageLog(s){return M(`/api/communication/cases/${s}/message-log`)},getStageExpectations(s){const i=s?`?status=${encodeURIComponent(s)}`:"";return M(`/api/communication/stage-expectations${i}`)},getEscalations(s){return M(`/api/communication/cases/${s}/escalations`)},createEscalation(s,i){return M(`/api/communication/cases/${s}/escalations`,{method:"POST",body:JSON.stringify(i)})},resolveEscalation(s){return M(`/api/communication/escalations/${s}/resolve`,{method:"POST",body:JSON.stringify({})})},getOpenActions(s={}){const i=new URLSearchParams(s).toString();return M(`/api/communication/open-actions?${i}`)}},Ve={registerOrg(s){return M("/api/agent/auth/register-org",{method:"POST",body:JSON.stringify(s)})},me(){return M("/api/agent/auth/me")},getDashboard(){return M("/api/agent/dashboard")},getLeads(s={}){const i=new URLSearchParams(s).toString();return M(`/api/agent/leads?${i}`)},createLead(s){return M("/api/agent/leads",{method:"POST",body:JSON.stringify(s)})},getLead(s){return M(`/api/agent/leads/${s}`)},updateLead(s,i){return M(`/api/agent/leads/${s}`,{method:"PATCH",body:JSON.stringify(i)})},addLeadNote(s,i){return M(`/api/agent/leads/${s}/note`,{method:"POST",body:JSON.stringify({note_text:i})})},convertLeadToCase(s,i){return M(`/api/agent/leads/${s}/convert-to-case`,{method:"POST",body:JSON.stringify(i)})},getCases(s={}){const i=new URLSearchParams(s).toString();return M(`/api/agent/cases?${i}`)},getCase(s){return M(`/api/agent/cases/${s}`)},getBankApps(s={}){const i=new URLSearchParams(s).toString();return M(`/api/agent/bank-apps?${i}`)},getStudents(s={}){const i=new URLSearchParams(s).toString();return M(`/api/agent/students?${i}`)},getStudent(s){return M(`/api/agent/students/${s}`)},getCommissions(s={}){const i=new URLSearchParams(s).toString();return M(`/api/agent/commissions?${i}`)},getCommission(s){return M(`/api/agent/commissions/${s}`)},createCommission(s){return M("/api/agent/commissions",{method:"POST",body:JSON.stringify(s)})},updateCommission(s,i){return M(`/api/agent/commissions/${s}`,{method:"PATCH",body:JSON.stringify(i)})},getReports(){return M("/api/agent/reports")},getProfile(){return M("/api/agent/settings/profile")},updateProfile(s){return M("/api/agent/settings/profile",{method:"PATCH",body:JSON.stringify(s)})},getBranches(){return M("/api/agent/settings/branches")},createBranch(s){return M("/api/agent/settings/branches",{method:"POST",body:JSON.stringify(s)})},getUsers(){return M("/api/agent/settings/users")},createUser(s){return M("/api/agent/settings/users",{method:"POST",body:JSON.stringify(s)})},updateUser(s,i){return M(`/api/agent/settings/users/${s}`,{method:"PATCH",body:JSON.stringify(i)})}},_e={login(s,i){return M("/api/bank-admin/auth/login",{method:"POST",body:JSON.stringify({email:s,password:i})})},me(){return M("/api/bank-admin/auth/me")},getBanks(){return M("/api/bank-admin/banks")},getBank(s){return M(`/api/bank-admin/banks/${s}`)},updateBank(s,i){return M(`/api/bank-admin/banks/${s}`,{method:"PUT",body:JSON.stringify(i)})},getProducts(s){return M(`/api/bank-admin/banks/${s}/products`)},createProduct(s,i){return M(`/api/bank-admin/banks/${s}/products`,{method:"POST",body:JSON.stringify(i)})},getProduct(s){return M(`/api/bank-admin/products/${s}`)},updateProduct(s,i){return M(`/api/bank-admin/products/${s}`,{method:"PUT",body:JSON.stringify(i)})},deleteProduct(s){return M(`/api/bank-admin/products/${s}`,{method:"DELETE"})},getCriteria(s){return M(`/api/bank-admin/products/${s}/criteria`)},addCriterion(s,i){return M(`/api/bank-admin/products/${s}/criteria`,{method:"POST",body:JSON.stringify(i)})},deleteCriterion(s){return M(`/api/bank-admin/criteria/${s}`,{method:"DELETE"})},getProductDocs(s){return M(`/api/bank-admin/products/${s}/documents`)},addProductDoc(s,i){return M(`/api/bank-admin/products/${s}/documents`,{method:"POST",body:JSON.stringify(i)})},deleteProductDoc(s){return M(`/api/bank-admin/product-documents/${s}`,{method:"DELETE"})},getBranches(s){return M(`/api/bank-admin/banks/${s}/branches`)},createBranch(s,i){return M(`/api/bank-admin/banks/${s}/branches`,{method:"POST",body:JSON.stringify(i)})},updateBranch(s,i){return M(`/api/bank-admin/branches/${s}`,{method:"PUT",body:JSON.stringify(i)})},getUsers(s){return M(`/api/bank-admin/banks/${s}/users`)},createUser(s,i){return M(`/api/bank-admin/banks/${s}/users`,{method:"POST",body:JSON.stringify(i)})},updateUser(s,i){return M(`/api/bank-admin/bank-users/${s}`,{method:"PUT",body:JSON.stringify(i)})},getAnnouncements(s){return M(`/api/bank-admin/banks/${s}/announcements`)},createAnnouncement(s,i){return M(`/api/bank-admin/banks/${s}/announcements`,{method:"POST",body:JSON.stringify(i)})},deleteAnnouncement(s){return M(`/api/bank-admin/announcements/${s}`,{method:"DELETE"})},getApiKeys(s){return M(`/api/bank-admin/banks/${s}/api-keys`)},createApiKey(s,i){return M(`/api/bank-admin/banks/${s}/api-keys`,{method:"POST",body:JSON.stringify(i)})},toggleApiKey(s){return M(`/api/bank-admin/api-keys/${s}/toggle`,{method:"PATCH",body:JSON.stringify({})})},getDashboard(s){return M(`/api/bank-admin/banks/${s}/dashboard`)},getAnalytics(s){return M(`/api/bank-admin/banks/${s}/analytics`)},getAuditLog(s){return M(`/api/bank-admin/banks/${s}/audit-log`)},getRegions(s){return M(`/api/bank-admin/banks/${s}/regions`)},createRegion(s,i){return M(`/api/bank-admin/banks/${s}/regions`,{method:"POST",body:JSON.stringify(i)})},getBankApplications(s,i={}){const r=new URLSearchParams(i).toString();return M(`/api/bank-admin/banks/${s}/bank-applications${r?"?"+r:""}`)},createBankApplication(s,i){return M(`/api/bank-admin/banks/${s}/bank-applications`,{method:"POST",body:JSON.stringify(i)})},getBankApplication(s){return M(`/api/bank-admin/bank-applications/${s}`)},updateBankApplicationStatus(s,i){return M(`/api/bank-admin/bank-applications/${s}/status`,{method:"PATCH",body:JSON.stringify(i)})},assignBankApplication(s,i){return M(`/api/bank-admin/bank-applications/${s}/assign`,{method:"PATCH",body:JSON.stringify(i)})},getQueries(s){return M(`/api/bank-admin/bank-applications/${s}/queries`)},createQuery(s,i){return M(`/api/bank-admin/bank-applications/${s}/queries`,{method:"POST",body:JSON.stringify(i)})},getQuery(s){return M(`/api/bank-admin/queries/${s}`)},addQueryMessage(s,i){return M(`/api/bank-admin/queries/${s}/messages`,{method:"POST",body:JSON.stringify(i)})},closeQuery(s){return M(`/api/bank-admin/queries/${s}/close`,{method:"PATCH",body:JSON.stringify({})})},getProofs(s){return M(`/api/bank-admin/bank-applications/${s}/proofs`)},uploadProof(s,i){return M(`/api/bank-admin/bank-applications/${s}/proofs`,{method:"POST",body:JSON.stringify(i)})},verifyProof(s,i){return M(`/api/bank-admin/proofs/${s}/verify`,{method:"PATCH",body:JSON.stringify(i)})},getDocReviews(s){return M(`/api/bank-admin/bank-applications/${s}/doc-reviews`)},reviewDoc(s,i){return M(`/api/bank-admin/bank-applications/${s}/doc-reviews`,{method:"POST",body:JSON.stringify(i)})},getDocRejectionReasons(){return M("/api/bank-admin/doc-rejection-reasons")},getPolicyVersions(s){return M(`/api/bank-admin/products/${s}/policy-versions`)},createPolicyVersion(s,i){return M(`/api/bank-admin/products/${s}/policy-versions`,{method:"POST",body:JSON.stringify(i)})},getEnhancedDashboard(s){return M(`/api/bank-admin/banks/${s}/enhanced-dashboard`)},getApplicationEvents(s){return M(`/api/bank-admin/bank-applications/${s}/events`)}},_o={getCoApplicants(s){return M(`${Ze}/${s}/co-applicants`)},addCoApplicant(s,i){return M(`${Ze}/${s}/co-applicants`,{method:"POST",body:JSON.stringify(i)})},updateCoApplicant(s,i,r){return M(`${Ze}/${s}/co-applicants/${i}`,{method:"PUT",body:JSON.stringify(r)})},deleteCoApplicant(s,i){return M(`${Ze}/${s}/co-applicants/${i}`,{method:"DELETE"})}},Ye={getEvents(s={}){const i=new URLSearchParams(s).toString();return M(`/api/events${i?"?"+i:""}`)},createEvent(s){return M("/api/events",{method:"POST",body:JSON.stringify(s)})},getEvent(s){return M(`/api/events/${s}`)},updateEvent(s,i){return M(`/api/events/${s}`,{method:"PATCH",body:JSON.stringify(i)})},getRegistrations(s,i={}){const r=new URLSearchParams(i).toString();return M(`/api/events/${s}/registrations${r?"?"+r:""}`)},checkin(s,i){return M(`/api/events/${s}/checkin`,{method:"POST",body:JSON.stringify(i)})},getCheckins(s){return M(`/api/events/${s}/checkins`)},getMessages(s){return M(`/api/events/${s}/messages`)},sendMessage(s,i){return M(`/api/events/${s}/messages`,{method:"POST",body:JSON.stringify(i)})},getLeadsConversions(s,i={}){const r=new URLSearchParams(i).toString();return M(`/api/events/${s}/leads${r?"?"+r:""}`)},bulkConvertToLeads(s,i){return M(`/api/events/${s}/convert/bulk-to-leads`,{method:"POST",body:JSON.stringify(i)})},convertRegistration(s,i,r){return M(`/api/events/${s}/convert/registration/${i}`,{method:"POST",body:JSON.stringify(r)})},getOverviewAnalytics(s={}){const i=new URLSearchParams(s).toString();return M(`/api/events/analytics${i?"?"+i:""}`)},getEventAnalytics(s){return M(`/api/events/${s}/analytics`)},getTicketTypes(s){return M(`/api/events/${s}/ticket-types`)},getMetaMappings(s){return M(`/api/events/${s}/meta-mappings`)},addMetaMapping(s,i){return M(`/api/events/${s}/meta-mappings`,{method:"POST",body:JSON.stringify(i)})},exportCSV(s){return`/api/events/${s}/export`},getPublicEvent(s){return fetch(`/api/events/public/event/${s}`).then(i=>i.json())},registerForEvent(s,i){return fetch(`/api/events/public/event/${s}/register`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)}).then(r=>r.json())},getTicket(s){return fetch(`/api/events/public/ticket/${s}`).then(i=>i.json())}},we={getDashboard(s=30){return M(`/api/admin/dashboard?days=${s}`)},getAutomationRules(){return M("/api/admin/automation-rules")},createAutomationRule(s){return M("/api/admin/automation-rules",{method:"POST",body:JSON.stringify(s)})},updateAutomationRule(s,i){return M(`/api/admin/automation-rules/${s}`,{method:"PUT",body:JSON.stringify(i)})},deleteAutomationRule(s){return M(`/api/admin/automation-rules/${s}`,{method:"DELETE"})},getTemplates(s={}){const i=new URLSearchParams(s).toString();return M(`/api/admin/message-templates${i?"?"+i:""}`)},createTemplate(s){return M("/api/admin/message-templates",{method:"POST",body:JSON.stringify(s)})},updateTemplate(s,i){return M(`/api/admin/message-templates/${s}`,{method:"PUT",body:JSON.stringify(i)})},deleteTemplate(s){return M(`/api/admin/message-templates/${s}`,{method:"DELETE"})},getUniversities(){return M("/api/admin/universities")},createUniversity(s){return M("/api/admin/universities",{method:"POST",body:JSON.stringify(s)})},updateUniversity(s,i){return M(`/api/admin/universities/${s}`,{method:"PUT",body:JSON.stringify(i)})},deleteUniversity(s){return M(`/api/admin/universities/${s}`,{method:"DELETE"})},getCourses(){return M("/api/admin/courses")},createCourse(s){return M("/api/admin/courses",{method:"POST",body:JSON.stringify(s)})},updateCourse(s,i){return M(`/api/admin/courses/${s}`,{method:"PUT",body:JSON.stringify(i)})},deleteCourse(s){return M(`/api/admin/courses/${s}`,{method:"DELETE"})},getCountries(){return M("/api/admin/countries")},createCountry(s){return M("/api/admin/countries",{method:"POST",body:JSON.stringify(s)})},updateCountry(s,i){return M(`/api/admin/countries/${s}`,{method:"PUT",body:JSON.stringify(i)})},deleteCountry(s){return M(`/api/admin/countries/${s}`,{method:"DELETE"})},getDocumentMaster(){return M("/api/admin/document-master")},createDocument(s){return M("/api/admin/document-master",{method:"POST",body:JSON.stringify(s)})},updateDocument(s,i){return M(`/api/admin/document-master/${s}`,{method:"PUT",body:JSON.stringify(i)})},deleteDocument(s){return M(`/api/admin/document-master/${s}`,{method:"DELETE"})},getStageMaster(s={}){const i=new URLSearchParams(s).toString();return M(`/api/admin/stage-master${i?"?"+i:""}`)},createStage(s){return M("/api/admin/stage-master",{method:"POST",body:JSON.stringify(s)})},updateStage(s,i){return M(`/api/admin/stage-master/${s}`,{method:"PUT",body:JSON.stringify(i)})},deleteStage(s){return M(`/api/admin/stage-master/${s}`,{method:"DELETE"})},getLossReasons(s={}){const i=new URLSearchParams(s).toString();return M(`/api/admin/loss-reasons${i?"?"+i:""}`)},createLossReason(s){return M("/api/admin/loss-reasons",{method:"POST",body:JSON.stringify(s)})},updateLossReason(s,i){return M(`/api/admin/loss-reasons/${s}`,{method:"PUT",body:JSON.stringify(i)})},deleteLossReason(s){return M(`/api/admin/loss-reasons/${s}`,{method:"DELETE"})},getSettings(){return M("/api/admin/settings")},updateSettings(s){return M("/api/admin/settings",{method:"PUT",body:JSON.stringify(s)})},getLeadReport(s=30){return M(`/api/admin/reports/leads?days=${s}`)},getCaseReport(s=30){return M(`/api/admin/reports/cases?days=${s}`)},getBankReport(){return M("/api/admin/reports/banks")},getStaffReport(s=30){return M(`/api/admin/reports/staff?days=${s}`)},getCampaignReport(s=30){return M(`/api/admin/reports/campaigns?days=${s}`)},getComms(){return M("/api/admin/comms")},getOrgs(){return M("/api/admin/orgs")},getAuditLogs(s={}){const i=new URLSearchParams(s).toString();return M(`/api/admin/audit-logs${i?"?"+i:""}`)},getNotifications(s={}){const i=new URLSearchParams(s).toString();return M(`/api/admin/notifications${i?"?"+i:""}`)},markNotificationRead(s){return M(`/api/admin/notifications/${s}/read`,{method:"PATCH",body:JSON.stringify({})})}};function Xg({activeFilter:s,onFilterChange:i,refreshKey:r}){const[o,d]=u.useState(null);if(u.useEffect(()=>{Ae.getSidebarCounts().then(d).catch(()=>{})},[r]),!o)return e.jsx("aside",{className:"sidebar",children:e.jsx("div",{style:{padding:20,color:"rgba(255,255,255,0.5)"},children:"Loading..."})});const f=[{key:"stage-1",icon:"fa-plug",color:"#78909c",label:"Pre-Login",count:o.stages[1]},{key:"stage-2",icon:"fa-sign-in-alt",color:"#f9a825",label:"Login Stage",count:o.stages[2]},{key:"stage-3",icon:"fa-file-alt",color:"#e65100",label:"Doc Verification",count:o.stages[3]},{key:"stage-4",icon:"fa-search-dollar",color:"#6a1b9a",label:"Credit Review",count:o.stages[4]},{key:"stage-5",icon:"fa-gavel",color:"#2e7d32",label:"Decision",count:o.stages[5]},{key:"stage-6",icon:"fa-handshake",color:"#1565c0",label:"Post Sanction",count:o.stages[6]},{key:"stage-7",icon:"fa-flag-checkered",color:"#37474f",label:"Closed",count:o.stages[7]}];return e.jsxs("aside",{className:"sidebar",children:[e.jsx("div",{className:"sidebar-section",children:"Quick Filters"}),e.jsxs("div",{className:`sidebar-item ${s==="all"?"active":""}`,onClick:()=>i("all"),children:[e.jsx("i",{className:"fas fa-layer-group"})," All Applications",e.jsx("span",{className:"count",children:o.all})]}),f.map(p=>e.jsxs("div",{className:`sidebar-item ${s===p.key?"active":""}`,onClick:()=>i(p.key),children:[e.jsx("i",{className:`fas ${p.icon}`,style:{color:p.color}})," ",p.label,e.jsx("span",{className:"count",children:p.count})]},p.key)),e.jsx("div",{className:"sidebar-section",style:{marginTop:20},children:"Awaiting From"}),e.jsxs("div",{className:`sidebar-item ${s==="await-Student"?"active":""}`,onClick:()=>i("await-Student"),children:[e.jsx("i",{className:"fas fa-user-graduate",style:{color:"#f57f17"}})," Awaiting Student",e.jsx("span",{className:"count",children:o.awaitStudent})]}),e.jsxs("div",{className:`sidebar-item ${s==="await-Bank"?"active":""}`,onClick:()=>i("await-Bank"),children:[e.jsx("i",{className:"fas fa-university",style:{color:"#1565c0"}})," Awaiting Bank",e.jsx("span",{className:"count",children:o.awaitBank})]}),e.jsxs("div",{className:`sidebar-item ${s==="await-Nexthara"?"active":""}`,onClick:()=>i("await-Nexthara"),children:[e.jsx("i",{className:"fas fa-building",style:{color:"#78909c"}})," Awaiting Nexthara",e.jsx("span",{className:"count",children:o.awaitNexthara})]}),e.jsx("div",{className:"sidebar-section",style:{marginTop:20},children:"Priority"}),e.jsxs("div",{className:`sidebar-item ${s==="priority-Urgent"?"active":""}`,onClick:()=>i("priority-Urgent"),children:[e.jsx("i",{className:"fas fa-exclamation-circle",style:{color:"#e53935"}})," Urgent",e.jsx("span",{className:"count",children:o.urgent})]}),e.jsxs("div",{className:`sidebar-item ${s==="priority-High"?"active":""}`,onClick:()=>i("priority-High"),children:[e.jsx("i",{className:"fas fa-arrow-up",style:{color:"#ffa726"}})," High Priority",e.jsx("span",{className:"count",children:o.high})]}),e.jsx("div",{className:"sidebar-section",style:{marginTop:20},children:"SLA Alerts"}),e.jsxs("div",{className:`sidebar-item ${s==="sla-breach"?"active":""}`,onClick:()=>i("sla-breach"),children:[e.jsx("i",{className:"fas fa-clock",style:{color:"#e53935"}})," SLA Breach",e.jsx("span",{className:"count",style:{background:"#e53935",color:"white"},children:o.slaBreach})]}),e.jsxs("div",{className:`sidebar-item ${s==="sla-warning"?"active":""}`,onClick:()=>i("sla-warning"),children:[e.jsx("i",{className:"fas fa-exclamation-triangle",style:{color:"#f57f17"}})," SLA Warning",e.jsx("span",{className:"count",style:{background:"#f57f17",color:"white"},children:o.slaWarning})]})]})}function Vf({refreshKey:s}){const[i,r]=u.useState(null);if(u.useEffect(()=>{Ae.getStats().then(r).catch(()=>{})},[s]),!i)return e.jsx("div",{className:"kpi-grid",children:e.jsx("div",{className:"kpi-card blue",children:"Loading..."})});const o=[{label:"Total Applications",value:i.total,cls:"blue",footer:`${i.awaitingBank} awaiting bank`,icon:"fa-arrow-up",footerCls:"up"},{label:"Sanctioned",value:i.sanctioned,cls:"green",footer:`${i.total?(i.sanctioned/i.total*100).toFixed(1):0}% conversion`,icon:"fa-arrow-up",footerCls:"up"},{label:"Pending Action",value:i.pending,cls:"amber",footer:`${i.awaitingStudent} awaiting student`,icon:"fa-clock",footerCls:"neutral"},{label:"Rejected / Dropped",value:i.rejected,cls:"red",footer:`${i.total?(i.rejected/i.total*100).toFixed(1):0}% rejection rate`,icon:"fa-arrow-down",footerCls:"down"},{label:"SLA Breach",value:i.slaBreach,cls:"purple",footer:"Needs escalation",icon:"fa-exclamation-triangle",footerCls:"down"}];return e.jsx("div",{className:"kpi-grid",children:o.map(d=>e.jsxs("div",{className:`kpi-card ${d.cls}`,children:[e.jsx("div",{className:"kpi-label",children:d.label}),e.jsx("div",{className:"kpi-value",children:d.value}),e.jsxs("div",{className:`kpi-footer ${d.footerCls}`,children:[e.jsx("i",{className:`fas ${d.icon}`})," ",d.footer]})]},d.label))})}const Hf=["DUPLICATE_LOGIN_OTHER_SOURCE","POLICY_MISMATCH","LOW_CIBIL","HIGH_FOIR","INCOME_INSUFFICIENT","COURSE_NOT_ELIGIBLE","COUNTRY_NOT_SUPPORTED","DOCUMENTS_INSUFFICIENT","EMPLOYER_NOT_ACCEPTABLE","FRAUD_RISK","STUDENT_DROPPED","STUDENT_CHOSE_OTHER_LENDER","TIMEOUT_EXPIRED","OTHER"],qn={Admission:["Offer Letter","Admission Letter","University Invoice / Fee Structure"],"Student KYC":["Passport (Student)","Aadhar Card","PAN Card","10th Certificate","12th Certificate","Graduation / Degree Certificate"],"Co-applicant":["Passport / Aadhar (Co-applicant)","PAN (Co-applicant)","Income Proof (Co-applicant)","Relationship Proof"],Financial:["ITR (2 years)","Bank Statement (6 months)","Salary Slips (3 months)","Form 16"],Collateral:["Property Papers","Property Valuation Report","Property Insurance"],Other:["CIBIL Report","Employment Letter","Gap Certificate","Visa Copy"]},Rt={NOT_CONNECTED:{label:"Not Connected",stage:1,stageLabel:"Pre-Login",color:"grey",awaiting:"Nexthara"},CONTACTED:{label:"Contacted",stage:1,stageLabel:"Pre-Login",color:"grey",awaiting:"Bank"},YET_TO_CONNECT:{label:"Yet to Connect",stage:1,stageLabel:"Pre-Login",color:"grey",awaiting:"Bank"},LOGIN_SUBMITTED:{label:"Login Submitted",stage:2,stageLabel:"Login Stage",color:"blue",awaiting:"Bank"},LOGIN_IN_PROGRESS:{label:"Login In Progress",stage:2,stageLabel:"Login Stage",color:"grey",awaiting:"Bank"},LOGIN_REJECTED:{label:"Login Rejected",stage:2,stageLabel:"Login Stage",color:"red",awaiting:"Nexthara"},DUPLICATE_LOGIN:{label:"Duplicate Login",stage:2,stageLabel:"Login Stage",color:"amber",awaiting:"Nexthara"},DOCS_PENDING:{label:"Docs Pending",stage:3,stageLabel:"Doc Verification",color:"amber",awaiting:"Student"},DOCS_SUBMITTED:{label:"Docs Submitted",stage:3,stageLabel:"Doc Verification",color:"blue",awaiting:"Bank"},DOCS_VERIFICATION:{label:"Docs Verification",stage:3,stageLabel:"Doc Verification",color:"blue",awaiting:"Bank"},UNDER_REVIEW:{label:"Under Review",stage:4,stageLabel:"Credit Review",color:"blue",awaiting:"Bank"},CREDIT_CHECK_IN_PROGRESS:{label:"Credit Check",stage:4,stageLabel:"Credit Review",color:"blue",awaiting:"Bank"},FIELD_VERIFICATION:{label:"Field Verification",stage:4,stageLabel:"Credit Review",color:"blue",awaiting:"Bank"},QUERY_RAISED:{label:"Query Raised",stage:4,stageLabel:"Credit Review",color:"amber",awaiting:"Student"},SANCTIONED:{label:"Sanctioned",stage:5,stageLabel:"Decision",color:"green",awaiting:"Student"},CONDITIONAL_SANCTION:{label:"Conditional Sanction",stage:5,stageLabel:"Decision",color:"amber",awaiting:"Student"},REJECTED:{label:"Rejected",stage:5,stageLabel:"Decision",color:"red",awaiting:"Nexthara"},SANCTION_ACCEPTED:{label:"Sanction Accepted",stage:6,stageLabel:"Post Sanction",color:"green",awaiting:"Bank"},AGREEMENT_SIGNED:{label:"Agreement Signed",stage:6,stageLabel:"Post Sanction",color:"green",awaiting:"Bank"},DISBURSEMENT_PENDING:{label:"Disbursement Pending",stage:6,stageLabel:"Post Sanction",color:"amber",awaiting:"Bank"},DISBURSED:{label:"Disbursed",stage:6,stageLabel:"Post Sanction",color:"green",awaiting:"Closed"},CLOSED:{label:"Closed",stage:7,stageLabel:"Closed",color:"green",awaiting:"Closed"},DROPPED:{label:"Dropped",stage:7,stageLabel:"Closed",color:"grey",awaiting:"Closed"},EXPIRED:{label:"Expired",stage:7,stageLabel:"Closed",color:"red",awaiting:"Closed"}},bs={DOCS_PENDING:["ITR (2 years)","Bank Statement (6 months)","Salary Slips","Passport Copy","Offer Letter","CIBIL Report","Collateral Documents"],LOGIN_REJECTED:["Country not supported","Course not eligible","Income below threshold","Policy mismatch"],QUERY_RAISED:["Income clarification","Co-applicant relation proof","Property valuation mismatch","Employment proof needed"],REJECTED:["Low FOIR","Low CIBIL","Incomplete documentation","Employer not acceptable","Course risk","Bank internal policy"],CONDITIONAL_SANCTION:["Additional collateral needed","Co-applicant required","Higher margin deposit"],DROPPED:["Student not responding","Intake deferred","Visa rejected","Admission cancelled","Student self-funded","Student chose other bank"]},Qf={NOT_CONNECTED:2,CONTACTED:2,YET_TO_CONNECT:2,LOGIN_SUBMITTED:3,LOGIN_IN_PROGRESS:3,LOGIN_REJECTED:3,DUPLICATE_LOGIN:3,DOCS_PENDING:4,DOCS_SUBMITTED:4,DOCS_VERIFICATION:4,UNDER_REVIEW:7,CREDIT_CHECK_IN_PROGRESS:7,FIELD_VERIFICATION:7,QUERY_RAISED:5,SANCTIONED:2,CONDITIONAL_SANCTION:2,REJECTED:2,SANCTION_ACCEPTED:5,AGREEMENT_SIGNED:5,DISBURSEMENT_PENDING:7,DISBURSED:7,CLOSED:null,DROPPED:null,EXPIRED:null},Gf=["SBI","HDFC","ICICI","Axis Bank","PNB","Bank of Baroda","Canara Bank","Union Bank","IDFC First","Kotak","Prodigy Finance","MPOWER","Credila","Avanse","InCred"],em={SBI:"#1a237e",HDFC:"#004c8c",ICICI:"#f57c00","Axis Bank":"#97144d",PNB:"#1565c0","Bank of Baroda":"#e65100","Canara Bank":"#1b5e20","Union Bank":"#283593","IDFC First":"#c62828",Kotak:"#e53935","Prodigy Finance":"#00695c",MPOWER:"#4527a0",Credila:"#0d47a1",Avanse:"#1565c0",InCred:"#2e7d32"},Vu=[{num:1,label:"Pre-Login",color:"grey"},{num:2,label:"Login Stage",color:"yellow"},{num:3,label:"Doc Verification",color:"orange"},{num:4,label:"Credit Review",color:"pink"},{num:5,label:"Decision",color:"green"},{num:6,label:"Post Sanction",color:"blue"},{num:7,label:"Closed",color:"dark"}];function ct(s){return s?""+Number(s).toLocaleString("en-IN"):"-"}function dt(s){if(!s)return"-";const i=new Date(s);return`${i.getDate().toString().padStart(2,"0")} ${["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][i.getMonth()]} ${i.getFullYear()}`}function na(s){return s?new Date(s).toLocaleString("en-IN",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}):"-"}function Mo({refreshKey:s}){const[i,r]=u.useState(null);return u.useEffect(()=>{Ae.getPipeline().then(r).catch(()=>{})},[s]),i?e.jsxs("div",{className:"pipeline-container",children:[e.jsx("div",{className:"pipeline-header",children:e.jsxs("h3",{children:[e.jsx("i",{className:"fas fa-stream",style:{marginRight:8,color:"var(--sbi-accent)"}})," Application Pipeline"]})}),e.jsx("div",{className:"pipeline-stages",children:Vu.map((o,d)=>{var f;return e.jsxs("div",{style:{display:"flex",alignItems:"stretch",flex:1},children:[e.jsxs("div",{className:"pipeline-stage",style:{flex:1},children:[e.jsxs("div",{className:`pipeline-stage-head ${o.color}`,children:["Stage ",o.num]}),e.jsxs("div",{className:"pipeline-stage-body",children:[e.jsx("div",{className:"pipeline-stage-count",children:((f=i[o.num])==null?void 0:f.count)||0}),e.jsx("div",{className:"pipeline-stage-label",children:o.label})]})]}),d<Vu.length-1&&e.jsx("div",{className:"pipeline-arrow",children:e.jsx("i",{className:"fas fa-chevron-right"})})]},o.num)})})]}):e.jsx("div",{className:"pipeline-container",children:"Loading pipeline..."})}const tm=["2024-09","2025-01","2025-05","2025-09","2026-01","2026-05","2026-09"];function Hu({filters:s,onFilterChange:i}){const r=(o,d)=>{i({...s,[o]:d})};return e.jsxs("div",{className:"filter-bar",children:[e.jsxs("div",{className:"search-box",children:[e.jsx("i",{className:"fas fa-search"}),e.jsx("input",{type:"text",placeholder:"Search name, case ID, bank, phone",value:s.search||"",onChange:o=>r("search",o.target.value)})]}),e.jsxs("select",{className:"filter-select",value:s.status||"",onChange:o=>r("status",o.target.value),children:[e.jsx("option",{value:"",children:"All Statuses"}),Object.entries(Rt).map(([o,d])=>e.jsx("option",{value:o,children:d.label},o))]}),e.jsxs("select",{className:"filter-select",value:s.awaiting||"",onChange:o=>r("awaiting",o.target.value),children:[e.jsx("option",{value:"",children:"All Awaiting"}),e.jsx("option",{value:"Student",children:"Student"}),e.jsx("option",{value:"Bank",children:"Bank"}),e.jsx("option",{value:"Nexthara",children:"Nexthara"})]}),e.jsxs("select",{className:"filter-select",value:s.priority||"",onChange:o=>r("priority",o.target.value),children:[e.jsx("option",{value:"",children:"All Priorities"}),e.jsx("option",{value:"Urgent",children:"Urgent"}),e.jsx("option",{value:"High",children:"High"}),e.jsx("option",{value:"Normal",children:"Normal"})]}),e.jsxs("select",{className:"filter-select",value:s.intake||"",onChange:o=>r("intake",o.target.value),children:[e.jsx("option",{value:"",children:"All Intakes"}),tm.map(o=>e.jsx("option",{value:o,children:o},o))]}),e.jsxs("select",{className:"filter-select",value:s.sla||"",onChange:o=>r("sla",o.target.value),children:[e.jsx("option",{value:"",children:"All SLA"}),e.jsx("option",{value:"breach",children:"SLA Breach"}),e.jsx("option",{value:"warning",children:"SLA Warning"})]})]})}function Ht({status:s}){const i=Rt[s];return i?e.jsxs("span",{className:`status-badge status-${i.color}`,children:[e.jsx("span",{className:"dot"}),i.label]}):e.jsx("span",{children:s})}const Qu={Student:{cls:"awaiting-student",icon:"fa-user-graduate"},Bank:{cls:"awaiting-bank",icon:"fa-university"},Nexthara:{cls:"awaiting-nexthara",icon:"fa-building"},Closed:{cls:"awaiting-closed",icon:"fa-check-circle"}};function Nn({awaiting:s}){const i=Qu[s]||Qu.Closed;return e.jsxs("span",{className:`awaiting-pill ${i.cls}`,children:[e.jsx("i",{className:`fas ${i.icon}`})," ",s]})}function Qt({days:s,awaiting:i,status:r}){if(i==="Closed")return e.jsxs("span",{className:"sla-tag ok",children:[e.jsx("i",{className:"fas fa-check"})," Done"]});const o=r?Qf[r]??7:7,d=Math.ceil(o*.7);return s>o?e.jsxs("span",{className:"sla-tag breach",children:[e.jsx("i",{className:"fas fa-exclamation-circle"})," ",s,"d"]}):s>=d?e.jsxs("span",{className:"sla-tag warning",children:[e.jsx("i",{className:"fas fa-clock"})," ",s,"d"]}):e.jsxs("span",{className:"sla-tag ok",children:[e.jsx("i",{className:"fas fa-check-circle"})," ",s,"d"]})}function qf({priority:s}){const i=s==="Urgent"?"priority-urgent":s==="High"?"priority-high":"priority-normal";return e.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:6,fontSize:12},children:[e.jsx("span",{className:`priority-dot ${i}`,title:s})," ",s]})}function ii({bank:s}){const i=em[s]||"#607d8b",r=s.substring(0,2).toUpperCase();return e.jsxs("div",{className:"bank-name",children:[e.jsx("span",{className:"bank-logo",style:{background:i},children:r}),e.jsx("span",{children:s})]})}function nm(s){return s.awaiting_from==="Student"&&s.sla_days>2?"sla-risk":s.awaiting_from==="Bank"&&s.sla_days>5?"escalate":""}function sm({app:s}){return s.awaiting_from==="Student"&&s.sla_days>2?e.jsx("span",{className:"sla-risk-tag",children:"SLA Risk"}):s.awaiting_from==="Bank"&&s.sla_days>5?e.jsx("span",{className:"escalate-tag",children:"Escalate"}):null}function Za({applications:s,total:i,page:r,pages:o,onPageChange:d,onSelectApp:f}){return s?e.jsxs("div",{className:"table-container",children:[e.jsxs("div",{className:"table-header",children:[e.jsx("h3",{children:"Bank Applications"}),e.jsxs("span",{className:"results-count",children:["Showing ",s.length," of ",i," applications"]})]}),e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Case ID"}),e.jsx("th",{children:"Student"}),e.jsx("th",{children:"Bank / Lender"}),e.jsx("th",{children:"Main Status"}),e.jsx("th",{children:"Sub Status"}),e.jsx("th",{children:"Awaiting"}),e.jsx("th",{children:"SLA"}),e.jsx("th",{children:"Priority"}),e.jsx("th",{children:"Updated"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:s.length===0?e.jsx("tr",{children:e.jsxs("td",{colSpan:10,style:{textAlign:"center",padding:40,color:"#999"},children:[e.jsx("i",{className:"fas fa-inbox",style:{fontSize:24,display:"block",marginBottom:10}}),"No applications found"]})}):s.map(p=>e.jsxs("tr",{className:nm(p),children:[e.jsx("td",{children:e.jsx("span",{className:"app-id",onClick:()=>f(p.id),children:p.id})}),e.jsxs("td",{children:[e.jsx("div",{className:"student-name",children:p.student_name}),e.jsx("div",{className:"student-sub",children:p.course})]}),e.jsx("td",{children:e.jsx(ii,{bank:p.bank})}),e.jsxs("td",{children:[e.jsx(Ht,{status:p.status}),e.jsx(sm,{app:p})]}),e.jsx("td",{style:{fontSize:12,color:"#666",maxWidth:140},children:p.sub_status}),e.jsx("td",{children:e.jsx(Nn,{awaiting:p.awaiting_from})}),e.jsx("td",{children:e.jsx(Qt,{days:p.sla_days,awaiting:p.awaiting_from})}),e.jsx("td",{children:e.jsx(qf,{priority:p.priority})}),e.jsx("td",{style:{fontSize:12},children:dt(p.updated_at)}),e.jsx("td",{children:e.jsx("button",{className:"btn btn-sm btn-outline",onClick:()=>f(p.id),title:"View Details",children:e.jsx("i",{className:"fas fa-eye"})})})]},p.id))})]}),o>1&&e.jsxs("div",{className:"pagination",children:[e.jsxs("div",{className:"info",children:["Page ",r," of ",o," (",i," total)"]}),e.jsxs("div",{className:"pagination-btns",children:[e.jsx("button",{onClick:()=>d(r-1),disabled:r<=1,children:e.jsx("i",{className:"fas fa-chevron-left"})}),Array.from({length:Math.min(o,5)},(p,x)=>{const m=x+1;return e.jsx("button",{className:r===m?"active":"",onClick:()=>d(m),children:m},m)}),e.jsx("button",{onClick:()=>d(r+1),disabled:r>=o,children:e.jsx("i",{className:"fas fa-chevron-right"})})]})]})]}):e.jsx("div",{className:"table-container",style:{padding:40,textAlign:"center",color:"#999"},children:"Loading..."})}const Gu={STUDENT:"#1565c0",BANK:"#6a1b9a",NEXTHARA:"#2e7d32"},qu={URGENT:"#d32f2f",HIGH:"#e65100",NORMAL:"#546e7a"},Ju={QUEUED:"fa-clock",SENT:"fa-check",DELIVERED:"fa-check-double",READ:"fa-eye",FAILED:"fa-times-circle"};function Ha(s){if(!s)return"";try{return new Date(s).toLocaleString("en-IN",{day:"2-digit",month:"short",hour:"2-digit",minute:"2-digit"})}catch{return s}}function am(s){return s?Math.ceil((new Date(s)-new Date)/864e5):null}function Jf({appId:s,app:i}){const[r,o]=u.useState([]),[d,f]=u.useState([]),[p,x]=u.useState([]),[m,v]=u.useState(null),[g,b]=u.useState(!0),[y,j]=u.useState(!1),[k,_]=u.useState(!1),[C,L]=u.useState(null),D=u.useCallback(async()=>{b(!0);try{const[Z,ce,xe,z]=await Promise.all([Qn.getNextActions(s),Qn.getReminderJobs(s),Qn.getEscalations(s),i!=null&&i.status?Qn.getStageExpectations(i.status):Promise.resolve([])]);o(Z),f(ce),x(xe),v((z==null?void 0:z[0])||null)}catch{}b(!1)},[s,i==null?void 0:i.status]);u.useEffect(()=>{s&&D()},[s,D]);const I=r.find(Z=>Z.status==="OPEN"),P=p.find(Z=>!Z.resolved_at),w=d[0];async function A(Z){try{await Qn.updateNextAction(Z,{status:"DONE"}),T.success("Action marked done"),D()}catch{T.error("Failed to update")}}async function N(){if(i){j(!0);try{await Qn.sendReminder(s,{to_type:i.awaiting_from==="Student"?"STUDENT":i.awaiting_from==="Bank"?"BANK":"STAFF",to_address:i.student_email,channel:"IN_APP",template_name:"manual_reminder"}),T.success("Reminder queued"),D()}catch{T.error("Failed to send reminder")}j(!1)}}async function W(){const Z=(P==null?void 0:P.level)||0;if(Z>=3){T.error("Maximum escalation level (3) reached");return}_(!0);try{await Qn.createEscalation(s,{level:Z+1,reason:"SLA_BREACH"}),T.success(`Escalation level ${Z+1} created`),D()}catch{T.error("Escalation failed")}_(!1)}async function F(Z){try{await Qn.resolveEscalation(Z),T.success("Escalation resolved"),D()}catch{T.error("Failed to resolve")}}return g?e.jsxs("div",{style:{padding:40,textAlign:"center",color:"#999"},children:[e.jsx("i",{className:"fas fa-spinner fa-spin",style:{fontSize:22}}),e.jsx("p",{style:{marginTop:10,fontSize:13},children:"Loading follow-up data..."})]}):e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:16},children:[m&&e.jsxs("div",{style:{background:"#f0f7ff",border:"1px solid #bbdefb",borderRadius:8,padding:"12px 16px"},children:[e.jsxs("div",{style:{fontSize:11,fontWeight:700,color:"#1565c0",textTransform:"uppercase",letterSpacing:1,marginBottom:6},children:[e.jsx("i",{className:"fas fa-clock",style:{marginRight:6}})," Expected Timeline"]}),e.jsx("div",{style:{fontSize:13,color:"#1a237e",marginBottom:4},children:m.student_text}),e.jsxs("div",{style:{fontSize:11,color:"#546e7a",background:"#fff3e0",border:"1px solid #ffe0b2",borderRadius:4,padding:"4px 8px",marginTop:6,display:"inline-block"},children:[e.jsx("i",{className:"fas fa-user-shield",style:{marginRight:4,color:"#e65100"}}),e.jsx("strong",{children:"Staff:"})," ",m.staff_text]})]}),P&&e.jsxs("div",{style:{background:"#fff3e0",border:"2px solid #d32f2f",borderRadius:8,padding:"12px 16px",display:"flex",alignItems:"flex-start",justifyContent:"space-between",gap:12},children:[e.jsxs("div",{children:[e.jsxs("div",{style:{fontSize:12,fontWeight:700,color:"#d32f2f",marginBottom:4},children:[e.jsx("i",{className:"fas fa-exclamation-triangle",style:{marginRight:6}}),"ESCALATION LEVEL ",P.level,"  ",P.reason]}),e.jsxs("div",{style:{fontSize:12,color:"#546e7a"},children:["Raised ",Ha(P.created_at)]})]}),e.jsxs("button",{className:"btn btn-sm btn-outline",style:{color:"#2e7d32",borderColor:"#2e7d32",whiteSpace:"nowrap"},onClick:()=>F(P.id),children:[e.jsx("i",{className:"fas fa-check"})," Resolve"]})]}),e.jsxs("div",{style:{border:"1px solid var(--border-color)",borderRadius:8,overflow:"hidden"},children:[e.jsxs("div",{style:{background:"#f5f5f5",padding:"10px 16px",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs("span",{style:{fontWeight:600,fontSize:13},children:[e.jsx("i",{className:"fas fa-bolt",style:{marginRight:6,color:"#f57c00"}})," Next Action"]}),I&&e.jsx("div",{style:{display:"flex",gap:6},children:e.jsxs("button",{className:"btn btn-sm btn-outline",style:{fontSize:11},onClick:()=>A(I.id),children:[e.jsx("i",{className:"fas fa-check"})," Mark Done"]})})]}),e.jsx("div",{style:{padding:"12px 16px"},children:I?e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:8},children:[e.jsx("span",{style:{fontSize:11,fontWeight:700,color:"#fff",background:Gu[I.owner_type]||"#546e7a",borderRadius:4,padding:"2px 8px"},children:I.owner_type}),e.jsx("span",{style:{fontSize:11,fontWeight:700,color:qu[I.priority],background:"#fafafa",border:`1px solid ${qu[I.priority]}`,borderRadius:4,padding:"2px 8px"},children:I.priority})]}),e.jsx("div",{style:{fontSize:14,fontWeight:600,color:"#212121",marginBottom:4},children:I.title}),I.description&&e.jsx("div",{style:{fontSize:12,color:"#546e7a",marginBottom:6},children:I.description}),I.due_at&&(()=>{const Z=am(I.due_at),ce=Z!==null&&Z<0;return e.jsxs("div",{style:{fontSize:12,color:ce?"#d32f2f":"#546e7a"},children:[e.jsx("i",{className:"fas fa-calendar-alt",style:{marginRight:4}}),"Due: ",Ha(I.due_at),Z!==null&&e.jsxs("span",{style:{marginLeft:6,fontWeight:600},children:["(",ce?`${Math.abs(Z)}d overdue`:Z===0?"Today":`${Z}d left`,")"]})]})})()]}):e.jsxs("div",{style:{color:"#999",fontSize:13},children:[e.jsx("i",{className:"fas fa-check-circle",style:{marginRight:6,color:"#2e7d32"}}),"No open actions  case is on track"]})})]}),e.jsxs("div",{style:{border:"1px solid var(--border-color)",borderRadius:8,overflow:"hidden"},children:[e.jsxs("div",{style:{background:"#f5f5f5",padding:"10px 16px",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs("span",{style:{fontWeight:600,fontSize:13},children:[e.jsx("i",{className:"fas fa-bell",style:{marginRight:6,color:"#1565c0"}})," Reminders"]}),e.jsxs("div",{style:{display:"flex",gap:8},children:[e.jsxs("button",{className:"btn btn-sm btn-primary",onClick:N,disabled:y,style:{fontSize:11},children:[e.jsx("i",{className:`fas ${y?"fa-spinner fa-spin":"fa-paper-plane"}`}),y?"Sending...":"Send Reminder"]}),e.jsxs("button",{className:"btn btn-sm btn-outline",style:{fontSize:11,color:"#d32f2f",borderColor:"#d32f2f"},onClick:W,disabled:k,children:[e.jsx("i",{className:`fas ${k?"fa-spinner fa-spin":"fa-exclamation-triangle"}`}),k?"...":`Escalate${P?` (L${P.level})`:""}`]})]})]}),e.jsx("div",{style:{padding:"12px 16px"},children:w?e.jsxs("div",{children:[e.jsxs("div",{style:{fontSize:12,color:"#546e7a",marginBottom:8},children:[e.jsx("strong",{children:"Last reminder:"})," ",Ha(w.created_at)," via ",w.channel,e.jsxs("span",{style:{marginLeft:8,color:w.status==="SENT"?"#2e7d32":w.status==="FAILED"?"#d32f2f":"#546e7a"},children:[e.jsx("i",{className:`fas ${Ju[w.status]||"fa-clock"}`,style:{marginRight:3}}),w.status]})]}),d.length>0&&e.jsx("div",{style:{maxHeight:140,overflowY:"auto",display:"flex",flexDirection:"column",gap:4},children:d.slice(0,5).map(Z=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,fontSize:11,padding:"4px 8px",background:"#fafafa",borderRadius:4,border:"1px solid var(--border-color)"},children:[e.jsx("span",{style:{color:Gu[Z.to_type]||"#546e7a",fontWeight:600,minWidth:56},children:Z.to_type}),e.jsxs("span",{style:{color:"#546e7a",flex:1},children:[Z.channel,"  ",Z.template_name]}),e.jsxs("span",{style:{color:Z.status==="SENT"?"#2e7d32":Z.status==="FAILED"?"#d32f2f":"#546e7a"},children:[e.jsx("i",{className:`fas ${Ju[Z.status]||"fa-clock"}`,style:{marginRight:3}}),Z.status]}),e.jsx("span",{style:{color:"#999",fontSize:10},children:Ha(Z.created_at)})]},Z.id))})]}):e.jsx("div",{style:{color:"#999",fontSize:13},children:'No reminders sent yet  click "Send Reminder" to notify the responsible party.'})})]}),p.length>0&&e.jsxs("div",{style:{border:"1px solid var(--border-color)",borderRadius:8,overflow:"hidden"},children:[e.jsx("div",{style:{background:"#f5f5f5",padding:"10px 16px"},children:e.jsxs("span",{style:{fontWeight:600,fontSize:13},children:[e.jsx("i",{className:"fas fa-layer-group",style:{marginRight:6,color:"#d32f2f"}})," Escalation History"]})}),e.jsx("div",{style:{padding:"8px 16px",display:"flex",flexDirection:"column",gap:6},children:p.map(Z=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,fontSize:12,padding:"6px 8px",background:Z.resolved_at?"#f1f8e9":"#fff3e0",borderRadius:4,border:`1px solid ${Z.resolved_at?"#c5e1a5":"#ffcc02"}`},children:[e.jsxs("span",{style:{fontWeight:700,color:"#d32f2f",minWidth:20},children:["L",Z.level]}),e.jsx("span",{style:{color:"#546e7a",flex:1},children:Z.reason}),e.jsx("span",{style:{color:"#999",fontSize:10},children:Ha(Z.created_at)}),Z.resolved_at?e.jsxs("span",{style:{color:"#2e7d32",fontWeight:600},children:[e.jsx("i",{className:"fas fa-check-circle"})," Resolved"]}):e.jsx("button",{className:"btn btn-sm btn-outline",style:{fontSize:10,color:"#2e7d32",borderColor:"#2e7d32",padding:"2px 6px"},onClick:()=>F(Z.id),children:"Resolve"})]},Z.id))})]})]})}function Ho(s,i=[]){const r=f=>f||"",o=f=>f?`${Number(f).toLocaleString("en-IN")}`:"",d=f=>f?new Date(f).toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric"}):"";return`<!DOCTYPE html>
<html><head><title>Application Pack  ${s.id}</title>
<style>
  body { font-family: Arial, sans-serif; max-width: 900px; margin: 0 auto; padding: 32px; font-size: 13px; color: #212121; }
  .hdr { display: flex; justify-content: space-between; align-items: flex-start; border-bottom: 3px solid #1a237e; padding-bottom: 16px; margin-bottom: 24px; }
  .logo { font-size: 22px; font-weight: 900; color: #1a237e; }
  .hdr-right { text-align: right; font-size: 12px; color: #666; }
  h2 { color: #1565c0; font-size: 15px; margin: 20px 0 8px; border-bottom: 1px solid #e0e0e0; padding-bottom: 4px; }
  .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 0; }
  .field { padding: 7px 12px 7px 0; border-bottom: 1px solid #f5f5f5; }
  .lbl { font-size: 10px; color: #888; text-transform: uppercase; letter-spacing: 0.4px; }
  .val { font-weight: 600; color: #1a1a1a; margin-top: 2px; }
  table { width: 100%; border-collapse: collapse; margin: 10px 0; font-size: 12px; }
  th { background: #e8eaf6; padding: 7px 10px; text-align: left; font-size: 11px; color: #1a237e; }
  td { padding: 7px 10px; border-bottom: 1px solid #f0f0f0; }
  .badge { display: inline-block; padding: 2px 8px; border-radius: 10px; font-size: 11px; background: #e3f2fd; color: #1565c0; }
  .footer { margin-top: 32px; border-top: 1px solid #e0e0e0; padding-top: 8px; font-size: 10px; color: #aaa; text-align: center; }
  @media print { body { padding: 0; } }
</style></head>
<body>
<div class="hdr">
  <div><div class="logo">NEXTHARA</div><div style="font-size:12px;color:#666;margin-top:4px">Education Loan Management Platform</div></div>
  <div class="hdr-right">
    <div class="badge">${s.id}</div>
    <div style="margin-top:6px">Generated: ${new Date().toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"})}</div>
    <div>Status: <strong>${(s.status||"").replace(/_/g," ")}</strong></div>
  </div>
</div>
<h1 style="margin:0 0 4px;font-size:18px;color:#1a237e">${r(s.student_name)}</h1>
<div style="font-size:12px;color:#555;margin-bottom:20px">${r(s.student_email)} &nbsp;&nbsp; ${r(s.student_phone)} &nbsp;&nbsp; ${r(s.bank)}</div>

<h2>Student &amp; Academic Details</h2>
<div class="grid">
  <div class="field"><div class="lbl">University</div><div class="val">${r(s.university)}</div></div>
  <div class="field"><div class="lbl">Course</div><div class="val">${r(s.course)}</div></div>
  <div class="field"><div class="lbl">Country</div><div class="val">${r(s.country)}</div></div>
  <div class="field"><div class="lbl">Intake</div><div class="val">${r(s.intake)}</div></div>
  <div class="field"><div class="lbl">Collateral</div><div class="val">${r(s.collateral)}</div></div>
  <div class="field"><div class="lbl">Loan Type</div><div class="val">${r(s.loan_type)}</div></div>
</div>

<h2>Loan Details</h2>
<div class="grid">
  <div class="field"><div class="lbl">Lender / Bank</div><div class="val">${r(s.bank)}</div></div>
  <div class="field"><div class="lbl">Bank App Ref</div><div class="val">${r(s.bank_application_ref)}</div></div>
  <div class="field"><div class="lbl">Loan Requested</div><div class="val">${o(s.loan_amount_requested)}</div></div>
  ${s.sanction_amount?`
  <div class="field"><div class="lbl">Sanction Amount</div><div class="val">${o(s.sanction_amount)}</div></div>
  <div class="field"><div class="lbl">ROI</div><div class="val">${s.roi?s.roi+"%":""}</div></div>
  <div class="field"><div class="lbl">Tenure</div><div class="val">${s.tenure?s.tenure+" months":""}</div></div>
  <div class="field"><div class="lbl">Processing Fee</div><div class="val">${s.processing_fee?s.processing_fee+"%":""}</div></div>
  <div class="field"><div class="lbl">Margin</div><div class="val">${s.margin_percent?s.margin_percent+"%":""}</div></div>
  `:'<div class="field"><div class="lbl">Sanction</div><div class="val">Not yet sanctioned</div></div>'}
</div>

<h2>Current Status</h2>
<div class="grid">
  <div class="field"><div class="lbl">Status</div><div class="val">${(s.status||"").replace(/_/g," ")}</div></div>
  <div class="field"><div class="lbl">Awaiting From</div><div class="val">${r(s.awaiting_from)}</div></div>
  <div class="field"><div class="lbl">Priority</div><div class="val">${r(s.priority)}</div></div>
  <div class="field"><div class="lbl">SLA Days Open</div><div class="val">${s.sla_days!=null?s.sla_days+" days":""}</div></div>
  <div class="field"><div class="lbl">Case Created</div><div class="val">${d(s.created_at)}</div></div>
  <div class="field"><div class="lbl">Last Updated</div><div class="val">${d(s.updated_at)}</div></div>
</div>

${i.length>0?`
<h2>Documents (${i.length} total)</h2>
<table>
<thead><tr><th>Document</th><th>Category</th><th>Status</th><th>Owner</th><th>Uploaded</th></tr></thead>
<tbody>
${i.map(f=>`<tr><td>${f.doc_name}${f.label?` (${f.label})`:""}</td><td>${f.doc_category}</td><td>${f.status}</td><td>${f.owner||""}</td><td>${d(f.uploaded_at)}</td></tr>`).join("")}
</tbody></table>`:""}

${s.history&&s.history.length>0?`
<h2>Status History (last ${Math.min(s.history.length,10)})</h2>
<table>
<thead><tr><th>Date</th><th>Status</th><th>Awaiting</th><th>By</th><th>Notes</th></tr></thead>
<tbody>
${s.history.slice(0,10).map(f=>`<tr><td>${d(f.created_at)}</td><td>${(f.status||"").replace(/_/g," ")}</td><td>${f.awaiting_from||""}</td><td>${f.changed_by||""}</td><td style="max-width:200px;word-break:break-word">${(f.notes||"").substring(0,100)}</td></tr>`).join("")}
</tbody></table>`:""}

<div class="footer">Generated by Nexthara Dashboard  ${new Date().toLocaleDateString("en-IN",{day:"numeric",month:"long",year:"numeric"})}  Confidential  for internal use only</div>
</body></html>`}const Qo={SBI:"PSU",PNB:"PSU","Bank of Baroda":"PSU","Canara Bank":"PSU","Union Bank":"PSU",HDFC:"Private",ICICI:"Private","Axis Bank":"Private","IDFC First":"Private",Kotak:"Private","Prodigy Finance":"Intl",MPOWER:"Intl",Credila:"NBFC",Avanse:"NBFC",InCred:"NBFC"},ti={PSU:{bg:"#eff6ff",color:"#1d4ed8",label:"PSU"},NBFC:{bg:"#faf5ff",color:"#7c3aed",label:"NBFC"},Intl:{bg:"#f0fdf4",color:"#15803d",label:"Intl"},Private:{bg:"#f9fafb",color:"#4b5563",label:"Pvt"}},im={"Pre-Login":["NOT_CONNECTED","CONTACTED","YET_TO_CONNECT"],Login:["LOGIN_SUBMITTED","LOGIN_IN_PROGRESS","LOGIN_REJECTED","DUPLICATE_LOGIN"],Documents:["DOCS_PENDING","DOCS_SUBMITTED","DOCS_VERIFICATION"],Credit:["UNDER_REVIEW","CREDIT_CHECK_IN_PROGRESS","FIELD_VERIFICATION","QUERY_RAISED"],Decision:["CONDITIONAL_SANCTION","SANCTIONED","REJECTED"],Post:["SANCTION_ACCEPTED","AGREEMENT_SIGNED","DISBURSEMENT_PENDING","DISBURSED"],Closed:["CLOSED","DROPPED","EXPIRED"]},lm=[{key:"overview",label:"Overview",icon:"fa-th-large"},{key:"lenders",label:"Lenders",icon:"fa-university"},{key:"documents",label:"Documents",icon:"fa-folder-open"},{key:"queries",label:"Queries",icon:"fa-question-circle"},{key:"pack-history",label:"Pack History",icon:"fa-box"},{key:"timeline",label:"Timeline",icon:"fa-history"},{key:"tasks",label:"Tasks / Notes",icon:"fa-tasks"},{key:"followup",label:"Follow-up",icon:"fa-bell"},{key:"close",label:"Close / Outcome",icon:"fa-flag-checkered"}];function Kf(s){if(!s||s.sla_days==null||s.awaiting_from!=="Bank")return"ok";const i=Qf[s.status];if(!i)return"ok";const r=s.sla_days/i;return r>=1?"breach":r>=.7?"warning":"ok"}function Yf({appId:s,onClose:i,onUpdated:r}){const[o,d]=u.useState(null),[f,p]=u.useState(!0),[x,m]=u.useState("overview"),v=u.useCallback(()=>{s&&(p(!0),Ae.getApplication(s).then(j=>{d(j),p(!1)}).catch(()=>p(!1)))},[s]);u.useEffect(()=>{v()},[v]);const g=u.useCallback(()=>{v(),r==null||r()},[v,r]),b=u.useCallback(async(j="Print",k="")=>{if(!o)return;let _=[];try{_=await bt.getDocuments(o.id)}catch{}const C=Ho(o,_),L=window.open("","_blank","width=960,height=800");if(!L){T.error("Allow popups to generate pack");return}L.document.write(C),L.document.close(),L.focus(),setTimeout(()=>L.print(),400);try{await ei.createPack(o.id,{sent_via:j,sent_to:k}),g()}catch{}T.success("Pack generated!",{icon:""})},[o,g]),y=u.useCallback(()=>{var L;if(!o)return;const j=(o.student_phone||"").replace(/\D/g,"");if(!j){T.error("No phone number on file for this student");return}const k=((L=o.status)==null?void 0:L.replace(/_/g," "))||"Under Review",_=encodeURIComponent(`Hi ${o.student_name}, this is an update on your education loan application with ${o.bank}.

Current status: ${k}
Awaiting: ${o.awaiting_from||""}

Please reach out if you have any questions.  Nexthara Team`),C=j.startsWith("91")?"":"91";window.open(`https://wa.me/${C}${j}?text=${_}`,"_blank")},[o]);return u.useEffect(()=>{const j=k=>{if(!(k.target.tagName==="INPUT"||k.target.tagName==="TEXTAREA"||k.target.tagName==="SELECT")){if(k.key==="Escape"){i();return}(k.key==="a"||k.key==="A")&&(m("lenders"),T(" A  Lenders tab",{duration:1200})),(k.key==="d"||k.key==="D")&&(m("documents"),T(" D  Documents tab",{duration:1200})),(k.key==="p"||k.key==="P")&&b(),(k.key==="q"||k.key==="Q")&&(m("queries"),T(" Q  Queries tab",{duration:1200}))}};return window.addEventListener("keydown",j),()=>window.removeEventListener("keydown",j)},[i,b]),s?e.jsx("div",{className:"cw-overlay",onClick:j=>j.target===j.currentTarget&&i(),children:e.jsxs("div",{className:"cw-workspace",children:[e.jsx(rm,{app:o,loading:f,onClose:i,onTabChange:m,onGeneratePack:b,onWhatsApp:y}),e.jsx("div",{className:"cw-tabbar",children:lm.map(j=>e.jsxs("button",{className:`cw-tab ${x===j.key?"active":""}`,onClick:()=>m(j.key),children:[e.jsx("i",{className:`fas ${j.icon}`}),e.jsx("span",{children:j.label})]},j.key))}),e.jsxs("div",{className:"cw-hotkey-bar",children:[e.jsxs("span",{className:"cw-hotkey",children:[e.jsx("kbd",{children:"A"})," Lenders"]}),e.jsxs("span",{className:"cw-hotkey",children:[e.jsx("kbd",{children:"D"})," Docs"]}),e.jsxs("span",{className:"cw-hotkey",children:[e.jsx("kbd",{children:"Q"})," Queries"]}),e.jsxs("span",{className:"cw-hotkey",children:[e.jsx("kbd",{children:"P"})," Pack"]}),e.jsxs("span",{className:"cw-hotkey",children:[e.jsx("kbd",{children:"Esc"})," Close"]})]}),e.jsx("div",{className:"cw-body",children:f?e.jsxs("div",{className:"cw-loading",children:[e.jsx("i",{className:"fas fa-spinner fa-spin"}),e.jsx("p",{children:"Loading case workspace"})]}):o?e.jsxs(e.Fragment,{children:[x==="overview"&&e.jsx(om,{app:o,onTabChange:m,onUpdated:g}),x==="lenders"&&e.jsx(dm,{app:o,onUpdated:g}),x==="documents"&&e.jsx(bm,{app:o,onUpdated:g,onTabChange:m}),x==="queries"&&e.jsx(jm,{app:o,onTabChange:m,onUpdated:g}),x==="pack-history"&&e.jsx(Sm,{app:o,onGeneratePack:b}),x==="timeline"&&e.jsx(km,{app:o}),x==="tasks"&&e.jsx(Nm,{app:o}),x==="followup"&&e.jsx("div",{style:{padding:"16px 0"},children:e.jsx(Jf,{appId:o.id,app:o})}),x==="close"&&e.jsx(Cm,{app:o,onClose:i,onUpdated:g})]}):e.jsx("div",{className:"cw-loading",children:e.jsx("p",{children:"Application not found"})})})]})}):null}function rm({app:s,loading:i,onClose:r,onTabChange:o,onGeneratePack:d,onWhatsApp:f}){var j,k;const[p,x]=u.useState(!1),m=u.useRef(null),v=(_,C)=>{_&&navigator.clipboard.writeText(_).then(()=>T.success(`${C} copied`))};u.useEffect(()=>{const _=C=>{m.current&&!m.current.contains(C.target)&&x(!1)};return document.addEventListener("mousedown",_),()=>document.removeEventListener("mousedown",_)},[]);const g=s&&((j=Rt[s.status])==null?void 0:j.color)||"grey",b=s&&((k=Rt[s.status])==null?void 0:k.stageLabel)||"",y=(s==null?void 0:s.collateral)&&s.collateral!=="NA"&&s.collateral!=="na";return e.jsxs("div",{className:"cw-header",children:[e.jsxs("div",{className:"cw-header-left",children:[e.jsx("div",{className:"cw-student-name",children:i?"":(s==null?void 0:s.student_name)||""}),e.jsxs("div",{className:"cw-header-meta",children:[(s==null?void 0:s.student_email)&&e.jsxs("span",{className:"cw-meta-chip",onClick:()=>v(s.student_email,"Email"),title:"Copy email",children:[e.jsx("i",{className:"fas fa-envelope"})," ",s.student_email]}),(s==null?void 0:s.student_phone)&&e.jsxs("span",{className:"cw-meta-chip",onClick:()=>v(s.student_phone,"Phone"),title:"Copy phone",children:[e.jsx("i",{className:"fas fa-phone"})," ",s.student_phone]}),(s==null?void 0:s.id)&&e.jsxs("span",{className:"cw-meta-chip",onClick:()=>v(s.id,"Case Ref"),title:"Copy Case Ref",children:[e.jsx("i",{className:"fas fa-hashtag"})," ",s.id]}),(s==null?void 0:s.bank_application_ref)&&e.jsxs("span",{className:"cw-meta-chip",onClick:()=>v(s.bank_application_ref,"Bank Ref"),title:"Copy Bank Ref",children:[e.jsx("i",{className:"fas fa-id-badge"})," ",s.bank_application_ref]})]})]}),e.jsxs("div",{className:"cw-header-chips",children:[(s==null?void 0:s.university)&&e.jsx("span",{className:"cw-chip",children:s.university}),(s==null?void 0:s.course)&&e.jsx("span",{className:"cw-chip",children:s.course}),(s==null?void 0:s.country)&&e.jsxs("span",{className:"cw-chip cw-chip-blue",children:[e.jsx("i",{className:"fas fa-globe",style:{fontSize:10}})," ",s.country]}),(s==null?void 0:s.intake)&&e.jsxs("span",{className:"cw-chip",children:[e.jsx("i",{className:"fas fa-calendar-alt",style:{fontSize:10}})," ",s.intake]}),y&&e.jsxs("span",{className:"cw-chip cw-chip-amber",children:[e.jsx("i",{className:"fas fa-home",style:{fontSize:10}})," ",s.collateral]}),(s==null?void 0:s.loan_amount_requested)&&e.jsxs("span",{className:"cw-chip",children:[e.jsx("i",{className:"fas fa-rupee-sign",style:{fontSize:10}})," Req: ",ct(s.loan_amount_requested)]}),(s==null?void 0:s.sanction_amount)&&e.jsxs("span",{className:"cw-chip cw-chip-green",children:[e.jsx("i",{className:"fas fa-check-circle",style:{fontSize:10}})," ",ct(s.sanction_amount)]}),e.jsx("span",{className:`cw-chip cw-chip-stage cw-chip-${g}`,children:b})]}),e.jsxs("div",{className:"cw-header-actions",children:[e.jsxs("button",{className:"btn btn-outline btn-sm",onClick:()=>o("lenders"),title:"Hotkey: A",children:[e.jsx("i",{className:"fas fa-plus"})," Add Lender"]}),e.jsxs("button",{className:"btn btn-outline btn-sm",onClick:()=>o("documents"),title:"Hotkey: D",children:[e.jsx("i",{className:"fas fa-file-alt"})," Request Docs"]}),e.jsxs("button",{className:"btn btn-outline btn-sm",onClick:()=>d==null?void 0:d(),title:"Hotkey: P  Generates a printable document pack",children:[e.jsx("i",{className:"fas fa-box"})," Generate Pack"]}),e.jsxs("button",{className:"btn btn-outline btn-sm",onClick:f,title:"Send WhatsApp status update to student",children:[e.jsx("i",{className:"fab fa-whatsapp"})," WA Update"]}),e.jsxs("div",{className:"cw-3dot-wrapper",ref:m,children:[e.jsx("button",{className:"cw-3dot-btn",onClick:()=>x(_=>!_),title:"More actions",children:e.jsx("i",{className:"fas fa-ellipsis-v"})}),p&&e.jsxs("div",{className:"cw-3dot-menu",children:[e.jsxs("button",{className:"cw-3dot-item",onClick:()=>{x(!1),d==null||d("Email")},children:[e.jsx("i",{className:"fas fa-file-pdf"})," Export PDF"]}),e.jsxs("button",{className:"cw-3dot-item",onClick:()=>{x(!1),o("close")},children:[e.jsx("i",{className:"fas fa-times-circle"})," Close Case"]}),e.jsxs("button",{className:"cw-3dot-item",onClick:()=>{x(!1),o("timeline")},children:[e.jsx("i",{className:"fas fa-history"})," View Audit Log"]}),e.jsxs("button",{className:"cw-3dot-item",onClick:()=>{x(!1),d==null||d("Print")},children:[e.jsx("i",{className:"fas fa-print"})," Print"]})]})]}),e.jsx("button",{className:"cw-close-btn",onClick:r,title:"Close workspace (Esc)",children:e.jsx("i",{className:"fas fa-times"})})]})]})}const Ku=["Germany","UK","USA","Canada","Australia","Collateral","HighValue","Urgent","VisaDeadline","VIPStudent"],Yu={Germany:{bg:"#eff6ff",color:"#1d4ed8"},UK:{bg:"#faf5ff",color:"#7c3aed"},USA:{bg:"#fff7ed",color:"#c2410c"},Canada:{bg:"#f0fdf4",color:"#15803d"},Australia:{bg:"#fef9c3",color:"#92400e"},Collateral:{bg:"#f0fdf4",color:"#15803d"},HighValue:{bg:"#fef9c3",color:"#92400e"},Urgent:{bg:"#fef2f2",color:"#b91c1c"},VisaDeadline:{bg:"#fff7ed",color:"#b45309"},VIPStudent:{bg:"#fdf4ff",color:"#7e22ce"}};function om({app:s,onTabChange:i,onUpdated:r}){const o=Kf(s),d=!["CLOSED","DROPPED","EXPIRED"].includes(s.status),f=["SANCTIONED","CONDITIONAL_SANCTION","SANCTION_ACCEPTED","AGREEMENT_SIGNED","DISBURSEMENT_PENDING","DISBURSED"].includes(s.status),p=s.collateral&&s.collateral!=="NA"&&s.collateral!=="na",[x,m]=u.useState(()=>{try{return JSON.parse(s.tags||"[]")}catch{return[]}}),[v,g]=u.useState(!1),[b,y]=u.useState(!1),[j,k]=u.useState([]),[_,C]=u.useState(!1);u.useEffect(()=>{Xa.getUsers().then(k).catch(()=>{})},[]);const L=async F=>{const Z=x.includes(F)?x.filter(ce=>ce!==F):[...x,F];m(Z);try{await Ae.updateApplication(s.id,{tags:Z})}catch{}},D=async F=>{C(!0);try{await Ae.updateApplication(s.id,{assigned_to:F,notes:`Case assigned to ${F}`}),T.success(`Assigned to ${F}`),y(!1),r==null||r()}catch(Z){T.error(Z.message||"Assignment failed")}C(!1)},[I,P]=u.useState([]);u.useEffect(()=>{bt.getDocuments(s.id).then(F=>P(F||[])).catch(()=>{})},[s.id]);const w=Object.values(qn).flat().length,A=I.filter(F=>["Received","Verified"].includes(F.status)).length,N=w>0?Math.round(A/w*100):0,W=[];return s.status==="DOCS_PENDING"&&W.push({icon:"fa-file-alt",text:"Request docs from student",color:"amber",tab:"documents"}),o==="breach"&&W.push({icon:"fa-exclamation-triangle",text:"Escalate lender  SLA breached",color:"red",tab:"lenders"}),f&&!["DISBURSED"].includes(s.status)&&W.push({icon:"fa-check-double",text:"Sanction received  compare & proceed",color:"green",tab:"close"}),s.status==="QUERY_RAISED"&&W.push({icon:"fa-question-circle",text:"Open query pending  resolve or remind",color:"amber",tab:"queries"}),o==="warning"&&W.push({icon:"fa-clock",text:"SLA at risk  follow up with bank",color:"amber",tab:"lenders"}),s.status==="NOT_CONNECTED"&&W.push({icon:"fa-phone",text:"Student not yet contacted  reach out",color:"grey",tab:null}),W.length===0&&W.push({icon:"fa-thumbs-up",text:"No pending actions  all clear",color:"grey",tab:null}),e.jsxs("div",{className:"cw-tab-content",children:[e.jsxs("div",{className:"cw-student-profile-row",children:[s.country&&e.jsxs("div",{className:"cw-profile-chip",children:[e.jsx("i",{className:"fas fa-globe"}),e.jsxs("span",{children:[e.jsx("b",{children:"Country:"})," ",s.country]})]}),s.intake&&e.jsxs("div",{className:"cw-profile-chip",children:[e.jsx("i",{className:"fas fa-calendar-alt"}),e.jsxs("span",{children:[e.jsx("b",{children:"Intake:"})," ",s.intake]})]}),s.loan_amount_requested&&e.jsxs("div",{className:"cw-profile-chip",children:[e.jsx("i",{className:"fas fa-rupee-sign"}),e.jsxs("span",{children:[e.jsx("b",{children:"Requested:"})," ",ct(s.loan_amount_requested)]})]}),p&&e.jsxs("div",{className:"cw-profile-chip cw-profile-chip-amber",children:[e.jsx("i",{className:"fas fa-home"}),e.jsxs("span",{children:[e.jsx("b",{children:"Collateral:"})," ",s.collateral]})]}),!p&&e.jsxs("div",{className:"cw-profile-chip cw-profile-chip-grey",children:[e.jsx("i",{className:"fas fa-ban"}),e.jsx("span",{children:"No Collateral"})]}),s.loan_type&&s.loan_type!=="NA"&&e.jsxs("div",{className:"cw-profile-chip",children:[e.jsx("i",{className:"fas fa-file-contract"}),e.jsxs("span",{children:[e.jsx("b",{children:"Loan Type:"})," ",s.loan_type]})]}),e.jsxs("div",{className:"cw-profile-chip",children:[e.jsx("i",{className:"fas fa-calendar-check"}),e.jsxs("span",{children:[e.jsx("b",{children:"Created:"})," ",dt(s.created_at)]})]})]}),e.jsxs("div",{className:"cw-overview-widgets",children:[e.jsxs("div",{className:"cw-widget",style:{cursor:"pointer"},onClick:()=>i("documents"),children:[e.jsx("div",{className:"cw-widget-label",children:"Docs Completion"}),e.jsxs("div",{className:`cw-widget-value cw-widget-${N>=80?"green":N>=50?"amber":"red"}`,children:[N,"%"]}),e.jsxs("div",{className:"cw-widget-sub",children:[A,"/",w," docs received"]}),e.jsx("div",{style:{marginTop:6,height:4,background:"#e5e7eb",borderRadius:2,overflow:"hidden"},children:e.jsx("div",{style:{width:`${N}%`,height:"100%",background:N>=80?"#16a34a":N>=50?"#f59e0b":"#dc2626",borderRadius:2,transition:"width 0.3s"}})})]}),e.jsxs("div",{className:"cw-widget",children:[e.jsx("div",{className:"cw-widget-label",children:"Active Lenders"}),e.jsx("div",{className:"cw-widget-value",children:d?1:0}),e.jsx("div",{className:"cw-widget-sub",children:"Lender applications"})]}),e.jsxs("div",{className:"cw-widget",style:{cursor:"pointer"},onClick:()=>i("queries"),children:[e.jsx("div",{className:"cw-widget-label",children:"Open Queries"}),e.jsx("div",{className:`cw-widget-value cw-widget-${s.status==="QUERY_RAISED"?"amber":"grey"}`,children:s.status==="QUERY_RAISED"?1:0}),e.jsx("div",{className:"cw-widget-sub",children:"Pending resolution"})]}),e.jsxs("div",{className:"cw-widget",style:{cursor:"pointer"},onClick:()=>i("lenders"),children:[e.jsx("div",{className:"cw-widget-label",children:"SLA Risk"}),e.jsx("div",{className:`cw-widget-value cw-widget-${o==="breach"?"red":o==="warning"?"amber":"green"}`,children:o==="breach"?"Breach":o==="warning"?"Risk":"OK"}),e.jsx("div",{className:"cw-widget-sub",children:s.sla_days!=null?`${s.sla_days}d open`:""})]}),e.jsxs("div",{className:"cw-widget",style:{cursor:"pointer"},onClick:()=>i("close"),children:[e.jsx("div",{className:"cw-widget-label",children:"Best Offer"}),e.jsx("div",{className:"cw-widget-value cw-widget-green",children:s.sanction_amount?ct(s.sanction_amount):""}),e.jsx("div",{className:"cw-widget-sub",children:s.roi?`${s.roi}% ROI`:"No sanction yet"})]})]}),e.jsxs("div",{className:"cw-overview-bottom",children:[e.jsxs("div",{className:"cw-panel",children:[e.jsxs("div",{className:"cw-panel-title",children:[e.jsx("i",{className:"fas fa-lightbulb"})," Next Best Actions"]}),e.jsx("div",{className:"cw-actions-list",children:W.map((F,Z)=>e.jsxs("div",{className:`cw-action-item cw-action-${F.color}`,children:[e.jsx("i",{className:`fas ${F.icon}`}),e.jsx("span",{children:F.text}),F.tab&&e.jsx("button",{className:"btn btn-sm btn-outline cw-action-btn",onClick:()=>i(F.tab),children:"Go "})]},Z))})]}),e.jsxs("div",{className:"cw-panel",children:[e.jsxs("div",{className:"cw-panel-title",children:[e.jsx("i",{className:"fas fa-user-tie"})," Owner & Priority"]}),e.jsxs("div",{className:"cw-owner-grid",children:[e.jsxs("div",{children:[e.jsx("label",{children:"Case Owner"}),e.jsxs("div",{className:"cw-owner-val",children:[e.jsx("i",{className:"fas fa-user-circle"})," ",s.assigned_to||"Unassigned"]})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Priority"}),e.jsxs("div",{className:"cw-owner-val",children:[e.jsx(qf,{priority:s.priority})," ",s.priority||"Normal"]})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Bank / Lender"}),e.jsx("div",{className:"cw-owner-val",children:e.jsx(ii,{bank:s.bank})})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Confidence Score"}),e.jsx("div",{className:"cw-owner-val",children:s.confidence_score?`${s.confidence_score}%`:""})]})]}),e.jsxs("div",{style:{marginBottom:10},children:[e.jsx("label",{style:{display:"block",fontSize:11,textTransform:"uppercase",letterSpacing:"0.5px",color:"#9ca3af",marginBottom:6},children:"Tags"}),e.jsxs("div",{className:"cw-tag-row",style:{marginBottom:6},children:[x.map(F=>{const Z=Yu[F]||{bg:"#f3f4f6",color:"#374151"};return e.jsxs("span",{className:"cw-tag",style:{background:Z.bg,color:Z.color,cursor:"pointer"},onClick:()=>L(F),title:"Click to remove",children:[F," ",e.jsx("i",{className:"fas fa-times",style:{fontSize:9,marginLeft:3}})]},F)}),e.jsxs("div",{style:{position:"relative",display:"inline-block"},children:[e.jsxs("button",{className:"cw-tag",style:{background:"#f3f4f6",color:"#374151",border:"1px dashed #d1d5db",cursor:"pointer"},onClick:()=>g(F=>!F),children:[e.jsx("i",{className:"fas fa-plus",style:{fontSize:9}})," Tag"]}),v&&e.jsxs("div",{className:"cw-3dot-menu",style:{top:28,left:0,minWidth:140},children:[Ku.filter(F=>!x.includes(F)).map(F=>{const Z=Yu[F]||{color:"#374151"};return e.jsx("button",{className:"cw-3dot-item",style:{color:Z.color},onClick:()=>{L(F),g(!1)},children:F},F)}),Ku.filter(F=>!x.includes(F)).length===0&&e.jsx("div",{style:{padding:"8px 16px",fontSize:12,color:"#9ca3af"},children:"All tags applied"})]})]})]})]}),e.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",position:"relative"},children:[e.jsxs("button",{className:"btn btn-outline btn-sm",onClick:()=>y(F=>!F),children:[e.jsx("i",{className:"fas fa-user-edit"})," Assign Owner"]}),b&&e.jsxs("div",{className:"cw-3dot-menu",style:{top:36,left:0,minWidth:200,zIndex:300},children:[e.jsx("div",{style:{padding:"8px 12px",fontSize:11,color:"#9ca3af",borderBottom:"1px solid #f3f4f6"},children:"Select team member"}),j.filter(F=>F.role==="super_admin"||F.role==="staff").map(F=>e.jsxs("button",{className:"cw-3dot-item",disabled:_,onClick:()=>D(F.name),children:[e.jsx("i",{className:"fas fa-user-circle"})," ",F.name,s.assigned_to===F.name&&e.jsx("i",{className:"fas fa-check",style:{marginLeft:"auto",color:"#2563eb"}})]},F.id)),j.length===0&&e.jsx("div",{style:{padding:"8px 12px",fontSize:12,color:"#9ca3af"},children:"No staff users found"}),e.jsxs("button",{className:"cw-3dot-item",onClick:()=>y(!1),style:{color:"#6b7280"},children:[e.jsx("i",{className:"fas fa-times"})," Cancel"]})]})]})]})]})]})}function dm({app:s,onUpdated:i}){const[r,o]=u.useState("cards"),[d,f]=u.useState(!1),p=Kf(s),x=["CLOSED","DROPPED","EXPIRED"].includes(s.status);return e.jsxs("div",{className:"cw-tab-content",children:[e.jsxs("div",{className:"cw-lenders-header",children:[e.jsxs("div",{style:{display:"flex",gap:8},children:[e.jsxs("button",{className:`btn btn-sm ${r==="cards"?"btn-primary":"btn-outline"}`,onClick:()=>o("cards"),children:[e.jsx("i",{className:"fas fa-th"})," Cards"]}),e.jsxs("button",{className:`btn btn-sm ${r==="table"?"btn-primary":"btn-outline"}`,onClick:()=>o("table"),children:[e.jsx("i",{className:"fas fa-list"})," Table"]})]}),e.jsxs("button",{className:"btn btn-primary btn-sm",onClick:()=>f(!0),title:"Open lender detail drawer to update lender info",children:[e.jsx("i",{className:"fas fa-plus"})," Add / Edit Lender"]})]}),r==="cards"?e.jsx("div",{className:"cw-lender-cards",children:e.jsx(cm,{app:s,slaState:p,isClosed:x,onOpenDrawer:()=>f(!0),onUpdated:i})}):e.jsx(um,{app:s,slaState:p,isClosed:x,onOpenDrawer:()=>f(!0)}),d&&e.jsx(fm,{app:s,onClose:()=>f(!1),onUpdated:()=>{f(!1),i()}})]})}function cm({app:s,slaState:i,isClosed:r,onOpenDrawer:o,onUpdated:d}){const f=Qo[s.bank]||"Private",p=ti[f]||ti.Private,[x,m]=u.useState(!1),[v,g]=u.useState(!1),[b,y]=u.useState(s.bank_application_ref||""),[j,k]=u.useState(!1),_=async()=>{k(!0);try{await Ae.updateApplication(s.id,{bank_application_ref:b}),T.success("Bank ref updated"),g(!1),d==null||d()}catch(L){T.error(L.message||"Update failed")}k(!1)},C=async L=>{try{L==="query"?(await Ae.updateApplication(s.id,{status:"QUERY_RAISED",awaiting_from:"Student",notes:"[QUERY] Query raised from lender card"}),T.success("Status set to Query Raised")):L==="pack"?(await Ae.updateApplication(s.id,{notes:"[PACK] Document pack sent to bank"}),T.success("Pack sent  logged in timeline")):L==="ping"&&(await Ae.updateApplication(s.id,{notes:`[PING] Bank ${s.bank} pinged for update`}),T.success(`${s.bank} pinged  logged in timeline`)),d==null||d()}catch(D){T.error(D.message||"Action failed")}};return e.jsxs("div",{className:`cw-lender-card ${r?"cw-lender-closed":""} ${x?"cw-lender-winner":""}`,children:[e.jsxs("div",{className:"cw-lcard-header",onClick:o,style:{cursor:"pointer"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[e.jsx(ii,{bank:s.bank}),e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("span",{className:"cw-lcard-bank-name",children:s.bank}),e.jsx("span",{className:"cw-bank-type-badge",style:{background:p.bg,color:p.color},children:p.label}),x&&e.jsxs("span",{className:"cw-winner-badge",children:[e.jsx("i",{className:"fas fa-trophy"})," Winner"]})]}),e.jsx("div",{className:"cw-lcard-ref",onClick:L=>L.stopPropagation(),children:v?e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:4},children:[e.jsx("input",{value:b,onChange:L=>y(L.target.value),onKeyDown:L=>{L.key==="Enter"&&_(),L.key==="Escape"&&g(!1)},style:{fontSize:12,padding:"2px 6px",border:"1px solid #2563eb",borderRadius:4,width:140},autoFocus:!0}),e.jsx("button",{className:"btn btn-sm",style:{padding:"2px 6px",fontSize:11},onClick:_,disabled:j,children:j?"":""}),e.jsx("button",{className:"btn btn-sm btn-outline",style:{padding:"2px 6px",fontSize:11},onClick:()=>g(!1),children:""})]}):e.jsxs("span",{children:["Ref: ",s.bank_application_ref||"",e.jsx("i",{className:"fas fa-pen cw-edit-icon",title:"Edit ref",style:{marginLeft:6,cursor:"pointer",fontSize:10},onClick:L=>{L.stopPropagation(),g(!0),y(s.bank_application_ref||"")}})]})})]})]}),e.jsxs("div",{className:"cw-lcard-date",children:[e.jsx("i",{className:"fas fa-calendar-alt",style:{fontSize:11,marginRight:4}}),s.created_at?dt(s.created_at):""]})]}),e.jsxs("div",{className:"cw-lcard-status-strip",children:[e.jsx(Ht,{status:s.status}),e.jsx(Nn,{awaiting:s.awaiting_from}),e.jsx(Qt,{days:s.sla_days,awaiting:s.awaiting_from}),e.jsxs("span",{className:"cw-lcard-update-meta",children:[e.jsx("i",{className:"fas fa-sync-alt",style:{fontSize:10}}),"",s.last_update_source||"Manual","",na(s.updated_at)]})]}),e.jsxs("div",{className:"cw-lcard-body",children:[e.jsx("div",{className:"cw-lcard-substatus",children:s.sub_status||""}),s.sanction_amount&&e.jsxs("div",{className:"cw-lcard-offer",children:[e.jsx("i",{className:"fas fa-check-circle",style:{color:"#16a34a",marginRight:6}}),ct(s.sanction_amount),s.roi&&`  ${s.roi}% ROI`,s.tenure&&`  ${s.tenure}m`]})]}),e.jsxs("div",{className:"cw-lcard-actions",children:[e.jsxs("button",{className:"btn btn-sm btn-outline",onClick:o,children:[e.jsx("i",{className:"fas fa-edit"})," Update Status"]}),e.jsxs("button",{className:"btn btn-sm btn-outline",onClick:()=>C("query"),title:"Set status to Query Raised",children:[e.jsx("i",{className:"fas fa-question"})," Raise Query"]}),e.jsxs("button",{className:"btn btn-sm btn-outline",onClick:()=>C("pack"),title:"Log pack as sent to bank",children:[e.jsx("i",{className:"fas fa-box"})," Send Pack"]}),e.jsxs("button",{className:"btn btn-sm btn-outline",onClick:()=>C("ping"),title:"Log a ping to the bank",children:[e.jsx("i",{className:"fas fa-bell"})," Ping Bank"]}),!r&&!x&&s.sanction_amount&&e.jsxs("button",{className:"btn btn-sm",style:{background:"#fef9c3",color:"#92400e",border:"1px solid #fde68a"},onClick:()=>m(!0),children:[e.jsx("i",{className:"fas fa-trophy"})," Mark as Winner"]}),!r&&e.jsxs("button",{className:"btn btn-sm",style:{background:"#fee2e2",color:"#dc2626",border:"1px solid #fca5a5"},onClick:()=>T("Use Close / Outcome tab to close this case",{icon:""}),children:[e.jsx("i",{className:"fas fa-times"})," Close"]})]}),e.jsxs("div",{className:"cw-lcard-switches",children:[e.jsxs("label",{className:"cw-switch-row",children:[e.jsx("span",{children:"Auto-notify student on lender update"}),e.jsx("input",{type:"checkbox",defaultChecked:!0})]}),e.jsxs("label",{className:"cw-switch-row",children:[e.jsx("span",{children:"Auto-notify bank on docs received"}),e.jsx("input",{type:"checkbox",defaultChecked:!0})]}),e.jsxs("div",{className:"cw-safety-gate",children:[e.jsx("i",{className:"fas fa-shield-alt"}),e.jsx("span",{children:"Critical update safety gate"}),e.jsx("span",{className:"cw-safety-gate-pill",children:"Always ON"})]})]})]})}function um({app:s,slaState:i,isClosed:r,onOpenDrawer:o}){const d=Qo[s.bank]||"Private",f=ti[d]||ti.Private;return e.jsx("div",{className:"table-container",children:e.jsxs("table",{className:"app-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Bank"}),e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Awaiting"}),e.jsx("th",{children:"SLA"}),e.jsx("th",{children:"Sub Status"}),e.jsx("th",{children:"Bank Ref"}),e.jsx("th",{children:"Last Updated"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx(ii,{bank:s.bank})}),e.jsx("td",{children:e.jsx("span",{className:"cw-bank-type-badge",style:{background:f.bg,color:f.color},children:f.label})}),e.jsx("td",{children:e.jsx(Ht,{status:s.status})}),e.jsx("td",{children:e.jsx(Nn,{awaiting:s.awaiting_from})}),e.jsx("td",{children:e.jsx(Qt,{days:s.sla_days,awaiting:s.awaiting_from})}),e.jsx("td",{style:{fontSize:12,color:"#6b7280"},children:s.sub_status||""}),e.jsx("td",{style:{fontSize:12},children:s.bank_application_ref||""}),e.jsx("td",{style:{fontSize:12},children:na(s.updated_at)}),e.jsx("td",{children:e.jsxs("button",{className:"btn btn-sm btn-outline",onClick:o,children:[e.jsx("i",{className:"fas fa-edit"})," Update"]})})]})})]})})}function fm({app:s,onClose:i,onUpdated:r}){const[o,d]=u.useState("status"),[f,p]=u.useState(!1),[x,m]=u.useState({status:s.status,sub_status:s.sub_status||"",awaiting_from:s.awaiting_from,priority:s.priority||"Normal",remarks:"",sanction_amount:s.sanction_amount||"",roi:s.roi||"",tenure:s.tenure||"",processing_fee:s.processing_fee||"",margin_percent:s.margin_percent||"",conditions:"",close_reason:"",close_notes:""}),v=[{key:"status",label:"Status Update"},{key:"queries",label:"Query Manager"},{key:"pack",label:"Pack Controls"},{key:"offer",label:"Offer Terms"},{key:"compare",label:"Compare Offers"},{key:"close",label:"Close Application"}],g=k=>{const _=Rt[k];m(C=>{var L;return{...C,status:k,awaiting_from:(_==null?void 0:_.awaiting)!=="Closed"?_==null?void 0:_.awaiting:C.awaiting_from,sub_status:((L=bs[k])==null?void 0:L[0])||""}})},b=["SANCTIONED","CONDITIONAL_SANCTION"].includes(x.status),y=["SANCTIONED","REJECTED","DISBURSED","AGREEMENT_SIGNED"].includes(x.status),j=async(k=!1,_=!1)=>{p(!0);try{const C={status:x.status,sub_status:x.sub_status,awaiting_from:x.awaiting_from,priority:x.priority,notes:x.remarks};b&&(x.sanction_amount&&(C.sanction_amount=Number(x.sanction_amount)),x.roi&&(C.roi=Number(x.roi)),x.tenure&&(C.tenure=Number(x.tenure)),x.processing_fee&&(C.processing_fee=Number(x.processing_fee)),x.margin_percent&&(C.margin_percent=Number(x.margin_percent))),await Ae.updateApplication(s.id,C);const L=_?"  Bank notified via template":k?"  Student notified":"";T.success(`Updated ${s.id}${L}`),r()}catch(C){T.error(C.message||"Update failed")}p(!1)};return e.jsx("div",{className:"cw-drawer-overlay",onClick:k=>k.target===k.currentTarget&&i(),children:e.jsxs("div",{className:"cw-drawer",children:[e.jsxs("div",{className:"cw-drawer-header",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[e.jsx(ii,{bank:s.bank}),e.jsxs("div",{children:[e.jsx("span",{style:{fontWeight:600,fontSize:15},children:s.bank}),(()=>{const k=Qo[s.bank]||"Private",_=ti[k];return e.jsx("span",{className:"cw-bank-type-badge",style:{background:_.bg,color:_.color,marginLeft:8},children:_.label})})()]})]}),e.jsx("button",{className:"cw-close-btn",onClick:i,children:e.jsx("i",{className:"fas fa-times"})})]}),e.jsx("div",{className:"cw-drawer-nav",children:v.map(k=>e.jsx("button",{className:`cw-drawer-nav-item ${o===k.key?"active":""}`,onClick:()=>d(k.key),children:k.label},k.key))}),e.jsxs("div",{className:"cw-drawer-body",children:[o==="status"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"cw-safety-gate-bar",children:[e.jsx("i",{className:"fas fa-shield-alt"}),e.jsx("span",{children:"Critical Update Safety Gate"}),e.jsx("span",{className:"cw-safety-gate-pill",children:"Always ON"})]}),y&&e.jsxs("div",{className:"bank-panel-warning",style:{marginBottom:12},children:[e.jsx("i",{className:"fas fa-exclamation-triangle"}),e.jsx("span",{children:"Critical status  Proof upload or supervisor confirmation may be required before this update goes live."})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Main Status"}),e.jsx("select",{value:x.status,onChange:k=>g(k.target.value),children:Object.entries(im).map(([k,_])=>e.jsx("optgroup",{label:k,children:_.map(C=>{var L;return e.jsx("option",{value:C,children:((L=Rt[C])==null?void 0:L.label)||C},C)})},k))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Sub Status"}),bs[x.status]?e.jsx("select",{value:x.sub_status,onChange:k=>m(_=>({..._,sub_status:k.target.value})),children:bs[x.status].map(k=>e.jsx("option",{value:k,children:k},k))}):e.jsx("input",{value:x.sub_status,onChange:k=>m(_=>({..._,sub_status:k.target.value})),placeholder:"Sub status / notes"})]})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Awaiting From"}),e.jsxs("select",{value:x.awaiting_from,onChange:k=>m(_=>({..._,awaiting_from:k.target.value})),children:[e.jsx("option",{children:"Student"}),e.jsx("option",{children:"Bank"}),e.jsx("option",{children:"Nexthara"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Priority"}),e.jsxs("select",{value:x.priority,onChange:k=>m(_=>({..._,priority:k.target.value})),children:[e.jsx("option",{children:"Normal"}),e.jsx("option",{children:"High"}),e.jsx("option",{children:"Urgent"})]})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Remarks"}),e.jsx("textarea",{value:x.remarks,onChange:k=>m(_=>({..._,remarks:k.target.value})),placeholder:"Add remarks",style:{minHeight:70}})]}),e.jsxs("div",{className:"form-actions",style:{marginTop:12,flexWrap:"wrap",gap:8},children:[e.jsx("button",{className:"btn btn-outline",onClick:i,children:"Cancel"}),e.jsxs("button",{className:"btn btn-primary",onClick:()=>j(!1,!1),disabled:f,children:[e.jsx("i",{className:`fas ${f?"fa-spinner fa-spin":"fa-save"}`}),f?"Saving":"Save Update"]}),e.jsxs("button",{className:"btn btn-outline",onClick:()=>j(!0,!1),disabled:f,children:[e.jsx("i",{className:"fas fa-user-check"})," Save + Notify Student"]}),e.jsxs("button",{className:"btn btn-outline",onClick:()=>j(!1,!0),disabled:f,style:{borderColor:"#2563eb",color:"#2563eb"},children:[e.jsx("i",{className:"fas fa-university"})," Save + Notify Bank"]})]})]}),o==="queries"&&e.jsx(pm,{app:s,onUpdated:r}),o==="pack"&&e.jsx(xm,{app:s,onUpdated:r}),o==="offer"&&(b?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Sanctioned Amount ()"}),e.jsx("input",{type:"number",value:x.sanction_amount,onChange:k=>m(_=>({..._,sanction_amount:k.target.value})),placeholder:"e.g. 2500000"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"ROI (%)"}),e.jsx("input",{value:x.roi,onChange:k=>m(_=>({..._,roi:k.target.value})),placeholder:"e.g. 9.5"})]})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Tenure (months)"}),e.jsx("input",{type:"number",value:x.tenure,onChange:k=>m(_=>({..._,tenure:k.target.value})),placeholder:"e.g. 120"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Processing Fee (%)"}),e.jsx("input",{value:x.processing_fee,onChange:k=>m(_=>({..._,processing_fee:k.target.value})),placeholder:"e.g. 1.0"})]})]}),e.jsx("div",{className:"form-row",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Margin (%)"}),e.jsx("input",{value:x.margin_percent,onChange:k=>m(_=>({..._,margin_percent:k.target.value})),placeholder:"e.g. 10"})]})}),e.jsxs("div",{className:"form-group",style:{marginBottom:16},children:[e.jsx("label",{children:"Conditions / Special Terms"}),e.jsx("textarea",{value:x.conditions,onChange:k=>m(_=>({..._,conditions:k.target.value})),placeholder:"e.g. Collateral to be mortgaged, Co-applicant required, additional documentation needed",style:{minHeight:70}})]}),e.jsxs("div",{className:"form-actions",children:[e.jsxs("button",{className:"btn btn-primary",onClick:()=>j(!1,!1),disabled:f,children:[e.jsx("i",{className:"fas fa-save"})," Save Offer Terms"]}),e.jsxs("button",{className:"btn btn-outline",onClick:()=>d("compare"),children:[e.jsx("i",{className:"fas fa-balance-scale"})," Compare Offers"]})]})]}):e.jsxs("div",{className:"cw-empty-state",children:[e.jsx("i",{className:"fas fa-gavel"}),e.jsx("p",{children:"No offer terms yet."}),e.jsx("p",{style:{fontSize:12,color:"#9ca3af"},children:"Status must be SANCTIONED or CONDITIONAL_SANCTION to enter offer terms."})]})),o==="compare"&&e.jsx(gm,{app:s}),o==="close"&&e.jsx(hm,{app:s,form:x,setForm:m,onUpdated:r})]})]})})}function hm({app:s,form:i,setForm:r,onUpdated:o}){const[d,f]=u.useState(!1),p=async()=>{if(!i.close_reason){T.error("Select a close reason");return}f(!0);try{await Ae.updateApplication(s.id,{status:"CLOSED",sub_status:i.close_reason,notes:i.close_notes}),T.success("Lender application closed"),o()}catch(x){T.error(x.message||"Close failed")}f(!1)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"form-group",style:{marginBottom:12},children:[e.jsx("label",{children:"Close Reason (required)"}),e.jsxs("select",{value:i.close_reason,onChange:x=>r(m=>({...m,close_reason:x.target.value})),children:[e.jsx("option",{value:"",children:" Select reason "}),Hf.map(x=>e.jsx("option",{value:x,children:x.replace(/_/g," ")},x))]})]}),e.jsxs("div",{className:"form-group",style:{marginBottom:16},children:[e.jsx("label",{children:"Notes"}),e.jsx("textarea",{value:i.close_notes,onChange:x=>r(m=>({...m,close_notes:x.target.value})),placeholder:"Additional notes",style:{minHeight:70}})]}),e.jsxs("button",{className:"btn",style:{background:"#dc2626",color:"#fff",border:"none"},onClick:p,disabled:d,children:[e.jsx("i",{className:`fas ${d?"fa-spinner fa-spin":"fa-times-circle"}`}),d?"Closing":"Close This Application"]})]})}function pm({app:s,onUpdated:i}){const[r,o]=u.useState("Document Request"),[d,f]=u.useState(""),[p,x]=u.useState(!1),m=async()=>{if(!d.trim()){T.error("Please describe the query");return}x(!0);try{await Ae.updateApplication(s.id,{status:"QUERY_RAISED",awaiting_from:"Student",notes:`[QUERY] Type: ${r} | ${d}`}),T.success("Query raised  status updated to Query Raised"),f(""),i==null||i()}catch(v){T.error(v.message||"Failed to create query")}x(!1)};return e.jsxs("div",{children:[s.status==="QUERY_RAISED"&&e.jsxs("div",{style:{background:"#fffbeb",border:"1px solid #fde68a",borderRadius:8,padding:"10px 14px",marginBottom:14,fontSize:13},children:[e.jsx("i",{className:"fas fa-exclamation-triangle",style:{color:"#d97706",marginRight:6}}),"Active query: status is ",e.jsx("strong",{children:"Query Raised"}),", awaiting from Student."]}),e.jsxs("div",{className:"form-group",style:{marginBottom:12},children:[e.jsx("label",{children:"Query Type"}),e.jsxs("select",{value:r,onChange:v=>o(v.target.value),children:[e.jsx("option",{children:"Document Request"}),e.jsx("option",{children:"Clarification"}),e.jsx("option",{children:"Field Verification"}),e.jsx("option",{children:"Income Proof"}),e.jsx("option",{children:"Other"})]})]}),e.jsxs("div",{className:"form-group",style:{marginBottom:16},children:[e.jsx("label",{children:"Query Details / Notes"}),e.jsx("textarea",{value:d,onChange:v=>f(v.target.value),placeholder:"Describe the query",style:{minHeight:70}})]}),e.jsxs("button",{className:"btn btn-primary btn-sm",onClick:m,disabled:p,children:[e.jsx("i",{className:`fas ${p?"fa-spinner fa-spin":"fa-paper-plane"}`}),p?"Creating":"Create Query & Notify Student"]})]})}function xm({app:s,onUpdated:i}){const[r,o]=u.useState("Bank Portal Upload"),[d,f]=u.useState(""),[p,x]=u.useState([]),[m,v]=u.useState(!1),g=u.useCallback(()=>{ei.getPacks(s.id).then(x).catch(()=>{})},[s.id]);u.useEffect(()=>{g()},[g]);const b=async()=>{v(!0);try{let y=[];try{y=await bt.getDocuments(s.id)}catch{}const j=Ho(s,y),k=window.open("","_blank","width=960,height=800");if(!k){T.error("Allow popups to generate pack"),v(!1);return}k.document.write(j),k.document.close(),k.focus(),setTimeout(()=>k.print(),400),await ei.createPack(s.id,{sent_via:r,sent_to:d}),T.success("Pack generated and logged!",{icon:""}),g(),i==null||i()}catch(y){T.error(y.message||"Generation failed")}v(!1)};return e.jsxs("div",{children:[e.jsxs("div",{className:"form-group",style:{marginBottom:12},children:[e.jsx("label",{children:"Send Pack Method"}),e.jsxs("select",{value:r,onChange:y=>o(y.target.value),children:[e.jsx("option",{children:"Bank Portal Upload"}),e.jsx("option",{children:"Email"}),e.jsx("option",{children:"Secure Link"}),e.jsx("option",{children:"WhatsApp"}),e.jsx("option",{children:"Print"})]})]}),e.jsxs("div",{className:"form-group",style:{marginBottom:16},children:[e.jsx("label",{children:"Sent To (Bank Officer / Email)"}),e.jsx("input",{value:d,onChange:y=>f(y.target.value),placeholder:"e.g. loan.officer@bank.in"})]}),e.jsxs("button",{className:"btn btn-primary",onClick:b,disabled:m,children:[e.jsx("i",{className:`fas ${m?"fa-spinner fa-spin":"fa-box"}`}),m?"Generating":"Generate & Print Pack"]}),p.length>0&&e.jsxs("div",{style:{marginTop:20},children:[e.jsx("div",{style:{fontSize:12,fontWeight:600,color:"#374151",marginBottom:8,textTransform:"uppercase",letterSpacing:"0.5px"},children:"Pack History"}),p.map(y=>e.jsxs("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:6,padding:"8px 12px",marginBottom:6,fontSize:12},children:[e.jsxs("div",{style:{fontWeight:600},children:["v",y.version,"  ",y.docs_count," docs"]}),e.jsxs("div",{style:{color:"#6b7280"},children:["Via ",y.sent_via,y.sent_to?`  ${y.sent_to}`:"","  ",new Date(y.created_at).toLocaleDateString("en-IN")]})]},y.id))]}),p.length===0&&e.jsx("div",{style:{marginTop:16,color:"#9ca3af",fontSize:13,textAlign:"center",padding:12},children:"No packs generated yet."})]})}function gm({app:s}){const[i,r]=u.useState(s.tenure||120),o=s.sanction_amount||0,d=(s.roi||0)/12/100,f=i,p=o&&d&&f?Math.round(o*d*Math.pow(1+d,f)/(Math.pow(1+d,f)-1)):0,x=p*f,m=x-o,v=g=>g?`${Math.round(g).toLocaleString("en-IN")}`:"";return s.sanction_amount?e.jsxs("div",{children:[e.jsxs("div",{style:{background:"#f0fdf4",border:"1px solid #bbf7d0",borderRadius:8,padding:"12px 16px",marginBottom:16},children:[e.jsxs("div",{style:{fontSize:13,fontWeight:700,color:"#15803d",marginBottom:4},children:[e.jsx("i",{className:"fas fa-check-circle",style:{marginRight:6}}),s.bank,"  Sanctioned Offer"]}),e.jsxs("div",{style:{fontSize:12,color:"#166534"},children:["Amount: ",v(s.sanction_amount),"  ROI: ",s.roi?s.roi+"%":"","  Tenure: ",s.tenure?s.tenure+"m":""]})]}),e.jsxs("div",{className:"form-group",style:{marginBottom:16},children:[e.jsx("label",{children:"Adjust Tenure for EMI Comparison (months)"}),e.jsx("input",{type:"range",min:"12",max:"240",step:"12",value:i,onChange:g=>r(Number(g.target.value)),style:{width:"100%"}}),e.jsxs("div",{style:{fontSize:12,color:"#6b7280",marginTop:4},children:[i," months (",(i/12).toFixed(1)," years)"]})]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:12,marginBottom:16},children:[{label:"Monthly EMI",value:v(p),color:"#1d4ed8"},{label:"Total Payable",value:v(x),color:"#374151"},{label:"Total Interest",value:v(m),color:"#b91c1c"}].map(g=>e.jsxs("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:8,padding:"12px",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:11,color:"#9ca3af",marginBottom:4,textTransform:"uppercase",letterSpacing:"0.5px"},children:g.label}),e.jsx("div",{style:{fontSize:18,fontWeight:700,color:g.color},children:g.value})]},g.label))}),s.processing_fee&&e.jsxs("div",{style:{fontSize:12,color:"#6b7280",marginTop:8},children:["Processing Fee: ",s.processing_fee,"% = ",v(o*s.processing_fee/100)," (one-time)"]}),s.margin_percent&&e.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:["Margin Money Required: ",s.margin_percent,"% = ",v(o*s.margin_percent/100)]})]}):e.jsxs("div",{className:"cw-empty-state",children:[e.jsx("i",{className:"fas fa-gavel"}),e.jsx("p",{children:"No sanctioned offer yet."}),e.jsx("p",{style:{fontSize:12,color:"#9ca3af"},children:"Offer terms will appear here once the bank sanctions the loan."})]})}const mm=["OK","Blurry","Expired","Mismatch","Incomplete"];function ym(s){return s?s.includes("pdf")?"fa-file-pdf":s.includes("image")?"fa-file-image":s.includes("word")||s.includes("doc")?"fa-file-word":s.includes("sheet")||s.includes("excel")||s.includes("xls")?"fa-file-excel":"fa-file-alt":"fa-file-alt"}function vm(s){return s==="OK"?{color:"#15803d",bg:"#f0fdf4"}:s==="Blurry"||s==="Incomplete"?{color:"#b45309",bg:"#fffbeb"}:s==="Expired"||s==="Mismatch"?{color:"#b91c1c",bg:"#fef2f2"}:{color:"#6b7280",bg:"#f9fafb"}}function bm({app:s,onUpdated:i,onTabChange:r}){const[o,d]=u.useState(Object.keys(qn)[0]),[f,p]=u.useState({}),[x,m]=u.useState([]),[v,g]=u.useState(!1),b=u.useRef(null),[y,j]=u.useState({doc_name:"",doc_category:"Other",owner:"Student",label:""}),[k,_]=u.useState(!1),C=u.useCallback(()=>{s!=null&&s.id&&bt.getDocuments(s.id).then(z=>m(z||[])).catch(()=>{})},[s==null?void 0:s.id]);u.useEffect(()=>{C()},[C]);const L={};x.forEach(z=>{["Received","Verified"].includes(z.status)&&(L[z.doc_name]=z.status)});const I=Object.values(qn).flat().length,P=Object.keys(L).length,w=x.filter(z=>z.status==="Verified").length,A=Math.round(P/I*100),N=async z=>{var de;const X=(de=z.target.files)==null?void 0:de[0];if(X){g(!0);try{const oe={...y};oe.doc_name||(oe.doc_name=X.name.replace(/\.[^.]+$/,"")),await bt.uploadFile(s.id,X,oe),T.success(`"${oe.doc_name}" uploaded`),C(),_(!1),j({doc_name:"",doc_category:"Other",owner:"Student",label:""})}catch(oe){T.error(oe.message||"Upload failed")}g(!1),z.target.value=""}},W=z=>{if(!z.file_path){T.error("No file attached  metadata record only");return}const X=bt.fileUrl(s.id,z.id,!1),de=localStorage.getItem("nexthara_token");fetch(X,{headers:{Authorization:`Bearer ${de}`}}).then(oe=>oe.ok?oe.blob():Promise.reject(oe.statusText)).then(oe=>{const ve=URL.createObjectURL(oe);window.open(ve,"_blank")}).catch(()=>T.error("Could not open file"))},F=z=>{if(!z.file_path){T.error("No file attached  metadata record only");return}const X=bt.fileUrl(s.id,z.id,!0),de=localStorage.getItem("nexthara_token");fetch(X,{headers:{Authorization:`Bearer ${de}`}}).then(oe=>oe.ok?oe.blob():Promise.reject(oe.statusText)).then(oe=>{const ve=document.createElement("a");ve.href=URL.createObjectURL(oe),ve.download=z.doc_name||"document",ve.click()}).catch(()=>T.error("Download failed"))},Z=async(z,X)=>{try{await bt.updateDocument(s.id,z.id,{status:X}),T.success(`Marked as ${X}`),C()}catch(de){T.error(de.message||"Update failed")}},ce=async z=>{try{await bt.updateDocument(s.id,z.id,{share_with_lender:z.share_with_lender?0:1}),C()}catch{T.error("Update failed")}},xe=(z,X)=>p(de=>({...de,[z]:X}));return e.jsxs("div",{className:"cw-tab-content",children:[e.jsxs("div",{className:"cw-doc-top-actions",children:[e.jsxs("button",{className:"btn btn-primary btn-sm",onClick:()=>_(z=>!z),children:[e.jsx("i",{className:"fas fa-cloud-upload-alt"})," ",k?"Cancel Upload":"Upload Document"]}),e.jsxs("button",{className:"btn btn-outline btn-sm",onClick:()=>{const z=(s.student_phone||"").replace(/\D/g,"");if(!z){T.error("No student phone number on file");return}const X=Object.values(qn).flat(),de=x.filter(J=>["Received","Verified"].includes(J.status)).map(J=>J.doc_name),oe=X.filter(J=>!de.includes(J)).slice(0,8),ve=oe.length?oe.map((J,O)=>`${O+1}. ${J}`).join(`
`):"Please upload any pending documents.",Y=encodeURIComponent(`Hi ${s.student_name}, we need the following documents for your loan application with ${s.bank}:

${ve}

Please upload them in the Nexthara Student Portal.  Nexthara Team`),se=z.startsWith("91")?"":"91";window.open(`https://wa.me/${se}${z}?text=${Y}`,"_blank")},children:[e.jsx("i",{className:"fas fa-paper-plane"})," Request Missing Docs"]}),e.jsxs("button",{className:"btn btn-outline btn-sm",onClick:async()=>{let z=[];try{z=await bt.getDocuments(s.id)}catch{}const X=Ho(s,z),de=window.open("","_blank","width=960,height=800");if(!de){T.error("Allow popups to generate pack");return}de.document.write(X),de.document.close(),de.focus(),setTimeout(()=>de.print(),400);try{await ei.createPack(s.id,{sent_via:"Print"}),i==null||i()}catch{}T.success("Pack generated!",{icon:""})},children:[e.jsx("i",{className:"fas fa-box"})," Generate / Update Pack"]}),e.jsxs("button",{className:"btn btn-outline btn-sm",onClick:async()=>{const z=(s.student_phone||"").replace(/\D/g,"");if(!z){T.error("No student phone number on file");return}const X=encodeURIComponent(`Hi ${s.student_name}, some of your uploaded documents need to be re-uploaded with better quality. Please log into the Nexthara Student Portal and re-upload the requested documents.  Nexthara Team`),de=z.startsWith("91")?"":"91";window.open(`https://wa.me/${de}${z}?text=${X}`,"_blank");try{await Ae.updateApplication(s.id,{notes:"[DOC] Re-upload request sent to student via WhatsApp"}),i==null||i()}catch{}T.success("Re-upload request sent via WhatsApp")},children:[e.jsx("i",{className:"fas fa-redo"})," Re-upload Request"]})]}),k&&e.jsxs("div",{className:"cw-panel cw-upload-panel",style:{marginBottom:16},children:[e.jsxs("div",{className:"cw-panel-title",children:[e.jsx("i",{className:"fas fa-cloud-upload-alt"})," Upload Document"]}),e.jsxs("div",{className:"form-row",style:{marginBottom:10},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Document Name"}),e.jsx("input",{placeholder:"e.g. ITR AY 24-25",value:y.doc_name,onChange:z=>j(X=>({...X,doc_name:z.target.value}))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Label / Year"}),e.jsx("input",{placeholder:"e.g. AY 2024-25",value:y.label,onChange:z=>j(X=>({...X,label:z.target.value}))})]})]}),e.jsxs("div",{className:"form-row",style:{marginBottom:12},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Category"}),e.jsxs("select",{value:y.doc_category,onChange:z=>j(X=>({...X,doc_category:z.target.value})),children:[Object.keys(qn).map(z=>e.jsx("option",{value:z,children:z},z)),e.jsx("option",{value:"Other",children:"Other"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Owner"}),e.jsxs("select",{value:y.owner,onChange:z=>j(X=>({...X,owner:z.target.value})),children:[e.jsx("option",{children:"Student"}),e.jsx("option",{children:"Co-applicant"}),e.jsx("option",{children:"Staff"})]})]})]}),e.jsxs("div",{style:{display:"flex",gap:10,alignItems:"center"},children:[e.jsxs("button",{className:"btn btn-primary",onClick:()=>{var z;return(z=b.current)==null?void 0:z.click()},disabled:v,children:[e.jsx("i",{className:`fas ${v?"fa-spinner fa-spin":"fa-folder-open"}`}),v?"Uploading":"Choose File & Upload"]}),e.jsx("span",{style:{fontSize:12,color:"#9ca3af"},children:"PDF, JPG, PNG, DOC, XLSX (max 20MB)"})]}),e.jsx("input",{ref:b,type:"file",accept:".pdf,.jpg,.jpeg,.png,.gif,.doc,.docx,.xlsx,.xls,.csv,.txt",style:{display:"none"},onChange:N})]}),e.jsxs("div",{className:"cw-docs-layout",children:[e.jsxs("div",{className:"cw-docs-checklist",children:[e.jsxs("div",{className:"cw-panel-title",children:[e.jsx("i",{className:"fas fa-clipboard-check"})," Document Checklist",e.jsxs("span",{className:"cw-doc-progress-label",children:[P,"/",I," (",A,"%)"]})]}),e.jsx("div",{className:"cw-doc-progress-bar",children:e.jsx("div",{className:"cw-doc-progress-fill",style:{width:`${A}%`}})}),e.jsxs("div",{style:{display:"flex",gap:12,fontSize:11,color:"#6b7280",margin:"4px 0 10px"},children:[e.jsxs("span",{children:[e.jsx("i",{className:"fas fa-circle",style:{color:"#16a34a",fontSize:8}})," Verified: ",w]}),e.jsxs("span",{children:[e.jsx("i",{className:"fas fa-circle",style:{color:"#2563eb",fontSize:8}})," Received: ",P-w]}),e.jsxs("span",{children:[e.jsx("i",{className:"fas fa-circle",style:{color:"#e5e7eb",fontSize:8}})," Pending: ",I-P]})]}),e.jsx("div",{className:"cw-doc-group-tabs",children:Object.keys(qn).map(z=>e.jsx("button",{className:`cw-doc-group-tab ${o===z?"active":""}`,onClick:()=>d(z),children:z},z))}),e.jsx("div",{className:"cw-doc-items",children:qn[o].map(z=>{const X=L[z],de=!!X,oe=X==="Verified",ve=f[z],Y=vm(ve);return e.jsxs("div",{className:`cw-doc-item ${de?"received":""}`,children:[e.jsx("div",{className:`cw-doc-checkbox ${de?"checked":""}`,children:oe?e.jsx("i",{className:"fas fa-check-double"}):de?e.jsx("i",{className:"fas fa-check"}):null}),e.jsx("span",{className:"cw-doc-name",children:z}),e.jsxs("div",{style:{display:"flex",gap:4,alignItems:"center",marginLeft:"auto"},children:[e.jsx("span",{className:`cw-doc-pill ${oe?"cw-doc-pill-green":de?"cw-doc-pill-blue":"cw-doc-pill-amber"}`,children:oe?"Verified":de?"Received":"Pending"}),de&&e.jsx("select",{className:"cw-doc-quality-select",value:ve||"OK",onChange:se=>xe(z,se.target.value),style:{color:Y.color,background:Y.bg},title:"Doc quality",children:mm.map(se=>e.jsx("option",{value:se,children:se},se))})]})]},z)})})]}),e.jsxs("div",{className:"cw-docs-grid",children:[e.jsxs("div",{className:"cw-panel-title",children:[e.jsx("i",{className:"fas fa-folder-open"})," Uploaded Documents",e.jsxs("span",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280",fontWeight:400,textTransform:"none"},children:[x.length," file",x.length!==1?"s":""]})]}),e.jsxs("div",{className:"cw-docs-grid-switches",children:[e.jsxs("label",{className:"cw-switch-row",children:[e.jsx("span",{children:"Auto-classify doc type"}),e.jsx("input",{type:"checkbox",defaultChecked:!0})]}),e.jsxs("label",{className:"cw-switch-row",children:[e.jsx("span",{children:"Allow bank access only via pack"}),e.jsx("input",{type:"checkbox",defaultChecked:!0})]})]}),x.length===0?e.jsxs("div",{className:"cw-empty-state",style:{marginTop:16},children:[e.jsx("i",{className:"fas fa-cloud-upload-alt"}),e.jsx("p",{children:"No documents uploaded yet."}),e.jsxs("button",{className:"btn btn-primary btn-sm",style:{marginTop:8},onClick:()=>_(!0),children:[e.jsx("i",{className:"fas fa-plus"})," Upload First Document"]})]}):e.jsx("div",{className:"cw-doc-grid-list",children:x.map(z=>{const X=z.status==="Verified"?"#15803d":z.status==="Invalid"?"#b91c1c":z.status==="Received"?"#1d4ed8":"#6b7280",de=z.status==="Verified"?"#f0fdf4":z.status==="Invalid"?"#fef2f2":z.status==="Received"?"#eff6ff":"#f9fafb";return e.jsxs("div",{className:"cw-doc-grid-item",children:[e.jsx("i",{className:`fas ${ym(z.mime_type)}`,style:{color:"#6b7280",fontSize:20,flexShrink:0}}),e.jsxs("div",{className:"cw-doc-grid-info",children:[e.jsxs("div",{className:"cw-doc-grid-name",children:[z.doc_name,z.label?` (${z.label})`:""]}),e.jsxs("div",{className:"cw-doc-grid-meta",children:[z.doc_category,"  ",z.owner||"Student",z.uploaded_at?`  ${dt(z.uploaded_at)}`:"",z.file_size?`  ${(z.file_size/1024).toFixed(0)}KB`:""]})]}),e.jsx("span",{style:{fontSize:10,fontWeight:700,padding:"2px 7px",borderRadius:10,background:de,color:X,flexShrink:0},children:z.status}),e.jsxs("label",{className:"cw-switch-row",style:{flexShrink:0,gap:4},title:"Share directly with lender",children:[e.jsx("i",{className:"fas fa-share-alt",style:{fontSize:11,color:z.share_with_lender?"#2563eb":"#9ca3af"}}),e.jsx("input",{type:"checkbox",checked:!!z.share_with_lender,onChange:()=>ce(z)})]}),e.jsxs("div",{className:"cw-doc-grid-actions",children:[z.file_path?e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-sm btn-outline",title:"View in new tab",onClick:()=>W(z),children:e.jsx("i",{className:"fas fa-eye"})}),e.jsx("button",{className:"btn btn-sm btn-outline",title:"Download",onClick:()=>F(z),children:e.jsx("i",{className:"fas fa-download"})})]}):e.jsx("span",{style:{fontSize:11,color:"#9ca3af"},children:"No file"}),z.status!=="Verified"&&e.jsx("button",{className:"btn btn-sm",style:{background:"#f0fdf4",color:"#15803d",border:"1px solid #bbf7d0"},title:"Mark Verified",onClick:()=>Z(z,"Verified"),children:e.jsx("i",{className:"fas fa-check"})}),z.status!=="Invalid"&&e.jsx("button",{className:"btn btn-sm",style:{background:"#fef2f2",color:"#b91c1c",border:"1px solid #fecaca"},title:"Mark Invalid",onClick:()=>Z(z,"Invalid"),children:e.jsx("i",{className:"fas fa-times"})})]})]},z.id)})})]})]})]})}function jm({app:s,onTabChange:i,onUpdated:r}){const[o,d]=u.useState("open"),[f,p]=u.useState(!1),[x,m]=u.useState(!1),[v,g]=u.useState(null),[b,y]=u.useState({type:"Document Request",docs:[],notes:""}),j=Object.values(qn).flat(),k=(s.history||[]).filter(w=>w.entry_type==="query"||(w.notes||"").startsWith("[QUERY]")),_=s.status==="QUERY_RAISED",C=w=>{y(A=>({...A,docs:A.docs.includes(w)?A.docs.filter(N=>N!==w):[...A.docs,w]}))},L=async()=>{if(b.docs.length===0&&!b.notes){T.error("Select at least one doc or add a note");return}m(!0);try{const w=b.docs.length?" | Docs: "+b.docs.join(", "):"",A=`[QUERY] Type: ${b.type}${w}${b.notes?" | Notes: "+b.notes:""}`;await Ae.updateApplication(s.id,{status:"QUERY_RAISED",awaiting_from:"Student",notes:A}),T.success("Query raised  status set to Query Raised, awaiting student"),p(!1),y({type:"Document Request",docs:[],notes:""}),r==null||r()}catch(w){T.error(w.message||"Failed to create query")}m(!1)},D=async w=>{g(w.id);try{await Ae.updateApplication(s.id,{status:"UNDER_REVIEW",awaiting_from:"Bank",notes:`[QUERY] Query resolved  resuming review at ${s.bank}`}),T.success("Query resolved  status set to Under Review"),r==null||r()}catch(A){T.error(A.message||"Failed to resolve query")}g(null)},I=async w=>{try{await Ae.updateApplication(s.id,{notes:`[QUERY] Reminder sent to student for query raised on ${(w.created_at||"").slice(0,10)}`}),T.success("Reminder logged"),r==null||r()}catch(A){T.error(A.message||"Failed to log reminder")}},P=(w="")=>{const A=w.match(/Type:\s*([^|]+)/),N=w.match(/Docs:\s*([^|]+)/),W=w.match(/Notes:\s*(.+)$/);return{type:A?A[1].trim():"Query",docs:N?N[1].trim():"",extraNote:W?W[1].trim():""}};return e.jsxs("div",{className:"cw-tab-content",children:[e.jsxs("div",{className:"cw-sub-tabs",children:[e.jsxs("button",{className:`cw-sub-tab ${o==="open"?"active":""}`,onClick:()=>d("open"),children:["Open Queries",_&&e.jsx("span",{className:"cw-sub-tab-badge",children:"1"})]}),e.jsxs("button",{className:`cw-sub-tab ${o==="history"?"active":""}`,onClick:()=>d("history"),children:["Query History",k.length>0&&e.jsx("span",{className:"cw-sub-tab-badge",children:k.length})]}),e.jsx("button",{className:`cw-sub-tab ${o==="student"?"active":""}`,onClick:()=>d("student"),children:"Pending Student Docs"}),e.jsx("button",{className:`cw-sub-tab ${o==="bank"?"active":""}`,onClick:()=>d("bank"),children:"Pending Bank Action"})]}),o==="open"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:12},children:e.jsxs("button",{className:"btn btn-primary btn-sm",onClick:()=>p(w=>!w),children:[e.jsx("i",{className:"fas fa-plus"})," ",f?"Cancel":"Raise New Query"]})}),f&&e.jsxs("div",{className:"cw-panel",style:{marginBottom:16},children:[e.jsxs("div",{className:"cw-panel-title",children:[e.jsx("i",{className:"fas fa-plus-circle"})," Raise Query"]}),e.jsx("div",{className:"form-row",style:{marginBottom:12},children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Query Type"}),e.jsxs("select",{value:b.type,onChange:w=>y(A=>({...A,type:w.target.value})),children:[e.jsx("option",{children:"Document Request"}),e.jsx("option",{children:"Clarification"}),e.jsx("option",{children:"Field Verification"}),e.jsx("option",{children:"Income Proof"}),e.jsx("option",{children:"Other"})]})]})}),e.jsxs("div",{className:"form-group",style:{marginBottom:12},children:[e.jsx("label",{children:"Select Requested Documents"}),e.jsx("div",{className:"cw-query-doc-grid",children:j.map(w=>e.jsxs("label",{className:"cw-query-doc-item",children:[e.jsx("input",{type:"checkbox",checked:b.docs.includes(w),onChange:()=>C(w)}),e.jsx("span",{children:w})]},w))})]}),e.jsxs("div",{className:"form-group",style:{marginBottom:12},children:[e.jsx("label",{children:"Additional Notes"}),e.jsx("textarea",{value:b.notes,onChange:w=>y(A=>({...A,notes:w.target.value})),placeholder:"Describe the query",style:{minHeight:60}})]}),b.docs.length>0&&e.jsxs("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10},children:["Selected: ",b.docs.join(", ")]}),e.jsxs("div",{className:"form-actions",children:[e.jsxs("button",{className:"btn btn-primary btn-sm",onClick:L,disabled:x,children:[e.jsx("i",{className:`fas ${x?"fa-spinner fa-spin":"fa-paper-plane"}`}),x?"Raising":"Raise Query & Notify Student"]}),e.jsx("button",{className:"btn btn-outline btn-sm",onClick:()=>p(!1),children:"Cancel"})]})]}),_?(()=>{const w=k[0],A=w?P(w.notes):{type:"Query",docs:"",extraNote:""};return e.jsxs("div",{className:"cw-panel",style:{borderLeft:"4px solid #f59e0b"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:10},children:[e.jsxs("div",{children:[e.jsxs("div",{style:{fontWeight:600,fontSize:14,color:"#92400e"},children:[e.jsx("i",{className:"fas fa-exclamation-circle",style:{marginRight:6}}),"Active Query  ",A.type]}),e.jsxs("div",{style:{fontSize:12,color:"#6b7280",marginTop:4},children:["Raised on ",w?(w.created_at||"").slice(0,10):"","  Awaiting Student"]})]}),e.jsx("span",{style:{fontSize:11,background:"#fef3c7",color:"#92400e",padding:"2px 8px",borderRadius:10,fontWeight:600},children:"OPEN"})]}),A.docs!==""&&e.jsxs("div",{style:{fontSize:12,color:"#374151",marginBottom:6},children:[e.jsx("strong",{children:"Requested docs:"})," ",A.docs]}),A.extraNote&&e.jsxs("div",{style:{fontSize:12,color:"#374151",marginBottom:6},children:[e.jsx("strong",{children:"Note:"})," ",A.extraNote]}),e.jsxs("div",{style:{display:"flex",gap:8,marginTop:12,flexWrap:"wrap"},children:[e.jsxs("button",{className:"btn btn-sm btn-outline",onClick:()=>w&&I(w),children:[e.jsx("i",{className:"fas fa-bell"})," Send Reminder"]}),e.jsxs("button",{className:"btn btn-sm btn-outline",onClick:()=>i==null?void 0:i("documents"),children:[e.jsx("i",{className:"fas fa-paperclip"})," View Docs"]}),e.jsxs("button",{className:"btn btn-sm btn-primary",onClick:()=>w&&D(w),disabled:v===(w==null?void 0:w.id),children:[e.jsx("i",{className:`fas ${v===(w==null?void 0:w.id)?"fa-spinner fa-spin":"fa-check"}`}),v===(w==null?void 0:w.id)?"Resolving":"Mark Resolved"]})]})]})})():e.jsxs("div",{className:"cw-empty-state",children:[e.jsx("i",{className:"fas fa-check-circle",style:{color:"#16a34a"}}),e.jsx("p",{children:"No open queries  all clear!"})]})]}),o==="history"&&e.jsx(e.Fragment,{children:k.length===0?e.jsxs("div",{className:"cw-empty-state",children:[e.jsx("i",{className:"fas fa-history"}),e.jsx("p",{children:"No query history yet."})]}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:10},children:k.map((w,A)=>{var F;const N=P(w.notes),W=(F=w.notes)==null?void 0:F.includes("resolved");return e.jsxs("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:8,padding:"12px 16px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:4},children:[e.jsx("div",{style:{fontSize:13,fontWeight:600,color:"#111827"},children:N.type}),e.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[e.jsx("span",{style:{fontSize:11,color:"#6b7280"},children:(w.created_at||"").slice(0,10)}),e.jsx("span",{style:{fontSize:11,padding:"2px 8px",borderRadius:10,background:W?"#dcfce7":"#fef3c7",color:W?"#16a34a":"#92400e",fontWeight:600},children:W?"Resolved":"Raised"})]})]}),N.docs!==""&&e.jsxs("div",{style:{fontSize:12,color:"#374151"},children:["Docs: ",N.docs]}),N.extraNote&&e.jsx("div",{style:{fontSize:12,color:"#6b7280",marginTop:2},children:N.extraNote}),e.jsxs("div",{style:{fontSize:11,color:"#9ca3af",marginTop:4},children:["By: ",w.changed_by||"Staff"]})]},w.id||A)})})}),o==="student"&&e.jsxs("div",{className:"cw-empty-state",children:[e.jsx("i",{className:"fas fa-user-clock"}),e.jsx("p",{children:s.awaiting_from==="Student"?"Currently awaiting documents from student.":"No pending student docs."})]}),o==="bank"&&e.jsxs("div",{className:"cw-empty-state",children:[e.jsx("i",{className:"fas fa-university"}),e.jsx("p",{children:s.awaiting_from==="Bank"?`Awaiting action from ${s.bank}.`:"No pending bank actions."}),s.awaiting_from==="Bank"&&s.sla_days!=null&&e.jsxs("p",{style:{fontSize:12,color:"#f59e0b",marginTop:4},children:[e.jsx("i",{className:"fas fa-clock"})," SLA: ",s.sla_days,"d open"]})]})]})}function Sm({app:s,onGeneratePack:i}){const[r,o]=u.useState([]),[d,f]=u.useState(!0),p=u.useCallback(()=>{f(!0),ei.getPacks(s.id).then(o).catch(()=>o([])).finally(()=>f(!1))},[s.id]);return u.useEffect(()=>{p()},[p]),e.jsxs("div",{className:"cw-tab-content",children:[e.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:16},children:e.jsxs("button",{className:"btn btn-primary btn-sm",onClick:async()=>{await(i==null?void 0:i("Print","")),p()},children:[e.jsx("i",{className:"fas fa-box"})," Generate New Pack"]})}),e.jsxs("div",{className:"table-container",children:[e.jsxs("div",{className:"table-header",children:[e.jsx("h3",{children:"Pack History"}),e.jsx("span",{className:"results-count",children:d?"":r.length===0?"No packs yet":`${r.length} pack${r.length!==1?"s":""}`})]}),e.jsxs("table",{className:"app-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Version"}),e.jsx("th",{children:"Generated At"}),e.jsx("th",{children:"Generated By"}),e.jsx("th",{children:"Lender"}),e.jsx("th",{children:"Docs"}),e.jsx("th",{children:"Sent Via"}),e.jsx("th",{children:"Sent To"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:d?e.jsx("tr",{children:e.jsxs("td",{colSpan:8,style:{textAlign:"center",padding:32,color:"#9ca3af"},children:[e.jsx("i",{className:"fas fa-spinner fa-spin"})," Loading"]})}):r.length===0?e.jsx("tr",{children:e.jsxs("td",{colSpan:8,style:{textAlign:"center",padding:48,color:"#9ca3af"},children:[e.jsx("i",{className:"fas fa-box",style:{fontSize:28,display:"block",marginBottom:10}}),'No packs generated yet. Click "Generate New Pack" to create the first version.']})}):r.map(x=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("span",{style:{fontWeight:600},children:["v",x.version]})}),e.jsx("td",{style:{fontSize:12},children:new Date(x.created_at).toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"})}),e.jsx("td",{style:{fontSize:12},children:x.generated_by||"Staff"}),e.jsx("td",{style:{fontSize:12},children:x.lender||s.bank}),e.jsx("td",{style:{fontSize:12},children:x.docs_count}),e.jsx("td",{style:{fontSize:12},children:x.sent_via||""}),e.jsx("td",{style:{fontSize:12,color:"#6b7280"},children:x.sent_to||""}),e.jsx("td",{children:e.jsxs("button",{className:"btn btn-sm btn-outline",onClick:async()=>{await(i==null?void 0:i("Reprint",x.sent_to||"")),p()},children:[e.jsx("i",{className:"fas fa-redo"})," Reprint"]})})]},x.id))})]})]})]})}function km({app:s}){const[i,r]=u.useState("all"),o=[{key:"all",label:"All"},{key:"status",label:"Status Changes"},{key:"docs",label:"Docs"},{key:"queries",label:"Queries"},{key:"packs",label:"Packs"},{key:"whatsapp",label:"WhatsApp / WABA"},{key:"proof",label:"Proof Uploads"}],d=s.history||[],f=i==="all"?d:d.filter(p=>p.entry_type===i||p.source===i);return e.jsxs("div",{className:"cw-tab-content",children:[e.jsx("div",{className:"cw-timeline-filters",children:o.map(p=>e.jsx("button",{className:`bank-chip ${i===p.key?"active":""}`,onClick:()=>r(p.key),children:p.label},p.key))}),f.length===0?e.jsxs("div",{className:"cw-empty-state",children:[e.jsx("i",{className:"fas fa-history"}),e.jsx("p",{children:"No timeline events yet."})]}):e.jsx("div",{className:"timeline",children:f.map((p,x)=>{const m=Rt[p.status],v=x===0;return e.jsxs("div",{className:"timeline-item",children:[e.jsx("div",{className:`timeline-dot ${(m==null?void 0:m.color)||"grey"}`,children:e.jsx("i",{className:`fas ${v?"fa-circle":"fa-check"}`})}),e.jsxs("div",{className:"timeline-content",children:[e.jsx("div",{className:"title",children:(m==null?void 0:m.label)||p.status}),e.jsxs("div",{className:"subtitle",children:[p.notes||"",p.sub_status&&p.sub_status!=="-"?` (${p.sub_status})`:""]}),e.jsxs("div",{className:"time",children:[e.jsx("i",{className:"fas fa-clock"})," ",na(p.created_at),"",e.jsx("i",{className:"fas fa-user"})," ",p.changed_by,"",e.jsx("span",{className:"status-badge status-blue",style:{fontSize:10,padding:"2px 8px"},children:p.source||p.entry_type||"Manual"})]})]})]},p.id||x)})})]})}function Nm({app:s}){const[i,r]=u.useState([]),[o,d]=u.useState([]),[f,p]=u.useState({title:"",assignee:"",due:""}),[x,m]=u.useState(""),v=()=>{if(!f.title.trim()){T.error("Enter a task title");return}r(y=>[...y,{...f,id:Date.now(),status:"open",created:new Date().toISOString()}]),p({title:"",assignee:"",due:""}),T.success("Task added")},g=()=>{x.trim()&&(d(y=>[...y,{text:x,created:new Date().toISOString(),by:"Staff"}]),m(""),T.success("Note added"))},b=y=>r(j=>j.filter(k=>k.id!==y));return e.jsx("div",{className:"cw-tab-content",children:e.jsxs("div",{className:"cw-tasks-layout",children:[e.jsxs("div",{className:"cw-panel",children:[e.jsxs("div",{className:"cw-panel-title",children:[e.jsx("i",{className:"fas fa-tasks"})," Internal Tasks"]}),e.jsxs("div",{className:"cw-task-form",children:[e.jsx("input",{className:"cw-input",placeholder:"Task title",value:f.title,onChange:y=>p(j=>({...j,title:y.target.value})),onKeyDown:y=>y.key==="Enter"&&v()}),e.jsxs("div",{style:{display:"flex",gap:8},children:[e.jsx("input",{className:"cw-input",placeholder:"Assign to",value:f.assignee,onChange:y=>p(j=>({...j,assignee:y.target.value}))}),e.jsx("input",{type:"date",className:"cw-input",value:f.due,onChange:y=>p(j=>({...j,due:y.target.value}))})]}),e.jsxs("button",{className:"btn btn-primary btn-sm",onClick:v,children:[e.jsx("i",{className:"fas fa-plus"})," Add Task"]})]}),i.length===0?e.jsx("div",{style:{color:"#9ca3af",fontSize:13,textAlign:"center",padding:"20px 0"},children:"No tasks yet. Add one above."}):i.map(y=>e.jsxs("div",{className:"cw-task-item",children:[e.jsxs("div",{children:[e.jsx("div",{className:"cw-task-title",children:y.title}),e.jsxs("div",{className:"cw-task-meta",children:[y.assignee&&e.jsxs("span",{children:[e.jsx("i",{className:"fas fa-user"})," ",y.assignee]}),y.due&&e.jsxs("span",{children:[e.jsx("i",{className:"fas fa-calendar"})," ",y.due]})]})]}),e.jsxs("button",{className:"btn btn-sm btn-outline",onClick:()=>b(y.id),children:[e.jsx("i",{className:"fas fa-check"})," Done"]})]},y.id))]}),e.jsxs("div",{className:"cw-panel",children:[e.jsxs("div",{className:"cw-panel-title",children:[e.jsx("i",{className:"fas fa-comment-alt"})," Internal Notes"]}),e.jsxs("div",{className:"cw-task-form",children:[e.jsx("textarea",{className:"cw-input",placeholder:"Add an internal note",value:x,onChange:y=>m(y.target.value),style:{minHeight:80,resize:"vertical"}}),e.jsxs("button",{className:"btn btn-primary btn-sm",onClick:g,children:[e.jsx("i",{className:"fas fa-comment"})," Add Note"]})]}),o.length===0?e.jsx("div",{style:{color:"#9ca3af",fontSize:13,textAlign:"center",padding:"20px 0"},children:"No notes yet."}):o.map((y,j)=>e.jsxs("div",{className:"cw-note-item",children:[e.jsx("div",{className:"cw-note-text",children:y.text}),e.jsxs("div",{className:"cw-note-meta",children:[e.jsx("i",{className:"fas fa-user"})," ",y.by,"",e.jsx("i",{className:"fas fa-clock"})," ",na(y.created)]})]},j))]})]})})}function Cm({app:s,onClose:i,onUpdated:r}){const[o,d]=u.useState({close_reason:"",winner_lender:"",final_amount:"",final_roi:"",close_notes:""}),[f,p]=u.useState(!1),x=["SANCTIONED","CONDITIONAL_SANCTION","SANCTION_ACCEPTED"].includes(s.status),m=async()=>{if(!o.close_reason){T.error("Select a close reason");return}p(!0);try{await Ae.updateApplication(s.id,{status:o.winner_lender?"DISBURSED":"CLOSED",sub_status:o.close_reason,notes:`Closed: ${o.close_reason}. ${o.close_notes}`}),T.success("Case closed successfully"),r(),i()}catch(v){T.error(v.message||"Failed to close case")}p(!1)};return e.jsx("div",{className:"cw-tab-content",children:e.jsxs("div",{className:"cw-panel",style:{maxWidth:640},children:[e.jsxs("div",{className:"cw-panel-title",children:[e.jsx("i",{className:"fas fa-flag-checkered"})," Close Case / Outcome"]}),x&&e.jsxs("div",{className:"bank-panel-note",style:{marginBottom:16},children:[e.jsx("i",{className:"fas fa-star",style:{marginRight:6}}),"This case has a sanction. Select the winner lender to record the outcome."]}),e.jsxs("div",{className:"form-group",style:{marginBottom:12},children:[e.jsx("label",{children:"Case Closed Reason (required)"}),e.jsxs("select",{value:o.close_reason,onChange:v=>d(g=>({...g,close_reason:v.target.value})),children:[e.jsx("option",{value:"",children:" Select close reason "}),Hf.map(v=>e.jsx("option",{value:v,children:v.replace(/_/g," ")},v))]})]}),x&&e.jsxs("div",{className:"form-group",style:{marginBottom:12},children:[e.jsx("label",{children:"Winner Lender (from sanctioned lenders)"}),e.jsxs("select",{value:o.winner_lender,onChange:v=>d(g=>({...g,winner_lender:v.target.value})),children:[e.jsx("option",{value:"",children:" Select winner "}),e.jsxs("option",{value:s.bank,children:[s.bank," (Sanctioned)"]})]})]}),e.jsxs("div",{className:"form-row",style:{marginBottom:12},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Final Loan Amount (optional)"}),e.jsx("input",{type:"number",value:o.final_amount,onChange:v=>d(g=>({...g,final_amount:v.target.value})),placeholder:"e.g. 2500000"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Final ROI (optional)"}),e.jsx("input",{value:o.final_roi,onChange:v=>d(g=>({...g,final_roi:v.target.value})),placeholder:"e.g. 9.5"})]})]}),e.jsxs("div",{className:"form-group",style:{marginBottom:16},children:[e.jsx("label",{children:"Close Notes"}),e.jsx("textarea",{value:o.close_notes,onChange:v=>d(g=>({...g,close_notes:v.target.value})),placeholder:"Notes about the closure",style:{minHeight:80}})]}),o.winner_lender&&e.jsxs("div",{className:"bank-panel-note",style:{marginBottom:16},children:[e.jsx("i",{className:"fas fa-info-circle",style:{marginRight:6}}),'Selecting a winner will auto-close all other lender applications with reason "Student chose another lender".']}),e.jsxs("button",{className:"btn btn-primary",onClick:m,disabled:f,style:{background:"#dc2626"},children:[e.jsx("i",{className:`fas ${f?"fa-spinner fa-spin":"fa-flag-checkered"}`}),f?"Closing":"Close Case"]})]})})}const _m=["MIT","Stanford","University of Toronto","UCL London","TU Munich","NUS Singapore","University of Melbourne","ETH Zurich","Columbia University","University of Oxford"],wm=["MS Computer Science","MBA Finance","MS Data Science","MEng Mechanical","MS AI/ML","MBA General","MS Biotechnology","LLM International Law","MS Electrical Eng","PhD Physics"];function Zf({onClose:s,onCreated:i}){const[r,o]=u.useState({student_name:"",student_email:"",bank:"SBI",university:"MIT",course:"MS Computer Science",priority:"Normal",notes:""}),[d,f]=u.useState(!1),p=async x=>{if(x.preventDefault(),!r.student_name||!r.student_email||!r.bank){T.error("Please fill all required fields");return}f(!0);try{await Ae.createApplication(r),T.success("Application created successfully"),i==null||i(),s()}catch(m){T.error(m.message||"Creation failed")}f(!1)};return e.jsx("div",{className:"modal-overlay show",onClick:x=>x.target===x.currentTarget&&s(),children:e.jsxs("div",{className:"modal",style:{maxWidth:600},children:[e.jsxs("div",{className:"modal-header",children:[e.jsxs("h3",{children:[e.jsx("i",{className:"fas fa-plus-circle",style:{marginRight:8}})," New Bank Application"]}),e.jsx("button",{className:"modal-close",onClick:s,children:e.jsx("i",{className:"fas fa-times"})})]}),e.jsx("div",{className:"modal-body",children:e.jsxs("form",{onSubmit:p,children:[e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Student Name *"}),e.jsx("input",{type:"text",value:r.student_name,onChange:x=>o(m=>({...m,student_name:x.target.value})),placeholder:"Full name",required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Student Email *"}),e.jsx("input",{type:"email",value:r.student_email,onChange:x=>o(m=>({...m,student_email:x.target.value})),placeholder:"email@example.com",required:!0})]})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Bank / Lender *"}),e.jsx("select",{value:r.bank,onChange:x=>o(m=>({...m,bank:x.target.value})),children:Gf.map(x=>e.jsx("option",{value:x,children:x},x))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Priority"}),e.jsxs("select",{value:r.priority,onChange:x=>o(m=>({...m,priority:x.target.value})),children:[e.jsx("option",{children:"Normal"}),e.jsx("option",{children:"High"}),e.jsx("option",{children:"Urgent"})]})]})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"University *"}),e.jsx("select",{value:r.university,onChange:x=>o(m=>({...m,university:x.target.value})),children:_m.map(x=>e.jsx("option",{value:x,children:x},x))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Course *"}),e.jsx("select",{value:r.course,onChange:x=>o(m=>({...m,course:x.target.value})),children:wm.map(x=>e.jsx("option",{value:x,children:x},x))})]})]}),e.jsxs("div",{className:"form-group",style:{marginTop:8},children:[e.jsx("label",{children:"Notes"}),e.jsx("textarea",{value:r.notes,onChange:x=>o(m=>({...m,notes:x.target.value})),placeholder:"Optional notes..."})]}),e.jsxs("div",{className:"form-actions",children:[e.jsx("button",{type:"button",className:"btn btn-outline",onClick:s,children:"Cancel"}),e.jsxs("button",{type:"submit",className:"btn btn-primary",disabled:d,children:[e.jsx("i",{className:`fas ${d?"fa-spinner fa-spin":"fa-plus"}`})," ",d?"Creating...":"Create Application"]})]})]})})]})})}function Xf(){const[s,i]=u.useState([]),[r,o]=u.useState(!0),[d,f]=u.useState(!1),[p,x]=u.useState(null);function m(){o(!0),Xa.getUsers().then(i).catch(()=>{}).finally(()=>o(!1))}u.useEffect(()=>{m()},[]);function v(g,b){window.confirm(`Delete user "${b}"? This cannot be undone.`)&&Xa.deleteUser(g).then(m).catch(()=>alert("Delete failed"))}return e.jsxs("div",{children:[e.jsxs("div",{className:"page-header",children:[e.jsxs("div",{children:[e.jsx("h2",{children:"User Management"}),e.jsx("div",{className:"subtitle",children:"Manage portal users and their access"})]}),e.jsxs("button",{className:"btn btn-primary",onClick:()=>{x(null),f(!0)},children:[e.jsx("i",{className:"fas fa-plus"})," Add User"]})]}),e.jsx("div",{className:"card",style:{padding:0,overflow:"hidden"},children:r?e.jsx("div",{style:{padding:40,textAlign:"center",color:"var(--text-muted)"},children:"Loading..."}):e.jsxs("table",{className:"app-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Email"}),e.jsx("th",{children:"Role"}),e.jsx("th",{children:"Bank"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Created"}),e.jsx("th",{children:"Actions"})]})}),e.jsxs("tbody",{children:[s.map(g=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("strong",{children:g.name})}),e.jsx("td",{style:{color:"var(--text-secondary)"},children:g.email}),e.jsx("td",{children:e.jsx("span",{className:`badge ${g.role==="super_admin"?"badge-blue":"badge-grey"}`,children:g.role==="super_admin"?"Super Admin":"Bank User"})}),e.jsx("td",{children:g.bank||e.jsx("span",{style:{color:"var(--text-muted)"},children:""})}),e.jsx("td",{children:e.jsx("span",{className:`badge ${g.is_active?"badge-green":"badge-red"}`,children:g.is_active?"Active":"Inactive"})}),e.jsx("td",{style:{color:"var(--text-muted)",fontSize:13},children:dt(g.created_at)}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",gap:8},children:[e.jsx("button",{className:"btn-icon",title:"Edit",onClick:()=>{x(g),f(!0)},children:e.jsx("i",{className:"fas fa-pencil-alt"})}),e.jsx("button",{className:"btn-icon btn-icon-danger",title:"Delete",onClick:()=>v(g.id,g.name),children:e.jsx("i",{className:"fas fa-trash"})})]})})]},g.id)),s.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:7,style:{textAlign:"center",color:"var(--text-muted)",padding:32},children:"No users found"})})]})]})}),d&&e.jsx(Em,{user:p,onClose:()=>f(!1),onSaved:()=>{f(!1),m()}})]})}function Em({user:s,onClose:i,onSaved:r}){const o=!!s,[d,f]=u.useState((s==null?void 0:s.name)||""),[p,x]=u.useState((s==null?void 0:s.email)||""),[m,v]=u.useState(""),[g,b]=u.useState((s==null?void 0:s.role)||"bank_user"),[y,j]=u.useState((s==null?void 0:s.bank)||""),[k,_]=u.useState((s==null?void 0:s.is_active)!==void 0?!!s.is_active:!0),[C,L]=u.useState(!1),[D,I]=u.useState("");async function P(w){w.preventDefault(),I(""),L(!0);try{const A={name:d,role:g,bank:g==="bank_user"?y:null};o?(A.is_active=k,await Xa.updateUser(s.id,A)):(A.email=p,A.password=m,await Xa.createUser(A)),r()}catch(A){I(A.message||"Save failed")}finally{L(!1)}}return e.jsx("div",{className:"modal-overlay show",onClick:i,children:e.jsxs("div",{className:"modal",style:{maxWidth:480,height:"auto"},onClick:w=>w.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{children:o?"Edit User":"Add User"}),e.jsx("button",{className:"modal-close",onClick:i,children:e.jsx("i",{className:"fas fa-times"})})]}),e.jsxs("form",{onSubmit:P,style:{padding:24},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Full Name"}),e.jsx("input",{className:"form-control",value:d,onChange:w=>f(w.target.value),required:!0})]}),!o&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Email"}),e.jsx("input",{type:"email",className:"form-control",value:p,onChange:w=>x(w.target.value),required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Password"}),e.jsx("input",{type:"password",className:"form-control",value:m,onChange:w=>v(w.target.value),required:!0,minLength:6})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Role"}),e.jsxs("select",{className:"form-control",value:g,onChange:w=>b(w.target.value),children:[e.jsx("option",{value:"super_admin",children:"Super Admin"}),e.jsx("option",{value:"bank_user",children:"Bank User"})]})]}),g==="bank_user"&&e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Bank"}),e.jsxs("select",{className:"form-control",value:y,onChange:w=>j(w.target.value),required:!0,children:[e.jsx("option",{value:"",children:"Select bank..."}),Gf.map(w=>e.jsx("option",{value:w,children:w},w))]})]}),o&&e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Status"}),e.jsxs("select",{className:"form-control",value:k?"1":"0",onChange:w=>_(w.target.value==="1"),children:[e.jsx("option",{value:"1",children:"Active"}),e.jsx("option",{value:"0",children:"Inactive"})]})]}),D&&e.jsx("div",{className:"login-error",style:{marginBottom:12},children:D}),e.jsxs("div",{style:{display:"flex",gap:10,justifyContent:"flex-end"},children:[e.jsx("button",{type:"button",className:"btn btn-outline",onClick:i,children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:C,children:C?"Saving...":o?"Save Changes":"Create User"})]})]})]})})}const eh={NEW:{bg:"#e3f2fd",color:"#1565c0",label:"NEW"},CONTACT_ATTEMPTED:{bg:"#f3e5f5",color:"#7b1fa2",label:"ATTEMPTED"},CONNECTED:{bg:"#ede7f6",color:"#512da8",label:"CONNECTED"},QUALIFIED:{bg:"#fff8e1",color:"#f57f17",label:"QUALIFIED"},DOCS_REQUESTED:{bg:"#e0f7fa",color:"#00695c",label:"DOCS REQ"},DOCS_RECEIVED:{bg:"#e0f2f1",color:"#00695c",label:"DOCS RCVD"},CASE_CREATED:{bg:"#e8f5e9",color:"#2e7d32",label:"CASE MADE"},DROPPED:{bg:"#eceff1",color:"#546e7a",label:"DROPPED"},LOST:{bg:"#fbe9e7",color:"#bf360c",label:"LOST"},DUPLICATE:{bg:"#f5f5f5",color:"#757575",label:"DUPLICATE"}},Rm={META_LEAD_FORM:{bg:"#1877f2",color:"#fff",label:"META"},META_WHATSAPP:{bg:"#25d366",color:"#fff",label:"WA"},WEBSITE_FORM:{bg:"#0288d1",color:"#fff",label:"WEB"},EVENT:{bg:"#7b1fa2",color:"#fff",label:"EVENT"},ADMISSION_CRM:{bg:"#2e7d32",color:"#fff",label:"ADMN"},MANUAL_ENTRY:{bg:"#757575",color:"#fff",label:"MANUAL"},IMPORT_CSV:{bg:"#546e7a",color:"#fff",label:"CSV"},WALK_IN:{bg:"#e65100",color:"#fff",label:"WALK-IN"},REFERRAL:{bg:"#6a1b9a",color:"#fff",label:"REF"},API:{bg:"#00695c",color:"#fff",label:"API"},META:{bg:"#1877f2",color:"#fff",label:"META"},GOOGLE:{bg:"#ea4335",color:"#fff",label:"GOOGLE"},WEBSITE:{bg:"#0288d1",color:"#fff",label:"WEB"},MANUAL:{bg:"#757575",color:"#fff",label:"MANUAL"}};function Am({stage:s}){const i=eh[s]||{bg:"#f5f5f5",color:"#666",label:s};return e.jsx("span",{style:{background:i.bg,color:i.color,padding:"2px 10px",borderRadius:12,fontSize:11,fontWeight:700,letterSpacing:.5},children:i.label})}function Tm({lead:s}){const i=s.lead_source_type||s.source||"MANUAL",r=Rm[i]||{bg:"#9e9e9e",color:"#fff",label:i};return e.jsx("span",{style:{background:r.bg,color:r.color,padding:"2px 8px",borderRadius:8,fontSize:11,fontWeight:700,letterSpacing:.3},children:r.label})}function zm({score:s}){if(!s&&s!==0)return e.jsx("span",{style:{color:"#bbb",fontSize:11},children:""});const i=s>=80,r=s>=80?"#c62828":s>=60?"#e65100":s>=40?"#f57f17":"#546e7a";return e.jsxs("span",{style:{fontWeight:700,color:r,fontSize:12},children:[i&&"",s]})}function Zu(s){if(!s)return"";const i=s/1e7;return i>=1?`${i.toFixed(1)}L`:`${(s/100).toLocaleString("en-IN")}`}function Xu(s){if(!s)return"";const i=Date.now()-new Date(s).getTime(),r=Math.floor(i/6e4);if(r<1)return"just now";if(r<60)return`${r}m ago`;const o=Math.floor(r/60);return o<24?`${o}h ago`:`${Math.floor(o/24)}d ago`}function Dm(s){if(!s)return"";const i=new Date(s),r=new Date,o=i-r,d=Math.floor(o/6e4);return d<-30?e.jsx("span",{style:{color:"#c62828",fontWeight:700},children:" Overdue"}):d<0?e.jsx("span",{style:{color:"#e65100",fontWeight:600},children:"Due now"}):d<60?e.jsxs("span",{style:{color:"#f57f17",fontWeight:600},children:["In ",d,"m"]}):r.toDateString()===i.toDateString()?e.jsxs("span",{style:{color:"#1565c0"},children:["Today ",i.toLocaleTimeString("en-IN",{hour:"2-digit",minute:"2-digit"})]}):i.toLocaleDateString("en-IN",{day:"2-digit",month:"short"})}function Gn({label:s,count:i,color:r,bg:o,active:d,onClick:f}){return e.jsxs("div",{onClick:f,style:{background:d?r:o||"#fff",color:d?"#fff":r,border:`2px solid ${r}`,borderRadius:12,padding:"14px 20px",cursor:"pointer",minWidth:100,textAlign:"center",transition:"all 0.2s",boxShadow:d?`0 4px 12px ${r}40`:"0 1px 4px rgba(0,0,0,0.08)"},children:[e.jsx("div",{style:{fontSize:28,fontWeight:800},children:i}),e.jsx("div",{style:{fontSize:11,fontWeight:600,marginTop:2,opacity:d?.9:.8},children:s})]})}const Lm=[{key:"all",label:"All Leads"},{key:"mine",label:" My Leads Today"},{key:"followup",label:" Follow-up Due"},{key:"overdue",label:" Overdue"},{key:"highvalue",label:" High Value"}];function th({onOpenLead:s}){const[i,r]=u.useState([]),[o,d]=u.useState(null),[f,p]=u.useState(null),[x,m]=u.useState(0),[v,g]=u.useState(1),[b,y]=u.useState(1),[j,k]=u.useState(!0),[_,C]=u.useState("all"),[L,D]=u.useState(""),[I,P]=u.useState({search:"",source_type:"",country:"",priority:""}),[w,A]=u.useState(!1),[N,W]=u.useState(0),F=u.useCallback(()=>W(z=>z+1),[]);u.useEffect(()=>{gt.getStats().then(d).catch(()=>{}),gt.getQueues().then(p).catch(()=>{})},[N]),u.useEffect(()=>{if(_!=="all")return;k(!0);const z={page:v,limit:50};I.search&&(z.search=I.search),I.source_type&&(z.source_type=I.source_type),I.country&&(z.country=I.country),I.priority&&(z.priority=I.priority),L&&(z.stage=L),gt.getLeads(z).then(X=>{r(X.data),m(X.total),y(X.pages)}).catch(()=>{}).finally(()=>k(!1))},[I,L,v,_,N]);const Z=_==="mine"?(f==null?void 0:f.myLeadsToday)||[]:_==="followup"?(f==null?void 0:f.followupDue)||[]:_==="overdue"?(f==null?void 0:f.overdue)||[]:_==="highvalue"?(f==null?void 0:f.highValue)||[]:i,ce=z=>{D(X=>X===z?"":z),C("all"),g(1)},xe=()=>{const z=[["Name","Phone","Source","Country","Loan","Score","Stage","Campaign","Owner","Last Activity","Next Follow-up","Priority"]];Z.forEach(oe=>z.push([oe.full_name,oe.phone_e164,oe.lead_source_type||oe.source,oe.country||"",Zu(oe.loan_amount_paise),oe.intent_score||"",oe.stage,oe.campaign_name||oe.meta_campaign_id||"",oe.assigned_staff_name||"",Xu(oe.last_activity_at),oe.next_followup_at||"",oe.priority]));const X=z.map(oe=>oe.join(",")).join(`
`),de=document.createElement("a");de.href="data:text/csv,"+encodeURIComponent(X),de.download="leads.csv",de.click()};return e.jsxs("div",{style:{padding:"0 0 40px 0"},children:[e.jsxs("div",{className:"page-header",style:{marginBottom:20},children:[e.jsxs("div",{children:[e.jsx("h2",{style:{fontSize:22,fontWeight:700},children:"Lead Management Panel"}),e.jsx("div",{className:"subtitle",children:"Manage, qualify, and convert student inquiries efficiently."})]}),e.jsxs("div",{className:"header-actions",children:[e.jsxs("button",{className:"btn btn-outline",onClick:F,children:[e.jsx("i",{className:"fas fa-sync-alt"})," Refresh"]}),e.jsxs("button",{className:"btn btn-primary",onClick:()=>A(!0),children:[e.jsx("i",{className:"fas fa-plus"})," Add Manual Lead"]})]})]}),o&&o.overdue>0&&e.jsxs("div",{style:{background:"#ffebee",border:"1px solid #ef9a9a",borderRadius:8,padding:"10px 16px",marginBottom:16,display:"flex",alignItems:"center",gap:10,color:"#c62828"},children:[e.jsx("i",{className:"fas fa-exclamation-triangle"}),e.jsxs("strong",{children:[o.overdue," Overdue Leads"]}),"  follow-ups are past due!",e.jsx("button",{onClick:()=>C("overdue"),style:{marginLeft:"auto",background:"#c62828",color:"#fff",border:"none",borderRadius:6,padding:"4px 12px",cursor:"pointer",fontSize:12},children:"View Overdue"})]}),o&&e.jsxs("div",{style:{display:"flex",gap:10,marginBottom:24,flexWrap:"wrap"},children:[e.jsx(Gn,{label:"New Today",count:o.newToday,color:"#1565c0",bg:"#e3f2fd",active:L==="NEW",onClick:()=>ce("NEW")}),e.jsx(Gn,{label:"Connected",count:o.counts.CONNECTED||0,color:"#7b1fa2",bg:"#f3e5f5",active:L==="CONNECTED",onClick:()=>ce("CONNECTED")}),e.jsx(Gn,{label:"Qualified",count:o.counts.QUALIFIED||0,color:"#f57f17",bg:"#fff8e1",active:L==="QUALIFIED",onClick:()=>ce("QUALIFIED")}),e.jsx(Gn,{label:"Docs Rcvd",count:o.counts.DOCS_RECEIVED||0,color:"#00695c",bg:"#e0f2f1",active:L==="DOCS_RECEIVED",onClick:()=>ce("DOCS_RECEIVED")}),e.jsx(Gn,{label:"Case Made",count:o.counts.CASE_CREATED||0,color:"#2e7d32",bg:"#e8f5e9",active:L==="CASE_CREATED",onClick:()=>ce("CASE_CREATED")}),e.jsx(Gn,{label:"Dropped",count:o.counts.DROPPED||0,color:"#546e7a",bg:"#eceff1",active:L==="DROPPED",onClick:()=>ce("DROPPED")}),e.jsx(Gn,{label:"Lost",count:o.counts.LOST||0,color:"#bf360c",bg:"#fbe9e7",active:L==="LOST",onClick:()=>ce("LOST")}),e.jsx(Gn,{label:"High Value",count:o.highValue||0,color:"#e65100",bg:"#fff3e0",active:!1,onClick:()=>C("highvalue")})]}),e.jsx("div",{style:{display:"flex",gap:8,marginBottom:16,flexWrap:"wrap"},children:Lm.map(z=>{var X;return e.jsxs("button",{onClick:()=>{C(z.key),g(1)},style:{padding:"6px 14px",borderRadius:20,border:`1.5px solid ${_===z.key?"#1a237e":"#ddd"}`,background:_===z.key?"#1a237e":"#fff",color:_===z.key?"#fff":"#333",fontWeight:_===z.key?700:400,cursor:"pointer",fontSize:13},children:[z.label,z.key==="overdue"&&((X=f==null?void 0:f.overdue)==null?void 0:X.length)>0&&e.jsx("span",{style:{marginLeft:6,background:"#c62828",color:"#fff",borderRadius:10,fontSize:10,padding:"1px 6px",fontWeight:700},children:f.overdue.length})]},z.key)})}),e.jsxs("div",{style:{background:"#fff",borderRadius:10,padding:"14px 16px",marginBottom:16,boxShadow:"0 1px 4px rgba(0,0,0,0.07)",display:"flex",gap:10,flexWrap:"wrap",alignItems:"center"},children:[e.jsx("input",{placeholder:" Search name / phone",value:I.search,onChange:z=>{P(X=>({...X,search:z.target.value})),g(1),C("all")},style:{flex:1,minWidth:180,padding:"7px 12px",border:"1px solid #e0e0e0",borderRadius:8,fontSize:13}}),e.jsxs("select",{value:I.source_type,onChange:z=>{P(X=>({...X,source_type:z.target.value})),g(1),C("all")},style:{padding:"7px 10px",border:"1px solid #e0e0e0",borderRadius:8,fontSize:13},children:[e.jsx("option",{value:"",children:"Source "}),e.jsx("option",{value:"META_LEAD_FORM",children:"Meta Lead Form"}),e.jsx("option",{value:"META_WHATSAPP",children:"Meta WhatsApp"}),e.jsx("option",{value:"WEBSITE_FORM",children:"Website Form"}),e.jsx("option",{value:"EVENT",children:"Event"}),e.jsx("option",{value:"ADMISSION_CRM",children:"Admission CRM"}),e.jsx("option",{value:"MANUAL_ENTRY",children:"Manual Entry"}),e.jsx("option",{value:"IMPORT_CSV",children:"Import CSV"}),e.jsx("option",{value:"WALK_IN",children:"Walk-in"}),e.jsx("option",{value:"REFERRAL",children:"Referral"}),e.jsx("option",{value:"API",children:"API"})]}),e.jsxs("select",{value:I.country,onChange:z=>{P(X=>({...X,country:z.target.value})),g(1),C("all")},style:{padding:"7px 10px",border:"1px solid #e0e0e0",borderRadius:8,fontSize:13},children:[e.jsx("option",{value:"",children:"Country "}),e.jsx("option",{children:"UK"}),e.jsx("option",{children:"USA"}),e.jsx("option",{children:"Canada"}),e.jsx("option",{children:"Australia"}),e.jsx("option",{children:"Ireland"}),e.jsx("option",{children:"Germany"})]}),e.jsxs("select",{value:L,onChange:z=>{D(z.target.value),g(1),C("all")},style:{padding:"7px 10px",border:"1px solid #e0e0e0",borderRadius:8,fontSize:13},children:[e.jsx("option",{value:"",children:"Stage "}),Object.keys(eh).map(z=>e.jsx("option",{children:z},z))]}),e.jsxs("select",{value:I.priority,onChange:z=>{P(X=>({...X,priority:z.target.value})),g(1),C("all")},style:{padding:"7px 10px",border:"1px solid #e0e0e0",borderRadius:8,fontSize:13},children:[e.jsx("option",{value:"",children:"Priority "}),e.jsx("option",{children:"NORMAL"}),e.jsx("option",{children:"HIGH"}),e.jsx("option",{children:"URGENT"})]}),e.jsx("button",{onClick:()=>{P({search:"",source_type:"",country:"",priority:""}),D(""),g(1),C("all")},style:{padding:"7px 12px",border:"1px solid #e0e0e0",borderRadius:8,fontSize:13,background:"#f5f5f5",cursor:"pointer"},children:"Reset"}),e.jsxs("button",{onClick:xe,style:{padding:"7px 12px",border:"1px solid #1a237e",borderRadius:8,fontSize:13,background:"#fff",color:"#1a237e",cursor:"pointer"},children:[e.jsx("i",{className:"fas fa-download"})," Export CSV"]})]}),e.jsxs("div",{style:{background:"#fff",borderRadius:10,boxShadow:"0 1px 4px rgba(0,0,0,0.07)",overflow:"hidden"},children:[e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:13},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{background:"#f5f6fa",borderBottom:"2px solid #e0e0e0"},children:[e.jsx("th",{style:Ut,children:"Name"}),e.jsx("th",{style:Ut,children:"Phone"}),e.jsx("th",{style:Ut,children:"Source"}),e.jsx("th",{style:Ut,children:"Country"}),e.jsx("th",{style:Ut,children:"Loan"}),e.jsx("th",{style:Ut,children:"Score"}),e.jsx("th",{style:Ut,children:"Campaign"}),e.jsx("th",{style:Ut,children:"Stage"}),e.jsx("th",{style:Ut,children:"Owner"}),e.jsx("th",{style:Ut,children:"Last Activity"}),e.jsx("th",{style:Ut,children:"Next Follow-up"}),e.jsx("th",{style:Ut,children:"Action"})]})}),e.jsx("tbody",{children:j&&_==="all"?e.jsx("tr",{children:e.jsx("td",{colSpan:12,style:{textAlign:"center",padding:40,color:"#999"},children:"Loading"})}):Z.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:12,style:{textAlign:"center",padding:40,color:"#999"},children:"No leads found"})}):Z.map(z=>{const X=z.stage==="NEW",de=z.next_followup_at&&new Date(z.next_followup_at)<new Date(Date.now()-30*6e4),oe=z.next_followup_at&&new Date(z.next_followup_at)>new Date&&new Date(z.next_followup_at)<new Date(Date.now()+30*6e4),ve=z.loan_amount_paise>=3e6,Y=z.intent_score>=80,se=z.stage==="NEW"&&!z.last_activity_at,J={borderBottom:"1px solid #f0f0f0",borderLeft:`4px solid ${de?"#c62828":X?"#1565c0":oe?"#f57f17":"transparent"}`,background:de?"#fff5f5":"transparent",transition:"background 0.15s"};return e.jsxs("tr",{style:J,onMouseEnter:O=>O.currentTarget.style.background=de?"#ffebee":"#f9fafe",onMouseLeave:O=>O.currentTarget.style.background=de?"#fff5f5":"transparent",children:[e.jsxs("td",{style:Vt,children:[e.jsxs("div",{style:{fontWeight:600},children:[z.full_name,ve&&e.jsx("span",{title:"High Value (>30L)",style:{marginLeft:4},children:""}),Y&&e.jsx("span",{title:"Hot score  80",style:{marginLeft:2},children:""})]}),de&&e.jsx("div",{style:{fontSize:10,color:"#c62828",fontWeight:700},children:"OVERDUE"}),z.city&&e.jsx("div",{style:{fontSize:11,color:"#888"},children:z.city})]}),e.jsx("td",{style:Vt,children:e.jsxs("span",{style:{fontFamily:"monospace",fontSize:12},children:[se&&e.jsx("span",{title:"Not contacted",style:{marginRight:4},children:""}),z.phone_e164]})}),e.jsx("td",{style:Vt,children:e.jsx(Tm,{lead:z})}),e.jsx("td",{style:Vt,children:z.country||""}),e.jsx("td",{style:Vt,children:Zu(z.loan_amount_paise)}),e.jsx("td",{style:Vt,children:e.jsx(zm,{score:z.intent_score})}),e.jsx("td",{style:Vt,children:z.campaign_name||z.meta_campaign_id?e.jsxs("span",{style:{fontSize:11,color:"#555",maxWidth:100,display:"inline-block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},title:z.campaign_name||z.meta_campaign_id,children:[(z.campaign_name||z.meta_campaign_id||"").slice(0,14),(z.campaign_name||z.meta_campaign_id||"").length>14?"":""]}):e.jsx("span",{style:{color:"#ccc"},children:""})}),e.jsx("td",{style:Vt,children:e.jsx(Am,{stage:z.stage})}),e.jsx("td",{style:Vt,children:z.assigned_staff_name||e.jsx("span",{style:{color:"#aaa"},children:"Unassigned"})}),e.jsx("td",{style:Vt,children:Xu(z.last_activity_at)}),e.jsx("td",{style:Vt,children:Dm(z.next_followup_at)}),e.jsx("td",{style:Vt,children:e.jsx("button",{onClick:()=>s(z.id),style:{padding:"5px 14px",background:"#1a237e",color:"#fff",border:"none",borderRadius:6,cursor:"pointer",fontSize:12,fontWeight:600},children:"Open"})})]},z.id)})})]}),_==="all"&&b>1&&e.jsxs("div",{style:{padding:"12px 16px",display:"flex",justifyContent:"space-between",alignItems:"center",borderTop:"1px solid #f0f0f0",fontSize:13},children:[e.jsxs("span",{style:{color:"#666"},children:["Showing ",Z.length," of ",x," leads"]}),e.jsxs("div",{style:{display:"flex",gap:6},children:[e.jsx("button",{onClick:()=>g(z=>Math.max(1,z-1)),disabled:v===1,style:{padding:"4px 12px",border:"1px solid #ddd",borderRadius:6,cursor:"pointer",background:"#fff"},children:" Prev"}),e.jsxs("span",{style:{padding:"4px 12px",color:"#555"},children:["Page ",v," / ",b]}),e.jsx("button",{onClick:()=>g(z=>Math.min(b,z+1)),disabled:v===b,style:{padding:"4px 12px",border:"1px solid #ddd",borderRadius:6,cursor:"pointer",background:"#fff"},children:"Next "})]})]})]}),w&&e.jsx(Im,{onClose:()=>A(!1),onCreated:()=>{A(!1),F()}})]})}const Ut={padding:"11px 14px",textAlign:"left",fontWeight:700,fontSize:12,color:"#555",whiteSpace:"nowrap"},Vt={padding:"10px 14px",verticalAlign:"middle"};function Im({onClose:s,onCreated:i}){const[r,o]=u.useState({full_name:"",phone_e164:"",email:"",city:"",source:"MANUAL",lead_source_type:"MANUAL_ENTRY",campaign_name:"",country:"",course:"",loan_amount_paise:"",priority:"NORMAL",intent_score:"50"}),[d,f]=u.useState(!1),p=(m,v)=>o(g=>({...g,[m]:v})),x=async m=>{if(m.preventDefault(),!r.full_name||!r.phone_e164)return T.error("Name and phone required");f(!0);try{const v={...r,loan_amount_paise:r.loan_amount_paise?Math.round(parseFloat(r.loan_amount_paise)*100):null,intent_score:r.intent_score?parseInt(r.intent_score):50};await gt.createLead(v),T.success("Lead added successfully!"),i()}catch(v){T.error(v.message)}finally{f(!1)}};return e.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.45)",zIndex:1200,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsxs("div",{style:{background:"#fff",borderRadius:12,padding:32,width:520,maxHeight:"90vh",overflowY:"auto",boxShadow:"0 8px 32px rgba(0,0,0,0.2)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:20},children:[e.jsx("h3",{style:{fontSize:18,fontWeight:700},children:"Add Manual Lead"}),e.jsx("button",{onClick:s,style:{background:"none",border:"none",fontSize:20,cursor:"pointer",color:"#666"},children:""})]}),e.jsxs("form",{onSubmit:x,style:{display:"flex",flexDirection:"column",gap:14},children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[e.jsxs("div",{children:[e.jsx("label",{style:tn,children:"Full Name *"}),e.jsx("input",{style:nn,value:r.full_name,onChange:m=>p("full_name",m.target.value),placeholder:"Varun Kumar"})]}),e.jsxs("div",{children:[e.jsx("label",{style:tn,children:"Phone (E.164) *"}),e.jsx("input",{style:nn,value:r.phone_e164,onChange:m=>p("phone_e164",m.target.value),placeholder:"+918848087657"})]}),e.jsxs("div",{children:[e.jsx("label",{style:tn,children:"Email"}),e.jsx("input",{style:nn,type:"email",value:r.email,onChange:m=>p("email",m.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{style:tn,children:"City"}),e.jsx("input",{style:nn,value:r.city,onChange:m=>p("city",m.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{style:tn,children:"Source Type"}),e.jsxs("select",{style:nn,value:r.lead_source_type,onChange:m=>p("lead_source_type",m.target.value),children:[e.jsx("option",{value:"MANUAL_ENTRY",children:"Manual Entry"}),e.jsx("option",{value:"META_LEAD_FORM",children:"Meta Lead Form"}),e.jsx("option",{value:"META_WHATSAPP",children:"Meta WhatsApp"}),e.jsx("option",{value:"WEBSITE_FORM",children:"Website Form"}),e.jsx("option",{value:"EVENT",children:"Event"}),e.jsx("option",{value:"ADMISSION_CRM",children:"Admission CRM"}),e.jsx("option",{value:"WALK_IN",children:"Walk-in"}),e.jsx("option",{value:"REFERRAL",children:"Referral"})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:tn,children:"Campaign Name"}),e.jsx("input",{style:nn,value:r.campaign_name,onChange:m=>p("campaign_name",m.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{style:tn,children:"Country Interested"}),e.jsxs("select",{style:nn,value:r.country,onChange:m=>p("country",m.target.value),children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{children:"UK"}),e.jsx("option",{children:"USA"}),e.jsx("option",{children:"Canada"}),e.jsx("option",{children:"Australia"}),e.jsx("option",{children:"Ireland"}),e.jsx("option",{children:"Germany"})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:tn,children:"Course"}),e.jsx("input",{style:nn,value:r.course,onChange:m=>p("course",m.target.value),placeholder:"MSc Data Science"})]}),e.jsxs("div",{children:[e.jsx("label",{style:tn,children:"Loan Amount ()"}),e.jsx("input",{style:nn,type:"number",value:r.loan_amount_paise,onChange:m=>p("loan_amount_paise",m.target.value),placeholder:"2500000"})]}),e.jsxs("div",{children:[e.jsx("label",{style:tn,children:"Priority"}),e.jsxs("select",{style:nn,value:r.priority,onChange:m=>p("priority",m.target.value),children:[e.jsx("option",{children:"NORMAL"}),e.jsx("option",{children:"HIGH"}),e.jsx("option",{children:"URGENT"})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:tn,children:"Intent Score (0100)"}),e.jsx("input",{style:nn,type:"number",min:"0",max:"100",value:r.intent_score,onChange:m=>p("intent_score",m.target.value)})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:10,marginTop:8},children:[e.jsx("button",{type:"button",onClick:s,style:{padding:"8px 20px",border:"1px solid #ddd",borderRadius:8,cursor:"pointer",background:"#fff"},children:"Cancel"}),e.jsx("button",{type:"submit",disabled:d,style:{padding:"8px 20px",background:"#1a237e",color:"#fff",border:"none",borderRadius:8,cursor:"pointer",fontWeight:600},children:d?"Creating":"Create Lead"})]})]})]})})}const tn={display:"block",fontSize:12,fontWeight:600,color:"#555",marginBottom:4},nn={width:"100%",padding:"8px 10px",border:"1px solid #e0e0e0",borderRadius:7,fontSize:13,boxSizing:"border-box"},Go={NEW:{color:"#1565c0",bg:"#e3f2fd"},CONTACT_ATTEMPTED:{color:"#7b1fa2",bg:"#f3e5f5"},CONNECTED:{color:"#512da8",bg:"#ede7f6"},QUALIFIED:{color:"#f57f17",bg:"#fff8e1"},DOCS_REQUESTED:{color:"#00695c",bg:"#e0f7fa"},DOCS_RECEIVED:{color:"#00695c",bg:"#e0f2f1"},CASE_CREATED:{color:"#2e7d32",bg:"#e8f5e9"},DROPPED:{color:"#546e7a",bg:"#eceff1"},LOST:{color:"#bf360c",bg:"#fbe9e7"},DUPLICATE:{color:"#757575",bg:"#f5f5f5"}},vl={META_LEAD_FORM:"Meta Lead Form",META_WHATSAPP:"Meta WhatsApp",WEBSITE_FORM:"Website Form",EVENT:"Event",ADMISSION_CRM:"Admission CRM",MANUAL_ENTRY:"Manual Entry",IMPORT_CSV:"Import CSV",WALK_IN:"Walk-in",REFERRAL:"Referral",API:"API"},Pm={CREATED:{icon:"",color:"#1565c0"},CALL:{icon:"",color:"#2e7d32"},NOTE:{icon:"",color:"#6a1b9a"},STAGE_CHANGE:{icon:"",color:"#f57f17"},QUALIFICATION:{icon:"",color:"#00695c"},QUALIFIED:{icon:"",color:"#f57f17"},FOLLOWUP:{icon:"",color:"#1565c0"},FOLLOWUP_DONE:{icon:"",color:"#2e7d32"},DROPPED:{icon:"",color:"#c62828"},CASE_CREATED:{icon:"",color:"#2e7d32"},MERGE:{icon:"",color:"#6a1b9a"}};function Tl({stage:s}){const i=Go[s]||{color:"#666",bg:"#f5f5f5"};return e.jsx("span",{style:{background:i.bg,color:i.color,padding:"3px 12px",borderRadius:12,fontSize:12,fontWeight:700},children:s})}function wo(s){if(!s)return"";const i=s/1e7;return i>=1?`${i.toFixed(1)}L`:`${(s/100).toLocaleString("en-IN")}`}function Zs(s){return s?new Date(s).toLocaleString("en-IN",{day:"2-digit",month:"short",hour:"2-digit",minute:"2-digit"}):""}function Ee({label:s,value:i}){return e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:11,color:"#888",fontWeight:600,marginBottom:2},children:s}),e.jsx("div",{style:{fontSize:13,color:"#222",fontWeight:500},children:i||""})]})}function Xs({icon:s,label:i,color:r,onClick:o}){return e.jsxs("button",{onClick:o,style:{display:"flex",alignItems:"center",gap:5,padding:"6px 12px",background:r+"14",color:r,border:`1.5px solid ${r}40`,borderRadius:8,cursor:"pointer",fontSize:12,fontWeight:600},onMouseEnter:d=>d.currentTarget.style.background=r+"28",onMouseLeave:d=>d.currentTarget.style.background=r+"14",children:[s," ",i]})}function js({title:s,onClose:i,children:r,width:o=420}){return e.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.5)",zIndex:1300,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsxs("div",{style:{background:"#fff",borderRadius:12,padding:28,width:o,maxHeight:"90vh",overflowY:"auto",boxShadow:"0 8px 32px rgba(0,0,0,0.2)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:18},children:[e.jsx("h3",{style:{fontSize:16,fontWeight:700},children:s}),e.jsx("button",{onClick:i,style:{background:"none",border:"none",fontSize:20,cursor:"pointer",color:"#666"},children:""})]}),r]})})}function nh({leadId:s,onClose:i,onOpenCase:r}){const[o,d]=u.useState(null),[f,p]=u.useState(!0),[x,m]=u.useState("overview"),[v,g]=u.useState(!1),[b,y]=u.useState(!1),[j,k]=u.useState(!1),[_,C]=u.useState(!1),[L,D]=u.useState(!1),[I,P]=u.useState(!1),w=u.useCallback(()=>{p(!0),gt.getLead(s).then(d).catch(()=>T.error("Failed to load lead")).finally(()=>p(!1))},[s]);u.useEffect(()=>{w()},[w]);const A=async()=>{if(window.confirm("Mark this lead as DROPPED?"))try{await gt.drop(s,"Manually dropped"),w(),T.success("Lead marked as Dropped")}catch(J){T.error(J.message)}};if(f)return e.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",zIndex:1100,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx("div",{style:{background:"#fff",borderRadius:12,padding:40},children:"Loading lead"})});if(!o)return null;const{lead:N,qualification:W,timeline:F,followups:Z,mapping:ce}=o,xe=Go[N.stage]||{color:"#666",bg:"#f5f5f5"},z=N.is_locked||N.stage==="CASE_CREATED",X=["QUALIFIED","DOCS_RECEIVED"].includes(N.stage)&&!z,de=N.next_followup_at&&new Date(N.next_followup_at)<new Date,oe=["META_LEAD_FORM","META_WHATSAPP","META"].includes(N.lead_source_type||N.source),ve=N.lead_source_type==="ADMISSION_CRM"||!!N.admission_case_id,Y=N.lead_source_type==="EVENT"||!!N.event_registration_id,se=[{key:"overview",label:"Overview"},{key:"qualify",label:"Qualification"},{key:"timeline",label:"Timeline"},{key:"campaign",label:"Campaign Data"},...ve?[{key:"admission",label:"Admission Sync"}]:[],...Y?[{key:"event",label:"Event Info"}]:[],{key:"followups",label:`Followups (${Z.filter(J=>J.status==="SCHEDULED").length})`},{key:"case",label:ce?" Case Link":" Case Link"}];return e.jsxs("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.45)",zIndex:1100,display:"flex",alignItems:"flex-start",justifyContent:"center",paddingTop:20,overflowY:"auto"},children:[e.jsxs("div",{style:{background:"#f0f2f5",borderRadius:12,width:"95vw",maxWidth:1200,minHeight:"80vh",maxHeight:"95vh",overflowY:"auto",boxShadow:"0 12px 40px rgba(0,0,0,0.25)",position:"relative",display:"flex",flexDirection:"column"},children:[e.jsxs("div",{style:{background:"#1a237e",color:"#fff",padding:"14px 24px",borderRadius:"12px 12px 0 0",display:"flex",alignItems:"center",justifyContent:"space-between",flexShrink:0},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[e.jsx("div",{style:{background:"rgba(255,255,255,0.2)",borderRadius:8,padding:"4px 10px",fontSize:12,fontWeight:600},children:N.id}),e.jsx("span",{style:{fontWeight:700,fontSize:16},children:N.full_name}),e.jsx(Tl,{stage:N.stage}),z&&e.jsx("span",{style:{background:"#ffd54f",color:"#333",fontSize:11,fontWeight:700,padding:"2px 8px",borderRadius:8},children:" LOCKED"}),N.intent_score>=80&&e.jsxs("span",{style:{background:"#c62828",color:"#fff",fontSize:11,fontWeight:700,padding:"2px 8px",borderRadius:8},children:[" HOT ",N.intent_score]})]}),e.jsx("button",{onClick:i,style:{background:"rgba(255,255,255,0.15)",border:"none",color:"#fff",borderRadius:6,padding:"6px 14px",cursor:"pointer",fontSize:16},children:""})]}),N.stage==="NEW"&&!N.last_activity_at&&e.jsx("div",{style:{background:"#fff3e0",borderBottom:"1px solid #ffe0b2",padding:"8px 24px",color:"#e65100",fontSize:13},children:" This lead has not been contacted yet."}),de&&e.jsxs("div",{style:{background:"#ffebee",borderBottom:"1px solid #ef9a9a",padding:"8px 24px",color:"#c62828",fontSize:13},children:[" Follow-up overdue! Scheduled: ",new Date(N.next_followup_at).toLocaleString("en-IN")]}),e.jsx("div",{style:{background:"#fff",borderBottom:"2px solid #e8eaf6",padding:"0 24px",display:"flex",gap:0,flexShrink:0,overflowX:"auto"},children:se.map(J=>e.jsx("button",{onClick:()=>m(J.key),style:{padding:"12px 18px",border:"none",background:"none",cursor:"pointer",fontSize:13,fontWeight:x===J.key?700:400,color:x===J.key?"#1a237e":"#666",borderBottom:`3px solid ${x===J.key?"#1a237e":"transparent"}`,whiteSpace:"nowrap",transition:"all 0.15s"},children:J.label},J.key))}),e.jsxs("div",{style:{flex:1,overflowY:"auto",padding:20},children:[x==="overview"&&e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"62% 38%",gap:16},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:16},children:[e.jsxs(Et,{title:"Lead Info",children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[e.jsx(Ee,{label:"Full Name",value:N.full_name}),e.jsx(Ee,{label:"Phone",value:e.jsx("a",{href:`tel:${N.phone_e164}`,style:{color:"#1565c0"},children:N.phone_e164})}),e.jsx(Ee,{label:"Email",value:N.email||""}),e.jsx(Ee,{label:"City",value:N.city||""}),e.jsx(Ee,{label:"Source",value:vl[N.lead_source_type]||N.lead_source_type||N.source||""}),e.jsx(Ee,{label:"Intent Score",value:N.intent_score!=null?`${N.intent_score}/100${N.intent_score>=80?" ":""}`:""}),e.jsx(Ee,{label:"Country",value:N.country||""}),e.jsx(Ee,{label:"Course",value:N.course||""}),e.jsx(Ee,{label:"Intake",value:N.intake||""}),e.jsx(Ee,{label:"Loan Amount",value:wo(N.loan_amount_paise)}),e.jsx(Ee,{label:"Priority",value:N.priority}),e.jsx(Ee,{label:"Assigned To",value:N.assigned_staff_name||""}),e.jsx(Ee,{label:"Created",value:Zs(N.created_at)}),e.jsx(Ee,{label:"Last Activity",value:Zs(N.last_activity_at)})]}),e.jsxs("div",{style:{display:"flex",gap:8,marginTop:14,flexWrap:"wrap"},children:[e.jsx(Xs,{icon:"",label:"Call",color:"#1a237e",onClick:()=>window.open(`tel:${N.phone_e164}`)}),e.jsx(Xs,{icon:"",label:"WhatsApp",color:"#25D366",onClick:()=>window.open(`https://wa.me/${N.phone_e164.replace("+","")}`)}),!z&&e.jsx(Xs,{icon:"",label:"Edit",color:"#555",onClick:()=>C(!0)}),!z&&e.jsx(Xs,{icon:"",label:"Qualification",color:"#6a1b9a",onClick:()=>D(!0)}),!z&&e.jsx(Xs,{icon:"",label:"Log Call",color:"#2e7d32",onClick:()=>g(!0)}),!z&&e.jsx(Xs,{icon:"",label:"Drop",color:"#c62828",onClick:A})]})]}),e.jsx(Et,{title:"Quick Message Templates",children:e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[{label:" Send Intro",msg:`Hi ${N.full_name}, I'm reaching out from Nexthara regarding your education loan inquiry.`},{label:" Eligibility Checklist",msg:`Hi ${N.full_name}, please share: Admission letter, Mark sheets (10th/12th/UG), Income proof, Bank statements.`},{label:" Document Upload Link",msg:`Hi ${N.full_name}, please upload your documents at: [portal link]`},{label:" Reminder",msg:`Hi ${N.full_name}, just a reminder for your follow-up call at the scheduled time.`}].map(J=>e.jsx("button",{onClick:()=>{var O;return(O=navigator.clipboard)==null?void 0:O.writeText(J.msg).then(()=>T.success("Copied!"))},style:{width:"100%",padding:"8px 12px",textAlign:"left",background:"#f5f6fa",border:"1px solid #e0e0e0",borderRadius:8,cursor:"pointer",fontSize:12,fontWeight:600,color:"#1a237e"},children:J.label},J.label))})})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:16},children:[e.jsxs(Et,{title:"Current Stage",children:[e.jsxs("div",{style:{background:xe.bg,borderRadius:8,padding:"12px 16px"},children:[e.jsx("div",{style:{fontSize:18,fontWeight:800,color:xe.color},children:N.stage}),e.jsxs("div",{style:{fontSize:12,color:"#666",marginTop:4},children:["Owner: ",N.assigned_staff_name||"Unassigned"]}),e.jsxs("div",{style:{fontSize:12,color:"#666"},children:["Priority: ",e.jsx("strong",{children:N.priority})]})]}),!z&&e.jsx("button",{onClick:()=>P(!0),style:{marginTop:10,width:"100%",padding:"8px",background:"#fff",border:"1.5px solid #1a237e",color:"#1a237e",borderRadius:8,cursor:"pointer",fontSize:13,fontWeight:600},children:"Change Stage "})]}),e.jsxs(Et,{title:"Next Follow-up",children:[N.next_followup_at?e.jsxs("div",{style:{background:de?"#ffebee":"#e8f5e9",borderRadius:8,padding:"12px 16px"},children:[e.jsx("div",{style:{fontWeight:600,color:de?"#c62828":"#2e7d32",fontSize:14},children:de?" Overdue":" Upcoming"}),e.jsx("div",{style:{fontSize:13,marginTop:4,color:"#333"},children:new Date(N.next_followup_at).toLocaleString("en-IN",{weekday:"short",day:"2-digit",month:"short",hour:"2-digit",minute:"2-digit"})})]}):e.jsx("div",{style:{background:"#fff3e0",borderRadius:8,padding:"12px 16px",color:"#e65100",fontSize:13},children:"No follow-up scheduled. Set one now!"}),e.jsx("button",{onClick:()=>y(!0),style:{marginTop:10,width:"100%",padding:"8px",background:"#1a237e",color:"#fff",border:"none",borderRadius:8,cursor:"pointer",fontSize:13,fontWeight:600},children:" Set / Update Follow-up"})]}),X&&e.jsxs(Et,{title:"Convert to Loan Case",highlight:!0,children:[e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:6,marginBottom:12},children:[["Admission verified",!!(W!=null&&W.admission_received)],["Basic docs received",N.stage==="DOCS_RECEIVED"],["Loan eligibility ok",!!(W!=null&&W.coapp_income_paise)],["Final doc confirmation",!1]].map(([J,O])=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,fontSize:13},children:[e.jsx("span",{style:{color:O?"#2e7d32":"#bbb",fontWeight:700},children:O?"":""}),e.jsx("span",{style:{color:O?"#333":"#999"},children:J})]},J))}),e.jsx("button",{onClick:()=>k(!0),style:{width:"100%",padding:"10px",background:"#2e7d32",color:"#fff",border:"none",borderRadius:8,cursor:"pointer",fontSize:14,fontWeight:700},children:" Create Loan Case"})]}),ce&&e.jsx(Et,{title:"Loan Case",children:e.jsxs("div",{style:{background:"#e8f5e9",borderRadius:8,padding:"12px 16px"},children:[e.jsx("div",{style:{fontWeight:700,color:"#2e7d32",fontSize:14},children:" Case Created"}),e.jsxs("div",{style:{fontSize:13,marginTop:4},children:["Case ID: ",e.jsx("strong",{children:ce.case_id})]}),e.jsxs("div",{style:{fontSize:12,color:"#666"},children:["By: ",ce.converted_by_staff_name]}),e.jsx("div",{style:{fontSize:12,color:"#666"},children:Zs(ce.converted_at)}),r&&e.jsx("button",{onClick:()=>r(ce.case_id),style:{marginTop:10,padding:"6px 14px",background:"#1a237e",color:"#fff",border:"none",borderRadius:6,cursor:"pointer",fontSize:12},children:"Open Case "})]})})]})]}),x==="qualify"&&e.jsx("div",{style:{maxWidth:700},children:e.jsxs(Et,{title:"Quick Qualification Panel",children:[W?e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14},children:[e.jsx(Ee,{label:"Admission Received",value:W.admission_received?" Yes":" No"}),e.jsx(Ee,{label:"University",value:W.university||""}),e.jsx(Ee,{label:"Country",value:W.country||""}),e.jsx(Ee,{label:"Course",value:W.course||""}),e.jsx(Ee,{label:"Loan Amount",value:wo(W.loan_amount_paise)}),e.jsx(Ee,{label:"Co-app Income",value:wo(W.coapp_income_paise)}),e.jsx(Ee,{label:"Collateral",value:W.collateral_available?" Yes":" No"}),e.jsx(Ee,{label:"CIBIL Known",value:W.cibil_known?" Yes":" No"}),e.jsx(Ee,{label:"Visa Urgency",value:W.visa_urgency||""})]}):e.jsx("p",{style:{color:"#999",fontSize:13,marginBottom:12},children:"No qualification data yet."}),e.jsxs("div",{style:{display:"flex",gap:8,marginTop:14},children:[e.jsx("button",{onClick:()=>D(!0),style:{padding:"7px 16px",background:"#1a237e",color:"#fff",border:"none",borderRadius:8,cursor:"pointer",fontSize:13,fontWeight:600},children:W?" Update Qualification":"+ Fill Qualification"}),!z&&N.stage==="CONNECTED"&&e.jsx("button",{onClick:async()=>{try{await gt.markQualified(s),w(),T.success("Marked as Qualified!")}catch(J){T.error(J.message)}},style:{padding:"7px 16px",background:"#f57f17",color:"#fff",border:"none",borderRadius:8,cursor:"pointer",fontSize:13,fontWeight:600},children:" Mark as Qualified"})]}),N.stage==="QUALIFIED"&&e.jsx("div",{style:{marginTop:10,padding:"8px 12px",background:"#e0f7fa",borderRadius:8,fontSize:13,color:"#00695c",fontWeight:600},children:" Suggest: Request Initial Documents?"})]})}),x==="timeline"&&e.jsx("div",{style:{maxWidth:700},children:e.jsxs(Et,{title:"Communication Timeline",children:[F.length===0?e.jsx("p",{style:{color:"#999",fontSize:13},children:"No activity yet."}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:0},children:F.map((J,O)=>{var ae;const U=Pm[J.type]||{icon:"",color:"#888"};return e.jsxs("div",{style:{display:"flex",gap:12,paddingBottom:12,position:"relative"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",width:28,flexShrink:0},children:[e.jsx("div",{style:{width:28,height:28,borderRadius:"50%",background:U.color+"22",color:U.color,display:"flex",alignItems:"center",justifyContent:"center",fontSize:14,fontWeight:700},children:U.icon}),O<F.length-1&&e.jsx("div",{style:{width:2,flex:1,background:"#e0e0e0",marginTop:4}})]}),e.jsxs("div",{style:{flex:1,paddingTop:4},children:[e.jsx("div",{style:{fontSize:13},children:(ae=J.note_text)==null?void 0:ae.replace(/^\[[^\]]+\]\s*/,"")}),e.jsxs("div",{style:{fontSize:11,color:"#999",marginTop:2},children:[J.staff_name||"System","  ",Zs(J.created_at)]})]})]},J.id||O)})}),e.jsx(Bm,{leadId:s,onAdded:w})]})}),x==="campaign"&&e.jsx("div",{style:{maxWidth:700},children:e.jsx(Et,{title:"Campaign & Attribution Data",children:oe||N.meta_campaign_id||N.utm_source?e.jsxs(e.Fragment,{children:[e.jsx("h5",{style:{fontSize:12,color:"#1a237e",fontWeight:700,textTransform:"uppercase",letterSpacing:.5,margin:"0 0 12px"},children:"Meta / Campaign IDs"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginBottom:20},children:[e.jsx(Ee,{label:"Source Type",value:vl[N.lead_source_type]||N.lead_source_type||""}),e.jsx(Ee,{label:"Source Reference ID",value:N.source_reference_id||""}),e.jsx(Ee,{label:"Meta Campaign ID",value:N.meta_campaign_id||""}),e.jsx(Ee,{label:"Meta Adset ID",value:N.meta_adset_id||""}),e.jsx(Ee,{label:"Meta Ad ID",value:N.meta_ad_id||""}),e.jsx(Ee,{label:"Meta Form ID",value:N.meta_form_id||""})]}),(N.utm_source||N.utm_campaign||N.utm_medium)&&e.jsxs(e.Fragment,{children:[e.jsx("h5",{style:{fontSize:12,color:"#1a237e",fontWeight:700,textTransform:"uppercase",letterSpacing:.5,margin:"0 0 12px"},children:"UTM Parameters"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[e.jsx(Ee,{label:"UTM Source",value:N.utm_source||""}),e.jsx(Ee,{label:"UTM Campaign",value:N.utm_campaign||""}),e.jsx(Ee,{label:"UTM Medium",value:N.utm_medium||""})]})]})]}):e.jsxs("div",{style:{color:"#999",fontSize:13},children:["No campaign / attribution data for this lead.",N.campaign_name&&e.jsx("div",{style:{marginTop:8},children:e.jsx(Ee,{label:"Campaign Name",value:N.campaign_name})})]})})}),x==="admission"&&e.jsx("div",{style:{maxWidth:700},children:e.jsxs(Et,{title:"Admission CRM Sync",children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[e.jsx(Ee,{label:"Admission Case ID",value:N.admission_case_id||""}),e.jsx(Ee,{label:"Sync Status",value:N.admission_sync_status||""}),e.jsx(Ee,{label:"Lead Source Type",value:vl[N.lead_source_type]||N.lead_source_type||""})]}),e.jsxs("div",{style:{marginTop:16,padding:"10px 14px",background:"#e8f5e9",borderRadius:8,fontSize:13,color:"#2e7d32"},children:[" This lead was synced from the Admission CRM system.",N.admission_case_id&&e.jsxs("div",{children:["Linked case: ",e.jsx("strong",{children:N.admission_case_id})]})]})]})}),x==="event"&&e.jsx("div",{style:{maxWidth:700},children:e.jsxs(Et,{title:"Event Registration Info",children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[e.jsx(Ee,{label:"Event Registration ID",value:N.event_registration_id||""}),e.jsx(Ee,{label:"Lead Source Type",value:vl[N.lead_source_type]||N.lead_source_type||""})]}),e.jsx("div",{style:{marginTop:16,padding:"10px 14px",background:"#ede7f6",borderRadius:8,fontSize:13,color:"#512da8"},children:" This lead registered via an event."})]})}),x==="followups"&&e.jsx("div",{style:{maxWidth:700},children:e.jsxs(Et,{title:"Scheduled Follow-ups",children:[Z.filter(J=>J.status==="SCHEDULED").length===0?e.jsx("p",{style:{color:"#999",fontSize:13,marginBottom:12},children:"No follow-ups scheduled."}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8,marginBottom:16},children:Z.filter(J=>J.status==="SCHEDULED").map(J=>{const O=new Date(J.scheduled_at)<new Date;return e.jsxs("div",{style:{background:O?"#fff5f5":"#f5f6fa",borderRadius:8,padding:"10px 14px",display:"flex",justifyContent:"space-between",alignItems:"flex-start",border:`1px solid ${O?"#ef9a9a":"#e0e0e0"}`},children:[e.jsxs("div",{children:[e.jsxs("div",{style:{fontSize:12,fontWeight:700,color:O?"#c62828":"#1a237e"},children:[J.type," ",O?" OVERDUE":""]}),e.jsx("div",{style:{fontSize:12,color:"#555",marginTop:2},children:new Date(J.scheduled_at).toLocaleString("en-IN",{day:"2-digit",month:"short",hour:"2-digit",minute:"2-digit"})}),J.note&&e.jsx("div",{style:{fontSize:11,color:"#888",marginTop:2},children:J.note})]}),e.jsx("button",{onClick:async()=>{try{await gt.completeFollowup(s,J.id),w(),T.success("Follow-up completed")}catch(U){T.error(U.message)}},style:{fontSize:11,padding:"4px 10px",border:"1px solid #ddd",borderRadius:6,cursor:"pointer",background:"#fff"},children:" Done"})]},J.id)})}),Z.filter(J=>J.status==="COMPLETED").length>0&&e.jsxs(e.Fragment,{children:[e.jsx("h5",{style:{fontSize:12,color:"#888",fontWeight:600,textTransform:"uppercase",margin:"16px 0 8px"},children:"Completed"}),Z.filter(J=>J.status==="COMPLETED").slice(-3).map(J=>e.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",padding:"6px 0",borderBottom:"1px solid #f5f5f5",fontSize:12,color:"#888"},children:[e.jsx("span",{style:{color:"#2e7d32"},children:""}),e.jsx("span",{children:J.type}),e.jsx("span",{children:""}),e.jsx("span",{children:Zs(J.scheduled_at)})]},J.id))]}),e.jsx("button",{onClick:()=>y(!0),style:{marginTop:16,padding:"9px 20px",background:"#1a237e",color:"#fff",border:"none",borderRadius:8,cursor:"pointer",fontSize:13,fontWeight:600},children:" + Add Follow-up"})]})}),x==="case"&&e.jsx("div",{style:{maxWidth:700},children:ce?e.jsx(Et,{title:"Linked Loan Case",children:e.jsxs("div",{style:{background:"#e8f5e9",borderRadius:10,padding:20},children:[e.jsx("div",{style:{fontSize:20,fontWeight:800,color:"#2e7d32",marginBottom:8},children:" Case Created"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[e.jsx(Ee,{label:"Case ID",value:ce.case_id}),e.jsx(Ee,{label:"Converted By",value:ce.converted_by_staff_name}),e.jsx(Ee,{label:"Converted At",value:Zs(ce.converted_at)})]}),r&&e.jsx("button",{onClick:()=>r(ce.case_id),style:{marginTop:16,padding:"9px 24px",background:"#1a237e",color:"#fff",border:"none",borderRadius:8,cursor:"pointer",fontSize:14,fontWeight:700},children:"Open Loan Case "})]})}):e.jsx(Et,{title:"Convert to Loan Case",highlight:X,children:X?e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{fontSize:13,color:"#333",marginBottom:14},children:"This lead is ready to be converted into a Loan Case."}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8,marginBottom:16},children:[["Admission verified",!!(W!=null&&W.admission_received)],["Basic docs received",N.stage==="DOCS_RECEIVED"],["Loan eligibility ok",!!(W!=null&&W.coapp_income_paise)],["Final doc confirmation",!1]].map(([J,O])=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,fontSize:13},children:[e.jsx("span",{style:{color:O?"#2e7d32":"#bbb",fontWeight:700},children:O?"":""}),e.jsx("span",{style:{color:O?"#333":"#999"},children:J})]},J))}),e.jsx("button",{onClick:()=>k(!0),style:{width:"100%",padding:"12px",background:"#2e7d32",color:"#fff",border:"none",borderRadius:8,cursor:"pointer",fontSize:15,fontWeight:700},children:" Create Loan Case"})]}):e.jsxs("div",{style:{color:"#999",fontSize:13},children:["Lead must be in ",e.jsx("strong",{children:"QUALIFIED"})," or ",e.jsx("strong",{children:"DOCS_RECEIVED"})," stage to convert to a case.",e.jsx("br",{}),e.jsx("br",{}),"Current stage: ",e.jsx(Tl,{stage:N.stage})]})})})]})]}),v&&e.jsx(Om,{leadId:s,onClose:()=>g(!1),onDone:()=>{g(!1),w()}}),b&&e.jsx(Wm,{leadId:s,onClose:()=>y(!1),onDone:()=>{y(!1),w()}}),j&&e.jsx(Mm,{leadId:s,lead:N,onClose:()=>k(!1),onDone:J=>{k(!1),w(),r&&r(J)}}),_&&e.jsx(Um,{lead:N,onClose:()=>C(!1),onDone:()=>{C(!1),w()}}),L&&e.jsx($m,{leadId:s,existing:W,onClose:()=>D(!1),onDone:()=>{D(!1),w()}}),I&&e.jsx(Fm,{leadId:s,currentStage:N.stage,onClose:()=>P(!1),onDone:()=>{P(!1),w()}})]})}function Et({title:s,children:i,highlight:r}){return e.jsxs("div",{style:{background:"#fff",borderRadius:10,padding:18,boxShadow:r?"0 2px 8px rgba(46,125,50,0.15)":"0 1px 4px rgba(0,0,0,0.07)",border:r?"1.5px solid #a5d6a7":"none"},children:[e.jsx("h4",{style:{fontSize:12,fontWeight:700,color:"#1a237e",marginBottom:12,textTransform:"uppercase",letterSpacing:.5},children:s}),i]})}function Bm({leadId:s,onAdded:i}){const[r,o]=u.useState(""),[d,f]=u.useState(!1),p=async()=>{if(r.trim()){f(!0);try{await gt.addNote(s,r),o(""),i(),T.success("Note added")}catch(x){T.error(x.message)}f(!1)}};return e.jsxs("div",{style:{marginTop:14,display:"flex",gap:8},children:[e.jsx("input",{value:r,onChange:x=>o(x.target.value),placeholder:"Add a note",style:{flex:1,padding:"8px 12px",border:"1px solid #e0e0e0",borderRadius:8,fontSize:13},onKeyDown:x=>x.key==="Enter"&&p()}),e.jsx("button",{onClick:p,disabled:d,style:{padding:"8px 16px",background:"#1a237e",color:"#fff",border:"none",borderRadius:8,cursor:"pointer",fontSize:13},children:d?"":"Add"})]})}const $e={width:"100%",padding:"8px 10px",border:"1px solid #e0e0e0",borderRadius:7,fontSize:13,marginBottom:10,boxSizing:"border-box"},Ie={display:"block",fontSize:12,fontWeight:600,color:"#555",marginBottom:4},sa={padding:"9px 20px",background:"#1a237e",color:"#fff",border:"none",borderRadius:8,cursor:"pointer",fontWeight:600,fontSize:13},Ss={padding:"9px 20px",background:"#fff",border:"1px solid #ddd",borderRadius:8,cursor:"pointer",fontSize:13};function Om({leadId:s,onClose:i,onDone:r}){const[o,d]=u.useState({call_status:"ATTEMPTED",duration_seconds:"",notes:""}),[f,p]=u.useState(!1),x=async()=>{p(!0);try{await gt.logCall(s,{...o,duration_seconds:o.duration_seconds?parseInt(o.duration_seconds):null}),T.success("Call logged"),r()}catch(m){T.error(m.message)}finally{p(!1)}};return e.jsxs(js,{title:"Log Call",onClose:i,children:[e.jsx("label",{style:Ie,children:"Call Status"}),e.jsxs("select",{style:$e,value:o.call_status,onChange:m=>d(v=>({...v,call_status:m.target.value})),children:[e.jsx("option",{value:"ATTEMPTED",children:"Attempted (No Answer)"}),e.jsx("option",{value:"CONNECTED",children:"Connected"}),e.jsx("option",{value:"VOICEMAIL",children:"Voicemail Left"}),e.jsx("option",{value:"BUSY",children:"Busy"})]}),e.jsx("label",{style:Ie,children:"Duration (seconds)"}),e.jsx("input",{style:$e,type:"number",value:o.duration_seconds,onChange:m=>d(v=>({...v,duration_seconds:m.target.value})),placeholder:"120"}),e.jsx("label",{style:Ie,children:"Notes"}),e.jsx("textarea",{style:{...$e,height:70},value:o.notes,onChange:m=>d(v=>({...v,notes:m.target.value})),placeholder:"Call summary"}),e.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"flex-end"},children:[e.jsx("button",{onClick:i,style:Ss,children:"Cancel"}),e.jsx("button",{onClick:x,disabled:f,style:sa,children:f?"":"Log Call"})]})]})}function Wm({leadId:s,onClose:i,onDone:r}){const o=new Date;o.setDate(o.getDate()+1),o.setMinutes(0,0,0);const[d,f]=u.useState({type:"CALL",scheduled_at:o.toISOString().slice(0,16),note:""}),[p,x]=u.useState(!1),m=async()=>{if(!d.scheduled_at)return T.error("Please set date/time");x(!0);try{await gt.setFollowup(s,{...d,scheduled_at:new Date(d.scheduled_at).toISOString()}),T.success("Follow-up scheduled"),r()}catch(v){T.error(v.message)}finally{x(!1)}};return e.jsxs(js,{title:"Schedule Follow-up",onClose:i,children:[e.jsx("label",{style:Ie,children:"Type"}),e.jsx("div",{style:{display:"flex",gap:8,marginBottom:10},children:["CALL","WHATSAPP","EMAIL","REMINDER"].map(v=>e.jsx("button",{onClick:()=>f(g=>({...g,type:v})),style:{flex:1,padding:"7px 4px",border:`1.5px solid ${d.type===v?"#1a237e":"#ddd"}`,background:d.type===v?"#e8eaf6":"#fff",borderRadius:7,cursor:"pointer",fontSize:11,fontWeight:d.type===v?700:400},children:v},v))}),e.jsx("label",{style:Ie,children:"Date & Time"}),e.jsx("input",{style:$e,type:"datetime-local",value:d.scheduled_at,onChange:v=>f(g=>({...g,scheduled_at:v.target.value}))}),e.jsx("label",{style:Ie,children:"Notes"}),e.jsx("input",{style:$e,value:d.note,onChange:v=>f(g=>({...g,note:v.target.value})),placeholder:"Call after documents uploaded"}),e.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"flex-end"},children:[e.jsx("button",{onClick:i,style:Ss,children:"Cancel"}),e.jsx("button",{onClick:m,disabled:p,style:sa,children:p?"":"Save Follow-up"})]})]})}function $m({leadId:s,existing:i,onClose:r,onDone:o}){const[d,f]=u.useState({admission_received:(i==null?void 0:i.admission_received)??!1,university:(i==null?void 0:i.university)||"",country:(i==null?void 0:i.country)||"",course:(i==null?void 0:i.course)||"",loan_amount_paise:i!=null&&i.loan_amount_paise?i.loan_amount_paise/100:"",coapp_income_paise:i!=null&&i.coapp_income_paise?i.coapp_income_paise/100:"",collateral_available:(i==null?void 0:i.collateral_available)??!1,cibil_known:(i==null?void 0:i.cibil_known)??!1,visa_urgency:(i==null?void 0:i.visa_urgency)||"NORMAL"}),[p,x]=u.useState(!1),m=(g,b)=>f(y=>({...y,[g]:b})),v=async()=>{x(!0);try{await gt.saveQualification(s,{...d,loan_amount_paise:d.loan_amount_paise?Math.round(parseFloat(d.loan_amount_paise)*100):null,coapp_income_paise:d.coapp_income_paise?Math.round(parseFloat(d.coapp_income_paise)*100):null}),T.success("Qualification saved"),o()}catch(g){T.error(g.message)}finally{x(!1)}};return e.jsxs(js,{title:"Quick Qualification Panel",onClose:r,children:[e.jsxs("div",{style:{maxHeight:"60vh",overflowY:"auto"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[e.jsx("input",{type:"checkbox",checked:d.admission_received,onChange:g=>m("admission_received",g.target.checked),id:"adm"}),e.jsx("label",{htmlFor:"adm",style:{fontSize:13,fontWeight:600},children:"Admission Received?"})]}),e.jsx("label",{style:Ie,children:"University"}),e.jsx("input",{style:$e,value:d.university,onChange:g=>m("university",g.target.value),placeholder:"Coventry University"}),e.jsx("label",{style:Ie,children:"Country"}),e.jsx("input",{style:$e,value:d.country,onChange:g=>m("country",g.target.value)}),e.jsx("label",{style:Ie,children:"Course"}),e.jsx("input",{style:$e,value:d.course,onChange:g=>m("course",g.target.value)}),e.jsx("label",{style:Ie,children:"Loan Amount ()"}),e.jsx("input",{style:$e,type:"number",value:d.loan_amount_paise,onChange:g=>m("loan_amount_paise",g.target.value),placeholder:"2500000"}),e.jsx("label",{style:Ie,children:"Co-app Income ( approx)"}),e.jsx("input",{style:$e,type:"number",value:d.coapp_income_paise,onChange:g=>m("coapp_income_paise",g.target.value),placeholder:"900000"}),e.jsxs("div",{style:{display:"flex",gap:20,marginBottom:10},children:[e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:6,fontSize:13,cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:d.collateral_available,onChange:g=>m("collateral_available",g.target.checked)})," Collateral?"]}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:6,fontSize:13,cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:d.cibil_known,onChange:g=>m("cibil_known",g.target.checked)})," CIBIL Known?"]})]}),e.jsx("label",{style:Ie,children:"Visa Urgency"}),e.jsxs("select",{style:$e,value:d.visa_urgency,onChange:g=>m("visa_urgency",g.target.value),children:[e.jsx("option",{value:"NORMAL",children:"Normal"}),e.jsx("option",{value:"URGENT",children:"Urgent"}),e.jsx("option",{value:"VERY_URGENT",children:"Very Urgent"})]})]}),e.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",marginTop:8},children:[e.jsx("button",{onClick:r,style:Ss,children:"Cancel"}),e.jsx("button",{onClick:v,disabled:p,style:sa,children:p?"":"Save Qualification"})]})]})}function Mm({leadId:s,lead:i,onClose:r,onDone:o}){const[d,f]=u.useState({branch_id:"",case_owner_id:"",student_phone:i.phone_e164||"",student_email:i.email||""}),[p,x]=u.useState(!1),m=async()=>{x(!0);try{const v=await gt.convert(s,d);T.success(`Loan Case ${v.case_id} created!`),o(v.case_id)}catch(v){T.error(v.message)}finally{x(!1)}};return e.jsxs(js,{title:"Create Loan Case",onClose:r,children:[e.jsxs("div",{style:{background:"#e8f5e9",borderRadius:8,padding:"10px 14px",marginBottom:14,fontSize:13},children:[e.jsx("strong",{children:i.full_name}),"  ",i.country||"","  ",i.course||""]}),e.jsx("label",{style:Ie,children:"Select Branch"}),e.jsxs("select",{style:$e,value:d.branch_id,onChange:v=>f(g=>({...g,branch_id:v.target.value})),children:[e.jsx("option",{value:"",children:"Select branch"}),e.jsx("option",{value:"SBI",children:"SBI"}),e.jsx("option",{value:"HDFC",children:"HDFC"}),e.jsx("option",{value:"ICICI",children:"ICICI"}),e.jsx("option",{value:"AXIS",children:"Axis Bank"}),e.jsx("option",{value:"UNION",children:"Union Bank"}),e.jsx("option",{value:"BOB",children:"Bank of Baroda"})]}),e.jsx("label",{style:Ie,children:"Confirm Student Phone"}),e.jsx("input",{style:$e,value:d.student_phone,onChange:v=>f(g=>({...g,student_phone:v.target.value}))}),e.jsx("label",{style:Ie,children:"Confirm Student Email"}),e.jsx("input",{style:$e,type:"email",value:d.student_email,onChange:v=>f(g=>({...g,student_email:v.target.value}))}),e.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",marginTop:8},children:[e.jsx("button",{onClick:r,style:Ss,children:"Cancel"}),e.jsx("button",{onClick:m,disabled:p,style:{...sa,background:"#2e7d32"},children:p?"":" Confirm & Create Case"})]})]})}function Fm({leadId:s,currentStage:i,onClose:r,onDone:o}){const f={NEW:["CONTACT_ATTEMPTED","DROPPED","LOST","DUPLICATE"],CONTACT_ATTEMPTED:["CONNECTED","DROPPED","LOST","DUPLICATE"],CONNECTED:["QUALIFIED","DROPPED","LOST","DUPLICATE"],QUALIFIED:["DOCS_REQUESTED","DROPPED","LOST","DUPLICATE"],DOCS_REQUESTED:["DOCS_RECEIVED","DROPPED","LOST","DUPLICATE"],DOCS_RECEIVED:["CASE_CREATED","DROPPED","LOST","DUPLICATE"]}[i]||[],[p,x]=u.useState(f[0]||""),[m,v]=u.useState(!1),g=async()=>{if(p){v(!0);try{await gt.updateLead(s,{stage:p}),T.success(`Stage updated to ${p}`),o()}catch(b){T.error(b.message)}finally{v(!1)}}};return f.length===0?e.jsxs(js,{title:"Change Stage",onClose:r,children:[e.jsxs("p",{style:{color:"#666",fontSize:13},children:["No further stage transitions from ",e.jsx("strong",{children:i}),"."]}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:12},children:e.jsx("button",{onClick:r,style:Ss,children:"Close"})})]}):e.jsxs(js,{title:"Change Stage",onClose:r,children:[e.jsxs("p",{style:{fontSize:13,color:"#555",marginBottom:12},children:["Current: ",e.jsx(Tl,{stage:i})]}),e.jsx("label",{style:Ie,children:"Move to:"}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8,marginBottom:16},children:f.map(b=>{const y=Go[b]||{color:"#666",bg:"#f5f5f5"};return e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:10,padding:"10px 14px",border:`2px solid ${p===b?y.color:"#e0e0e0"}`,borderRadius:8,cursor:"pointer",background:p===b?y.bg:"#fff"},children:[e.jsx("input",{type:"radio",name:"stage",value:b,checked:p===b,onChange:()=>x(b)}),e.jsx(Tl,{stage:b})]},b)})}),e.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"flex-end"},children:[e.jsx("button",{onClick:r,style:Ss,children:"Cancel"}),e.jsx("button",{onClick:g,disabled:m||!p,style:sa,children:m?"":"Update Stage"})]})]})}function Um({lead:s,onClose:i,onDone:r}){const[o,d]=u.useState({full_name:s.full_name,phone_e164:s.phone_e164,email:s.email||"",city:s.city||"",country:s.country||"",course:s.course||"",intake:s.intake||"",loan_amount_paise:s.loan_amount_paise?s.loan_amount_paise/100:"",priority:s.priority,intent_score:s.intent_score!=null?s.intent_score:50}),[f,p]=u.useState(!1),x=(v,g)=>d(b=>({...b,[v]:g})),m=async()=>{p(!0);try{const v={...o,loan_amount_paise:o.loan_amount_paise?Math.round(parseFloat(o.loan_amount_paise)*100):null,intent_score:parseInt(o.intent_score)||50};await gt.updateLead(s.id,v),T.success("Lead updated"),r()}catch(v){T.error(v.message)}finally{p(!1)}};return e.jsxs(js,{title:"Edit Lead",onClose:i,children:[e.jsxs("div",{style:{maxHeight:"60vh",overflowY:"auto"},children:[e.jsx("label",{style:Ie,children:"Full Name"}),e.jsx("input",{style:$e,value:o.full_name,onChange:v=>x("full_name",v.target.value)}),e.jsx("label",{style:Ie,children:"Phone (E.164)"}),e.jsx("input",{style:$e,value:o.phone_e164,onChange:v=>x("phone_e164",v.target.value)}),e.jsx("label",{style:Ie,children:"Email"}),e.jsx("input",{style:$e,type:"email",value:o.email,onChange:v=>x("email",v.target.value)}),e.jsx("label",{style:Ie,children:"City"}),e.jsx("input",{style:$e,value:o.city,onChange:v=>x("city",v.target.value)}),e.jsx("label",{style:Ie,children:"Country"}),e.jsxs("select",{style:$e,value:o.country,onChange:v=>x("country",v.target.value),children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{children:"UK"}),e.jsx("option",{children:"USA"}),e.jsx("option",{children:"Canada"}),e.jsx("option",{children:"Australia"}),e.jsx("option",{children:"Ireland"}),e.jsx("option",{children:"Germany"})]}),e.jsx("label",{style:Ie,children:"Course"}),e.jsx("input",{style:$e,value:o.course,onChange:v=>x("course",v.target.value)}),e.jsx("label",{style:Ie,children:"Intake"}),e.jsx("input",{style:$e,value:o.intake,onChange:v=>x("intake",v.target.value)}),e.jsx("label",{style:Ie,children:"Loan Amount ()"}),e.jsx("input",{style:$e,type:"number",value:o.loan_amount_paise,onChange:v=>x("loan_amount_paise",v.target.value)}),e.jsx("label",{style:Ie,children:"Priority"}),e.jsxs("select",{style:$e,value:o.priority,onChange:v=>x("priority",v.target.value),children:[e.jsx("option",{children:"NORMAL"}),e.jsx("option",{children:"HIGH"}),e.jsx("option",{children:"URGENT"})]}),e.jsx("label",{style:Ie,children:"Intent Score (0100)"}),e.jsx("input",{style:$e,type:"number",min:"0",max:"100",value:o.intent_score,onChange:v=>x("intent_score",v.target.value)})]}),e.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",marginTop:8},children:[e.jsx("button",{onClick:i,style:Ss,children:"Cancel"}),e.jsx("button",{onClick:m,disabled:f,style:sa,children:f?"":"Save Changes"})]})]})}const Eo=["#1565c0","#7b1fa2","#f57f17","#00695c","#2e7d32"];function sh(){const[s,i]=u.useState(null),[r,o]=u.useState(!0);if(u.useEffect(()=>{gt.getAnalytics().then(i).catch(()=>{}).finally(()=>o(!1))},[]),r)return e.jsx("div",{style:{padding:40,textAlign:"center",color:"#999"},children:"Loading analytics"});if(!s)return e.jsx("div",{style:{padding:40,color:"#c62828"},children:"Failed to load analytics."});const d=Math.max(...s.funnel.map(f=>f.count),1);return e.jsxs("div",{style:{padding:"0 0 40px 0"},children:[e.jsx("div",{className:"page-header",style:{marginBottom:24},children:e.jsxs("div",{children:[e.jsx("h2",{style:{fontSize:22,fontWeight:700},children:"Lead Analytics"}),e.jsx("div",{className:"subtitle",children:"Funnel view, conversion rates, and staff performance"})]})}),e.jsxs("div",{style:{background:"#fff",borderRadius:12,padding:28,boxShadow:"0 2px 8px rgba(0,0,0,0.07)",marginBottom:24},children:[e.jsx("h3",{style:{fontSize:16,fontWeight:700,marginBottom:20,color:"#1a237e"},children:"Conversion Funnel"}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:14,alignItems:"center"},children:s.funnel.map((f,p)=>e.jsxs("div",{style:{width:"100%",maxWidth:600},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:4,fontSize:13},children:[e.jsx("span",{style:{fontWeight:600},children:f.label}),e.jsxs("span",{style:{color:Eo[p],fontWeight:700},children:[f.count," (",f.pct,"%)"]})]}),e.jsx("div",{style:{background:"#f0f2f5",borderRadius:8,height:28,overflow:"hidden",position:"relative"},children:e.jsx("div",{style:{width:`${f.count/d*100}%`,minWidth:f.count>0?4:0,height:"100%",background:Eo[p],borderRadius:8,transition:"width 0.5s ease",display:"flex",alignItems:"center",paddingLeft:10},children:f.pct>8&&e.jsxs("span",{style:{color:"#fff",fontSize:11,fontWeight:700},children:[f.pct,"%"]})})})]},f.label))}),e.jsx("div",{style:{display:"flex",gap:16,marginTop:28,flexWrap:"wrap"},children:s.funnel.slice(1).map((f,p)=>{const x=s.funnel[p],m=x.count>0?Math.round(f.count/x.count*100):0;return e.jsxs("div",{style:{flex:1,minWidth:120,background:"#f5f6fa",borderRadius:10,padding:"14px 16px",textAlign:"center"},children:[e.jsxs("div",{style:{fontSize:24,fontWeight:800,color:Eo[p+1]},children:[m,"%"]}),e.jsxs("div",{style:{fontSize:11,color:"#666",marginTop:4},children:[x.label.split(" ")[0],"  ",f.label.split(" ")[0]]})]},f.label)})})]}),e.jsxs("div",{style:{background:"#fff",borderRadius:12,padding:28,boxShadow:"0 2px 8px rgba(0,0,0,0.07)"},children:[e.jsx("h3",{style:{fontSize:16,fontWeight:700,marginBottom:20,color:"#1a237e"},children:"Staff Performance"}),s.staff.length===0?e.jsx("p",{style:{color:"#999",fontSize:13},children:"No staff data available."}):e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:13},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{background:"#f5f6fa",borderBottom:"2px solid #e0e0e0"},children:[e.jsx("th",{style:Qa,children:"Staff"}),e.jsx("th",{style:Qa,children:"Leads"}),e.jsx("th",{style:Qa,children:"Connected %"}),e.jsx("th",{style:Qa,children:"Qualified %"}),e.jsx("th",{style:Qa,children:"Case %"})]})}),e.jsx("tbody",{children:s.staff.map(f=>e.jsxs("tr",{style:{borderBottom:"1px solid #f0f0f0"},children:[e.jsx("td",{style:Ga,children:e.jsx("strong",{children:f.name})}),e.jsx("td",{style:Ga,children:f.leads}),e.jsx("td",{style:Ga,children:e.jsx(Ro,{value:f.connected_pct,color:"#7b1fa2"})}),e.jsx("td",{style:Ga,children:e.jsx(Ro,{value:f.qualified_pct,color:"#f57f17"})}),e.jsx("td",{style:Ga,children:e.jsx(Ro,{value:f.case_pct,color:"#2e7d32"})})]},f.id))})]})]})]})}function Ro({value:s,color:i}){return e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("div",{style:{flex:1,background:"#f0f2f5",borderRadius:4,height:8,overflow:"hidden"},children:e.jsx("div",{style:{width:`${s}%`,height:"100%",background:i,borderRadius:4}})}),e.jsxs("span",{style:{fontSize:12,fontWeight:700,color:i,minWidth:32},children:[s,"%"]})]})}const Qa={padding:"10px 16px",textAlign:"left",fontSize:12,fontWeight:700,color:"#555"},Ga={padding:"12px 16px",verticalAlign:"middle"},ah={NEW:"New",CONTACT_ATTEMPTED:"Attempted",CONNECTED:"Connected",QUALIFIED:"Qualified",DOCS_REQUESTED:"Docs Req.",DOCS_RECEIVED:"Docs Recv.",CASE_CREATED:"Case Created"},Vm={NEW:"#78909c",CONTACT_ATTEMPTED:"#f57f17",CONNECTED:"#1565c0",QUALIFIED:"#6a1b9a",DOCS_REQUESTED:"#ad1457",DOCS_RECEIVED:"#00838f",CASE_CREATED:"#2e7d32"},Hm={NEW:"badge-grey",CONTACT_ATTEMPTED:"badge-amber",CONNECTED:"badge-blue",QUALIFIED:"badge-purple",DOCS_REQUESTED:"badge-red",DOCS_RECEIVED:"badge-blue",CASE_CREATED:"badge-green",DROPPED:"badge-red",LOST:"badge-red",DUPLICATE:"badge-grey"};function ef({stage:s}){const i=ah[s]||(s==null?void 0:s.replace(/_/g," "));return e.jsx("span",{className:`badge ${Hm[s]||"badge-grey"}`,children:i})}function Ao(s){return`${((s||0)/1e5).toFixed(1)}L`}function Qm(){const[s,i]=u.useState(null),[r,o]=u.useState(!0);if(u.useEffect(()=>{Ve.getDashboard().then(i).catch(()=>T.error("Failed to load dashboard")).finally(()=>o(!1))},[]),r)return e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:300,color:"var(--text-muted)",flexDirection:"column",gap:12},children:[e.jsx("i",{className:"fas fa-spinner fa-spin",style:{fontSize:28,color:"var(--sbi-accent)"}}),"Loading dashboard..."]});if(!s)return null;const{kpis:d,funnel:f,recentLeads:p,overdueLeads:x}=s,m=Math.max(...(f==null?void 0:f.map(g=>g.count))||[1],1),v=[{label:"Total Leads",value:d.totalLeads,icon:"fa-user-plus",cls:"blue",footer:"All leads in your network"},{label:"Active Leads",value:d.activeLeads,icon:"fa-fire",cls:"amber",footer:"In active pipeline stages"},{label:"Cases Created",value:d.casesCreated,icon:"fa-briefcase",cls:"green",footer:"Leads converted to cases"},{label:"Total Commission",value:Ao(d.totalCommPaise),icon:"fa-rupee-sign",cls:"purple",footer:"Across all commissions"},{label:"Commission Paid",value:Ao(d.paidCommPaise),icon:"fa-check-circle",cls:"green",footer:`Pending: ${Ao(d.totalCommPaise-d.paidCommPaise)}`}];return e.jsxs("div",{children:[e.jsxs("div",{className:"page-header",children:[e.jsxs("div",{children:[e.jsx("h2",{children:"Agent Dashboard"}),e.jsx("div",{className:"subtitle",children:"Your leads, cases and commissions at a glance"})]}),e.jsxs("button",{className:"btn btn-outline",onClick:()=>window.location.reload(),children:[e.jsx("i",{className:"fas fa-sync-alt"})," Refresh"]})]}),e.jsx("div",{className:"kpi-grid",style:{marginBottom:24,gridTemplateColumns:"repeat(5, 1fr)"},children:v.map(g=>e.jsxs("div",{className:`kpi-card ${g.cls}`,style:{padding:"14px 16px"},children:[e.jsx("div",{className:"kpi-label",style:{fontSize:11},children:g.label}),e.jsx("div",{className:"kpi-value",style:{fontSize:22},children:g.value??""}),e.jsxs("div",{className:"kpi-footer neutral",style:{fontSize:11},children:[e.jsx("i",{className:`fas ${g.icon}`})," ",g.footer]})]},g.label))}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16,marginBottom:20},children:[e.jsxs("div",{className:"table-container",style:{padding:20},children:[e.jsx("div",{className:"table-header",style:{padding:"0 0 14px 0",border:"none"},children:e.jsxs("h3",{children:[e.jsx("i",{className:"fas fa-filter",style:{marginRight:8,color:"var(--sbi-accent)"}}),"Lead Funnel"]})}),f==null?void 0:f.map(g=>e.jsxs("div",{style:{marginBottom:12},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:5,fontSize:12},children:[e.jsx("span",{style:{color:"var(--text-secondary)"},children:ah[g.stage]||g.stage}),e.jsx("span",{style:{fontWeight:600,color:"var(--text-primary)"},children:g.count})]}),e.jsx("div",{style:{height:7,background:"#f0f2f5",borderRadius:4,overflow:"hidden"},children:e.jsx("div",{style:{height:"100%",width:`${g.count/m*100}%`,background:Vm[g.stage]||"var(--sbi-accent)",borderRadius:4,transition:"width 0.5s"}})})]},g.stage)),!(f!=null&&f.length)&&e.jsx("div",{style:{color:"var(--text-muted)",fontSize:13},children:"No leads yet."})]}),e.jsxs("div",{className:"table-container",style:{padding:0,overflow:"hidden"},children:[e.jsx("div",{className:"table-header",children:e.jsxs("h3",{children:[e.jsx("i",{className:"fas fa-clock",style:{marginRight:8,color:"var(--sbi-accent)"}}),"Recent Leads"]})}),e.jsxs("table",{className:"app-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Phone"}),e.jsx("th",{children:"Stage"})]})}),e.jsxs("tbody",{children:[!(p!=null&&p.length)&&e.jsx("tr",{children:e.jsx("td",{colSpan:3,style:{textAlign:"center",padding:32,color:"var(--text-muted)"},children:"No leads yet."})}),p==null?void 0:p.map(g=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("div",{className:"student-name",children:g.full_name})}),e.jsx("td",{style:{color:"var(--text-muted)",fontSize:12},children:g.phone_e164}),e.jsx("td",{children:e.jsx(ef,{stage:g.stage})})]},g.id))]})]})]})]}),e.jsxs("div",{className:"table-container",style:{padding:0,overflow:"hidden"},children:[e.jsxs("div",{className:"table-header",children:[e.jsxs("h3",{children:[e.jsx("i",{className:"fas fa-exclamation-triangle",style:{marginRight:8,color:"var(--status-amber)"}}),"Follow-up Queue"]}),e.jsx("span",{className:"results-count",children:"Least recently updated"})]}),x!=null&&x.length?e.jsx("div",{style:{padding:20,display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(220px, 1fr))",gap:12},children:x.map(g=>e.jsxs("div",{style:{background:"#f8f9fb",borderRadius:8,padding:"12px 14px",border:"1px solid var(--border-color)"},children:[e.jsx("div",{className:"student-name",children:g.full_name}),e.jsx("div",{className:"student-sub",children:g.phone_e164}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginTop:8,alignItems:"center"},children:[e.jsx(ef,{stage:g.stage}),e.jsx("span",{style:{fontSize:10,color:"var(--text-muted)"},children:new Date(g.updated_at).toLocaleDateString()})]})]},g.id))}):e.jsxs("div",{style:{padding:"32px 20px",textAlign:"center",color:"var(--text-muted)"},children:[e.jsx("i",{className:"fas fa-check-circle",style:{fontSize:24,display:"block",marginBottom:8,color:"var(--status-green)"}}),"All leads are up to date"]})]})]})}const ih=["NEW","CONTACT_ATTEMPTED","CONNECTED","QUALIFIED","DOCS_REQUESTED","DOCS_RECEIVED","CASE_CREATED","DROPPED","LOST","DUPLICATE"],Gm={NEW:"badge-grey",CONTACT_ATTEMPTED:"badge-amber",CONNECTED:"badge-blue",QUALIFIED:"badge-purple",DOCS_REQUESTED:"badge-red",DOCS_RECEIVED:"badge-blue",CASE_CREATED:"badge-green",DROPPED:"badge-red",LOST:"badge-red",DUPLICATE:"badge-grey"};function lh({stage:s}){return e.jsx("span",{className:`badge ${Gm[s]||"badge-grey"}`,children:s==null?void 0:s.replace(/_/g," ")})}function rh(s){return s?`${(s/1e5).toFixed(1)}L`:""}function qm(){const[s,i]=u.useState([]),[r,o]=u.useState(0),[d,f]=u.useState(1),[p,x]=u.useState(1),[m,v]=u.useState(""),[g,b]=u.useState(""),[y,j]=u.useState(!1),[k,_]=u.useState(!1),[C,L]=u.useState(null),[D,I]=u.useState(null),[P,w]=u.useState(0),A=u.useCallback(()=>{j(!0);const N={page:d,limit:30};m&&(N.search=m),g&&(N.stage=g),Ve.getLeads(N).then(W=>{i(W.data),o(W.total),x(W.pages)}).catch(()=>T.error("Failed to load leads")).finally(()=>j(!1))},[d,m,g,P]);return u.useEffect(()=>{A()},[A]),e.jsxs("div",{children:[e.jsxs("div",{className:"page-header",children:[e.jsxs("div",{children:[e.jsx("h2",{children:"Leads"}),e.jsxs("div",{className:"subtitle",children:[r," total leads in your pipeline"]})]}),e.jsx("div",{className:"header-actions",children:e.jsxs("button",{className:"btn btn-primary",onClick:()=>_(!0),children:[e.jsx("i",{className:"fas fa-plus"})," Add Lead"]})})]}),e.jsxs("div",{className:"bank-chip-filters",style:{flexWrap:"nowrap",gap:5},children:[e.jsx("button",{className:`bank-chip${g?"":" active"}`,style:{padding:"4px 10px",fontSize:11},onClick:()=>{b(""),f(1)},children:"All"}),ih.map(N=>e.jsx("button",{className:`bank-chip${g===N?" active":""}`,style:{padding:"4px 10px",fontSize:11},onClick:()=>{b(N),f(1)},children:N.replace(/_/g," ")},N))]}),e.jsx("div",{className:"filter-bar",style:{marginTop:8},children:e.jsxs("div",{className:"search-box",children:[e.jsx("i",{className:"fas fa-search"}),e.jsx("input",{type:"text",placeholder:"Search name, phone, email...",value:m,onChange:N=>{v(N.target.value),f(1)}})]})}),e.jsxs("div",{className:"table-container",style:{marginTop:8},children:[e.jsxs("div",{className:"table-header",children:[e.jsx("h3",{children:"Leads"}),e.jsxs("span",{className:"results-count",children:["Showing ",s.length," of ",r]})]}),e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Phone"}),e.jsx("th",{children:"Country"}),e.jsx("th",{children:"Course"}),e.jsx("th",{children:"Loan Amt"}),e.jsx("th",{children:"Stage"}),e.jsx("th",{children:"Priority"}),e.jsx("th",{children:"Created"}),e.jsx("th",{})]})}),e.jsxs("tbody",{children:[y&&e.jsx("tr",{children:e.jsx("td",{colSpan:9,style:{textAlign:"center",padding:40,color:"var(--text-muted)"},children:"Loading..."})}),!y&&s.length===0&&e.jsx("tr",{children:e.jsxs("td",{colSpan:9,style:{textAlign:"center",padding:40,color:"var(--text-muted)"},children:[e.jsx("i",{className:"fas fa-inbox",style:{fontSize:24,display:"block",marginBottom:8}}),"No leads found"]})}),s.map(N=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("div",{className:"student-name",children:N.full_name})}),e.jsx("td",{style:{color:"var(--text-muted)",fontSize:12},children:N.phone_e164}),e.jsx("td",{style:{color:"var(--text-muted)"},children:N.country||""}),e.jsx("td",{style:{color:"var(--text-muted)"},children:N.course||""}),e.jsx("td",{style:{color:"var(--text-muted)"},children:rh(N.loan_amount_paise)}),e.jsx("td",{children:e.jsx(lh,{stage:N.stage})}),e.jsx("td",{children:e.jsx("span",{className:`badge ${N.priority==="HIGH"?"badge-amber":"badge-grey"}`,children:N.priority||""})}),e.jsx("td",{style:{color:"var(--text-muted)",fontSize:12,whiteSpace:"nowrap"},children:new Date(N.created_at).toLocaleDateString()}),e.jsxs("td",{style:{display:"flex",gap:6,alignItems:"center"},children:[e.jsx("button",{className:"btn btn-sm btn-outline",onClick:()=>L(N),children:"View"}),!N.internal_case_id&&!["CASE_CREATED","DROPPED","LOST","DUPLICATE"].includes(N.stage)&&e.jsx("button",{className:"btn btn-sm",style:{background:"var(--status-green-bg)",color:"var(--status-green)",border:"1px solid #a5d6a7"},onClick:()=>I(N),children:"Convert"})]})]},N.id))]})]}),p>1&&e.jsxs("div",{className:"pagination",children:[e.jsxs("div",{className:"info",children:["Page ",d," of ",p," (",r," total)"]}),e.jsxs("div",{className:"pagination-btns",children:[e.jsx("button",{onClick:()=>f(N=>N-1),disabled:d<=1,children:e.jsx("i",{className:"fas fa-chevron-left"})}),Array.from({length:Math.min(p,5)},(N,W)=>W+1).map(N=>e.jsx("button",{className:d===N?"active":"",onClick:()=>f(N),children:N},N)),e.jsx("button",{onClick:()=>f(N=>N+1),disabled:d>=p,children:e.jsx("i",{className:"fas fa-chevron-right"})})]})]})]}),k&&e.jsx(Jm,{onClose:()=>_(!1),onCreated:()=>{_(!1),w(N=>N+1)}}),C&&e.jsx(Km,{lead:C,onClose:()=>{L(null),w(N=>N+1)}}),D&&e.jsx(Zm,{lead:D,onClose:()=>I(null),onConverted:()=>{I(null),w(N=>N+1)}})]})}function Jm({onClose:s,onCreated:i}){const[r,o]=u.useState({full_name:"",phone_e164:"",email:"",city:"",country:"",course:"",university:"",intake:"",loan_amount_paise:""}),[d,f]=u.useState(!1),p=(m,v)=>o(g=>({...g,[m]:v}));async function x(m){m.preventDefault(),f(!0);try{await Ve.createLead({...r,loan_amount_paise:r.loan_amount_paise?Number(r.loan_amount_paise):null}),T.success("Lead created"),i()}catch(v){T.error(v.message)}finally{f(!1)}}return e.jsx("div",{className:"modal-overlay show",children:e.jsxs("div",{className:"modal",style:{marginTop:60},children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{children:"Add New Lead"}),e.jsx("button",{className:"modal-close",onClick:s,children:""})]}),e.jsx("div",{className:"modal-body",children:e.jsxs("form",{onSubmit:x,children:[e.jsx("div",{className:"form-row",children:[{label:"Full Name *",key:"full_name",req:!0},{label:"Phone *",key:"phone_e164",req:!0,placeholder:"+91..."}].map(m=>e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:m.label}),e.jsx("input",{type:"text",required:m.req,placeholder:m.placeholder||"",value:r[m.key],onChange:v=>p(m.key,v.target.value)})]},m.key))}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Email"}),e.jsx("input",{type:"email",value:r.email,onChange:m=>p("email",m.target.value)})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"City"}),e.jsx("input",{type:"text",value:r.city,onChange:m=>p("city",m.target.value)})]})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Country"}),e.jsx("input",{type:"text",value:r.country,onChange:m=>p("country",m.target.value)})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Course"}),e.jsx("input",{type:"text",value:r.course,onChange:m=>p("course",m.target.value)})]})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"University"}),e.jsx("input",{type:"text",value:r.university,onChange:m=>p("university",m.target.value)})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Intake"}),e.jsx("input",{type:"text",value:r.intake,onChange:m=>p("intake",m.target.value)})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Loan Amount ()  e.g. 5000000 for 50L"}),e.jsx("input",{type:"number",value:r.loan_amount_paise,onChange:m=>p("loan_amount_paise",m.target.value),placeholder:"Amount in paise"})]}),e.jsxs("div",{className:"form-actions",children:[e.jsx("button",{type:"button",className:"btn btn-outline",onClick:s,children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:d,children:d?"Creating...":"Create Lead"})]})]})})]})})}function Km({lead:s,onClose:i}){var y,j;const[r,o]=u.useState(s),[d,f]=u.useState(""),[p,x]=u.useState(s.stage),[m,v]=u.useState(!1);async function g(){if(d.trim()){v(!0);try{await Ve.addLeadNote(r.id,d),T.success("Note added"),f("");const k=await Ve.getLead(r.id);o(k)}catch(k){T.error(k.message)}finally{v(!1)}}}async function b(){if(p!==r.stage){v(!0);try{await Ve.updateLead(r.id,{stage:p}),T.success("Stage updated");const k=await Ve.getLead(r.id);o(k)}catch(k){T.error(k.message)}finally{v(!1)}}}return e.jsx("div",{className:"modal-overlay show",children:e.jsxs("div",{className:"modal",children:[e.jsxs("div",{className:"modal-header",children:[e.jsxs("div",{children:[e.jsx("h3",{children:r.full_name}),e.jsxs("div",{style:{fontSize:12,color:"var(--text-muted)",marginTop:4},children:[r.phone_e164,"  ",e.jsx(lh,{stage:r.stage})]})]}),e.jsx("button",{className:"modal-close",onClick:i,children:""})]}),e.jsxs("div",{className:"modal-body",children:[e.jsx("div",{className:"detail-grid",children:[["Email",r.email],["City",r.city],["Country",r.country],["Course",r.course],["University",r.university],["Intake",r.intake],["Loan Amount",r.loan_amount_paise?rh(r.loan_amount_paise):null],["Case ID",r.internal_case_id]].map(([k,_])=>_?e.jsxs("div",{className:"detail-item",children:[e.jsx("label",{children:k}),e.jsx("div",{className:"value",children:_})]},k):null)}),e.jsxs("div",{className:"update-form",children:[e.jsxs("h4",{children:[e.jsx("i",{className:"fas fa-exchange-alt",style:{marginRight:8}}),"Update Stage"]}),e.jsxs("div",{style:{display:"flex",gap:10},children:[e.jsx("select",{className:"filter-select",style:{flex:1},value:p,onChange:k=>x(k.target.value),children:ih.map(k=>e.jsx("option",{value:k,children:k.replace(/_/g," ")},k))}),e.jsx("button",{className:"btn btn-primary",onClick:b,disabled:m||p===r.stage,children:"Save"})]})]}),e.jsxs("div",{style:{marginTop:20},children:[e.jsx("h4",{style:{fontSize:14,fontWeight:600,color:"var(--text-primary)",marginBottom:12},children:"Notes"}),e.jsxs("div",{style:{display:"flex",gap:8,marginBottom:12},children:[e.jsx("input",{className:"cw-input",value:d,onChange:k=>f(k.target.value),placeholder:"Add a note...",onKeyDown:k=>k.key==="Enter"&&g()}),e.jsx("button",{className:"btn btn-primary",onClick:g,disabled:m||!d.trim(),children:"Add"})]}),((y=r.notes)==null?void 0:y.length)===0&&e.jsx("div",{style:{color:"var(--text-muted)",fontSize:13},children:"No notes yet."}),(j=r.notes)==null?void 0:j.map(k=>e.jsxs("div",{className:"cw-note-item",children:[e.jsx("div",{className:"cw-note-text",children:k.note_text}),e.jsxs("div",{className:"cw-note-meta",children:[e.jsx("i",{className:"fas fa-user"})," ",k.agent_user_name,"  ",new Date(k.created_at).toLocaleString()]})]},k.id))]})]})]})})}const Ym=["SBI","HDFC","Axis","ICICI","Credila","Auxilo","Avanse","IDFC","Union Bank","Bank of Baroda","Other"];function Zm({lead:s,onClose:i,onConverted:r}){const[o,d]=u.useState(""),[f,p]=u.useState(s.loan_amount_paise?String(Math.round(s.loan_amount_paise/100)):""),[x,m]=u.useState(""),[v,g]=u.useState(!1);async function b(y){if(y.preventDefault(),!o)return T.error("Please select a bank");g(!0);try{await Ve.convertLeadToCase(s.id,{bank:o,loan_amount_requested:f?Number(f):null,notes:x.trim()||null}),T.success("Lead converted to case successfully!"),r()}catch(j){T.error(j.message)}finally{g(!1)}}return e.jsx("div",{className:"modal-overlay show",children:e.jsxs("div",{className:"modal",style:{marginTop:60},children:[e.jsxs("div",{className:"modal-header",children:[e.jsxs("div",{children:[e.jsx("h3",{children:"Convert to Case"}),e.jsxs("div",{style:{fontSize:12,color:"var(--text-muted)",marginTop:3},children:[s.full_name,"  ",s.phone_e164]})]}),e.jsx("button",{className:"modal-close",onClick:i,children:""})]}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{className:"bank-panel-note",children:[e.jsx("i",{className:"fas fa-info-circle",style:{marginRight:6}}),"A new application case will be created and linked to this lead. The lead stage will be updated to ",e.jsx("strong",{children:"Case Created"}),"."]}),e.jsxs("div",{className:"update-form",style:{marginTop:0,marginBottom:16},children:[e.jsx("h4",{children:"Lead Summary"}),e.jsx("div",{className:"detail-grid",style:{marginBottom:0},children:[["University",s.university],["Course",s.course],["Country",s.country],["Intake",s.intake]].map(([y,j])=>j?e.jsxs("div",{className:"detail-item",children:[e.jsx("label",{children:y}),e.jsx("div",{className:"value",children:j})]},y):null)})]}),e.jsxs("form",{onSubmit:b,children:[e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Bank / Lender *"}),e.jsxs("select",{value:o,onChange:y=>d(y.target.value),required:!0,children:[e.jsx("option",{value:"",children:"Select bank..."}),Ym.map(y=>e.jsx("option",{value:y,children:y},y))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Loan Amount Requested ()"}),e.jsx("input",{type:"number",value:f,onChange:y=>p(y.target.value),placeholder:"e.g. 5000000 for 50L"}),f&&e.jsxs("div",{style:{fontSize:11,color:"var(--text-muted)",marginTop:4},children:["= ",(Number(f)/1e5).toFixed(2),"L"]})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Notes (optional)"}),e.jsx("textarea",{rows:3,value:x,onChange:y=>m(y.target.value),placeholder:"Any additional notes for the case..."})]}),e.jsxs("div",{className:"form-actions",children:[e.jsx("button",{type:"button",className:"btn btn-outline",onClick:i,children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:v||!o,style:{background:"var(--status-green)",boxShadow:"0 2px 6px rgba(46,125,50,0.3)"},children:v?"Converting...":"Convert to Case"})]})]})]})]})})}function Xm(s){return s?`${(s/1e5).toFixed(1)}L`:""}function ey(){const[s,i]=u.useState([]),[r,o]=u.useState(0),[d,f]=u.useState(1),[p,x]=u.useState(1),[m,v]=u.useState(""),[g,b]=u.useState(!1),[y,j]=u.useState(null),k=u.useCallback(()=>{b(!0);const _={page:d,limit:30};m&&(_.search=m),Ve.getCases(_).then(C=>{i(C.data),o(C.total),x(C.pages)}).catch(()=>T.error("Failed to load cases")).finally(()=>b(!1))},[d,m]);return u.useEffect(()=>{k()},[k]),e.jsxs("div",{children:[e.jsxs("div",{className:"page-header",children:[e.jsxs("div",{children:[e.jsx("h2",{children:"Cases"}),e.jsxs("div",{className:"subtitle",children:[r," cases linked to your leads"]})]}),e.jsxs("button",{className:"btn btn-outline",onClick:k,children:[e.jsx("i",{className:"fas fa-sync-alt"})," Refresh"]})]}),e.jsx("div",{className:"filter-bar",children:e.jsxs("div",{className:"search-box",children:[e.jsx("i",{className:"fas fa-search"}),e.jsx("input",{type:"text",placeholder:"Search name, bank, university...",value:m,onChange:_=>{v(_.target.value),f(1)}})]})}),e.jsxs("div",{className:"table-container",style:{marginTop:8},children:[e.jsxs("div",{className:"table-header",children:[e.jsx("h3",{children:"Cases"}),e.jsxs("span",{className:"results-count",children:["Showing ",s.length," of ",r]})]}),e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Student"}),e.jsx("th",{children:"Phone"}),e.jsx("th",{children:"Bank"}),e.jsx("th",{children:"University / Course"}),e.jsx("th",{children:"Loan Amt"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Awaiting"}),e.jsx("th",{children:"Created"}),e.jsx("th",{})]})}),e.jsxs("tbody",{children:[g&&e.jsx("tr",{children:e.jsx("td",{colSpan:9,style:{textAlign:"center",padding:40,color:"var(--text-muted)"},children:"Loading..."})}),!g&&s.length===0&&e.jsx("tr",{children:e.jsxs("td",{colSpan:9,style:{textAlign:"center",padding:40,color:"var(--text-muted)"},children:[e.jsx("i",{className:"fas fa-briefcase",style:{fontSize:24,display:"block",marginBottom:8}}),"No cases found. Leads appear here once converted to cases."]})}),s.map(_=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("div",{className:"student-name",children:_.student_name||_.full_name})}),e.jsx("td",{style:{color:"var(--text-muted)",fontSize:12},children:_.phone_e164}),e.jsx("td",{style:{fontWeight:500},children:_.bank||""}),e.jsxs("td",{children:[e.jsx("div",{style:{fontSize:13},children:_.university||""}),_.course&&e.jsx("div",{className:"student-sub",children:_.course})]}),e.jsx("td",{style:{color:"var(--text-muted)"},children:Xm(_.loan_amount_requested?_.loan_amount_requested*100:null)}),e.jsx("td",{children:e.jsx(Ht,{status:_.status})}),e.jsx("td",{style:{color:"var(--text-muted)",fontSize:12},children:_.awaiting_from||""}),e.jsx("td",{style:{color:"var(--text-muted)",fontSize:12,whiteSpace:"nowrap"},children:_.case_created_at?new Date(_.case_created_at).toLocaleDateString():""}),e.jsx("td",{children:_.case_id&&e.jsxs("button",{className:"btn btn-sm btn-primary",onClick:()=>Ve.getCase(_.case_id).then(j).catch(()=>T.error("Failed to load case")),children:["Open ",e.jsx("i",{className:"fas fa-arrow-right",style:{marginLeft:4}})]})})]},_.agent_lead_id))]})]}),p>1&&e.jsxs("div",{className:"pagination",children:[e.jsxs("div",{className:"info",children:["Page ",d," of ",p," (",r," total)"]}),e.jsxs("div",{className:"pagination-btns",children:[e.jsx("button",{onClick:()=>f(_=>_-1),disabled:d<=1,children:e.jsx("i",{className:"fas fa-chevron-left"})}),Array.from({length:Math.min(p,5)},(_,C)=>C+1).map(_=>e.jsx("button",{className:d===_?"active":"",onClick:()=>f(_),children:_},_)),e.jsx("button",{onClick:()=>f(_=>_+1),disabled:d>=p,children:e.jsx("i",{className:"fas fa-chevron-right"})})]})]})]}),y&&e.jsx(ty,{caseData:y,onClose:()=>j(null)})]})}function ty({caseData:s,onClose:i}){var r,o,d;return e.jsx("div",{className:"modal-overlay show",children:e.jsxs("div",{className:"modal",children:[e.jsxs("div",{className:"modal-header",style:{background:"var(--header-gradient)",color:"#fff",borderRadius:"12px 12px 0 0"},children:[e.jsxs("div",{children:[e.jsx("h3",{style:{color:"#fff"},children:s.student_name}),e.jsxs("div",{style:{fontSize:12,color:"rgba(255,255,255,0.8)",marginTop:4},children:["Case #",(r=s.id)==null?void 0:r.slice(0,8),"  ",s.bank]})]}),e.jsx("button",{className:"modal-close",style:{background:"rgba(255,255,255,0.15)",color:"#fff"},onClick:i,children:""})]}),e.jsxs("div",{className:"modal-body",children:[e.jsx("div",{className:"detail-grid",children:[["Bank",s.bank],["University",s.university],["Course",s.course],["Status",(o=s.status)==null?void 0:o.replace(/_/g," ")],["Sub-status",s.sub_status],["Awaiting From",s.awaiting_from],["Loan Requested",s.loan_amount_requested?`${s.loan_amount_requested.toLocaleString()}`:null],["Sanction Amount",s.sanction_amount?`${s.sanction_amount.toLocaleString()}`:null],["Priority",s.priority]].map(([f,p])=>p?e.jsxs("div",{className:"detail-item",children:[e.jsx("label",{children:f}),e.jsx("div",{className:"value",children:p})]},f):null)}),s.commission&&e.jsxs("div",{className:"sanction-card",style:{marginTop:20},children:[e.jsx("h4",{children:"Commission"}),e.jsxs("div",{className:"sanction-grid",children:[e.jsxs("div",{className:"sanction-item",children:[e.jsx("label",{children:"Rate"}),e.jsxs("div",{className:"value",children:[s.commission.commission_percent,"%"]})]}),e.jsxs("div",{className:"sanction-item",children:[e.jsx("label",{children:"Amount"}),e.jsxs("div",{className:"value",children:["",((s.commission.commission_amount_paise||0)/100).toLocaleString()]})]}),e.jsxs("div",{className:"sanction-item",children:[e.jsx("label",{children:"Status"}),e.jsx("div",{className:"value",children:s.commission.status})]})]})]}),((d=s.history)==null?void 0:d.length)>0&&e.jsxs("div",{className:"timeline",style:{marginTop:20},children:[e.jsx("h4",{children:"Status History"}),s.history.slice().reverse().map(f=>{var p;return e.jsxs("div",{className:"timeline-item",children:[e.jsx("div",{className:"timeline-dot blue",children:e.jsx("i",{className:"fas fa-circle",style:{fontSize:8}})}),e.jsxs("div",{className:"timeline-content",children:[e.jsx("div",{className:"title",children:(p=f.status)==null?void 0:p.replace(/_/g," ")}),f.notes&&e.jsx("div",{className:"subtitle",children:f.notes}),e.jsx("div",{className:"time",children:new Date(f.created_at).toLocaleString()})]})]},f.id)})]})]})]})})}const ny=["Credila","SBI","Axis","HDFC","ICICI","Prodigy","IDFC","Auxilo","Avanse"],sy=["NOT_CONNECTED","LOGIN_SUBMITTED","DOCS_PENDING","UNDER_REVIEW","QUERY_RAISED","SANCTIONED","AGREEMENT_SIGNED","DISBURSEMENT_PENDING","DISBURSED","REJECTED","CLOSED"];function ay(){const[s,i]=u.useState([]),[r,o]=u.useState(0),[d,f]=u.useState(1),[p,x]=u.useState(1),[m,v]=u.useState(""),[g,b]=u.useState(""),[y,j]=u.useState(!1),[k,_]=u.useState(null),[C,L]=u.useState(0),D=u.useCallback(()=>{j(!0);const I={page:d,limit:30};m&&(I.status=m),g&&(I.bank=g),Ve.getBankApps(I).then(P=>{i(P.data),o(P.total),x(P.pages)}).catch(()=>T.error("Failed to load bank applications")).finally(()=>j(!1))},[d,m,g,C]);return u.useEffect(()=>{D()},[D]),e.jsxs("div",{children:[e.jsxs("div",{className:"page-header",children:[e.jsxs("div",{children:[e.jsx("h2",{children:"Bank Applications"}),e.jsxs("div",{className:"subtitle",children:[r," total across all cases"]})]}),e.jsxs("button",{className:"btn btn-outline",onClick:()=>L(I=>I+1),children:[e.jsx("i",{className:"fas fa-sync-alt"})," Refresh"]})]}),e.jsxs("div",{className:"filter-bar",children:[e.jsxs("select",{className:"filter-select",value:g,onChange:I=>{b(I.target.value),f(1)},children:[e.jsx("option",{value:"",children:"All Banks"}),ny.map(I=>e.jsx("option",{value:I,children:I},I))]}),e.jsxs("select",{className:"filter-select",value:m,onChange:I=>{v(I.target.value),f(1)},children:[e.jsx("option",{value:"",children:"All Statuses"}),sy.map(I=>e.jsx("option",{value:I,children:I.replace(/_/g," ")},I))]})]}),e.jsxs("div",{className:"table-container",style:{marginTop:8},children:[e.jsxs("div",{className:"table-header",children:[e.jsx("h3",{children:"Bank Applications"}),e.jsxs("span",{className:"results-count",children:["Showing ",s.length," of ",r]})]}),e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Case Ref"}),e.jsx("th",{children:"Student"}),e.jsx("th",{children:"Bank"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Awaiting"}),e.jsx("th",{children:"SLA"}),e.jsx("th",{children:"Loan Amt"}),e.jsx("th",{children:"Sanction Amt"}),e.jsx("th",{children:"Last Update"}),e.jsx("th",{})]})}),e.jsxs("tbody",{children:[y&&e.jsx("tr",{children:e.jsx("td",{colSpan:10,style:{textAlign:"center",padding:40,color:"var(--text-muted)"},children:"Loading..."})}),!y&&s.length===0&&e.jsx("tr",{children:e.jsxs("td",{colSpan:10,style:{textAlign:"center",padding:40,color:"var(--text-muted)"},children:[e.jsx("i",{className:"fas fa-university",style:{fontSize:24,display:"block",marginBottom:8}}),"No bank applications found. Convert leads to cases to see bank applications here."]})}),s.map(I=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("span",{className:"app-id",children:I.app_id?`#${I.app_id.slice(0,8)}`:""})}),e.jsxs("td",{children:[e.jsx("div",{className:"student-name",children:I.full_name}),e.jsx("div",{className:"student-sub",children:I.phone_e164})]}),e.jsx("td",{style:{fontWeight:500},children:I.bank||""}),e.jsx("td",{children:e.jsx(Ht,{status:I.status})}),e.jsx("td",{children:e.jsx(Nn,{awaiting:I.awaiting_from})}),e.jsx("td",{children:e.jsx(Qt,{days:I.sla_days||0,awaiting:I.awaiting_from,status:I.status})}),e.jsx("td",{style:{color:"var(--text-muted)"},children:I.loan_amount_requested?`${(I.loan_amount_requested/1e5).toFixed(1)}L`:""}),e.jsx("td",{style:{fontWeight:I.sanction_amount?600:400,color:I.sanction_amount?"var(--status-green)":"var(--text-muted)"},children:I.sanction_amount?`${(I.sanction_amount/1e5).toFixed(1)}L`:""}),e.jsx("td",{style:{color:"var(--text-muted)",fontSize:12,whiteSpace:"nowrap"},children:I.created_at?new Date(I.created_at).toLocaleDateString():""}),e.jsx("td",{children:e.jsxs("button",{className:"btn btn-sm btn-primary",onClick:()=>_(I),children:["Actions ",e.jsx("i",{className:"fas fa-arrow-right",style:{marginLeft:4}})]})})]},I.agent_lead_id+(I.app_id||"")))]})]}),p>1&&e.jsxs("div",{className:"pagination",children:[e.jsxs("div",{className:"info",children:["Page ",d," of ",p," (",r," total)"]}),e.jsxs("div",{className:"pagination-btns",children:[e.jsx("button",{onClick:()=>f(I=>I-1),disabled:d<=1,children:e.jsx("i",{className:"fas fa-chevron-left"})}),Array.from({length:Math.min(p,5)},(I,P)=>P+1).map(I=>e.jsx("button",{className:d===I?"active":"",onClick:()=>f(I),children:I},I)),e.jsx("button",{onClick:()=>f(I=>I+1),disabled:d>=p,children:e.jsx("i",{className:"fas fa-chevron-right"})})]})]})]}),k&&e.jsx(iy,{app:k,onClose:()=>_(null),onUpdated:()=>{_(null),L(I=>I+1)}})]})}function iy({app:s,onClose:i}){var v;const[r,o]=u.useState("overview"),[d,f]=u.useState(""),[p,x]=u.useState(!1);async function m(){if(d.trim()){x(!0);try{T.success("Query raised  your account manager will follow up."),f("")}catch(g){T.error(g.message)}finally{x(!1)}}}return e.jsx("div",{className:"cw-drawer-overlay",children:e.jsxs("div",{className:"cw-drawer",children:[e.jsxs("div",{className:"cw-drawer-header",style:{background:"var(--header-gradient)"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:700,fontSize:15,color:"#fff"},children:s.full_name}),e.jsxs("div",{style:{fontSize:12,color:"rgba(255,255,255,0.75)",marginTop:2},children:[s.bank||"No bank assigned","  ",s.app_id?`#${s.app_id.slice(0,8)}`:"No case"]})]}),e.jsx("button",{className:"cw-close-btn",onClick:i,children:""})]}),e.jsxs("div",{className:"bank-status-bar",children:[e.jsx(Ht,{status:s.status}),e.jsx(Qt,{days:s.sla_days||0,awaiting:s.awaiting_from,status:s.status}),s.awaiting_from&&e.jsx(Nn,{awaiting:s.awaiting_from})]}),e.jsx("div",{className:"cw-drawer-nav",children:["overview","timeline","query"].map(g=>e.jsx("button",{className:`cw-drawer-nav-item${r===g?" active":""}`,onClick:()=>o(g),style:{textTransform:"capitalize"},children:g},g))}),e.jsxs("div",{className:"cw-drawer-body",children:[r==="overview"&&e.jsxs("div",{children:[e.jsx("div",{className:"detail-grid",children:[["Student",s.full_name],["Phone",s.phone_e164],["Bank",s.bank],["Awaiting From",s.awaiting_from],["SLA Days",s.sla_days?`${s.sla_days} days`:null],["Loan Amount",s.loan_amount_requested?`${(s.loan_amount_requested/1e5).toFixed(2)}L`:null],["Sanction Amount",s.sanction_amount?`${(s.sanction_amount/1e5).toFixed(2)}L`:null],["Bank Ref",s.bank_application_ref],["Priority",s.priority]].map(([g,b])=>b?e.jsxs("div",{className:"detail-item",children:[e.jsx("label",{children:g}),e.jsx("div",{className:"value",children:b})]},g):null)}),e.jsxs("div",{className:"bank-panel-warning",style:{marginTop:16},children:[e.jsx("i",{className:"fas fa-info-circle"}),e.jsxs("div",{children:["To update bank status or upload documents, use the ",e.jsx("strong",{children:"Timeline"})," tab or ",e.jsx("strong",{children:"Raise Query"})," to communicate with the Nexthara team."]})]})]}),r==="timeline"&&e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:12,fontWeight:700,color:"var(--text-muted)",marginBottom:16,textTransform:"uppercase",letterSpacing:.5},children:"Status History"}),!s.history||s.history.length===0?e.jsxs("div",{className:"cw-empty-state",children:[e.jsx("i",{className:"fas fa-history"}),e.jsx("p",{children:"No timeline available."})]}):e.jsx("div",{className:"timeline",children:(v=s.history)==null?void 0:v.slice().reverse().map((g,b)=>{var y;return e.jsxs("div",{className:"timeline-item",children:[e.jsx("div",{className:"timeline-dot blue",children:e.jsx("i",{className:"fas fa-circle",style:{fontSize:7}})}),e.jsxs("div",{className:"timeline-content",children:[e.jsx("div",{className:"title",children:(y=g.status)==null?void 0:y.replace(/_/g," ")}),g.notes&&e.jsx("div",{className:"subtitle",children:g.notes}),e.jsx("div",{className:"time",children:g.created_at?new Date(g.created_at).toLocaleString():""})]})]},b)})})]}),r==="query"&&e.jsxs("div",{children:[e.jsxs("div",{className:"bank-panel-note",style:{marginBottom:16},children:[e.jsx("i",{className:"fas fa-question-circle",style:{marginRight:6}}),"Raise a query with the Nexthara team about this bank application. Your query will be reviewed within 24 hours."]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Your Query"}),e.jsx("textarea",{rows:5,placeholder:"Describe the issue or question you have about this application...",value:d,onChange:g=>f(g.target.value)})]}),e.jsx("div",{className:"form-actions",children:e.jsx("button",{className:"btn btn-primary",onClick:m,disabled:p||!d.trim(),children:p?"Submitting...":"Submit Query"})})]})]})]})})}const ly={NEW:"badge-grey",CONTACT_ATTEMPTED:"badge-amber",CONNECTED:"badge-blue",QUALIFIED:"badge-purple",DOCS_REQUESTED:"badge-red",DOCS_RECEIVED:"badge-blue",CASE_CREATED:"badge-green",DROPPED:"badge-red",LOST:"badge-red",DUPLICATE:"badge-grey"};function ry({stage:s}){return e.jsx("span",{className:`badge ${ly[s]||"badge-grey"}`,children:s==null?void 0:s.replace(/_/g," ")})}function oh(s){return s?`${(s/1e5).toFixed(1)}L`:""}function oy(){const[s,i]=u.useState([]),[r,o]=u.useState(0),[d,f]=u.useState(1),[p,x]=u.useState(1),[m,v]=u.useState(""),[g,b]=u.useState(!1),[y,j]=u.useState(null),k=u.useCallback(()=>{b(!0);const C={page:d,limit:30};m&&(C.search=m),Ve.getStudents(C).then(L=>{i(L.data),o(L.total),x(L.pages)}).catch(()=>T.error("Failed to load students")).finally(()=>b(!1))},[d,m]);u.useEffect(()=>{k()},[k]);function _(C){Ve.getStudent(C.id).then(j).catch(()=>T.error("Failed to load student details"))}return e.jsxs("div",{children:[e.jsx("div",{className:"page-header",children:e.jsxs("div",{children:[e.jsx("h2",{children:"Students"}),e.jsxs("div",{className:"subtitle",children:[r," students in your network"]})]})}),e.jsx("div",{className:"filter-bar",children:e.jsxs("div",{className:"search-box",children:[e.jsx("i",{className:"fas fa-search"}),e.jsx("input",{type:"text",placeholder:"Search by name, phone, email...",value:m,onChange:C=>{v(C.target.value),f(1)}})]})}),g&&e.jsx("div",{style:{textAlign:"center",padding:40,color:"var(--text-muted)"},children:e.jsx("i",{className:"fas fa-spinner fa-spin",style:{fontSize:24,color:"var(--sbi-accent)"}})}),!g&&s.length===0&&e.jsxs("div",{className:"table-container",style:{textAlign:"center",padding:48},children:[e.jsx("i",{className:"fas fa-graduation-cap",style:{fontSize:32,color:"var(--text-muted)",display:"block",marginBottom:12}}),e.jsx("div",{style:{color:"var(--text-muted)"},children:"No students found. Add leads to populate the student directory."})]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(280px, 1fr))",gap:16},children:s.map(C=>{var L,D;return e.jsxs("div",{onClick:()=>_(C),style:{background:"var(--card-bg)",border:"1px solid var(--border-color)",borderRadius:"var(--radius)",padding:18,cursor:"pointer",boxShadow:"var(--shadow-sm)",transition:"all 0.2s"},onMouseEnter:I=>{I.currentTarget.style.boxShadow="var(--shadow-md)",I.currentTarget.style.transform="translateY(-2px)"},onMouseLeave:I=>{I.currentTarget.style.boxShadow="var(--shadow-sm)",I.currentTarget.style.transform="none"},children:[e.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center",marginBottom:12},children:[e.jsx("div",{className:"user-avatar",style:{width:40,height:40,fontSize:15},children:(D=(L=C.full_name)==null?void 0:L[0])==null?void 0:D.toUpperCase()}),e.jsxs("div",{style:{minWidth:0},children:[e.jsx("div",{className:"student-name",style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:C.full_name}),e.jsx("div",{className:"student-sub",children:C.phone_e164})]})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:5},children:[C.email&&e.jsxs("span",{style:{fontSize:12,color:"var(--text-muted)"},children:[e.jsx("i",{className:"fas fa-envelope",style:{marginRight:6,width:12}}),C.email]}),C.country&&e.jsxs("span",{style:{fontSize:12,color:"var(--text-muted)"},children:[e.jsx("i",{className:"fas fa-globe",style:{marginRight:6,width:12}}),C.country,C.course?`  ${C.course}`:""]}),C.university&&e.jsxs("span",{style:{fontSize:12,color:"var(--text-muted)"},children:[e.jsx("i",{className:"fas fa-university",style:{marginRight:6,width:12}}),C.university]}),C.intake&&e.jsxs("span",{style:{fontSize:12,color:"var(--text-muted)"},children:[e.jsx("i",{className:"fas fa-calendar-alt",style:{marginRight:6,width:12}}),"Intake: ",C.intake]}),C.loan_amount_paise&&e.jsxs("span",{style:{fontSize:12,color:"var(--text-muted)"},children:[e.jsx("i",{className:"fas fa-rupee-sign",style:{marginRight:6,width:12}}),oh(C.loan_amount_paise)]})]}),e.jsxs("div",{style:{marginTop:12,paddingTop:10,borderTop:"1px solid var(--border-color)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(ry,{stage:C.stage}),C.internal_case_id?e.jsxs("span",{className:"badge badge-green",children:[e.jsx("i",{className:"fas fa-briefcase",style:{marginRight:4}}),"Has Case"]}):e.jsx("span",{style:{fontSize:11,color:"var(--text-muted)"},children:"No case yet"})]})]},C.id)})}),p>1&&e.jsxs("div",{className:"pagination",style:{marginTop:20},children:[e.jsxs("div",{className:"info",children:["Page ",d," of ",p," (",r," total)"]}),e.jsxs("div",{className:"pagination-btns",children:[e.jsx("button",{onClick:()=>f(C=>C-1),disabled:d<=1,children:e.jsx("i",{className:"fas fa-chevron-left"})}),Array.from({length:Math.min(p,5)},(C,L)=>L+1).map(C=>e.jsx("button",{className:d===C?"active":"",onClick:()=>f(C),children:C},C)),e.jsx("button",{onClick:()=>f(C=>C+1),disabled:d>=p,children:e.jsx("i",{className:"fas fa-chevron-right"})})]})]}),y&&e.jsx(dy,{student:y,onClose:()=>j(null)})]})}function dy({student:s,onClose:i}){var r,o,d,f;return e.jsx("div",{className:"modal-overlay show",children:e.jsxs("div",{className:"modal",children:[e.jsxs("div",{className:"modal-header",style:{background:"var(--header-gradient)",color:"#fff",borderRadius:"12px 12px 0 0"},children:[e.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center"},children:[e.jsx("div",{className:"user-avatar",style:{width:40,height:40,fontSize:16},children:(o=(r=s.full_name)==null?void 0:r[0])==null?void 0:o.toUpperCase()}),e.jsxs("div",{children:[e.jsx("h3",{style:{color:"#fff",margin:0},children:s.full_name}),e.jsx("div",{style:{fontSize:12,color:"rgba(255,255,255,0.75)",marginTop:2},children:s.phone_e164})]})]}),e.jsx("button",{className:"modal-close",style:{background:"rgba(255,255,255,0.15)",color:"#fff"},onClick:i,children:""})]}),e.jsxs("div",{className:"modal-body",children:[e.jsx("div",{style:{marginBottom:4,fontSize:11,fontWeight:700,color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:1},children:"Contact Info"}),e.jsx("div",{className:"detail-grid",children:[["Phone",s.phone_e164],["Email",s.email],["City",s.city]].map(([p,x])=>x?e.jsxs("div",{className:"detail-item",children:[e.jsx("label",{children:p}),e.jsx("div",{className:"value",children:x})]},p):null)}),e.jsx("div",{style:{marginTop:20,marginBottom:4,fontSize:11,fontWeight:700,color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:1},children:"Application Details"}),e.jsx("div",{className:"detail-grid",children:[["Country",s.country],["Course",s.course],["University",s.university],["Intake",s.intake],["Loan Amount",oh(s.loan_amount_paise)]].map(([p,x])=>x&&x!==""?e.jsxs("div",{className:"detail-item",children:[e.jsx("label",{children:p}),e.jsx("div",{className:"value",children:x})]},p):null)}),s.case&&e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginTop:20,marginBottom:8,fontSize:11,fontWeight:700,color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:1},children:"Active Case"}),e.jsx("div",{className:"sanction-card",children:e.jsxs("div",{className:"sanction-grid",children:[e.jsxs("div",{className:"sanction-item",children:[e.jsx("label",{children:"Bank"}),e.jsx("div",{className:"value",children:s.case.bank})]}),e.jsxs("div",{className:"sanction-item",children:[e.jsx("label",{children:"Status"}),e.jsx("div",{className:"value",children:(d=s.case.status)==null?void 0:d.replace(/_/g," ")})]}),e.jsxs("div",{className:"sanction-item",children:[e.jsx("label",{children:"Awaiting"}),e.jsx("div",{className:"value",children:s.case.sub_status||""})]})]})})]}),s.commission&&e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginTop:20,marginBottom:8,fontSize:11,fontWeight:700,color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:1},children:"Commission"}),e.jsxs("div",{className:"detail-grid",children:[e.jsxs("div",{className:"detail-item",children:[e.jsx("label",{children:"Rate"}),e.jsxs("div",{className:"value",children:[s.commission.commission_percent,"%"]})]}),e.jsxs("div",{className:"detail-item",children:[e.jsx("label",{children:"Amount"}),e.jsxs("div",{className:"value",children:["",((s.commission.commission_amount_paise||0)/100).toLocaleString()]})]}),e.jsxs("div",{className:"detail-item",children:[e.jsx("label",{children:"Status"}),e.jsx("div",{className:"value",children:s.commission.status})]})]})]}),((f=s.notes)==null?void 0:f.length)>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginTop:20,marginBottom:8,fontSize:11,fontWeight:700,color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:1},children:"Notes"}),s.notes.map(p=>e.jsxs("div",{className:"cw-note-item",children:[e.jsx("div",{className:"cw-note-text",children:p.note_text}),e.jsxs("div",{className:"cw-note-meta",children:[e.jsx("i",{className:"fas fa-user"})," ",p.agent_user_name,"  ",new Date(p.created_at).toLocaleString()]})]},p.id))]}),e.jsxs("div",{style:{marginTop:20,display:"flex",gap:10},children:[e.jsxs("a",{href:`tel:${s.phone_e164}`,className:"btn btn-primary",style:{flex:1,textAlign:"center",textDecoration:"none"},children:[e.jsx("i",{className:"fas fa-phone"})," Call"]}),s.email&&e.jsxs("a",{href:`mailto:${s.email}`,className:"btn btn-outline",style:{flex:1,textAlign:"center",textDecoration:"none"},children:[e.jsx("i",{className:"fas fa-envelope"})," Email"]}),s.phone_e164&&e.jsxs("a",{href:`https://wa.me/${s.phone_e164.replace(/\D/g,"")}`,target:"_blank",rel:"noreferrer",className:"btn",style:{flex:1,textAlign:"center",textDecoration:"none",background:"#25D366",color:"#fff",border:"none"},children:[e.jsx("i",{className:"fab fa-whatsapp"})," WhatsApp"]})]})]})]})})}const dh={PENDING:"badge-amber",CONFIRMED:"badge-blue",PAID:"badge-green",DISPUTED:"badge-red"};function cy({status:s}){return e.jsx("span",{className:`badge ${dh[s]||"badge-grey"}`,children:s})}function tf(s){return s?`${((s||0)/100).toLocaleString("en-IN",{maximumFractionDigits:0})}`:""}function bl(s){return s?`${((s||0)/1e5).toFixed(2)}L`:""}const uy=["PENDING","CONFIRMED","PAID","DISPUTED"];function fy(){const[s,i]=u.useState([]),[r,o]=u.useState(null),[d,f]=u.useState(0),[p,x]=u.useState(1),[m,v]=u.useState(1),[g,b]=u.useState(""),[y,j]=u.useState(!1),[k,_]=u.useState(null),[C,L]=u.useState(0),D=u.useCallback(()=>{j(!0);const P={page:p,limit:30};g&&(P.status=g),Ve.getCommissions(P).then(w=>{i(w.data),f(w.total),v(w.pages),o(w.totals)}).catch(()=>T.error("Failed to load commissions")).finally(()=>j(!1))},[p,g,C]);u.useEffect(()=>{D()},[D]);const I=r?[{label:"Total Earned",value:bl(r.total_paise),cls:"blue",icon:"fa-coins"},{label:"Paid Out",value:bl(r.paid_paise),cls:"green",icon:"fa-check-circle"},{label:"Confirmed",value:bl(r.confirmed_paise),cls:"blue",icon:"fa-thumbs-up"},{label:"Pending",value:bl(r.pending_paise),cls:"amber",icon:"fa-clock"}]:[];return e.jsxs("div",{children:[e.jsx("div",{className:"page-header",children:e.jsxs("div",{children:[e.jsx("h2",{children:"Commissions"}),e.jsxs("div",{className:"subtitle",children:[d," commission records"]})]})}),r&&e.jsx("div",{className:"kpi-grid",style:{marginBottom:24},children:I.map(P=>e.jsxs("div",{className:`kpi-card ${P.cls}`,children:[e.jsx("div",{className:"kpi-label",children:P.label}),e.jsx("div",{className:"kpi-value",style:{fontSize:22},children:P.value}),e.jsx("div",{className:"kpi-footer neutral",children:e.jsx("i",{className:`fas ${P.icon}`})})]},P.label))}),e.jsx("div",{className:"filter-bar",style:{marginBottom:12},children:e.jsxs("select",{className:"filter-select",value:g,onChange:P=>{b(P.target.value),x(1)},children:[e.jsx("option",{value:"",children:"All Statuses"}),uy.map(P=>e.jsx("option",{value:P,children:P},P))]})}),e.jsxs("div",{className:"table-container",children:[e.jsxs("div",{className:"table-header",children:[e.jsx("h3",{children:"Commission Records"}),e.jsxs("span",{className:"results-count",children:["Showing ",s.length," of ",d]})]}),e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Student"}),e.jsx("th",{children:"Phone"}),e.jsx("th",{children:"Sanction Amt"}),e.jsx("th",{children:"Commission %"}),e.jsx("th",{children:"Commission Amt"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Paid At"}),e.jsx("th",{})]})}),e.jsxs("tbody",{children:[y&&e.jsx("tr",{children:e.jsx("td",{colSpan:8,style:{textAlign:"center",padding:40,color:"var(--text-muted)"},children:"Loading..."})}),!y&&s.length===0&&e.jsx("tr",{children:e.jsxs("td",{colSpan:8,style:{textAlign:"center",padding:40,color:"var(--text-muted)"},children:[e.jsx("i",{className:"fas fa-coins",style:{fontSize:24,display:"block",marginBottom:8}}),"No commissions yet. Commissions appear once a case is sanctioned by a bank."]})}),s.map(P=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("div",{className:"student-name",children:P.student_name||""})}),e.jsx("td",{style:{color:"var(--text-muted)",fontSize:12},children:P.phone_e164||""}),e.jsx("td",{style:{color:"var(--text-muted)"},children:tf(P.sanction_amount_paise)}),e.jsx("td",{style:{color:"var(--text-muted)"},children:P.commission_percent?`${P.commission_percent}%`:""}),e.jsx("td",{style:{fontWeight:600,color:P.status==="PAID"?"var(--status-green)":"var(--text-primary)"},children:tf(P.commission_amount_paise)}),e.jsx("td",{children:e.jsx(cy,{status:P.status})}),e.jsx("td",{style:{color:"var(--text-muted)",fontSize:12},children:P.paid_at?new Date(P.paid_at).toLocaleDateString():""}),e.jsx("td",{children:e.jsx("button",{className:"btn btn-sm btn-outline",onClick:()=>_(P),children:"Detail"})})]},P.id))]})]}),m>1&&e.jsxs("div",{className:"pagination",children:[e.jsxs("div",{className:"info",children:["Page ",p," of ",m," (",d," total)"]}),e.jsxs("div",{className:"pagination-btns",children:[e.jsx("button",{onClick:()=>x(P=>P-1),disabled:p<=1,children:e.jsx("i",{className:"fas fa-chevron-left"})}),Array.from({length:Math.min(m,5)},(P,w)=>w+1).map(P=>e.jsx("button",{className:p===P?"active":"",onClick:()=>x(P),children:P},P)),e.jsx("button",{onClick:()=>x(P=>P+1),disabled:p>=m,children:e.jsx("i",{className:"fas fa-chevron-right"})})]})]})]}),k&&e.jsx(hy,{commission:k,onClose:()=>_(null),onUpdated:()=>{_(null),L(P=>P+1)}})]})}function hy({commission:s,onClose:i,onUpdated:r}){const[o,d]=u.useState(""),[f,p]=u.useState(!1);async function x(){if(o.trim()){p(!0);try{await Ve.updateCommission(s.id,{status:"DISPUTED"}),T.success("Commission marked as disputed. Nexthara team will review."),r()}catch(g){T.error(g.message)}finally{p(!1)}}}const m=["PENDING","CONFIRMED"].includes(s.status),v=g=>g?`${((g||0)/100).toLocaleString("en-IN",{maximumFractionDigits:0})}`:"";return e.jsx("div",{className:"modal-overlay show",children:e.jsxs("div",{className:"modal",style:{marginTop:60},children:[e.jsxs("div",{className:"modal-header",style:{background:"var(--header-gradient)",color:"#fff",borderRadius:"12px 12px 0 0"},children:[e.jsxs("div",{children:[e.jsx("h3",{style:{color:"#fff"},children:"Commission Detail"}),e.jsx("div",{style:{fontSize:12,color:"rgba(255,255,255,0.75)",marginTop:3},children:s.student_name})]}),e.jsx("button",{className:"modal-close",style:{background:"rgba(255,255,255,0.15)",color:"#fff"},onClick:i,children:""})]}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{className:s.status==="PAID"?"sanction-card":"update-form",style:{marginTop:0,marginBottom:20,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:26,fontWeight:800,color:s.status==="PAID"?"var(--status-green)":"var(--text-primary)"},children:v(s.commission_amount_paise)}),e.jsxs("div",{style:{fontSize:12,color:"var(--text-muted)",marginTop:2},children:[s.commission_percent,"% of ",v(s.sanction_amount_paise)]})]}),e.jsx("span",{className:`badge ${dh[s.status]||"badge-grey"}`,children:s.status})]}),e.jsx("div",{className:"detail-grid",children:[["Student",s.student_name],["Case ID",s.case_id?`#${s.case_id.slice(0,10)}`:null],["Sanction Amount",v(s.sanction_amount_paise)],["Commission Rate",s.commission_percent?`${s.commission_percent}%`:null],["Commission Amount",v(s.commission_amount_paise)],["Invoice Number",s.invoice_number],["Paid At",s.paid_at?new Date(s.paid_at).toLocaleString():null],["Created",new Date(s.created_at).toLocaleDateString()]].map(([g,b])=>b?e.jsxs("div",{className:"detail-item",children:[e.jsx("label",{children:g}),e.jsx("div",{className:"value",children:b})]},g):null)}),m&&e.jsxs("div",{className:"update-form",style:{marginTop:20},children:[e.jsx("h4",{children:"Raise Dispute"}),e.jsxs("div",{className:"bank-panel-warning",children:[e.jsx("i",{className:"fas fa-exclamation-triangle"}),"If the commission amount or details are incorrect, raise a dispute. Nexthara's accounts team will review within 35 business days."]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Explain the discrepancy"}),e.jsx("textarea",{rows:3,value:o,onChange:g=>d(g.target.value),placeholder:"Describe the issue..."})]}),e.jsx("div",{className:"form-actions",children:e.jsx("button",{className:"btn",style:{background:"var(--status-red)",color:"#fff",border:"none"},onClick:x,disabled:f||!o.trim(),children:f?"Submitting...":"Raise Dispute"})})]}),s.status==="DISPUTED"&&e.jsx("div",{className:"bank-panel-warning",style:{marginTop:16},children:e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:600},children:"Dispute Filed"}),e.jsx("div",{style:{marginTop:4},children:"This commission is under review by the Nexthara accounts team."})]})}),s.status==="PAID"&&e.jsxs("div",{style:{marginTop:16,padding:"12px 14px",background:"var(--status-green-bg)",borderRadius:6,border:"1px solid #a5d6a7"},children:[e.jsx("div",{style:{fontSize:12,fontWeight:600,color:"var(--status-green)"},children:"Commission Paid"}),e.jsx("div",{style:{fontSize:12,color:"#388e3c",marginTop:4},children:s.paid_at?`Paid on ${new Date(s.paid_at).toLocaleDateString()}`:"Payment confirmed by accounts team"})]})]})]})})}const py={NEW:"var(--status-grey)",CONTACT_ATTEMPTED:"var(--status-amber)",CONNECTED:"var(--status-blue)",QUALIFIED:"var(--status-purple)",DOCS_REQUESTED:"#ad1457",DOCS_RECEIVED:"#00838f",CASE_CREATED:"var(--status-green)",DROPPED:"var(--status-red)",LOST:"#991b1b",DUPLICATE:"var(--status-grey)"},xy={PENDING:"badge-amber",CONFIRMED:"badge-blue",PAID:"badge-green",DISPUTED:"badge-red"};function To(s){return s?`${((s||0)/1e5).toFixed(1)}L`:"0"}function gy(s,i){return i?`${Math.round(s/i*100)}%`:"0%"}function my(){var C;const[s,i]=u.useState(null),[r,o]=u.useState(!0);if(u.useEffect(()=>{Ve.getReports().then(i).catch(()=>T.error("Failed to load reports")).finally(()=>o(!1))},[]),r)return e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:300,color:"var(--text-muted)",flexDirection:"column",gap:12},children:[e.jsx("i",{className:"fas fa-spinner fa-spin",style:{fontSize:28,color:"var(--sbi-accent)"}}),"Loading reports..."]});if(!s)return null;const{leadsByStage:d,leadsByMonth:f,conversionRate:p,commByStatus:x}=s,m=(p==null?void 0:p.total)||0,v=(p==null?void 0:p.converted)||0,g=m?Math.round(v/m*100):0,b=Math.max(...(d==null?void 0:d.map(L=>L.count))||[1],1),y=Math.max(...(f==null?void 0:f.map(L=>L.count))||[1],1),j=(x==null?void 0:x.reduce((L,D)=>L+D.total_paise,0))||0,k=((C=x==null?void 0:x.find(L=>L.status==="PAID"))==null?void 0:C.total_paise)||0,_=[{label:"Total Leads",value:m,cls:"blue",icon:"fa-user-plus",footer:"All leads in pipeline"},{label:"Cases Created",value:v,cls:"green",icon:"fa-briefcase",footer:"Leads converted to cases"},{label:"LeadCase Rate",value:`${g}%`,cls:"purple",icon:"fa-percentage",footer:"Conversion rate"},{label:"Total Commission",value:To(j),cls:"amber",icon:"fa-coins",footer:"Across all statuses"},{label:"Commission Paid",value:To(k),cls:"green",icon:"fa-check-circle",footer:"Successfully disbursed"}];return e.jsxs("div",{children:[e.jsx("div",{className:"page-header",children:e.jsxs("div",{children:[e.jsx("h2",{children:"Reports"}),e.jsx("div",{className:"subtitle",children:"Performance overview and commission analytics"})]})}),e.jsx("div",{className:"kpi-grid",style:{marginBottom:24},children:_.map(L=>e.jsxs("div",{className:`kpi-card ${L.cls}`,children:[e.jsx("div",{className:"kpi-label",children:L.label}),e.jsx("div",{className:"kpi-value",children:L.value??""}),e.jsxs("div",{className:"kpi-footer neutral",children:[e.jsx("i",{className:`fas ${L.icon}`})," ",L.footer]})]},L.label))}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16,marginBottom:20},children:[e.jsxs("div",{className:"table-container",style:{padding:20},children:[e.jsx("div",{className:"table-header",style:{padding:"0 0 14px 0",border:"none"},children:e.jsxs("h3",{children:[e.jsx("i",{className:"fas fa-filter",style:{marginRight:8,color:"var(--sbi-accent)"}}),"Leads by Stage"]})}),(d||[]).map(L=>{var D;return e.jsxs("div",{style:{marginBottom:12},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:5,fontSize:12},children:[e.jsx("span",{style:{color:"var(--text-secondary)"},children:(D=L.stage)==null?void 0:D.replace(/_/g," ")}),e.jsx("span",{style:{fontWeight:600,color:"var(--text-primary)"},children:L.count})]}),e.jsx("div",{style:{height:7,background:"#f0f2f5",borderRadius:4,overflow:"hidden"},children:e.jsx("div",{style:{height:"100%",width:`${L.count/b*100}%`,background:py[L.stage]||"var(--sbi-accent)",borderRadius:4,transition:"width 0.5s"}})})]},L.stage)}),(d==null?void 0:d.length)===0&&e.jsx("div",{style:{color:"var(--text-muted)",fontSize:13},children:"No lead data yet."})]}),e.jsxs("div",{className:"table-container",style:{padding:20},children:[e.jsx("div",{className:"table-header",style:{padding:"0 0 14px 0",border:"none"},children:e.jsxs("h3",{children:[e.jsx("i",{className:"fas fa-chart-bar",style:{marginRight:8,color:"var(--sbi-accent)"}}),"Leads by Month (Last 12)"]})}),(f||[]).length===0&&e.jsx("div",{style:{color:"var(--text-muted)",fontSize:13},children:"No data yet."}),e.jsx("div",{style:{display:"flex",gap:6,alignItems:"flex-end",height:140},children:[...f||[]].reverse().map(L=>{var D;return e.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",gap:4},children:[e.jsx("div",{style:{fontSize:10,color:"var(--text-muted)",fontWeight:600},children:L.count}),e.jsx("div",{style:{width:"100%",height:`${Math.max(L.count/y*110,4)}px`,background:"var(--sbi-accent)",borderRadius:"3px 3px 0 0",opacity:.8}}),e.jsx("div",{style:{fontSize:9,color:"var(--text-muted)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:30,textAlign:"center"},children:(D=L.month)==null?void 0:D.slice(5)})]},L.month)})})]})]}),e.jsxs("div",{className:"table-container",style:{padding:0,overflow:"hidden",marginBottom:20},children:[e.jsx("div",{className:"table-header",children:e.jsxs("h3",{children:[e.jsx("i",{className:"fas fa-coins",style:{marginRight:8,color:"var(--sbi-accent)"}}),"Commission Summary"]})}),(x||[]).length===0?e.jsx("div",{style:{padding:"32px 20px",textAlign:"center",color:"var(--text-muted)"},children:"No commission data yet."}):e.jsx("div",{style:{padding:20,display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(180px, 1fr))",gap:16},children:x.map(L=>e.jsxs("div",{style:{padding:"16px 18px",borderRadius:8,border:"1px solid var(--border-color)",background:"#f8f9fb"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[e.jsx("span",{className:`badge ${xy[L.status]||"badge-grey"}`,children:L.status}),e.jsxs("span",{style:{fontSize:12,color:"var(--text-muted)"},children:[L.count," cases"]})]}),e.jsx("div",{style:{fontSize:22,fontWeight:700,color:"var(--text-primary)"},children:To(L.total_paise)}),e.jsxs("div",{style:{fontSize:11,color:"var(--text-muted)",marginTop:2},children:[gy(L.total_paise,j)," of total"]})]},L.status))})]}),e.jsxs("div",{className:"table-container",style:{padding:20},children:[e.jsx("div",{className:"table-header",style:{padding:"0 0 14px 0",border:"none"},children:e.jsxs("h3",{children:[e.jsx("i",{className:"fas fa-funnel-dollar",style:{marginRight:8,color:"var(--sbi-accent)"}}),"Lead  Case Conversion"]})}),e.jsx("div",{style:{display:"flex",gap:0,alignItems:"center",flexWrap:"wrap"},children:[{label:"Total Leads",value:m,cls:"grey"},{label:"Cases Created",value:v,cls:"green"},{label:"Conversion Rate",value:`${g}%`,cls:"purple"}].map((L,D)=>e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsxs("div",{className:`kpi-card ${L.cls}`,style:{textAlign:"center",minWidth:160,margin:0},children:[e.jsx("div",{className:"kpi-value",children:L.value}),e.jsx("div",{className:"kpi-label",style:{marginTop:4},children:L.label})]}),D<2&&e.jsx("div",{style:{fontSize:20,color:"var(--border-color)",padding:"0 12px"},children:""})]},L.label))})]})]})}const pe={primary:"#2563EB",light:"#DBEAFE",bg:"#F8FAFC",card:"#FFFFFF",border:"#E5E7EB",text:"#0F172A",muted:"#64748B"},yy=[{key:"org",label:"Organization",icon:"fa-building"},{key:"branches",label:"Branches",icon:"fa-code-branch"},{key:"users",label:"Users & Roles",icon:"fa-users"},{key:"whatsapp",label:"WhatsApp",icon:"fa-comment-dots"},{key:"audit",label:"Audit Logs",icon:"fa-shield-alt"}],vy=["ORG_OWNER","BRANCH_MANAGER","COUNSELOR","ACCOUNTANT","VIEW_ONLY"],ch={ORG_OWNER:"Owner",BRANCH_MANAGER:"Branch Mgr",COUNSELOR:"Counselor",ACCOUNTANT:"Accountant",VIEW_ONLY:"View Only"},by={ORG_OWNER:"#7C3AED",BRANCH_MANAGER:"#1D4ED8",COUNSELOR:"#0891B2",ACCOUNTANT:"#D97706",VIEW_ONLY:"#6B7280"};function jy({role:s}){const i=by[s]||"#6B7280";return e.jsx("span",{style:{fontSize:11,fontWeight:700,padding:"2px 8px",borderRadius:20,background:`${i}20`,color:i},children:ch[s]||s})}function Sy(){const{user:s}=ks(),[i,r]=u.useState("org"),o=["ORG_OWNER","BRANCH_MANAGER"].includes(s==null?void 0:s.role);return e.jsxs("div",{children:[e.jsxs("div",{style:{marginBottom:20},children:[e.jsx("h2",{style:{margin:0,fontSize:18,fontWeight:700,color:pe.text},children:"Settings"}),e.jsx("div",{style:{fontSize:12,color:pe.muted},children:"Manage your organization, users and preferences"})]}),e.jsx("div",{style:{display:"flex",gap:0,borderBottom:`1px solid ${pe.border}`,marginBottom:24},children:yy.map(d=>e.jsxs("button",{onClick:()=>r(d.key),style:{padding:"9px 18px",border:"none",background:"none",cursor:"pointer",fontSize:13,fontWeight:i===d.key?600:500,color:i===d.key?pe.primary:pe.muted,borderBottom:i===d.key?`2px solid ${pe.primary}`:"2px solid transparent",marginBottom:-1,display:"flex",gap:6,alignItems:"center"},children:[e.jsx("i",{className:`fas ${d.icon}`,style:{fontSize:12}}),d.label]},d.key))}),i==="org"&&e.jsx(ky,{canManage:o}),i==="branches"&&e.jsx(Ny,{canManage:o}),i==="users"&&e.jsx(Cy,{canManage:o,user:s}),i==="whatsapp"&&e.jsx(_y,{}),i==="audit"&&e.jsx(wy,{})]})}function ky({canManage:s}){const[i,r]=u.useState(null),[o,d]=u.useState(!1),[f,p]=u.useState({}),[x,m]=u.useState(!1);u.useEffect(()=>{Ve.getProfile().then(g=>{r(g),p({name:g.name,legal_name:g.legal_name||"",gstin:g.gstin||""})}).catch(()=>T.error("Failed to load org profile"))},[]);async function v(){m(!0);try{const g=await Ve.updateProfile(f);r(g),d(!1),T.success("Organization profile updated")}catch(g){T.error(g.message)}finally{m(!1)}}return i?e.jsxs("div",{style:{background:pe.card,border:`1px solid ${pe.border}`,borderRadius:10,padding:24,maxWidth:520},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:20},children:[e.jsx("div",{style:{fontWeight:600,fontSize:15,color:pe.text},children:"Organization Profile"}),s&&!o&&e.jsx("button",{onClick:()=>d(!0),style:{padding:"6px 14px",background:pe.light,color:pe.primary,border:"none",borderRadius:7,fontWeight:600,fontSize:13,cursor:"pointer"},children:"Edit"})]}),o?e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:14},children:[e.jsx(hn,{label:"Organization Name *",value:f.name,onChange:g=>p(b=>({...b,name:g}))}),e.jsx(hn,{label:"Legal Name",value:f.legal_name,onChange:g=>p(b=>({...b,legal_name:g}))}),e.jsx(hn,{label:"GSTIN",value:f.gstin,onChange:g=>p(b=>({...b,gstin:g}))}),e.jsxs("div",{style:{display:"flex",gap:10,marginTop:4},children:[e.jsx("button",{onClick:()=>d(!1),style:{flex:1,padding:"9px",border:`1px solid ${pe.border}`,borderRadius:8,background:"transparent",cursor:"pointer",fontWeight:600,fontSize:13,color:pe.muted},children:"Cancel"}),e.jsx("button",{onClick:v,disabled:x,style:{flex:1,padding:"9px",background:pe.primary,color:"#fff",border:"none",borderRadius:8,fontWeight:600,fontSize:13,cursor:"pointer",opacity:x?.7:1},children:x?"Saving...":"Save Changes"})]})]}):e.jsxs("div",{children:[e.jsx(ea,{label:"Organization Name",value:i.name}),e.jsx(ea,{label:"Legal Name",value:i.legal_name}),e.jsx(ea,{label:"GSTIN",value:i.gstin}),e.jsx(ea,{label:"Status",value:e.jsx("span",{style:{fontSize:12,fontWeight:700,padding:"2px 8px",borderRadius:20,background:i.status==="ACTIVE"?"#DCFCE7":"#FEE2E2",color:i.status==="ACTIVE"?"#166534":"#991B1B"},children:i.status})}),e.jsx(ea,{label:"Plan",value:i.plan_id||"STARTER"}),e.jsx(ea,{label:"Member Since",value:new Date(i.created_at).toLocaleDateString()})]})]}):e.jsx("div",{style:{color:pe.muted,padding:24},children:"Loading..."})}function Ny({canManage:s}){const[i,r]=u.useState([]),[o,d]=u.useState(!1),[f,p]=u.useState({name:"",city:"",timezone:"Asia/Kolkata"}),[x,m]=u.useState(!1);function v(){Ve.getBranches().then(r).catch(()=>T.error("Failed to load branches"))}u.useEffect(()=>{v()},[]);async function g(b){b.preventDefault(),m(!0);try{await Ve.createBranch(f),T.success("Branch created"),d(!1),p({name:"",city:"",timezone:"Asia/Kolkata"}),v()}catch(y){T.error(y.message)}finally{m(!1)}}return e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[e.jsxs("div",{style:{fontWeight:600,fontSize:15,color:pe.text},children:[i.length," Branch",i.length!==1?"es":""]}),s&&e.jsxs("button",{onClick:()=>d(b=>!b),style:{padding:"7px 14px",background:pe.primary,color:"#fff",border:"none",borderRadius:8,fontWeight:600,fontSize:13,cursor:"pointer"},children:[e.jsx("i",{className:"fas fa-plus",style:{marginRight:6}}),"Add Branch"]})]}),o&&e.jsxs("form",{onSubmit:g,style:{background:pe.card,border:`1px solid ${pe.border}`,borderRadius:10,padding:20,marginBottom:16,display:"flex",flexDirection:"column",gap:12},children:[e.jsx("div",{style:{fontWeight:600,fontSize:14,color:pe.text,marginBottom:4},children:"New Branch"}),e.jsx(hn,{label:"Branch Name *",value:f.name,onChange:b=>p(y=>({...y,name:b})),required:!0}),e.jsx(hn,{label:"City",value:f.city,onChange:b=>p(y=>({...y,city:b}))}),e.jsx(hn,{label:"Timezone",value:f.timezone,onChange:b=>p(y=>({...y,timezone:b}))}),e.jsxs("div",{style:{display:"flex",gap:10,marginTop:4},children:[e.jsx("button",{type:"button",onClick:()=>d(!1),style:{flex:1,padding:"9px",border:`1px solid ${pe.border}`,borderRadius:8,background:"transparent",cursor:"pointer",fontWeight:600,fontSize:13,color:pe.muted},children:"Cancel"}),e.jsx("button",{type:"submit",disabled:x,style:{flex:1,padding:"9px",background:pe.primary,color:"#fff",border:"none",borderRadius:8,fontWeight:600,fontSize:13,cursor:"pointer",opacity:x?.7:1},children:x?"Creating...":"Create Branch"})]})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:10},children:[i.length===0&&e.jsx("div",{style:{color:pe.muted,fontSize:13},children:"No branches found."}),i.map(b=>e.jsxs("div",{style:{background:pe.card,border:`1px solid ${pe.border}`,borderRadius:10,padding:"14px 18px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:600,fontSize:14,color:pe.text},children:b.name}),e.jsxs("div",{style:{fontSize:12,color:pe.muted,marginTop:2},children:[b.city||"No city","  ",b.timezone]})]}),e.jsx("div",{style:{fontSize:11,color:pe.muted},children:new Date(b.created_at).toLocaleDateString()})]},b.id))]})]})}function Cy({canManage:s,user:i}){const[r,o]=u.useState([]),[d,f]=u.useState(!1),[p,x]=u.useState({name:"",email:"",phone_e164:"",password:"",role:"COUNSELOR"}),[m,v]=u.useState(!1);function g(){Ve.getUsers().then(o).catch(()=>T.error("Failed to load users"))}u.useEffect(()=>{g()},[]);async function b(j){j.preventDefault(),v(!0);try{await Ve.createUser(p),T.success("User created"),f(!1),x({name:"",email:"",phone_e164:"",password:"",role:"COUNSELOR"}),g()}catch(k){T.error(k.message)}finally{v(!1)}}async function y(j){try{await Ve.updateUser(j.id,{is_active:j.is_active?0:1}),T.success(`User ${j.is_active?"deactivated":"activated"}`),g()}catch(k){T.error(k.message)}}return e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[e.jsxs("div",{style:{fontWeight:600,fontSize:15,color:pe.text},children:[r.length," Team Member",r.length!==1?"s":""]}),s&&e.jsxs("button",{onClick:()=>f(j=>!j),style:{padding:"7px 14px",background:pe.primary,color:"#fff",border:"none",borderRadius:8,fontWeight:600,fontSize:13,cursor:"pointer"},children:[e.jsx("i",{className:"fas fa-plus",style:{marginRight:6}}),"Add User"]})]}),d&&e.jsxs("form",{onSubmit:b,style:{background:pe.card,border:`1px solid ${pe.border}`,borderRadius:10,padding:20,marginBottom:16,display:"flex",flexDirection:"column",gap:12},children:[e.jsx("div",{style:{fontWeight:600,fontSize:14,color:pe.text,marginBottom:4},children:"Invite New User"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[e.jsx(hn,{label:"Full Name *",value:p.name,onChange:j=>x(k=>({...k,name:j})),required:!0}),e.jsx(hn,{label:"Email *",value:p.email,onChange:j=>x(k=>({...k,email:j})),type:"email",required:!0}),e.jsx(hn,{label:"Phone",value:p.phone_e164,onChange:j=>x(k=>({...k,phone_e164:j})),placeholder:"+91..."}),e.jsx(hn,{label:"Temp Password *",value:p.password,onChange:j=>x(k=>({...k,password:j})),type:"password",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,fontWeight:600,color:pe.muted,display:"block",marginBottom:4},children:"Role"}),e.jsx("select",{value:p.role,onChange:j=>x(k=>({...k,role:j.target.value})),style:{width:"100%",padding:"8px 10px",border:`1px solid ${pe.border}`,borderRadius:7,fontSize:13,color:pe.text,background:pe.bg,outline:"none"},children:vy.map(j=>e.jsx("option",{value:j,children:ch[j]},j))})]}),e.jsxs("div",{style:{display:"flex",gap:10,marginTop:4},children:[e.jsx("button",{type:"button",onClick:()=>f(!1),style:{flex:1,padding:"9px",border:`1px solid ${pe.border}`,borderRadius:8,background:"transparent",cursor:"pointer",fontWeight:600,fontSize:13,color:pe.muted},children:"Cancel"}),e.jsx("button",{type:"submit",disabled:m,style:{flex:1,padding:"9px",background:pe.primary,color:"#fff",border:"none",borderRadius:8,fontWeight:600,fontSize:13,cursor:"pointer",opacity:m?.7:1},children:m?"Creating...":"Create User"})]})]}),e.jsxs("div",{style:{background:"#F0F9FF",border:"1px solid #BAE6FD",borderRadius:8,padding:"10px 14px",marginBottom:16,fontSize:12,color:"#0C4A6E"},children:[e.jsx("strong",{children:"Role Permissions:"})," Owner = full access  Branch Mgr = leads/cases/docs/branch users  Counselor = leads/cases/docs  Accountant = commissions view  View Only = read only"]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:10},children:[r.length===0&&e.jsx("div",{style:{color:pe.muted,fontSize:13},children:"No users found."}),r.map(j=>{var k,_;return e.jsxs("div",{style:{background:pe.card,border:`1px solid ${pe.border}`,borderRadius:10,padding:"14px 18px",display:"flex",justifyContent:"space-between",alignItems:"center",opacity:j.is_active?1:.5},children:[e.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center"},children:[e.jsx("div",{style:{width:36,height:36,borderRadius:"50%",background:pe.light,display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:e.jsx("span",{style:{fontWeight:700,fontSize:14,color:pe.primary},children:(_=(k=j.name)==null?void 0:k[0])==null?void 0:_.toUpperCase()})}),e.jsxs("div",{children:[e.jsxs("div",{style:{fontWeight:600,fontSize:14,color:pe.text,display:"flex",gap:8,alignItems:"center"},children:[j.name,j.id===(i==null?void 0:i.id)&&e.jsx("span",{style:{fontSize:10,color:pe.muted},children:"(you)"})]}),e.jsx("div",{style:{fontSize:12,color:pe.muted},children:j.email})]})]}),e.jsxs("div",{style:{display:"flex",gap:10,alignItems:"center"},children:[e.jsx(jy,{role:j.role}),s&&j.id!==(i==null?void 0:i.id)&&e.jsx("button",{onClick:()=>y(j),style:{padding:"4px 10px",background:j.is_active?"#FEE2E2":"#DCFCE7",color:j.is_active?"#DC2626":"#16A34A",border:"none",borderRadius:6,cursor:"pointer",fontSize:12,fontWeight:600},children:j.is_active?"Deactivate":"Activate"})]})]},j.id)})]})]})}function _y(){return e.jsxs("div",{style:{background:pe.card,border:`1px solid ${pe.border}`,borderRadius:10,padding:28,maxWidth:520},children:[e.jsx("div",{style:{fontWeight:600,fontSize:15,color:pe.text,marginBottom:12},children:"WhatsApp Configuration"}),e.jsx("div",{style:{padding:"16px 18px",background:"#F0FDF4",border:"1px solid #86EFAC",borderRadius:8,marginBottom:20},children:e.jsxs("div",{style:{display:"flex",gap:10,alignItems:"center"},children:[e.jsx("i",{className:"fab fa-whatsapp",style:{fontSize:24,color:"#25D366"}}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:600,fontSize:13,color:"#166534"},children:"WhatsApp Business API"}),e.jsx("div",{style:{fontSize:12,color:"#15803D",marginTop:2},children:"Connect your WhatsApp Business number to send automated messages to students."})]})]})}),e.jsxs("div",{style:{fontSize:13,color:pe.muted,lineHeight:1.7},children:["WhatsApp Business API integration is available on the ",e.jsx("strong",{children:"Pro"})," and ",e.jsx("strong",{children:"Enterprise"})," plans.",e.jsx("br",{}),e.jsx("br",{}),"Features include:",e.jsx("br",{})," Automated follow-up reminders to students",e.jsx("br",{})," Document request notifications",e.jsx("br",{})," Status update broadcasts",e.jsx("br",{})," Template message management",e.jsx("br",{}),e.jsx("br",{}),"Contact ",e.jsx("strong",{children:"support@nexthara.com"})," to upgrade your plan and configure WhatsApp integration."]}),e.jsxs("button",{style:{marginTop:20,padding:"10px 20px",background:"#25D366",color:"#fff",border:"none",borderRadius:8,fontWeight:600,fontSize:13,cursor:"pointer"},children:[e.jsx("i",{className:"fab fa-whatsapp",style:{marginRight:8}}),"Request WhatsApp Setup"]})]})}function wy(){return e.jsxs("div",{style:{background:pe.card,border:`1px solid ${pe.border}`,borderRadius:10,padding:28},children:[e.jsx("div",{style:{fontWeight:600,fontSize:15,color:pe.text,marginBottom:8},children:"Audit Logs"}),e.jsx("div",{style:{fontSize:13,color:pe.muted,marginBottom:20},children:"Track all actions taken by your team within this organization."}),e.jsxs("div",{style:{padding:"14px 16px",background:"#F0F9FF",borderRadius:8,border:"1px solid #BAE6FD",fontSize:12,color:"#0C4A6E",lineHeight:1.7},children:[e.jsx("strong",{children:"Audit trail includes:"}),e.jsx("br",{})," Lead creation and stage updates",e.jsx("br",{})," Case conversions",e.jsx("br",{})," Document uploads",e.jsx("br",{})," User account changes",e.jsx("br",{})," Commission disputes",e.jsx("br",{}),e.jsx("br",{}),"Audit log export and advanced filtering is available on the ",e.jsx("strong",{children:"Enterprise"})," plan."]})]})}function hn({label:s,value:i,onChange:r,type:o="text",required:d,placeholder:f}){return e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,fontWeight:600,color:pe.muted,display:"block",marginBottom:4},children:s}),e.jsx("input",{type:o,required:d,placeholder:f||"",value:i,onChange:p=>r(p.target.value),style:{width:"100%",padding:"8px 10px",border:`1px solid ${pe.border}`,borderRadius:7,fontSize:13,color:pe.text,background:pe.bg,boxSizing:"border-box",outline:"none"}})]})}function ea({label:s,value:i}){return e.jsxs("div",{style:{display:"flex",padding:"8px 0",borderBottom:`1px solid ${pe.border}`},children:[e.jsx("div",{style:{width:160,flexShrink:0,fontSize:12,color:pe.muted,fontWeight:500},children:s}),e.jsx("div",{style:{fontSize:13,color:pe.text,flex:1},children:i??""})]})}const nf=[{key:"dashboard",label:"Dashboard",icon:"fa-chart-line"},{key:"leads",label:"Leads",icon:"fa-user-plus"},{key:"cases",label:"Cases",icon:"fa-briefcase"},{key:"bank-apps",label:"Bank Applications",icon:"fa-university"},{key:"students",label:"Students",icon:"fa-graduation-cap"},{key:"commissions",label:"Commissions",icon:"fa-rupee-sign"},{key:"reports",label:"Reports",icon:"fa-chart-bar"},{key:"settings",label:"Settings",icon:"fa-cog"}];function Ey(){var x,m,v,g;const{user:s,logout:i}=ks(),[r,o]=u.useState("dashboard"),[d,f]=u.useState(!0),p=u.useCallback(b=>o(b),[]);return e.jsxs("div",{style:{display:"flex",minHeight:"100vh",background:"var(--body-bg)",fontFamily:"Roboto, sans-serif"},children:[e.jsxs("aside",{style:{width:d?240:64,flexShrink:0,background:"var(--sidebar-bg)",display:"flex",flexDirection:"column",transition:"width 0.2s",overflow:"hidden",position:"sticky",top:0,height:"100vh"},children:[e.jsx("div",{style:{padding:"18px 16px",borderBottom:"1px solid rgba(255,255,255,0.1)",display:"flex",alignItems:"center",gap:10,flexShrink:0},children:d?e.jsxs("div",{style:{flex:1},children:[e.jsx(ai,{height:26,dark:!0}),e.jsx("div",{style:{fontSize:10,color:"rgba(255,255,255,0.5)",marginTop:3},children:"Agent Portal"})]}):e.jsx("div",{style:{width:32,height:32,borderRadius:6,background:"rgba(255,255,255,0.15)",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,fontWeight:700,color:"#fff",fontSize:14},children:"N"})}),e.jsx("nav",{style:{flex:1,padding:"8px 0",overflowY:"auto"},children:nf.map(b=>{const y=r===b.key;return e.jsxs("div",{className:`sidebar-item${y?" active":""}`,onClick:()=>p(b.key),title:d?"":b.label,style:{padding:d?"11px 20px":"11px 0",justifyContent:d?"flex-start":"center"},children:[e.jsx("i",{className:`fas ${b.icon}`}),d&&e.jsx("span",{children:b.label})]},b.key)})}),e.jsxs("div",{style:{borderTop:"1px solid rgba(255,255,255,0.1)",padding:"8px 0",flexShrink:0},children:[d&&e.jsxs("div",{style:{padding:"8px 20px",marginBottom:2},children:[e.jsx("div",{style:{fontSize:12,fontWeight:600,color:"rgba(255,255,255,0.9)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:(s==null?void 0:s.org_name)||"My Organization"}),e.jsx("div",{style:{fontSize:11,color:"rgba(255,255,255,0.5)",marginTop:1},children:(x=s==null?void 0:s.role)==null?void 0:x.replace("_"," ")})]}),e.jsxs("div",{className:"sidebar-item",onClick:i,title:"Logout",style:{color:"#ef9a9a",padding:d?"11px 20px":"11px 0",justifyContent:d?"flex-start":"center"},children:[e.jsx("i",{className:"fas fa-sign-out-alt"}),d&&e.jsx("span",{children:"Logout"})]})]})]}),e.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",minWidth:0},children:[e.jsxs("header",{style:{background:"var(--header-gradient)",color:"#fff",display:"flex",alignItems:"center",padding:"0 20px",gap:16,height:56,flexShrink:0,boxShadow:"0 2px 8px rgba(0,0,0,0.2)"},children:[e.jsx("button",{onClick:()=>f(b=>!b),style:{background:"rgba(255,255,255,0.1)",border:"1px solid rgba(255,255,255,0.2)",color:"#fff",width:34,height:34,borderRadius:8,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:15,flexShrink:0},children:e.jsx("i",{className:"fas fa-bars"})}),e.jsx("div",{style:{flex:1,fontSize:15,fontWeight:600,letterSpacing:.3},children:((m=nf.find(b=>b.key===r))==null?void 0:m.label)||""}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[e.jsx("div",{className:"user-avatar",style:{width:32,height:32,fontSize:13},children:(g=(v=s==null?void 0:s.name)==null?void 0:v[0])==null?void 0:g.toUpperCase()}),e.jsx("span",{style:{fontSize:13,color:"rgba(255,255,255,0.9)",fontWeight:500},children:s==null?void 0:s.name})]})]}),e.jsxs("main",{style:{flex:1,overflowY:"auto",padding:24,background:"var(--body-bg)"},children:[r==="dashboard"&&e.jsx(Qm,{}),r==="leads"&&e.jsx(qm,{}),r==="cases"&&e.jsx(ey,{}),r==="bank-apps"&&e.jsx(ay,{}),r==="students"&&e.jsx(oy,{}),r==="commissions"&&e.jsx(fy,{}),r==="reports"&&e.jsx(my,{}),r==="settings"&&e.jsx(Sy,{})]})]})]})}const Ry=["MIN_INCOME","MIN_CIBIL","COUNTRY","COURSE_TYPE","MAX_AGE","COLLATERAL_MIN"];function Ay({bankId:s}){var me,be,je,V;const[i,r]=u.useState(null),[o,d]=u.useState([]),[f,p]=u.useState(null),[x,m]=u.useState(null),[v,g]=u.useState("bank"),[b,y]=u.useState(!0),[j,k]=u.useState(!1),[_,C]=u.useState(!1),[L,D]=u.useState(!1),[I,P]=u.useState(!1),[w,A]=u.useState({}),[N,W]=u.useState({product_name:"",loan_type:"UNSECURED",min_amount_paise:"",max_amount_paise:"",interest_range:"",tenure_range:"",processing_fee_percent:"",collateral_required:!1,coapp_required:!1}),[F,Z]=u.useState({criteria_type:"MIN_INCOME",criteria_value:""}),[ce,xe]=u.useState({doc_code:"",mandatory:!0,order_no:""}),z=async()=>{y(!0);try{const[q,re]=await Promise.all([_e.getBank(s),_e.getProducts(s)]);r(q),d(re),A({name:q.name,logo_url:q.logo_url||"",country:q.country||"India",default_sla_days:q.default_sla_days||7})}catch{T.error("Failed to load bank data")}y(!1)};u.useEffect(()=>{s&&z()},[s]);const X=async q=>{try{const re=await _e.getProduct(q);m(re)}catch{T.error("Failed to load product details")}};u.useEffect(()=>{f&&X(f)},[f]);const de=async()=>{P(!0);try{await _e.updateBank(s,w),T.success("Bank details updated")}catch(q){T.error(q.message)}P(!1)},oe=async()=>{P(!0);try{await _e.createProduct(s,{...N,min_amount_paise:parseInt(N.min_amount_paise)||0,max_amount_paise:parseInt(N.max_amount_paise)||0,processing_fee_percent:parseFloat(N.processing_fee_percent)||0}),T.success("Product created"),k(!1),W({product_name:"",loan_type:"UNSECURED",min_amount_paise:"",max_amount_paise:"",interest_range:"",tenure_range:"",processing_fee_percent:"",collateral_required:!1,coapp_required:!1});const q=await _e.getProducts(s);d(q)}catch(q){T.error(q.message)}P(!1)},ve=async q=>{if(window.confirm("Delete this product and all its criteria/documents?"))try{await _e.deleteProduct(q),T.success("Product deleted"),f===q&&(p(null),m(null));const re=await _e.getProducts(s);d(re)}catch(re){T.error(re.message)}},Y=async()=>{P(!0);try{let q=F.criteria_value;try{q=JSON.parse(q)}catch{}await _e.addCriterion(f,{criteria_type:F.criteria_type,criteria_value:q}),T.success("Criterion added"),C(!1),await X(f)}catch(q){T.error(q.message)}P(!1)},se=async q=>{try{await _e.deleteCriterion(q),T.success("Removed"),await X(f)}catch(re){T.error(re.message)}},J=async()=>{P(!0);try{await _e.addProductDoc(f,{doc_code:ce.doc_code,mandatory:ce.mandatory,order_no:parseInt(ce.order_no)||0}),T.success("Document added"),D(!1),xe({doc_code:"",mandatory:!0,order_no:""}),await X(f)}catch(q){T.error(q.message)}P(!1)},O=async q=>{try{await _e.deleteProductDoc(q),T.success("Removed"),await X(f)}catch(re){T.error(re.message)}};if(b)return e.jsx("div",{style:{textAlign:"center",padding:60,color:"#6b7280"},children:e.jsx("i",{className:"fas fa-spinner fa-spin",style:{fontSize:24}})});const U={width:"100%",padding:"8px 12px",border:"1px solid #d1d5db",borderRadius:6,fontSize:13,outline:"none",fontFamily:"Roboto, sans-serif"},ae={display:"block",fontSize:12,fontWeight:500,color:"#374151",marginBottom:4};return e.jsxs("div",{children:[e.jsx("div",{style:{display:"flex",gap:4,marginBottom:20,borderBottom:"2px solid #e5e7eb",paddingBottom:0},children:[["bank","Bank Details"],["products","Loan Products"]].map(([q,re])=>e.jsx("button",{onClick:()=>g(q),style:{padding:"10px 20px",border:"none",background:"transparent",fontSize:13,fontWeight:500,color:v===q?"#0d7377":"#6b7280",borderBottom:`3px solid ${v===q?"#0d7377":"transparent"}`,cursor:"pointer",fontFamily:"Roboto, sans-serif",marginBottom:-2},children:re},q))}),v==="bank"&&e.jsxs("div",{style:{background:"#fff",borderRadius:10,padding:24,boxShadow:"0 1px 4px rgba(0,0,0,0.08)",maxWidth:600},children:[e.jsx("div",{style:{fontSize:15,fontWeight:600,color:"#0d7377",marginBottom:20},children:"Bank Master Details"}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16,marginBottom:16},children:[{label:"Bank Name",key:"name"},{label:"Country",key:"country"},{label:"Logo URL",key:"logo_url"},{label:"Default SLA Days",key:"default_sla_days",type:"number"}].map(({label:q,key:re,type:Je})=>e.jsxs("div",{children:[e.jsx("label",{style:ae,children:q}),e.jsx("input",{type:Je||"text",style:U,value:w[re]||"",onChange:Xe=>A(jt=>({...jt,[re]:Xe.target.value}))})]},re))}),e.jsx("button",{onClick:de,disabled:I,style:{padding:"9px 20px",background:"#0d7377",color:"#fff",border:"none",borderRadius:6,fontSize:13,fontWeight:500,cursor:"pointer"},children:I?"Saving...":"Save Changes"})]}),v==="products"&&e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"280px 1fr",gap:20},children:[e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[e.jsxs("div",{style:{fontSize:14,fontWeight:600,color:"#111827"},children:["Products (",o.length,")"]}),e.jsxs("button",{onClick:()=>k(!0),style:{padding:"5px 12px",background:"#0d7377",color:"#fff",border:"none",borderRadius:6,fontSize:12,cursor:"pointer"},children:[e.jsx("i",{className:"fas fa-plus",style:{marginRight:4}})," Add"]})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[o.map(q=>e.jsxs("div",{onClick:()=>p(q.id),style:{background:f===q.id?"#e0f2f1":"#fff",border:`1px solid ${f===q.id?"#0d7377":"#e5e7eb"}`,borderRadius:8,padding:"12px 14px",cursor:"pointer"},children:[e.jsx("div",{style:{fontSize:13,fontWeight:600,color:"#111827",marginBottom:4},children:q.product_name}),e.jsxs("div",{style:{display:"flex",gap:6},children:[e.jsx("span",{style:{fontSize:10,padding:"2px 6px",borderRadius:4,background:q.loan_type==="SECURED"?"#fef3c7":"#dbeafe",color:q.loan_type==="SECURED"?"#b45309":"#1565c0",fontWeight:600},children:q.loan_type}),e.jsx("span",{style:{fontSize:10,padding:"2px 6px",borderRadius:4,background:q.is_active?"#dcfce7":"#f3f4f6",color:q.is_active?"#16a34a":"#6b7280",fontWeight:600},children:q.is_active?"Active":"Inactive"})]})]},q.id)),o.length===0&&e.jsx("div",{style:{color:"#9ca3af",fontSize:13,textAlign:"center",padding:20},children:"No products yet"})]})]}),e.jsxs("div",{children:[!f&&e.jsxs("div",{style:{background:"#fff",borderRadius:10,padding:40,textAlign:"center",color:"#9ca3af",boxShadow:"0 1px 4px rgba(0,0,0,0.08)"},children:[e.jsx("i",{className:"fas fa-box-open",style:{fontSize:32,marginBottom:12,display:"block"}}),"Select a product to view details"]}),f&&x&&e.jsxs("div",{children:[e.jsxs("div",{style:{background:"#fff",borderRadius:10,padding:20,boxShadow:"0 1px 4px rgba(0,0,0,0.08)",marginBottom:16},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:16},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:16,fontWeight:700,color:"#111827"},children:x.product_name}),e.jsxs("div",{style:{fontSize:12,color:"#6b7280",marginTop:2},children:[x.loan_type,"  ",x.interest_range||"Rate TBD"]})]}),e.jsxs("button",{onClick:()=>ve(f),style:{padding:"5px 10px",background:"#fef2f2",color:"#dc2626",border:"1px solid #fecaca",borderRadius:6,fontSize:12,cursor:"pointer"},children:[e.jsx("i",{className:"fas fa-trash",style:{marginRight:4}})," Delete"]})]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:12},children:[{label:"Min Amount",value:x.min_amount_paise?`${(x.min_amount_paise/100).toLocaleString()}`:""},{label:"Max Amount",value:x.max_amount_paise?`${(x.max_amount_paise/100).toLocaleString()}`:""},{label:"Processing Fee",value:`${x.processing_fee_percent||0}%`},{label:"Tenure Range",value:x.tenure_range||""},{label:"Collateral",value:x.collateral_required?"Required":"Not Required"},{label:"Co-applicant",value:x.coapp_required?"Required":"Optional"}].map(({label:q,value:re})=>e.jsxs("div",{style:{background:"#f9fafb",borderRadius:6,padding:"10px 12px"},children:[e.jsx("div",{style:{fontSize:10,color:"#6b7280",textTransform:"uppercase",letterSpacing:.5,marginBottom:4},children:q}),e.jsx("div",{style:{fontSize:14,fontWeight:600,color:"#111827"},children:re})]},q))})]}),e.jsxs("div",{style:{background:"#fff",borderRadius:10,padding:20,boxShadow:"0 1px 4px rgba(0,0,0,0.08)",marginBottom:16},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:14},children:[e.jsx("div",{style:{fontSize:14,fontWeight:600,color:"#111827"},children:"Eligibility Criteria"}),e.jsx("button",{onClick:()=>C(!0),style:{padding:"4px 10px",background:"#0d7377",color:"#fff",border:"none",borderRadius:5,fontSize:12,cursor:"pointer"},children:"+ Add"})]}),(me=x.criteria)==null?void 0:me.map(q=>e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 0",borderBottom:"1px solid #f3f4f6"},children:[e.jsxs("div",{children:[e.jsx("span",{style:{fontSize:12,fontWeight:600,background:"#dbeafe",color:"#1565c0",padding:"2px 8px",borderRadius:4,marginRight:8},children:q.criteria_type}),e.jsx("span",{style:{fontSize:12,color:"#374151",fontFamily:"monospace"},children:q.criteria_value})]}),e.jsx("button",{onClick:()=>se(q.id),style:{background:"none",border:"none",color:"#dc2626",cursor:"pointer",fontSize:12},children:e.jsx("i",{className:"fas fa-times"})})]},q.id)),!((be=x.criteria)!=null&&be.length)&&e.jsx("div",{style:{color:"#9ca3af",fontSize:13},children:"No criteria defined"})]}),e.jsxs("div",{style:{background:"#fff",borderRadius:10,padding:20,boxShadow:"0 1px 4px rgba(0,0,0,0.08)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:14},children:[e.jsx("div",{style:{fontSize:14,fontWeight:600,color:"#111827"},children:"Document Checklist"}),e.jsx("button",{onClick:()=>D(!0),style:{padding:"4px 10px",background:"#0d7377",color:"#fff",border:"none",borderRadius:5,fontSize:12,cursor:"pointer"},children:"+ Add"})]}),(je=x.documents)==null?void 0:je.map(q=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,padding:"8px 0",borderBottom:"1px solid #f3f4f6"},children:[e.jsxs("div",{style:{width:20,fontSize:11,color:"#9ca3af"},children:["#",q.order_no]}),e.jsx("div",{style:{flex:1,fontSize:13,fontWeight:500},children:q.doc_code}),e.jsx("span",{style:{fontSize:10,padding:"2px 6px",borderRadius:4,background:q.mandatory?"#dcfce7":"#f3f4f6",color:q.mandatory?"#16a34a":"#6b7280",fontWeight:600},children:q.mandatory?"Mandatory":"Optional"}),e.jsx("button",{onClick:()=>O(q.id),style:{background:"none",border:"none",color:"#dc2626",cursor:"pointer",fontSize:12},children:e.jsx("i",{className:"fas fa-times"})})]},q.id)),!((V=x.documents)!=null&&V.length)&&e.jsx("div",{style:{color:"#9ca3af",fontSize:13},children:"No documents defined"})]})]})]})]}),j&&e.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.5)",zIndex:2e3,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsxs("div",{style:{background:"#fff",borderRadius:12,width:560,maxWidth:"95vw",maxHeight:"90vh",overflow:"auto",padding:24},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:20},children:[e.jsx("div",{style:{fontSize:16,fontWeight:600},children:"Add Loan Product"}),e.jsx("button",{onClick:()=>k(!1),style:{background:"none",border:"none",fontSize:18,cursor:"pointer",color:"#6b7280"},children:""})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14},children:[e.jsxs("div",{style:{gridColumn:"1/-1"},children:[e.jsx("label",{style:ae,children:"Product Name *"}),e.jsx("input",{style:U,value:N.product_name,onChange:q=>W(re=>({...re,product_name:q.target.value})),placeholder:"e.g. HDFC Credila Unsecured Education Loan"})]}),e.jsxs("div",{children:[e.jsx("label",{style:ae,children:"Loan Type"}),e.jsxs("select",{style:U,value:N.loan_type,onChange:q=>W(re=>({...re,loan_type:q.target.value})),children:[e.jsx("option",{value:"UNSECURED",children:"UNSECURED"}),e.jsx("option",{value:"SECURED",children:"SECURED"})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:ae,children:"Processing Fee %"}),e.jsx("input",{type:"number",style:U,value:N.processing_fee_percent,onChange:q=>W(re=>({...re,processing_fee_percent:q.target.value})),placeholder:"1.5"})]}),e.jsxs("div",{children:[e.jsx("label",{style:ae,children:"Min Amount (in paise)"}),e.jsx("input",{type:"number",style:U,value:N.min_amount_paise,onChange:q=>W(re=>({...re,min_amount_paise:q.target.value})),placeholder:"e.g. 5000000 = 50,000"})]}),e.jsxs("div",{children:[e.jsx("label",{style:ae,children:"Max Amount (in paise)"}),e.jsx("input",{type:"number",style:U,value:N.max_amount_paise,onChange:q=>W(re=>({...re,max_amount_paise:q.target.value})),placeholder:"e.g. 10000000 = 1L"})]}),e.jsxs("div",{children:[e.jsx("label",{style:ae,children:"Interest Range"}),e.jsx("input",{style:U,value:N.interest_range,onChange:q=>W(re=>({...re,interest_range:q.target.value})),placeholder:"e.g. 10.5% - 13.5%"})]}),e.jsxs("div",{children:[e.jsx("label",{style:ae,children:"Tenure Range"}),e.jsx("input",{style:U,value:N.tenure_range,onChange:q=>W(re=>({...re,tenure_range:q.target.value})),placeholder:"e.g. 5 - 15 years"})]}),e.jsxs("div",{style:{gridColumn:"1/-1",display:"flex",gap:20},children:[e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8,fontSize:13,cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:N.collateral_required,onChange:q=>W(re=>({...re,collateral_required:q.target.checked}))}),"Collateral Required"]}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8,fontSize:13,cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:N.coapp_required,onChange:q=>W(re=>({...re,coapp_required:q.target.checked}))}),"Co-applicant Required"]})]})]}),e.jsxs("div",{style:{display:"flex",gap:10,marginTop:20,justifyContent:"flex-end"},children:[e.jsx("button",{onClick:()=>k(!1),style:{padding:"8px 16px",background:"#f3f4f6",border:"1px solid #e5e7eb",borderRadius:6,fontSize:13,cursor:"pointer"},children:"Cancel"}),e.jsx("button",{onClick:oe,disabled:I||!N.product_name,style:{padding:"8px 16px",background:"#0d7377",color:"#fff",border:"none",borderRadius:6,fontSize:13,cursor:"pointer",opacity:I||!N.product_name?.6:1},children:I?"Creating...":"Create Product"})]})]})}),_&&e.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.5)",zIndex:2e3,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsxs("div",{style:{background:"#fff",borderRadius:12,width:440,padding:24},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:20},children:[e.jsx("div",{style:{fontSize:15,fontWeight:600},children:"Add Eligibility Criterion"}),e.jsx("button",{onClick:()=>C(!1),style:{background:"none",border:"none",fontSize:18,cursor:"pointer",color:"#6b7280"},children:""})]}),e.jsxs("div",{style:{marginBottom:14},children:[e.jsx("label",{style:ae,children:"Criteria Type"}),e.jsx("select",{style:U,value:F.criteria_type,onChange:q=>Z(re=>({...re,criteria_type:q.target.value})),children:Ry.map(q=>e.jsx("option",{value:q,children:q},q))})]}),e.jsxs("div",{style:{marginBottom:20},children:[e.jsx("label",{style:ae,children:"Value (number or JSON)"}),e.jsx("textarea",{style:{...U,height:80,resize:"vertical"},value:F.criteria_value,onChange:q=>Z(re=>({...re,criteria_value:q.target.value})),placeholder:'e.g. 600000 or {"min": 700}'})]}),e.jsxs("div",{style:{display:"flex",gap:10,justifyContent:"flex-end"},children:[e.jsx("button",{onClick:()=>C(!1),style:{padding:"8px 16px",background:"#f3f4f6",border:"1px solid #e5e7eb",borderRadius:6,fontSize:13,cursor:"pointer"},children:"Cancel"}),e.jsx("button",{onClick:Y,disabled:I,style:{padding:"8px 16px",background:"#0d7377",color:"#fff",border:"none",borderRadius:6,fontSize:13,cursor:"pointer"},children:"Add Criterion"})]})]})}),L&&e.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.5)",zIndex:2e3,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsxs("div",{style:{background:"#fff",borderRadius:12,width:400,padding:24},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:20},children:[e.jsx("div",{style:{fontSize:15,fontWeight:600},children:"Add Document to Checklist"}),e.jsx("button",{onClick:()=>D(!1),style:{background:"none",border:"none",fontSize:18,cursor:"pointer",color:"#6b7280"},children:""})]}),e.jsxs("div",{style:{marginBottom:14},children:[e.jsx("label",{style:ae,children:"Document Code / Name *"}),e.jsx("input",{style:U,value:ce.doc_code,onChange:q=>xe(re=>({...re,doc_code:q.target.value})),placeholder:"e.g. PASSPORT, BANK_STATEMENT_6M"})]}),e.jsxs("div",{style:{marginBottom:14},children:[e.jsx("label",{style:ae,children:"Order Number"}),e.jsx("input",{type:"number",style:U,value:ce.order_no,onChange:q=>xe(re=>({...re,order_no:q.target.value})),placeholder:"1"})]}),e.jsx("div",{style:{marginBottom:20},children:e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8,fontSize:13,cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:ce.mandatory,onChange:q=>xe(re=>({...re,mandatory:q.target.checked}))}),"Mandatory Document"]})}),e.jsxs("div",{style:{display:"flex",gap:10,justifyContent:"flex-end"},children:[e.jsx("button",{onClick:()=>D(!1),style:{padding:"8px 16px",background:"#f3f4f6",border:"1px solid #e5e7eb",borderRadius:6,fontSize:13,cursor:"pointer"},children:"Cancel"}),e.jsx("button",{onClick:J,disabled:I||!ce.doc_code,style:{padding:"8px 16px",background:"#0d7377",color:"#fff",border:"none",borderRadius:6,fontSize:13,cursor:"pointer",opacity:I||!ce.doc_code?.6:1},children:"Add Document"})]})]})})]})}function Ty({bankId:s,bankRole:i}){const[r,o]=u.useState([]),[d,f]=u.useState(!0),[p,x]=u.useState(!1),[m,v]=u.useState(null),[g,b]=u.useState(!1),[y,j]=u.useState({branch_name:"",region:"",state:"",city:""}),k=i==="SUPER_ADMIN",_=async()=>{f(!0);try{const w=await _e.getBranches(s);o(w)}catch{T.error("Failed to load branches")}f(!1)};u.useEffect(()=>{s&&_()},[s]);const C=()=>{v(null),j({branch_name:"",region:"",state:"",city:""}),x(!0)},L=w=>{v(w),j({branch_name:w.branch_name,region:w.region||"",state:w.state||"",city:w.city||""}),x(!0)},D=async()=>{b(!0);try{m?(await _e.updateBranch(m.id,y),T.success("Branch updated")):(await _e.createBranch(s,y),T.success("Branch created")),x(!1),await _()}catch(w){T.error(w.message)}b(!1)},I={width:"100%",padding:"8px 12px",border:"1px solid #d1d5db",borderRadius:6,fontSize:13,outline:"none",fontFamily:"Roboto, sans-serif"},P={display:"block",fontSize:12,fontWeight:500,color:"#374151",marginBottom:4};return e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:20},children:[e.jsxs("div",{children:[e.jsx("h2",{style:{fontSize:20,fontWeight:700,color:"#0d7377",marginBottom:2},children:"Branch Network"}),e.jsxs("div",{style:{fontSize:13,color:"#6b7280"},children:[r.length," branches configured"]})]}),k&&e.jsxs("button",{onClick:C,style:{padding:"9px 18px",background:"#0d7377",color:"#fff",border:"none",borderRadius:6,fontSize:13,fontWeight:500,cursor:"pointer"},children:[e.jsx("i",{className:"fas fa-plus",style:{marginRight:6}})," Add Branch"]})]}),d&&e.jsx("div",{style:{textAlign:"center",padding:40,color:"#6b7280"},children:e.jsx("i",{className:"fas fa-spinner fa-spin",style:{fontSize:20}})}),!d&&r.length===0&&e.jsxs("div",{style:{background:"#fff",borderRadius:10,padding:60,textAlign:"center",color:"#9ca3af",boxShadow:"0 1px 4px rgba(0,0,0,0.08)"},children:[e.jsx("i",{className:"fas fa-sitemap",style:{fontSize:36,marginBottom:12,display:"block"}}),"No branches configured yet"]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(280px, 1fr))",gap:16},children:r.map(w=>e.jsxs("div",{style:{background:"#fff",borderRadius:10,padding:20,boxShadow:"0 1px 4px rgba(0,0,0,0.08)",border:"1px solid #e5e7eb"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:12},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:15,fontWeight:600,color:"#111827"},children:w.branch_name}),w.region&&e.jsx("div",{style:{fontSize:12,color:"#6b7280",marginTop:2},children:w.region})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:w.is_active?"#dcfce7":"#f3f4f6",color:w.is_active?"#16a34a":"#6b7280",fontWeight:600},children:w.is_active?"Active":"Inactive"}),k&&e.jsx("button",{onClick:()=>L(w),style:{background:"#f3f4f6",border:"1px solid #e5e7eb",borderRadius:6,padding:"4px 8px",cursor:"pointer",fontSize:12,color:"#374151"},children:e.jsx("i",{className:"fas fa-edit"})})]})]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:8},children:[{label:"State",value:w.state},{label:"City",value:w.city},{label:"Officers",value:w.user_count||0}].map(({label:A,value:N})=>e.jsxs("div",{style:{background:"#f9fafb",borderRadius:6,padding:"8px 10px"},children:[e.jsx("div",{style:{fontSize:10,color:"#9ca3af",marginBottom:2,textTransform:"uppercase",letterSpacing:.3},children:A}),e.jsx("div",{style:{fontSize:13,fontWeight:600,color:"#374151"},children:N||""})]},A))})]},w.id))}),p&&e.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.5)",zIndex:2e3,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsxs("div",{style:{background:"#fff",borderRadius:12,width:480,padding:24},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:20},children:[e.jsx("div",{style:{fontSize:16,fontWeight:600},children:m?"Edit Branch":"Add Branch"}),e.jsx("button",{onClick:()=>x(!1),style:{background:"none",border:"none",fontSize:18,cursor:"pointer",color:"#6b7280"},children:""})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14,marginBottom:20},children:[[{label:"Branch Name *",key:"branch_name",full:!0,placeholder:"e.g. Mumbai Central Branch"},{label:"Region",key:"region",placeholder:"e.g. West"},{label:"State",key:"state",placeholder:"e.g. Maharashtra"},{label:"City",key:"city",placeholder:"e.g. Mumbai"}].map(({label:w,key:A,full:N,placeholder:W})=>e.jsxs("div",{style:N?{gridColumn:"1/-1"}:{},children:[e.jsx("label",{style:P,children:w}),e.jsx("input",{style:I,value:y[A],onChange:F=>j(Z=>({...Z,[A]:F.target.value})),placeholder:W})]},A)),m&&e.jsxs("div",{style:{gridColumn:"1/-1"},children:[e.jsx("label",{style:P,children:"Status"}),e.jsxs("select",{style:I,value:y.is_active?1:0,onChange:w=>j(A=>({...A,is_active:parseInt(w.target.value)})),children:[e.jsx("option",{value:1,children:"Active"}),e.jsx("option",{value:0,children:"Inactive"})]})]})]}),e.jsxs("div",{style:{display:"flex",gap:10,justifyContent:"flex-end"},children:[e.jsx("button",{onClick:()=>x(!1),style:{padding:"8px 16px",background:"#f3f4f6",border:"1px solid #e5e7eb",borderRadius:6,fontSize:13,cursor:"pointer"},children:"Cancel"}),e.jsx("button",{onClick:D,disabled:g||!y.branch_name,style:{padding:"8px 16px",background:"#0d7377",color:"#fff",border:"none",borderRadius:6,fontSize:13,cursor:"pointer",opacity:g||!y.branch_name?.6:1},children:g?"Saving...":m?"Update Branch":"Create Branch"})]})]})})]})}const zo=["SUPER_ADMIN","REGION_HEAD","BRANCH_MANAGER","OFFICER"],qa={SUPER_ADMIN:"#7c3aed",REGION_HEAD:"#1565c0",BRANCH_MANAGER:"#0d7377",OFFICER:"#374151"},jl={SUPER_ADMIN:"National Head",REGION_HEAD:"Region Head",BRANCH_MANAGER:"Branch Manager",OFFICER:"Officer"};function zy({bankId:s,bankRole:i}){const[r,o]=u.useState([]),[d,f]=u.useState([]),[p,x]=u.useState(!0),[m,v]=u.useState(!1),[g,b]=u.useState(!1),[y,j]=u.useState(""),[k,_]=u.useState(""),[C,L]=u.useState({name:"",email:"",phone:"",role:"OFFICER",branch_id:"",password:""}),D=i==="SUPER_ADMIN",I=async()=>{x(!0);try{const[F,Z]=await Promise.all([_e.getUsers(s),_e.getBranches(s)]);o(F),f(Z)}catch{T.error("Failed to load users")}x(!1)};u.useEffect(()=>{s&&I()},[s]);const P=async()=>{if(!C.name||!C.email||!C.password)return T.error("Name, email and password required");b(!0);try{await _e.createUser(s,C),T.success("User created"),v(!1),L({name:"",email:"",phone:"",role:"OFFICER",branch_id:"",password:""}),await I()}catch(F){T.error(F.message)}b(!1)},w=async F=>{try{await _e.updateUser(F.id,{is_active:F.is_active?0:1}),T.success(F.is_active?"User deactivated":"User activated"),await I()}catch(Z){T.error(Z.message)}},A=r.filter(F=>(!y||F.name.toLowerCase().includes(y.toLowerCase())||F.email.toLowerCase().includes(y.toLowerCase()))&&(!k||F.role===k)),N={width:"100%",padding:"8px 12px",border:"1px solid #d1d5db",borderRadius:6,fontSize:13,outline:"none",fontFamily:"Roboto, sans-serif"},W={display:"block",fontSize:12,fontWeight:500,color:"#374151",marginBottom:4};return e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[e.jsxs("div",{children:[e.jsx("h2",{style:{fontSize:20,fontWeight:700,color:"#0d7377",marginBottom:2},children:"Bank Users"}),e.jsxs("div",{style:{fontSize:13,color:"#6b7280"},children:[r.length," users  Role-based access control"]})]}),D&&e.jsxs("button",{onClick:()=>v(!0),style:{padding:"9px 18px",background:"#0d7377",color:"#fff",border:"none",borderRadius:6,fontSize:13,fontWeight:500,cursor:"pointer"},children:[e.jsx("i",{className:"fas fa-user-plus",style:{marginRight:6}})," Add User"]})]}),e.jsxs("div",{style:{display:"flex",gap:12,marginBottom:16,flexWrap:"wrap"},children:[e.jsxs("div",{style:{position:"relative",flex:1,minWidth:200},children:[e.jsx("i",{className:"fas fa-search",style:{position:"absolute",left:12,top:"50%",transform:"translateY(-50%)",color:"#9ca3af",fontSize:13}}),e.jsx("input",{style:{...N,paddingLeft:36},placeholder:"Search name or email...",value:y,onChange:F=>j(F.target.value)})]}),e.jsxs("select",{style:{...N,width:180},value:k,onChange:F=>_(F.target.value),children:[e.jsx("option",{value:"",children:"All Roles"}),zo.map(F=>e.jsx("option",{value:F,children:jl[F]},F))]})]}),p&&e.jsx("div",{style:{textAlign:"center",padding:40,color:"#6b7280"},children:e.jsx("i",{className:"fas fa-spinner fa-spin",style:{fontSize:20}})}),!p&&e.jsx("div",{style:{background:"#fff",borderRadius:10,boxShadow:"0 1px 4px rgba(0,0,0,0.08)",overflow:"hidden"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsx("tr",{style:{background:"#f9fafb"},children:["Name","Email","Phone","Role","Branch","Status",""].map(F=>e.jsx("th",{style:{padding:"10px 14px",textAlign:"left",fontSize:11,fontWeight:600,textTransform:"uppercase",color:"#6b7280",letterSpacing:.5,borderBottom:"2px solid #e5e7eb",whiteSpace:"nowrap"},children:F},F))})}),e.jsxs("tbody",{children:[A.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:7,style:{textAlign:"center",padding:40,color:"#9ca3af",fontSize:13},children:"No users found"})}),A.map(F=>e.jsxs("tr",{style:{borderBottom:"1px solid #f3f4f6"},children:[e.jsx("td",{style:{padding:"12px 14px"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[e.jsx("div",{style:{width:32,height:32,borderRadius:"50%",background:qa[F.role]||"#6b7280",display:"flex",alignItems:"center",justifyContent:"center",color:"#fff",fontWeight:700,fontSize:13,flexShrink:0},children:F.name[0].toUpperCase()}),e.jsx("div",{style:{fontSize:13,fontWeight:500,color:"#111827"},children:F.name})]})}),e.jsx("td",{style:{padding:"12px 14px",fontSize:13,color:"#374151"},children:F.email}),e.jsx("td",{style:{padding:"12px 14px",fontSize:13,color:"#6b7280"},children:F.phone||""}),e.jsx("td",{style:{padding:"12px 14px"},children:e.jsx("span",{style:{fontSize:11,padding:"3px 8px",borderRadius:10,background:`${qa[F.role]}20`,color:qa[F.role],fontWeight:600},children:jl[F.role]||F.role})}),e.jsx("td",{style:{padding:"12px 14px",fontSize:13,color:"#6b7280"},children:F.branch_name||""}),e.jsx("td",{style:{padding:"12px 14px"},children:e.jsx("span",{style:{fontSize:11,padding:"3px 8px",borderRadius:10,background:F.is_active?"#dcfce7":"#f3f4f6",color:F.is_active?"#16a34a":"#6b7280",fontWeight:600},children:F.is_active?"Active":"Inactive"})}),e.jsx("td",{style:{padding:"12px 14px"},children:D&&e.jsx("button",{onClick:()=>w(F),style:{padding:"4px 10px",background:F.is_active?"#fef2f2":"#f0fdf4",color:F.is_active?"#dc2626":"#16a34a",border:`1px solid ${F.is_active?"#fecaca":"#bbf7d0"}`,borderRadius:5,fontSize:12,cursor:"pointer"},children:F.is_active?"Deactivate":"Activate"})})]},F.id))]})]})}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:12,marginTop:20},children:zo.map(F=>{const Z=r.filter(ce=>ce.role===F).length;return e.jsxs("div",{style:{background:"#fff",borderRadius:8,padding:"14px 16px",boxShadow:"0 1px 4px rgba(0,0,0,0.08)",borderLeft:`4px solid ${qa[F]}`},children:[e.jsx("div",{style:{fontSize:11,color:"#6b7280",marginBottom:4,textTransform:"uppercase",letterSpacing:.5},children:jl[F]}),e.jsx("div",{style:{fontSize:22,fontWeight:700,color:qa[F]},children:Z})]},F)})}),m&&e.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.5)",zIndex:2e3,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsxs("div",{style:{background:"#fff",borderRadius:12,width:520,maxWidth:"95vw",padding:24},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:20},children:[e.jsx("div",{style:{fontSize:16,fontWeight:600},children:"Add Bank User"}),e.jsx("button",{onClick:()=>v(!1),style:{background:"none",border:"none",fontSize:18,cursor:"pointer",color:"#6b7280"},children:""})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14,marginBottom:16},children:[[{label:"Full Name *",key:"name",placeholder:"Ravi Kumar"},{label:"Email *",key:"email",type:"email",placeholder:"ravi@bank.com"},{label:"Phone",key:"phone",placeholder:"+91 98765 43210"},{label:"Password *",key:"password",type:"password",placeholder:"Min 8 chars"}].map(({label:F,key:Z,type:ce,placeholder:xe})=>e.jsxs("div",{children:[e.jsx("label",{style:W,children:F}),e.jsx("input",{type:ce||"text",style:N,value:C[Z],onChange:z=>L(X=>({...X,[Z]:z.target.value})),placeholder:xe})]},Z)),e.jsxs("div",{children:[e.jsx("label",{style:W,children:"Role *"}),e.jsx("select",{style:N,value:C.role,onChange:F=>L(Z=>({...Z,role:F.target.value})),children:zo.map(F=>e.jsx("option",{value:F,children:jl[F]},F))})]}),e.jsxs("div",{children:[e.jsx("label",{style:W,children:"Branch"}),e.jsxs("select",{style:N,value:C.branch_id,onChange:F=>L(Z=>({...Z,branch_id:F.target.value})),children:[e.jsx("option",{value:"",children:"No Branch (National)"}),d.map(F=>e.jsx("option",{value:F.id,children:F.branch_name},F.id))]})]})]}),e.jsxs("div",{style:{display:"flex",gap:10,justifyContent:"flex-end"},children:[e.jsx("button",{onClick:()=>v(!1),style:{padding:"8px 16px",background:"#f3f4f6",border:"1px solid #e5e7eb",borderRadius:6,fontSize:13,cursor:"pointer"},children:"Cancel"}),e.jsx("button",{onClick:P,disabled:g,style:{padding:"8px 16px",background:"#0d7377",color:"#fff",border:"none",borderRadius:6,fontSize:13,cursor:"pointer",opacity:g?.7:1},children:g?"Creating...":"Create User"})]})]})})]})}const Dy=["ALL","REGION","BRANCH"],Ja={ALL:"#1565c0",REGION:"#7c3aed",BRANCH:"#0d7377"};function Ly({bankId:s,bankRole:i}){const[r,o]=u.useState([]),[d,f]=u.useState(!0),[p,x]=u.useState(!1),[m,v]=u.useState(!1),[g,b]=u.useState({title:"",description:"",attachment_url:"",visible_to:"ALL"}),y=i==="SUPER_ADMIN",j=async()=>{f(!0);try{o(await _e.getAnnouncements(s))}catch{T.error("Failed to load")}f(!1)};u.useEffect(()=>{s&&j()},[s]);const k=async()=>{if(!g.title)return T.error("Title required");v(!0);try{await _e.createAnnouncement(s,g),T.success("Announcement posted"),x(!1),b({title:"",description:"",attachment_url:"",visible_to:"ALL"}),await j()}catch(D){T.error(D.message)}v(!1)},_=async D=>{if(window.confirm("Delete this announcement?"))try{await _e.deleteAnnouncement(D),T.success("Deleted"),await j()}catch(I){T.error(I.message)}},C={width:"100%",padding:"8px 12px",border:"1px solid #d1d5db",borderRadius:6,fontSize:13,outline:"none",fontFamily:"Roboto, sans-serif"},L={display:"block",fontSize:12,fontWeight:500,color:"#374151",marginBottom:4};return e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:20},children:[e.jsxs("div",{children:[e.jsx("h2",{style:{fontSize:20,fontWeight:700,color:"#0d7377",marginBottom:2},children:"Bank Announcements"}),e.jsx("div",{style:{fontSize:13,color:"#6b7280"},children:"Policy updates, product changes, posters & notifications"})]}),y&&e.jsxs("button",{onClick:()=>x(!0),style:{padding:"9px 18px",background:"#0d7377",color:"#fff",border:"none",borderRadius:6,fontSize:13,fontWeight:500,cursor:"pointer"},children:[e.jsx("i",{className:"fas fa-bullhorn",style:{marginRight:6}})," New Announcement"]})]}),d&&e.jsx("div",{style:{textAlign:"center",padding:40,color:"#6b7280"},children:e.jsx("i",{className:"fas fa-spinner fa-spin",style:{fontSize:20}})}),!d&&r.length===0&&e.jsxs("div",{style:{background:"#fff",borderRadius:10,padding:60,textAlign:"center",color:"#9ca3af",boxShadow:"0 1px 4px rgba(0,0,0,0.08)"},children:[e.jsx("i",{className:"fas fa-bullhorn",style:{fontSize:36,marginBottom:12,display:"block"}}),"No announcements yet"]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:12},children:r.map(D=>{var I;return e.jsx("div",{style:{background:"#fff",borderRadius:10,padding:20,boxShadow:"0 1px 4px rgba(0,0,0,0.08)",border:"1px solid #e5e7eb"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsxs("div",{style:{flex:1},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:8},children:[e.jsx("div",{style:{fontSize:15,fontWeight:600,color:"#111827"},children:D.title}),e.jsx("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:`${Ja[D.visible_to]||"#6b7280"}20`,color:Ja[D.visible_to]||"#6b7280",fontWeight:600},children:D.visible_to})]}),D.description&&e.jsx("div",{style:{fontSize:13,color:"#374151",lineHeight:1.5,marginBottom:8},children:D.description}),D.attachment_url&&e.jsxs("a",{href:D.attachment_url,target:"_blank",rel:"noopener noreferrer",style:{fontSize:12,color:"#1565c0",display:"inline-flex",alignItems:"center",gap:4},children:[e.jsx("i",{className:"fas fa-paperclip"})," Attachment"]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginLeft:12},children:[e.jsx("div",{style:{fontSize:11,color:"#9ca3af",whiteSpace:"nowrap"},children:(I=D.created_at)==null?void 0:I.slice(0,10)}),y&&e.jsx("button",{onClick:()=>_(D.id),style:{background:"#fef2f2",border:"1px solid #fecaca",borderRadius:5,padding:"4px 8px",color:"#dc2626",cursor:"pointer",fontSize:12},children:e.jsx("i",{className:"fas fa-trash"})})]})]})},D.id)})}),p&&e.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.5)",zIndex:2e3,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsxs("div",{style:{background:"#fff",borderRadius:12,width:520,maxWidth:"95vw",padding:24},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:20},children:[e.jsx("div",{style:{fontSize:16,fontWeight:600},children:"New Announcement"}),e.jsx("button",{onClick:()=>x(!1),style:{background:"none",border:"none",fontSize:18,cursor:"pointer",color:"#6b7280"},children:""})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:14,marginBottom:20},children:[e.jsxs("div",{children:[e.jsx("label",{style:L,children:"Title *"}),e.jsx("input",{style:C,value:g.title,onChange:D=>b(I=>({...I,title:D.target.value})),placeholder:"e.g. New Product Launched: Global Ed-Vantage"})]}),e.jsxs("div",{children:[e.jsx("label",{style:L,children:"Description"}),e.jsx("textarea",{style:{...C,height:100,resize:"vertical"},value:g.description,onChange:D=>b(I=>({...I,description:D.target.value})),placeholder:"Detailed announcement message..."})]}),e.jsxs("div",{children:[e.jsx("label",{style:L,children:"Attachment URL"}),e.jsx("input",{style:C,value:g.attachment_url,onChange:D=>b(I=>({...I,attachment_url:D.target.value})),placeholder:"https://... (link to PDF, poster, etc.)"})]}),e.jsxs("div",{children:[e.jsx("label",{style:L,children:"Visible To"}),e.jsx("div",{style:{display:"flex",gap:8},children:Dy.map(D=>e.jsx("button",{type:"button",onClick:()=>b(I=>({...I,visible_to:D})),style:{flex:1,padding:"8px 0",border:`1px solid ${g.visible_to===D?Ja[D]:"#d1d5db"}`,borderRadius:6,background:g.visible_to===D?`${Ja[D]}15`:"#fff",color:g.visible_to===D?Ja[D]:"#6b7280",fontWeight:g.visible_to===D?600:400,fontSize:13,cursor:"pointer"},children:D},D))})]})]}),e.jsxs("div",{style:{display:"flex",gap:10,justifyContent:"flex-end"},children:[e.jsx("button",{onClick:()=>x(!1),style:{padding:"8px 16px",background:"#f3f4f6",border:"1px solid #e5e7eb",borderRadius:6,fontSize:13,cursor:"pointer"},children:"Cancel"}),e.jsx("button",{onClick:k,disabled:m||!g.title,style:{padding:"8px 16px",background:"#0d7377",color:"#fff",border:"none",borderRadius:6,fontSize:13,cursor:"pointer",opacity:m||!g.title?.6:1},children:m?"Posting...":"Post Announcement"})]})]})})]})}const Sl=s=>s?`${(s/1e5).toFixed(1)}L`:"0",Do={INITIATED:"#64748b",DOCS_PENDING:"#f59e0b",LOGIN_DONE:"#3b82f6",UNDER_REVIEW:"#8b5cf6",SANCTIONED:"#059669",REJECTED:"#dc2626",DISBURSED:"#0d9488",CLOSED:"#374151"};function Iy(s){return s?Math.ceil((new Date(s)-new Date)/864e5):null}function Py({bankId:s,bankRole:i,onOpenApp:r}){const[o,d]=u.useState(null),[f,p]=u.useState(!0),[x,m]=u.useState(null);if(u.useEffect(()=>{s&&(p(!0),_e.getEnhancedDashboard(s).then(d).catch(W=>m(W.message)).finally(()=>p(!1)))},[s]),f)return e.jsx("div",{style:{padding:60,textAlign:"center",color:"#6b7280"},children:e.jsx("i",{className:"fas fa-spinner fa-spin",style:{fontSize:24}})});if(x)return e.jsxs("div",{style:{padding:40,textAlign:"center",color:"#ef4444"},children:["Failed to load dashboard: ",x]});if(!o)return null;const{kpis:v={},funnel:g=[],sla_risk_queue:b=[],country_mix:y=[],branch_performance:j=[],officer_leaderboard:k=[],credit_utilization:_=[],tat_metrics:C={}}=o,L=v.total_assigned||0,D=L>0?(v.sanctioned/L*100).toFixed(1):"0.0",I=L>0?(v.rejected/L*100).toFixed(1):"0.0",P=[{label:"Apps Assigned",value:L,color:"#2563eb",icon:"fa-briefcase"},{label:"Active",value:v.active||0,color:"#0d9488",icon:"fa-spinner"},{label:"Sanctioned",value:v.sanctioned||0,color:"#059669",icon:"fa-check-circle"},{label:"Rejected",value:v.rejected||0,color:"#dc2626",icon:"fa-times-circle"},{label:"Disbursed",value:v.disbursed||0,color:"#7c3aed",icon:"fa-money-bill-wave"},{label:"SLA Breaches",value:v.sla_breaches||0,color:"#dc2626",icon:"fa-exclamation-triangle"},{label:"Sanction %",value:`${D}%`,color:"#059669",icon:"fa-percentage"},{label:"Avg Sanction",value:Sl(v.avg_sanction_paise),color:"#0d9488",icon:"fa-rupee-sign"}],w=Math.max(...g.map(W=>W.count),1),A=Math.max(...y.map(W=>W.count),1),N=Math.max(..._.map(W=>W.total),1);return e.jsxs("div",{style:{paddingBottom:32},children:[e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(8, 1fr)",gap:1,background:"#e5e7eb",border:"1px solid #e5e7eb",borderRadius:12,overflow:"hidden",marginBottom:20},children:P.map(W=>e.jsxs("div",{style:{background:"#fff",padding:"16px 10px",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:10,color:"#6b7280",marginBottom:4,fontWeight:700,textTransform:"uppercase",letterSpacing:"0.04em"},children:W.label}),e.jsx("div",{style:{fontSize:22,fontWeight:800,color:W.color},children:W.value??0})]},W.label))}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16,marginBottom:16},children:[e.jsxs("div",{style:{background:"#fff",borderRadius:12,padding:20,boxShadow:"0 1px 4px rgba(0,0,0,0.06)"},children:[e.jsxs("div",{style:{fontSize:15,fontWeight:700,color:"#111827",marginBottom:16},children:[e.jsx("i",{className:"fas fa-filter",style:{marginRight:8,color:"#2563eb"}}),"Application Funnel"]}),g.length===0?e.jsx("div",{style:{color:"#9ca3af",fontSize:13,textAlign:"center",paddingTop:24},children:"No applications yet"}):g.map(W=>{var F;return e.jsxs("div",{style:{marginBottom:10},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:12,marginBottom:3},children:[e.jsx("span",{style:{color:"#374151",fontWeight:500},children:(F=W.status)==null?void 0:F.replace(/_/g," ")}),e.jsx("span",{style:{color:"#6b7280",fontWeight:700},children:W.count})]}),e.jsx("div",{style:{height:8,background:"#f1f5f9",borderRadius:4},children:e.jsx("div",{style:{height:8,width:`${W.count/w*100}%`,background:Do[W.status]||"#9ca3af",borderRadius:4,transition:"width 0.5s"}})})]},W.status)}),e.jsxs("div",{style:{marginTop:16,display:"grid",gridTemplateColumns:"1fr 1fr",gap:8},children:[e.jsxs("div",{style:{background:"#f0fdf4",borderRadius:8,padding:"10px 12px",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:11,color:"#6b7280"},children:"Sanction %"}),e.jsxs("div",{style:{fontSize:18,fontWeight:700,color:"#059669"},children:[D,"%"]})]}),e.jsxs("div",{style:{background:"#fef2f2",borderRadius:8,padding:"10px 12px",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:11,color:"#6b7280"},children:"Rejection %"}),e.jsxs("div",{style:{fontSize:18,fontWeight:700,color:"#dc2626"},children:[I,"%"]})]})]})]}),e.jsxs("div",{style:{background:"#fff",borderRadius:12,padding:20,boxShadow:"0 1px 4px rgba(0,0,0,0.06)"},children:[e.jsxs("div",{style:{fontSize:15,fontWeight:700,color:"#111827",marginBottom:16},children:[e.jsx("i",{className:"fas fa-chart-bar",style:{marginRight:8,color:"#7c3aed"}}),"Credit Utilization (Monthly)"]}),_.length===0&&e.jsx("div",{style:{color:"#9ca3af",fontSize:13,textAlign:"center",paddingTop:24},children:"No data yet"}),e.jsx("div",{style:{display:"flex",alignItems:"flex-end",gap:6,height:110},children:_.map(W=>{var F;return e.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",gap:2},children:[e.jsxs("div",{style:{width:"100%",display:"flex",flexDirection:"column",gap:1,flex:1,justifyContent:"flex-end"},children:[e.jsx("div",{style:{background:"#059669",width:"100%",height:`${W.sanctioned/Math.max(N,1)*90}px`,borderRadius:"3px 3px 0 0",minHeight:2},title:`Sanctioned: ${W.sanctioned}`}),e.jsx("div",{style:{background:"#bfdbfe",width:"100%",height:`${(W.total-W.sanctioned)/Math.max(N,1)*90}px`,minHeight:2},title:`Other: ${W.total-W.sanctioned}`})]}),e.jsx("div",{style:{fontSize:9,color:"#9ca3af",whiteSpace:"nowrap"},children:(F=W.month)==null?void 0:F.slice(5)})]},W.month)})}),e.jsxs("div",{style:{display:"flex",gap:12,marginTop:8,fontSize:11},children:[e.jsx("span",{style:{color:"#059669"},children:" Sanctioned"}),e.jsx("span",{style:{color:"#3b82f6"},children:" Other Active"})]}),e.jsxs("div",{style:{marginTop:12,display:"grid",gridTemplateColumns:"1fr 1fr",gap:8},children:[e.jsxs("div",{style:{background:"#f9fafb",borderRadius:8,padding:"10px 12px"},children:[e.jsx("div",{style:{fontSize:11,color:"#6b7280"},children:"Avg Sanction"}),e.jsx("div",{style:{fontSize:15,fontWeight:700,color:"#111827"},children:Sl(v.avg_sanction_paise)})]}),e.jsxs("div",{style:{background:"#f9fafb",borderRadius:8,padding:"10px 12px"},children:[e.jsx("div",{style:{fontSize:11,color:"#6b7280"},children:"Total Disbursed"}),e.jsx("div",{style:{fontSize:15,fontWeight:700,color:"#111827"},children:Sl(v.total_disbursed_paise)})]})]})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16,marginBottom:16},children:[e.jsxs("div",{style:{background:"#fff",borderRadius:12,padding:20,boxShadow:"0 1px 4px rgba(0,0,0,0.06)"},children:[e.jsxs("div",{style:{fontSize:15,fontWeight:700,color:"#111827",marginBottom:16},children:[e.jsx("i",{className:"fas fa-clock",style:{marginRight:8,color:"#f59e0b"}}),"TAT Breakdown"]}),[{label:"Assign  Login",value:C==null?void 0:C.avg_hours_assign_to_login},{label:"Login  Sanction",value:C==null?void 0:C.avg_hours_login_to_sanction}].map(W=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px 0",borderBottom:"1px solid #f3f4f6"},children:[e.jsx("div",{style:{fontSize:13,color:"#374151"},children:W.label}),e.jsx("div",{style:{fontSize:18,fontWeight:700,color:W.value?"#0d7377":"#9ca3af"},children:W.value?`${(W.value/24).toFixed(1)}d`:""})]},W.label)),e.jsxs("div",{style:{marginTop:16,background:"#f0f9ff",borderRadius:8,padding:"12px 16px"},children:[e.jsx("div",{style:{fontSize:12,color:"#0d7377",fontWeight:700,marginBottom:6},children:"SLA Risk Queue"}),e.jsxs("div",{style:{fontSize:13,color:"#374151"},children:[e.jsx("span",{style:{fontWeight:700,color:"#dc2626",fontSize:20},children:v.sla_breaches||0})," active SLA breaches"]})]})]}),e.jsxs("div",{style:{background:"#fff",borderRadius:12,padding:20,boxShadow:"0 1px 4px rgba(0,0,0,0.06)"},children:[e.jsxs("div",{style:{fontSize:15,fontWeight:700,color:"#111827",marginBottom:16},children:[e.jsx("i",{className:"fas fa-globe",style:{marginRight:8,color:"#0d9488"}}),"Country Mix"]}),y.length===0&&e.jsx("div",{style:{color:"#9ca3af",fontSize:13},children:"No data"}),y.map(W=>e.jsxs("div",{style:{marginBottom:10},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:13,marginBottom:3},children:[e.jsx("span",{style:{color:"#374151",fontWeight:500},children:W.country}),e.jsxs("span",{style:{color:"#6b7280"},children:[W.count," ",e.jsxs("span",{style:{fontSize:11,color:"#059669"},children:["(",W.sanctioned," sanctioned)"]})]})]}),e.jsx("div",{style:{height:6,background:"#f1f5f9",borderRadius:4},children:e.jsx("div",{style:{height:6,width:`${W.count/A*100}%`,background:"#0d9488",borderRadius:4}})})]},W.country))]})]}),b.length>0&&e.jsxs("div",{style:{background:"#fff",borderRadius:12,padding:20,boxShadow:"0 1px 4px rgba(0,0,0,0.06)",marginBottom:16},children:[e.jsxs("div",{style:{fontSize:15,fontWeight:700,color:"#111827",marginBottom:16},children:[e.jsx("i",{className:"fas fa-exclamation-triangle",style:{marginRight:8,color:"#dc2626"}}),"SLA Risk Queue (Top 10)"]}),e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsx("tr",{style:{background:"#fef2f2",borderBottom:"1px solid #fecaca"},children:["Student","Country","Status","SLA Due","Branch","Officer",""].map(W=>e.jsx("th",{style:{padding:"8px 12px",textAlign:"left",fontSize:11,fontWeight:700,color:"#6b7280",textTransform:"uppercase"},children:W},W))})}),e.jsx("tbody",{children:b.map(W=>{var ce;const F=Iy(W.sla_due_at),Z=F!==null&&F<0;return e.jsxs("tr",{style:{borderBottom:"1px solid #f9fafb",cursor:r?"pointer":"default"},onClick:()=>r&&r(W.id),children:[e.jsx("td",{style:{padding:"10px 12px",fontSize:13,fontWeight:600,color:"#111827"},children:W.student_name}),e.jsx("td",{style:{padding:"10px 12px",fontSize:12,color:"#374151"},children:W.country||""}),e.jsx("td",{style:{padding:"10px 12px"},children:e.jsx("span",{style:{fontSize:11,padding:"2px 7px",borderRadius:10,background:(Do[W.status]||"#9ca3af")+"20",color:Do[W.status]||"#9ca3af",fontWeight:700},children:(ce=W.status)==null?void 0:ce.replace(/_/g," ")})}),e.jsx("td",{style:{padding:"10px 12px"},children:e.jsx("span",{style:{fontSize:12,fontWeight:700,color:Z?"#dc2626":F<=1?"#d97706":"#374151"},children:Z?`${Math.abs(F)}d overdue`:F===0?"Due today":`${F}d left`})}),e.jsx("td",{style:{padding:"10px 12px",fontSize:12,color:"#374151"},children:W.branch_name||""}),e.jsx("td",{style:{padding:"10px 12px",fontSize:12,color:"#374151"},children:W.officer_name||""}),e.jsx("td",{style:{padding:"10px 12px"},children:r&&e.jsx("button",{onClick:xe=>{xe.stopPropagation(),r(W.id)},style:{fontSize:11,padding:"3px 8px",background:"#fee2e2",color:"#dc2626",border:"none",borderRadius:5,cursor:"pointer",fontWeight:600},children:"Open"})})]},W.id)})})]})]}),["SUPER_ADMIN","REGION_HEAD"].includes(i)&&e.jsxs("div",{style:{background:"#fff",borderRadius:12,boxShadow:"0 1px 4px rgba(0,0,0,0.06)",overflow:"hidden",marginBottom:16},children:[e.jsx("div",{style:{padding:"16px 20px",borderBottom:"1px solid #f3f4f6"},children:e.jsxs("div",{style:{fontSize:15,fontWeight:700,color:"#111827"},children:[e.jsx("i",{className:"fas fa-building",style:{marginRight:8,color:"#2563eb"}}),"Branch / Region Performance"]})}),e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsx("tr",{style:{background:"#f9fafb"},children:["Branch","Region/State","Apps","Sanctions","Sanction %","SLA Breach","Avg Ticket"].map(W=>e.jsx("th",{style:{padding:"10px 14px",textAlign:"left",fontSize:11,fontWeight:700,color:"#6b7280",textTransform:"uppercase",letterSpacing:"0.04em"},children:W},W))})}),e.jsxs("tbody",{children:[j.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:7,style:{padding:24,textAlign:"center",color:"#9ca3af",fontSize:13},children:"No branches yet"})}),j.map(W=>e.jsxs("tr",{style:{borderBottom:"1px solid #f3f4f6"},children:[e.jsx("td",{style:{padding:"11px 14px",fontWeight:600,fontSize:13,color:"#111827"},children:W.branch_name}),e.jsxs("td",{style:{padding:"11px 14px",fontSize:13,color:"#6b7280"},children:[W.region?`${W.region} / `:"",W.state||""]}),e.jsx("td",{style:{padding:"11px 14px",fontSize:13,fontWeight:600},children:W.apps}),e.jsx("td",{style:{padding:"11px 14px",fontSize:13,color:"#059669",fontWeight:600},children:W.sanctions}),e.jsx("td",{style:{padding:"11px 14px"},children:e.jsx("span",{style:{color:(W.sanction_rate||0)>=50?"#059669":"#d97706",fontWeight:700,fontSize:13},children:W.sanction_rate!=null?`${W.sanction_rate}%`:""})}),e.jsx("td",{style:{padding:"11px 14px"},children:W.sla_breaches>0?e.jsx("span",{style:{background:"#fee2e2",color:"#dc2626",borderRadius:10,padding:"2px 8px",fontSize:11,fontWeight:700},children:W.sla_breaches}):e.jsx("span",{style:{color:"#059669",fontSize:12,fontWeight:600},children:" Clean"})}),e.jsx("td",{style:{padding:"11px 14px",fontSize:13,color:"#374151"},children:Sl(W.avg_ticket_paise)})]},W.id))]})]})]}),e.jsxs("div",{style:{background:"#fff",borderRadius:12,boxShadow:"0 1px 4px rgba(0,0,0,0.06)",overflow:"hidden"},children:[e.jsx("div",{style:{padding:"16px 20px",borderBottom:"1px solid #f3f4f6"},children:e.jsxs("div",{style:{fontSize:15,fontWeight:700,color:"#111827"},children:[e.jsx("i",{className:"fas fa-trophy",style:{marginRight:8,color:"#d97706"}}),"Officer Performance Leaderboard"]})}),e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsx("tr",{style:{background:"#f9fafb"},children:["#","Officer","Branch","Apps Handled","Sanctions","Sanction %","SLA Breaches"].map(W=>e.jsx("th",{style:{padding:"10px 14px",textAlign:"left",fontSize:11,fontWeight:700,color:"#6b7280",textTransform:"uppercase",letterSpacing:"0.04em"},children:W},W))})}),e.jsxs("tbody",{children:[k.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:7,style:{padding:24,textAlign:"center",color:"#9ca3af",fontSize:13},children:"No officers yet"})}),k.map((W,F)=>e.jsxs("tr",{style:{borderBottom:"1px solid #f3f4f6",background:F===0?"#fffbeb":"transparent"},children:[e.jsx("td",{style:{padding:"11px 14px",fontSize:13,fontWeight:700,color:F===0?"#d97706":"#9ca3af"},children:F===0?"":F===1?"":F===2?"":F+1}),e.jsx("td",{style:{padding:"11px 14px",fontWeight:600,fontSize:13,color:"#111827"},children:W.name}),e.jsx("td",{style:{padding:"11px 14px",fontSize:12,color:"#6b7280"},children:W.branch_name||""}),e.jsx("td",{style:{padding:"11px 14px",fontSize:13,fontWeight:600},children:W.apps_handled}),e.jsx("td",{style:{padding:"11px 14px",fontSize:13,color:"#059669",fontWeight:600},children:W.sanctions}),e.jsx("td",{style:{padding:"11px 14px"},children:e.jsx("span",{style:{color:(W.sanction_rate||0)>=50?"#059669":"#d97706",fontWeight:700},children:W.sanction_rate!=null?`${W.sanction_rate}%`:""})}),e.jsx("td",{style:{padding:"11px 14px"},children:W.sla_breaches>0?e.jsx("span",{style:{color:"#dc2626",fontWeight:700},children:W.sla_breaches}):e.jsx("span",{style:{color:"#059669",fontWeight:600},children:""})})]},W.id))]})]})]})]})}function By({bankId:s}){var p,x,m,v,g,b,y,j;const[i,r]=u.useState(null),[o,d]=u.useState(!0);if(u.useEffect(()=>{s&&_e.getAnalytics(s).then(r).catch(()=>{}).finally(()=>d(!1))},[s]),o)return e.jsxs("div",{style:{textAlign:"center",padding:60,color:"#6b7280"},children:[e.jsx("i",{className:"fas fa-spinner fa-spin",style:{fontSize:24}}),e.jsx("div",{style:{marginTop:12},children:"Loading analytics..."})]});if(!i)return e.jsx("div",{style:{textAlign:"center",padding:60,color:"#9ca3af"},children:"No analytics data"});const f=Math.max(...((p=i.country_exposure)==null?void 0:p.map(k=>k.count))||[1],1);return e.jsxs("div",{children:[e.jsxs("div",{style:{marginBottom:20},children:[e.jsx("h2",{style:{fontSize:20,fontWeight:700,color:"#0d7377",marginBottom:4},children:"Advanced Bank Analytics"}),e.jsx("div",{style:{fontSize:13,color:"#6b7280"},children:"Country exposure, risk heatmap, credit utilization and trends"})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:20,marginBottom:20},children:[e.jsxs("div",{style:{background:"#fff",borderRadius:10,padding:20,boxShadow:"0 1px 4px rgba(0,0,0,0.08)"},children:[e.jsxs("div",{style:{fontSize:14,fontWeight:600,color:"#111827",marginBottom:16},children:[e.jsx("i",{className:"fas fa-globe-asia",style:{marginRight:8,color:"#0d7377"}})," Country-wise Exposure"]}),(x=i.country_exposure)==null?void 0:x.map(k=>{const _=(k.count/f*100).toFixed(0),C=k.count>0?(k.sanctioned/k.count*100).toFixed(0):0;return e.jsxs("div",{style:{marginBottom:14},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:4},children:[e.jsx("span",{style:{fontSize:13,fontWeight:500},children:k.country||"Unknown"}),e.jsxs("span",{style:{fontSize:12,color:"#6b7280"},children:[k.count," apps  ",C,"% sanctioned"]})]}),e.jsx("div",{style:{height:8,background:"#f3f4f6",borderRadius:4,overflow:"hidden"},children:e.jsx("div",{style:{height:"100%",width:`${_}%`,background:"linear-gradient(90deg, #0d7377, #14a085)",borderRadius:4}})})]},k.country)}),!((m=i.country_exposure)!=null&&m.length)&&e.jsx("div",{style:{color:"#9ca3af",fontSize:13,textAlign:"center",padding:20},children:"No exposure data"})]}),e.jsxs("div",{style:{background:"#fff",borderRadius:10,padding:20,boxShadow:"0 1px 4px rgba(0,0,0,0.08)"},children:[e.jsxs("div",{style:{fontSize:14,fontWeight:600,color:"#111827",marginBottom:16},children:[e.jsx("i",{className:"fas fa-fire",style:{marginRight:8,color:"#dc2626"}})," Risk Heatmap  Rejection by Country"]}),(v=i.rejection_by_country)==null?void 0:v.map((k,_)=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:10},children:[e.jsx("div",{style:{width:28,height:28,borderRadius:6,display:"flex",alignItems:"center",justifyContent:"center",fontSize:12,fontWeight:700,color:"#fff",background:_===0?"#dc2626":_===1?"#f59e0b":_===2?"#f97316":"#6b7280"},children:_+1}),e.jsx("div",{style:{flex:1,fontSize:13,fontWeight:500},children:k.country||"Unknown"}),e.jsxs("div",{style:{fontSize:13,fontWeight:700,color:"#dc2626"},children:[k.rejected," rejections"]})]},k.country)),!((g=i.rejection_by_country)!=null&&g.length)&&e.jsx("div",{style:{color:"#9ca3af",fontSize:13,textAlign:"center",padding:20},children:"No rejection data"})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:20,marginBottom:20},children:[e.jsxs("div",{style:{background:"#fff",borderRadius:10,padding:20,boxShadow:"0 1px 4px rgba(0,0,0,0.08)"},children:[e.jsxs("div",{style:{fontSize:14,fontWeight:600,color:"#111827",marginBottom:16},children:[e.jsx("i",{className:"fas fa-chart-area",style:{marginRight:8,color:"#7c3aed"}})," Monthly Application Trend"]}),((b=i.monthly_trend)==null?void 0:b.length)>0?e.jsx("div",{children:i.monthly_trend.map(k=>{const _=k.total>0?(k.sanctioned/k.total*100).toFixed(0):0;return e.jsxs("div",{style:{marginBottom:12},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:4},children:[e.jsx("span",{style:{fontSize:12,fontWeight:600,color:"#374151"},children:k.month}),e.jsxs("span",{style:{fontSize:12,color:"#6b7280"},children:[k.total," total  ",k.sanctioned," sanctioned (",_,"%)"]})]}),e.jsxs("div",{style:{display:"flex",height:10,borderRadius:5,overflow:"hidden",background:"#f3f4f6"},children:[e.jsx("div",{style:{width:`${_}%`,background:"#16a34a"}}),e.jsx("div",{style:{width:`${100-_}%`,background:"#e5e7eb"}})]})]},k.month)})}):e.jsx("div",{style:{color:"#9ca3af",fontSize:13,textAlign:"center",padding:20},children:"No trend data (6 months)"})]}),e.jsxs("div",{style:{background:"#fff",borderRadius:10,padding:20,boxShadow:"0 1px 4px rgba(0,0,0,0.08)"},children:[e.jsxs("div",{style:{fontSize:14,fontWeight:600,color:"#111827",marginBottom:16},children:[e.jsx("i",{className:"fas fa-tachometer-alt",style:{marginRight:8,color:"#1565c0"}})," Credit Utilization (Sanctioned Volume)"]}),((y=i.credit_utilization)==null?void 0:y.length)>0?e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{padding:"6px 8px",textAlign:"left",fontSize:11,color:"#6b7280",fontWeight:600},children:"Month"}),e.jsx("th",{style:{padding:"6px 8px",textAlign:"right",fontSize:11,color:"#6b7280",fontWeight:600},children:"Cases"}),e.jsx("th",{style:{padding:"6px 8px",textAlign:"right",fontSize:11,color:"#6b7280",fontWeight:600},children:"Total Sanctioned"})]})}),e.jsx("tbody",{children:i.credit_utilization.map(k=>e.jsxs("tr",{style:{borderBottom:"1px solid #f3f4f6"},children:[e.jsx("td",{style:{padding:"8px",fontSize:13,fontWeight:500},children:k.month}),e.jsx("td",{style:{padding:"8px",fontSize:13,textAlign:"right"},children:k.cases}),e.jsx("td",{style:{padding:"8px",fontSize:13,textAlign:"right",fontWeight:600,color:"#1565c0"},children:k.total_sanctioned?`${(k.total_sanctioned/1e5).toFixed(1)}L`:""})]},k.month))})]}):e.jsx("div",{style:{color:"#9ca3af",fontSize:13,textAlign:"center",padding:20},children:"No sanctioned volume data"})]})]}),((j=i.rejection_by_intake)==null?void 0:j.length)>0&&e.jsxs("div",{style:{background:"#fff",borderRadius:10,padding:20,boxShadow:"0 1px 4px rgba(0,0,0,0.08)"},children:[e.jsxs("div",{style:{fontSize:14,fontWeight:600,color:"#111827",marginBottom:16},children:[e.jsx("i",{className:"fas fa-calendar-alt",style:{marginRight:8,color:"#f59e0b"}})," Rejection by Intake Season"]}),e.jsx("div",{style:{display:"flex",gap:12,flexWrap:"wrap"},children:i.rejection_by_intake.map(k=>e.jsxs("div",{style:{background:"#fef2f2",border:"1px solid #fecaca",borderRadius:8,padding:"10px 16px",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:4},children:k.intake}),e.jsx("div",{style:{fontSize:20,fontWeight:700,color:"#dc2626"},children:k.rejected}),e.jsx("div",{style:{fontSize:11,color:"#9ca3af"},children:"rejections"})]},k.intake))})]})]})}const sf={INITIATED:"#6b7280",DOCS_PENDING:"#f59e0b",LOGIN_DONE:"#3b82f6",UNDER_REVIEW:"#8b5cf6",SANCTIONED:"#10b981",REJECTED:"#ef4444",DISBURSED:"#059669",CLOSED:"#9ca3af"},af={BANK:"#0d7377",STUDENT:"#f59e0b",NEXTHARA:"#3b82f6"};function uh(s,i){if(!s||["SANCTIONED","REJECTED","DISBURSED","CLOSED"].includes(i))return"ok";const d=(new Date(s)-new Date)/864e5;return d<0?"breach":d<=2?"risk":"ok"}function Oy({sla_due_at:s,status:i}){const r=uh(s,i);return r==="breach"?e.jsx("span",{style:{background:"#fee2e2",color:"#dc2626",fontSize:10,fontWeight:700,padding:"2px 6px",borderRadius:4},children:"SLA BREACH"}):r==="risk"?e.jsx("span",{style:{background:"#fef3c7",color:"#d97706",fontSize:10,fontWeight:700,padding:"2px 6px",borderRadius:4},children:"SLA RISK"}):null}function Wy({bankId:s,bankRole:i,onOpenApp:r}){const[o,d]=u.useState([]),[f,p]=u.useState(0),[x,m]=u.useState(!1),[v,g]=u.useState([]),[b,y]=u.useState([]),[j,k]=u.useState([]),[_,C]=u.useState({status:"",awaiting_from:"",sla_risk:"",country:"",product_id:"",branch_id:"",officer_id:"",search:""}),[L,D]=u.useState(0),I=50,P=u.useCallback(async()=>{m(!0);try{const N={..._,limit:I,offset:L*I};Object.keys(N).forEach(F=>{N[F]||delete N[F]});const W=await _e.getBankApplications(s,N);d(W.applications||[]),p(W.total||0)}catch(N){console.error(N)}finally{m(!1)}},[s,_,L]);u.useEffect(()=>{P()},[P]),u.useEffect(()=>{_e.getProducts(s).then(g).catch(()=>{}),_e.getBranches(s).then(y).catch(()=>{}),_e.getUsers(s).then(N=>k(N.filter(W=>W.role==="OFFICER"||W.role==="BRANCH_MANAGER"))).catch(()=>{})},[s]);const w=(N,W)=>{C(F=>({...F,[N]:W})),D(0)},A={height:32,padding:"0 10px",border:"1px solid #d1d5db",borderRadius:6,fontSize:12,background:"#fff",outline:"none",color:"#374151"};return e.jsxs("div",{children:[e.jsxs("div",{style:{background:"#fff",borderRadius:10,padding:"14px 18px",marginBottom:16,boxShadow:"0 1px 4px rgba(0,0,0,0.07)",display:"flex",flexWrap:"wrap",gap:10,alignItems:"center"},children:[e.jsx("input",{style:{...A,width:200},placeholder:"Search name / case ref...",value:_.search,onChange:N=>w("search",N.target.value)}),e.jsxs("select",{style:A,value:_.status,onChange:N=>w("status",N.target.value),children:[e.jsx("option",{value:"",children:"All Statuses"}),["INITIATED","DOCS_PENDING","LOGIN_DONE","UNDER_REVIEW","SANCTIONED","REJECTED","DISBURSED","CLOSED"].map(N=>e.jsx("option",{value:N,children:N.replace(/_/g," ")},N))]}),e.jsxs("select",{style:A,value:_.awaiting_from,onChange:N=>w("awaiting_from",N.target.value),children:[e.jsx("option",{value:"",children:"Awaiting"}),e.jsx("option",{value:"BANK",children:"Bank"}),e.jsx("option",{value:"STUDENT",children:"Student"}),e.jsx("option",{value:"NEXTHARA",children:"Nexthara"})]}),e.jsxs("select",{style:A,value:_.sla_risk,onChange:N=>w("sla_risk",N.target.value),children:[e.jsx("option",{value:"",children:"SLA Risk"}),e.jsx("option",{value:"BREACH",children:"Breach"}),e.jsx("option",{value:"RISK",children:"At Risk"})]}),e.jsxs("select",{style:A,value:_.product_id,onChange:N=>w("product_id",N.target.value),children:[e.jsx("option",{value:"",children:"All Products"}),v.map(N=>e.jsx("option",{value:N.id,children:N.product_name},N.id))]}),["SUPER_ADMIN","REGION_HEAD"].includes(i)&&e.jsxs("select",{style:A,value:_.branch_id,onChange:N=>w("branch_id",N.target.value),children:[e.jsx("option",{value:"",children:"All Branches"}),b.map(N=>e.jsx("option",{value:N.id,children:N.branch_name},N.id))]}),["SUPER_ADMIN","REGION_HEAD","BRANCH_MANAGER"].includes(i)&&e.jsxs("select",{style:A,value:_.officer_id,onChange:N=>w("officer_id",N.target.value),children:[e.jsx("option",{value:"",children:"All Officers"}),j.map(N=>e.jsx("option",{value:N.id,children:N.name},N.id))]}),e.jsxs("button",{onClick:P,style:{height:32,padding:"0 14px",background:"#0d7377",color:"#fff",border:"none",borderRadius:6,fontSize:12,fontWeight:600,cursor:"pointer"},children:[e.jsx("i",{className:"fas fa-search",style:{marginRight:6}}),"Search"]}),e.jsx("button",{onClick:()=>{C({status:"",awaiting_from:"",sla_risk:"",country:"",product_id:"",branch_id:"",officer_id:"",search:""}),D(0)},style:{height:32,padding:"0 12px",background:"#f3f4f6",color:"#374151",border:"1px solid #d1d5db",borderRadius:6,fontSize:12,cursor:"pointer"},children:"Clear"}),e.jsxs("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280"},children:[f," application",f!==1?"s":""]})]}),e.jsxs("div",{style:{background:"#fff",borderRadius:10,boxShadow:"0 1px 4px rgba(0,0,0,0.07)",overflow:"hidden"},children:[x?e.jsx("div",{style:{padding:48,textAlign:"center",color:"#9ca3af"},children:e.jsx("i",{className:"fas fa-spinner fa-spin",style:{fontSize:24}})}):o.length===0?e.jsxs("div",{style:{padding:48,textAlign:"center",color:"#9ca3af"},children:[e.jsx("i",{className:"fas fa-inbox",style:{fontSize:32,marginBottom:12,display:"block"}}),"No applications found"]}):e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsx("tr",{style:{background:"#f9fafb",borderBottom:"1px solid #e5e7eb"},children:["Case Ref","Student","Country","Product","Status","Awaiting","SLA Due","Last Update",""].map(N=>e.jsx("th",{style:{padding:"10px 14px",textAlign:"left",fontSize:11,fontWeight:700,color:"#6b7280",textTransform:"uppercase",letterSpacing:.5,whiteSpace:"nowrap"},children:N},N))})}),e.jsx("tbody",{children:o.map(N=>{var Z;const W=uh(N.sla_due_at,N.status),F=W==="breach"?"3px solid #ef4444":W==="risk"?"3px solid #f59e0b":"3px solid transparent";return e.jsxs("tr",{style:{borderBottom:"1px solid #f3f4f6",borderLeft:F,cursor:"pointer",transition:"background 0.1s"},onMouseEnter:ce=>ce.currentTarget.style.background="#f9fafb",onMouseLeave:ce=>ce.currentTarget.style.background="",onClick:()=>r&&r(N.id),children:[e.jsx("td",{style:{padding:"12px 14px",fontSize:12,fontWeight:600,color:"#0d7377",fontFamily:"monospace"},children:N.case_id?`NX-${N.case_id.slice(0,6).toUpperCase()}`:N.id.slice(0,8).toUpperCase()}),e.jsxs("td",{style:{padding:"12px 14px"},children:[e.jsx("div",{style:{fontSize:13,fontWeight:600,color:"#111827"},children:N.student_name}),e.jsx("div",{style:{fontSize:11,color:"#6b7280"},children:N.student_phone})]}),e.jsx("td",{style:{padding:"12px 14px",fontSize:12,color:"#374151"},children:N.country||""}),e.jsxs("td",{style:{padding:"12px 14px"},children:[e.jsx("div",{style:{fontSize:12,color:"#374151"},children:N.product_name||""}),N.awaiting_from==="BANK"&&N.status==="DOCS_PENDING"&&e.jsx("span",{style:{fontSize:10,background:"#fef3c7",color:"#92400e",padding:"1px 5px",borderRadius:3,marginTop:2,display:"inline-block"},children:"DOCS PENDING"})]}),e.jsx("td",{style:{padding:"12px 14px"},children:e.jsx("span",{style:{fontSize:11,fontWeight:700,padding:"3px 8px",borderRadius:12,background:(sf[N.status]||"#9ca3af")+"20",color:sf[N.status]||"#9ca3af"},children:(Z=N.status)==null?void 0:Z.replace(/_/g," ")})}),e.jsx("td",{style:{padding:"12px 14px"},children:e.jsx("span",{style:{fontSize:11,fontWeight:600,padding:"3px 8px",borderRadius:12,background:(af[N.awaiting_from]||"#9ca3af")+"20",color:af[N.awaiting_from]||"#9ca3af"},children:N.awaiting_from||""})}),e.jsx("td",{style:{padding:"12px 14px"},children:N.sla_due_at?e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:12,color:W==="breach"?"#dc2626":W==="risk"?"#d97706":"#374151",fontWeight:W!=="ok"?700:400},children:new Date(N.sla_due_at).toLocaleDateString("en-IN",{day:"numeric",month:"short"})}),e.jsx(Oy,{sla_due_at:N.sla_due_at,status:N.status})]}):""}),e.jsx("td",{style:{padding:"12px 14px",fontSize:11,color:"#6b7280"},children:N.updated_at?new Date(N.updated_at).toLocaleDateString("en-IN",{day:"numeric",month:"short"}):""}),e.jsx("td",{style:{padding:"12px 14px"},children:e.jsx("button",{onClick:ce=>{ce.stopPropagation(),r&&r(N.id)},style:{fontSize:12,padding:"5px 12px",background:"#e0f2f1",color:"#0d7377",border:"none",borderRadius:6,cursor:"pointer",fontWeight:600},children:"Open"})})]},N.id)})})]}),f>I&&e.jsxs("div",{style:{padding:"12px 18px",borderTop:"1px solid #e5e7eb",display:"flex",gap:8,alignItems:"center",justifyContent:"flex-end"},children:[e.jsx("button",{disabled:L===0,onClick:()=>D(N=>N-1),style:{padding:"5px 12px",border:"1px solid #d1d5db",borderRadius:6,background:L===0?"#f9fafb":"#fff",cursor:L===0?"not-allowed":"pointer",fontSize:12},children:" Prev"}),e.jsxs("span",{style:{fontSize:12,color:"#6b7280"},children:["Page ",L+1," of ",Math.ceil(f/I)]}),e.jsx("button",{disabled:(L+1)*I>=f,onClick:()=>D(N=>N+1),style:{padding:"5px 12px",border:"1px solid #d1d5db",borderRadius:6,background:(L+1)*I>=f?"#f9fafb":"#fff",cursor:(L+1)*I>=f?"not-allowed":"pointer",fontSize:12},children:"Next "})]})]})]})}const $y=["INITIATED","DOCS_PENDING","LOGIN_DONE","UNDER_REVIEW","SANCTIONED","REJECTED","DISBURSED","CLOSED"],lf={INITIATED:"#6b7280",DOCS_PENDING:"#f59e0b",LOGIN_DONE:"#3b82f6",UNDER_REVIEW:"#8b5cf6",SANCTIONED:"#10b981",REJECTED:"#ef4444",DISBURSED:"#059669",CLOSED:"#9ca3af"},My=["SANCTION_LETTER","REJECTION_PROOF","DISBURSEMENT_PROOF"];function Fy({label:s,active:i,onClick:r,count:o}){return e.jsxs("button",{onClick:r,style:{padding:"10px 18px",border:"none",borderBottom:i?"2px solid #0d7377":"2px solid transparent",background:"none",cursor:"pointer",fontSize:13,fontWeight:i?700:500,color:i?"#0d7377":"#6b7280",transition:"all 0.15s",display:"flex",alignItems:"center",gap:6},children:[s,o>0&&e.jsx("span",{style:{background:"#0d7377",color:"#fff",fontSize:10,fontWeight:700,padding:"1px 6px",borderRadius:10},children:o})]})}function Ka({title:s,children:i}){return e.jsxs("div",{style:{marginBottom:20},children:[e.jsx("div",{style:{fontSize:12,fontWeight:700,color:"#6b7280",textTransform:"uppercase",letterSpacing:.5,marginBottom:10},children:s}),i]})}function Qe({label:s,value:i}){return e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"6px 0",borderBottom:"1px solid #f3f4f6",fontSize:13},children:[e.jsx("span",{style:{color:"#6b7280"},children:s}),e.jsx("span",{style:{fontWeight:600,color:"#111827",textAlign:"right",maxWidth:"60%"},children:i||""})]})}function Uy({appId:s,bankId:i,bankRole:r,onBack:o}){var Pt;const[d,f]=u.useState(null),[p,x]=u.useState([]),[m,v]=u.useState([]),[g,b]=u.useState([]),[y,j]=u.useState([]),[k,_]=u.useState([]),[C,L]=u.useState("overview"),[D,I]=u.useState(!0),[P,w]=u.useState(!1),[A,N]=u.useState(!1),[W,F]=u.useState(!1),[Z,ce]=u.useState(null),[xe,z]=u.useState(null),[X,de]=u.useState({status:"",awaiting_from:"",sanction_amount_paise:"",roi_final:"",rejection_reason:"",notes:""}),[oe,ve]=u.useState({title:"",message:""}),[Y,se]=u.useState({message:"",attachment_url:""}),[J,O]=u.useState({proof_type:"SANCTION_LETTER",file_url:"",notes:""}),[U,ae]=u.useState({action:"VERIFIED",rejection_reason_code:"",rejection_note:""}),[me,be]=u.useState(!1),je=u.useCallback(async()=>{I(!0);try{const[Q,Se,Oe,Tt,an,ln]=await Promise.all([_e.getBankApplication(s),_e.getApplicationEvents(s).catch(()=>[]),_e.getQueries(s).catch(()=>[]),_e.getProofs(s).catch(()=>[]),_e.getDocReviews(s).catch(()=>[]),_e.getDocRejectionReasons().catch(()=>[])]);f(Q),x(Array.isArray(Se)?Se:[]),v(Array.isArray(Oe)?Oe:[]),b(Array.isArray(Tt)?Tt:[]),j(Array.isArray(an)?an:[]),_(Array.isArray(ln)?ln:[]),Q!=null&&Q.status&&de(ts=>({...ts,status:Q.status}))}catch(Q){console.error(Q)}finally{I(!1)}},[s]);u.useEffect(()=>{je()},[je]);const V=async()=>{if(X.status){be(!0);try{await _e.updateBankApplicationStatus(s,{status:X.status,awaiting_from:X.awaiting_from||void 0,sanction_amount_paise:X.sanction_amount_paise?parseInt(X.sanction_amount_paise):void 0,roi_final:X.roi_final?parseFloat(X.roi_final):void 0,rejection_reason:X.rejection_reason||void 0,notes:X.notes||void 0}),w(!1),je()}catch(Q){alert("Error: "+(Q.message||"Failed"))}finally{be(!1)}}},q=async()=>{if(!(!oe.title||!oe.message)){be(!0);try{await _e.createQuery(s,oe),N(!1),ve({title:"",message:""}),je()}catch{alert("Error creating query")}finally{be(!1)}}},re=async()=>{if(!(!xe||!Y.message)){be(!0);try{await _e.addQueryMessage(xe.id,Y),se({message:"",attachment_url:""});const Q=await _e.getQuery(xe.id);z(Q),je()}catch{alert("Error sending reply")}finally{be(!1)}}},Je=async()=>{if(J.file_url){be(!0);try{await _e.uploadProof(s,J),F(!1),O({proof_type:"SANCTION_LETTER",file_url:"",notes:""}),je()}catch{alert("Error uploading proof")}finally{be(!1)}}},Xe=async()=>{if(Z!=null&&Z.doc_code){be(!0);try{await _e.reviewDoc(s,{doc_code:Z.doc_code,...U}),ce(null),ae({action:"VERIFIED",rejection_reason_code:"",rejection_note:""}),je()}catch(Q){alert("Error: "+(Q.message||"Failed"))}finally{be(!1)}}},jt=async Q=>{try{const Se=await _e.getQuery(Q.id);z(Se)}catch{z(Q)}};if(D)return e.jsx("div",{style:{padding:60,textAlign:"center",color:"#9ca3af"},children:e.jsx("i",{className:"fas fa-spinner fa-spin",style:{fontSize:28}})});if(!d)return e.jsxs("div",{style:{padding:40,textAlign:"center"},children:[e.jsx("button",{onClick:o,style:{fontSize:13,color:"#0d7377",background:"none",border:"none",cursor:"pointer",marginBottom:20},children:" Back"}),e.jsx("p",{style:{color:"#ef4444"},children:"Application not found."})]});const mt=d.sla_due_at?new Date(d.sla_due_at):null,lt=mt&&mt<new Date&&!["SANCTIONED","REJECTED","DISBURSED","CLOSED"].includes(d.status),sn={};return y.forEach(Q=>{(!sn[Q.doc_code]||new Date(Q.reviewed_at)>new Date(sn[Q.doc_code].reviewed_at))&&(sn[Q.doc_code]=Q)}),e.jsxs("div",{children:[e.jsxs("button",{onClick:o,style:{fontSize:13,color:"#0d7377",background:"none",border:"none",cursor:"pointer",marginBottom:16,padding:0},children:[e.jsx("i",{className:"fas fa-arrow-left",style:{marginRight:6}}),"Back to Applications"]}),e.jsxs("div",{style:{background:"#fff",borderRadius:12,padding:"18px 24px",marginBottom:16,boxShadow:"0 1px 4px rgba(0,0,0,0.08)",borderLeft:lt?"4px solid #ef4444":"4px solid #0d7377"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"space-between",flexWrap:"wrap",gap:12},children:[e.jsxs("div",{children:[e.jsxs("div",{style:{fontSize:11,color:"#6b7280",marginBottom:4,fontFamily:"monospace",fontWeight:700},children:[d.case_id?`NX-${d.case_id.slice(0,6).toUpperCase()}`:d.id.slice(0,8).toUpperCase(),lt&&e.jsx("span",{style:{marginLeft:8,background:"#fee2e2",color:"#dc2626",fontSize:10,fontWeight:700,padding:"2px 6px",borderRadius:4},children:"SLA BREACH"})]}),e.jsx("div",{style:{fontSize:20,fontWeight:800,color:"#111827",marginBottom:4},children:d.student_name}),e.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:12,fontSize:13,color:"#6b7280"},children:[e.jsxs("span",{children:[e.jsx("i",{className:"fas fa-globe",style:{marginRight:4,color:"#0d7377"}}),d.country||""]}),e.jsxs("span",{children:[e.jsx("i",{className:"fas fa-university",style:{marginRight:4,color:"#0d7377"}}),d.university||""]}),e.jsxs("span",{children:[e.jsx("i",{className:"fas fa-tag",style:{marginRight:4,color:"#0d7377"}}),d.product_name||""]}),d.branch_name&&e.jsxs("span",{children:[e.jsx("i",{className:"fas fa-code-branch",style:{marginRight:4,color:"#0d7377"}}),d.branch_name]})]})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end",gap:8},children:[e.jsx("span",{style:{fontSize:13,fontWeight:700,padding:"5px 14px",borderRadius:20,background:(lf[d.status]||"#9ca3af")+"20",color:lf[d.status]||"#9ca3af"},children:(Pt=d.status)==null?void 0:Pt.replace(/_/g," ")}),mt&&e.jsxs("span",{style:{fontSize:12,color:lt?"#dc2626":"#6b7280"},children:["SLA: ",mt.toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric"})]}),d.awaiting_from&&e.jsxs("span",{style:{fontSize:12,fontWeight:600,color:"#0d7377",background:"#e0f2f1",padding:"3px 10px",borderRadius:10},children:["Awaiting: ",d.awaiting_from]})]})]}),e.jsxs("div",{style:{marginTop:16,display:"flex",gap:8,flexWrap:"wrap"},children:[e.jsxs("button",{onClick:()=>w(!0),style:{padding:"7px 14px",background:"#0d7377",color:"#fff",border:"none",borderRadius:7,fontSize:12,fontWeight:600,cursor:"pointer"},children:[e.jsx("i",{className:"fas fa-edit",style:{marginRight:5}}),"Update Status"]}),e.jsxs("button",{onClick:()=>N(!0),style:{padding:"7px 14px",background:"#fff",color:"#0d7377",border:"1px solid #0d7377",borderRadius:7,fontSize:12,fontWeight:600,cursor:"pointer"},children:[e.jsx("i",{className:"fas fa-question-circle",style:{marginRight:5}}),"Raise Query"]}),e.jsxs("button",{onClick:()=>F(!0),style:{padding:"7px 14px",background:"#fff",color:"#7c3aed",border:"1px solid #7c3aed",borderRadius:7,fontSize:12,fontWeight:600,cursor:"pointer"},children:[e.jsx("i",{className:"fas fa-upload",style:{marginRight:5}}),"Upload Proof"]})]})]}),e.jsxs("div",{style:{background:"#fff",borderRadius:12,boxShadow:"0 1px 4px rgba(0,0,0,0.08)",overflow:"hidden"},children:[e.jsx("div",{style:{display:"flex",borderBottom:"1px solid #e5e7eb",overflowX:"auto"},children:[{key:"overview",label:"Overview"},{key:"documents",label:"Documents",count:Object.keys(sn).length},{key:"queries",label:"Queries",count:m.filter(Q=>Q.status==="OPEN").length},{key:"timeline",label:"Timeline",count:p.length},{key:"proofs",label:"Proofs",count:g.length}].map(Q=>e.jsx(Fy,{label:Q.label,active:C===Q.key,onClick:()=>L(Q.key),count:Q.count||0},Q.key))}),e.jsxs("div",{style:{padding:24},children:[C==="overview"&&e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:24},children:[e.jsxs("div",{children:[e.jsxs(Ka,{title:"Student Snapshot",children:[e.jsx(Qe,{label:"Name",value:d.student_name}),e.jsx(Qe,{label:"Phone",value:d.student_phone}),e.jsx(Qe,{label:"Email",value:d.student_email}),e.jsx(Qe,{label:"Country",value:d.country}),e.jsx(Qe,{label:"University",value:d.university}),e.jsx(Qe,{label:"Course",value:d.course}),e.jsx(Qe,{label:"Intake",value:d.intake}),e.jsx(Qe,{label:"Loan Amount",value:d.loan_amount_paise?`${(d.loan_amount_paise/100).toLocaleString()}`:null})]}),e.jsxs(Ka,{title:"Loan Details",children:[e.jsx(Qe,{label:"Product",value:d.product_name}),e.jsx(Qe,{label:"Loan Type",value:d.loan_type}),e.jsx(Qe,{label:"Sanction Amount",value:d.sanction_amount_paise?`${(d.sanction_amount_paise/100).toLocaleString()}`:null}),e.jsx(Qe,{label:"ROI Final",value:d.roi_final?`${d.roi_final}%`:null}),e.jsx(Qe,{label:"Disbursed Amount",value:d.disbursed_amount_paise?`${(d.disbursed_amount_paise/100).toLocaleString()}`:null}),d.rejection_reason&&e.jsx(Qe,{label:"Rejection Reason",value:d.rejection_reason})]})]}),e.jsxs("div",{children:[e.jsxs(Ka,{title:"Bank Assignment",children:[e.jsx(Qe,{label:"Branch",value:d.branch_name?`${d.branch_name} (${d.city||""})`:null}),e.jsx(Qe,{label:"Officer",value:d.officer_name}),e.jsx(Qe,{label:"Officer Phone",value:d.officer_phone}),e.jsx(Qe,{label:"Priority",value:d.priority})]}),e.jsx(Ka,{title:"Next Action (Bank-side)",children:e.jsxs("div",{style:{background:"#f0f9ff",borderRadius:8,padding:"14px 16px"},children:[e.jsxs("div",{style:{fontSize:13,color:"#0d7377",fontWeight:700,marginBottom:6},children:["Awaiting: ",e.jsx("span",{style:{color:"#374151"},children:d.awaiting_from})]}),mt&&e.jsxs("div",{style:{fontSize:12,color:lt?"#dc2626":"#6b7280",fontWeight:lt?700:400},children:["SLA Due: ",mt.toLocaleString("en-IN",{day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"}),lt&&"  BREACHED"]}),e.jsxs("div",{style:{fontSize:12,color:"#6b7280",marginTop:6},children:["Last update: ",d.last_bank_update_at?new Date(d.last_bank_update_at).toLocaleDateString("en-IN"):"Not yet updated"]})]})}),e.jsxs(Ka,{title:"Timeline Summary",children:[e.jsx(Qe,{label:"Submitted",value:d.submitted_at?new Date(d.submitted_at).toLocaleDateString("en-IN"):null}),e.jsx(Qe,{label:"Created",value:d.created_at?new Date(d.created_at).toLocaleDateString("en-IN"):null}),e.jsx(Qe,{label:"Open Queries",value:m.filter(Q=>Q.status==="OPEN").length}),e.jsx(Qe,{label:"Proofs Uploaded",value:g.length})]})]})]}),C==="documents"&&e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[e.jsx("div",{style:{fontSize:14,fontWeight:700,color:"#111827"},children:"Document Checklist"}),e.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:[Object.keys(sn).length," reviewed"]})]}),y.length===0?e.jsxs("div",{style:{padding:32,textAlign:"center",color:"#9ca3af"},children:[e.jsx("i",{className:"fas fa-folder-open",style:{fontSize:28,marginBottom:10,display:"block"}}),'No document reviews yet. Use "Review Doc" button below to verify or reject documents.']}):e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsx("tr",{style:{background:"#f9fafb",borderBottom:"1px solid #e5e7eb"},children:["Document","Action","Reason","Note","Reviewed By","Date",""].map(Q=>e.jsx("th",{style:{padding:"8px 12px",textAlign:"left",fontSize:11,fontWeight:700,color:"#6b7280",textTransform:"uppercase"},children:Q},Q))})}),e.jsx("tbody",{children:y.map(Q=>e.jsxs("tr",{style:{borderBottom:"1px solid #f3f4f6"},children:[e.jsx("td",{style:{padding:"10px 12px",fontSize:13,fontWeight:600,color:"#374151",fontFamily:"monospace"},children:Q.doc_code}),e.jsx("td",{style:{padding:"10px 12px"},children:e.jsx("span",{style:{fontSize:11,fontWeight:700,padding:"2px 8px",borderRadius:12,background:Q.action==="VERIFIED"?"#d1fae5":"#fee2e2",color:Q.action==="VERIFIED"?"#065f46":"#dc2626"},children:Q.action})}),e.jsx("td",{style:{padding:"10px 12px",fontSize:12,color:"#6b7280"},children:Q.rejection_reason_code||""}),e.jsx("td",{style:{padding:"10px 12px",fontSize:12,color:"#374151"},children:Q.rejection_note||""}),e.jsx("td",{style:{padding:"10px 12px",fontSize:12,color:"#374151"},children:Q.reviewed_by_name||""}),e.jsx("td",{style:{padding:"10px 12px",fontSize:12,color:"#6b7280"},children:Q.reviewed_at?new Date(Q.reviewed_at).toLocaleDateString("en-IN",{day:"numeric",month:"short"}):""}),e.jsx("td",{style:{padding:"10px 12px"},children:e.jsx("button",{onClick:()=>{ce({doc_code:Q.doc_code}),ae({action:"VERIFIED",rejection_reason_code:"",rejection_note:""})},style:{fontSize:11,padding:"3px 8px",background:"#e0f2f1",color:"#0d7377",border:"none",borderRadius:5,cursor:"pointer"},children:"Re-review"})})]},Q.id))})]}),e.jsx("div",{style:{marginTop:16},children:e.jsxs("button",{onClick:()=>{ce({doc_code:""}),ae({action:"VERIFIED",rejection_reason_code:"",rejection_note:""})},style:{padding:"8px 16px",background:"#0d7377",color:"#fff",border:"none",borderRadius:7,fontSize:13,fontWeight:600,cursor:"pointer"},children:[e.jsx("i",{className:"fas fa-plus",style:{marginRight:6}}),"Review a Document"]})})]}),C==="queries"&&e.jsxs("div",{style:{display:"grid",gridTemplateColumns:xe?"1fr 1fr":"1fr",gap:20},children:[e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[e.jsxs("div",{style:{fontSize:14,fontWeight:700,color:"#111827"},children:["Queries (",m.length,")"]}),e.jsxs("button",{onClick:()=>N(!0),style:{padding:"6px 14px",background:"#0d7377",color:"#fff",border:"none",borderRadius:7,fontSize:12,fontWeight:600,cursor:"pointer"},children:[e.jsx("i",{className:"fas fa-plus",style:{marginRight:5}}),"New Query"]})]}),m.length===0?e.jsxs("div",{style:{padding:32,textAlign:"center",color:"#9ca3af"},children:[e.jsx("i",{className:"fas fa-comments",style:{fontSize:28,marginBottom:10,display:"block"}}),"No queries raised yet"]}):m.map(Q=>{var Se,Oe;return e.jsxs("div",{onClick:()=>jt(Q),style:{padding:"12px 16px",border:`1px solid ${(xe==null?void 0:xe.id)===Q.id?"#0d7377":"#e5e7eb"}`,borderRadius:8,marginBottom:8,cursor:"pointer",background:(xe==null?void 0:xe.id)===Q.id?"#e0f2f1":"#fff",transition:"all 0.15s"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:4},children:[e.jsx("div",{style:{fontSize:13,fontWeight:700,color:"#111827"},children:Q.title}),e.jsx("span",{style:{fontSize:10,fontWeight:700,padding:"2px 7px",borderRadius:10,background:Q.status==="OPEN"?"#fef3c7":Q.status==="CLOSED"?"#f3f4f6":"#d1fae5",color:Q.status==="OPEN"?"#92400e":Q.status==="CLOSED"?"#6b7280":"#065f46"},children:Q.status})]}),e.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:[(Se=Q.message)==null?void 0:Se.slice(0,80),((Oe=Q.message)==null?void 0:Oe.length)>80?"...":""]}),e.jsxs("div",{style:{fontSize:11,color:"#9ca3af",marginTop:4},children:["By ",Q.raised_by_name||Q.raised_by_actor_type,"  ",Q.created_at?new Date(Q.created_at).toLocaleDateString("en-IN"):""]})]},Q.id)})]}),xe&&e.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:10,overflow:"hidden"},children:[e.jsxs("div",{style:{background:"#f9fafb",padding:"12px 16px",borderBottom:"1px solid #e5e7eb",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("div",{style:{fontSize:14,fontWeight:700,color:"#111827"},children:xe.title}),e.jsxs("div",{style:{display:"flex",gap:8},children:[xe.status!=="CLOSED"&&e.jsx("button",{onClick:async()=>{await _e.closeQuery(xe.id),je(),z(null)},style:{fontSize:11,padding:"4px 10px",background:"#fee2e2",color:"#dc2626",border:"none",borderRadius:5,cursor:"pointer",fontWeight:600},children:"Close Query"}),e.jsx("button",{onClick:()=>z(null),style:{background:"none",border:"none",cursor:"pointer",color:"#6b7280",fontSize:16},children:""})]})]}),e.jsxs("div",{style:{maxHeight:300,overflowY:"auto",padding:16},children:[e.jsxs("div",{style:{background:"#f0f9ff",borderRadius:8,padding:12,marginBottom:12},children:[e.jsxs("div",{style:{fontSize:11,fontWeight:700,color:"#0d7377",marginBottom:4},children:["Original query  ",xe.raised_by_name]}),e.jsx("div",{style:{fontSize:13,color:"#374151"},children:xe.message})]}),(xe.messages||[]).map(Q=>e.jsxs("div",{style:{background:Q.actor_type==="BANK"?"#e0f2f1":"#fafafa",borderRadius:8,padding:12,marginBottom:8},children:[e.jsxs("div",{style:{fontSize:11,fontWeight:700,color:Q.actor_type==="BANK"?"#0d7377":"#6b7280",marginBottom:4},children:[Q.actor_name||Q.actor_type,"  ",Q.created_at?new Date(Q.created_at).toLocaleString("en-IN",{day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"}):""]}),e.jsx("div",{style:{fontSize:13,color:"#374151"},children:Q.message}),Q.attachment_url&&e.jsx("a",{href:Q.attachment_url,target:"_blank",rel:"noreferrer",style:{fontSize:12,color:"#0d7377"},children:"View Attachment"})]},Q.id))]}),xe.status!=="CLOSED"&&e.jsxs("div",{style:{padding:16,borderTop:"1px solid #e5e7eb"},children:[e.jsx("textarea",{placeholder:"Type your reply...",value:Y.message,onChange:Q=>se(Se=>({...Se,message:Q.target.value})),style:{width:"100%",minHeight:80,padding:10,border:"1px solid #d1d5db",borderRadius:7,fontSize:13,resize:"vertical",boxSizing:"border-box"}}),e.jsx("button",{onClick:re,disabled:me||!Y.message,style:{marginTop:8,padding:"7px 16px",background:"#0d7377",color:"#fff",border:"none",borderRadius:7,fontSize:13,fontWeight:600,cursor:"pointer"},children:"Send Reply"})]})]})]}),C==="timeline"&&e.jsxs("div",{children:[e.jsxs("div",{style:{fontSize:14,fontWeight:700,color:"#111827",marginBottom:16},children:["Application Timeline (",p.length," events)"]}),p.length===0?e.jsxs("div",{style:{padding:32,textAlign:"center",color:"#9ca3af"},children:[e.jsx("i",{className:"fas fa-history",style:{fontSize:28,marginBottom:10,display:"block"}}),"No events logged yet"]}):e.jsxs("div",{style:{position:"relative",paddingLeft:24},children:[e.jsx("div",{style:{position:"absolute",left:8,top:0,bottom:0,width:2,background:"#e5e7eb"}}),[...p].reverse().map((Q,Se)=>{var ln;const Oe=(()=>{try{return JSON.parse(Q.details)}catch{return{}}})(),Tt={STATUS_CHANGE:"fa-exchange-alt",DOC_VERIFIED:"fa-check-circle",DOC_REJECTED:"fa-times-circle",QUERY_RAISED:"fa-question-circle",PROOF_UPLOADED:"fa-upload",ASSIGNED:"fa-user-check",APPLICATION_CREATED:"fa-plus-circle",PACK_DOWNLOADED:"fa-download"},an={STATUS_CHANGE:"#3b82f6",DOC_VERIFIED:"#10b981",DOC_REJECTED:"#ef4444",QUERY_RAISED:"#f59e0b",PROOF_UPLOADED:"#7c3aed",ASSIGNED:"#0d7377",APPLICATION_CREATED:"#10b981"};return e.jsxs("div",{style:{display:"flex",gap:14,marginBottom:16},children:[e.jsx("div",{style:{width:24,height:24,borderRadius:"50%",background:an[Q.event_type]||"#9ca3af",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,marginLeft:-12,zIndex:1},children:e.jsx("i",{className:`fas ${Tt[Q.event_type]||"fa-circle"}`,style:{color:"#fff",fontSize:10}})}),e.jsxs("div",{style:{flex:1,background:"#f9fafb",borderRadius:8,padding:"10px 14px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsxs("div",{style:{fontSize:13,fontWeight:700,color:"#374151"},children:[(ln=Q.event_type)==null?void 0:ln.replace(/_/g," "),Oe.from&&Oe.to&&e.jsxs("span",{style:{fontWeight:400,color:"#6b7280",marginLeft:6},children:[Oe.from,"  ",Oe.to]}),Oe.doc_code&&e.jsx("span",{style:{fontWeight:400,color:"#6b7280",marginLeft:6,fontFamily:"monospace"},children:Oe.doc_code})]}),e.jsx("div",{style:{fontSize:11,color:"#9ca3af",whiteSpace:"nowrap",marginLeft:8},children:Q.created_at?new Date(Q.created_at).toLocaleString("en-IN",{day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"}):""})]}),Oe.by&&e.jsxs("div",{style:{fontSize:12,color:"#6b7280",marginTop:2},children:["By ",Oe.by]}),Oe.notes&&e.jsxs("div",{style:{fontSize:12,color:"#374151",marginTop:4,fontStyle:"italic"},children:['"',Oe.notes,'"']})]})]},Q.id)})]})]}),C==="proofs"&&e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[e.jsxs("div",{style:{fontSize:14,fontWeight:700,color:"#111827"},children:["Proof Documents (",g.length,")"]}),e.jsxs("button",{onClick:()=>F(!0),style:{padding:"6px 14px",background:"#0d7377",color:"#fff",border:"none",borderRadius:7,fontSize:12,fontWeight:600,cursor:"pointer"},children:[e.jsx("i",{className:"fas fa-upload",style:{marginRight:5}}),"Upload Proof"]})]}),g.length===0?e.jsxs("div",{style:{padding:40,textAlign:"center",color:"#9ca3af"},children:[e.jsx("i",{className:"fas fa-file-upload",style:{fontSize:32,marginBottom:10,display:"block"}}),"No proofs uploaded yet"]}):e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(280px, 1fr))",gap:16},children:g.map(Q=>{var Se;return e.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:10,padding:16,background:"#fff"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:10},children:[e.jsx("div",{style:{fontSize:13,fontWeight:700,color:"#374151"},children:(Se=Q.proof_type)==null?void 0:Se.replace(/_/g," ")}),e.jsx("span",{style:{fontSize:11,fontWeight:700,padding:"2px 8px",borderRadius:10,background:Q.status==="VERIFIED"?"#d1fae5":Q.status==="REJECTED"?"#fee2e2":"#fef3c7",color:Q.status==="VERIFIED"?"#065f46":Q.status==="REJECTED"?"#dc2626":"#92400e"},children:Q.status})]}),e.jsxs("a",{href:Q.file_url,target:"_blank",rel:"noreferrer",style:{display:"block",fontSize:12,color:"#0d7377",marginBottom:8,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:[e.jsx("i",{className:"fas fa-external-link-alt",style:{marginRight:4}}),"View File"]}),Q.notes&&e.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:8,fontStyle:"italic"},children:Q.notes}),e.jsxs("div",{style:{fontSize:11,color:"#9ca3af"},children:["Uploaded by ",Q.uploaded_by_name||Q.uploaded_by_actor_type,"  ",Q.created_at?new Date(Q.created_at).toLocaleDateString("en-IN"):""]}),Q.status==="PENDING_VERIFY"&&["SUPER_ADMIN","REGION_HEAD","BRANCH_MANAGER"].includes(r)&&e.jsxs("div",{style:{marginTop:10,display:"flex",gap:6},children:[e.jsx("button",{onClick:async()=>{await _e.verifyProof(Q.id,{status:"VERIFIED"}),je()},style:{flex:1,padding:"5px 0",background:"#d1fae5",color:"#065f46",border:"none",borderRadius:5,fontSize:11,fontWeight:700,cursor:"pointer"},children:"Verify"}),e.jsx("button",{onClick:async()=>{await _e.verifyProof(Q.id,{status:"REJECTED"}),je()},style:{flex:1,padding:"5px 0",background:"#fee2e2",color:"#dc2626",border:"none",borderRadius:5,fontSize:11,fontWeight:700,cursor:"pointer"},children:"Reject"})]})]},Q.id)})})]})]})]}),P&&e.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.5)",zIndex:100,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsxs("div",{style:{background:"#fff",borderRadius:12,padding:28,width:440,boxShadow:"0 20px 60px rgba(0,0,0,0.3)"},children:[e.jsx("div",{style:{fontSize:16,fontWeight:800,color:"#111827",marginBottom:20},children:"Update Application Status"}),e.jsx("label",{style:{display:"block",fontSize:12,fontWeight:600,color:"#374151",marginBottom:4},children:"Status *"}),e.jsxs("select",{value:X.status,onChange:Q=>de(Se=>({...Se,status:Q.target.value})),style:{width:"100%",padding:"8px 12px",border:"1px solid #d1d5db",borderRadius:7,fontSize:13,marginBottom:12},children:[e.jsx("option",{value:"",children:"Select status"}),$y.map(Q=>e.jsx("option",{value:Q,children:Q.replace(/_/g," ")},Q))]}),e.jsx("label",{style:{display:"block",fontSize:12,fontWeight:600,color:"#374151",marginBottom:4},children:"Awaiting From"}),e.jsxs("select",{value:X.awaiting_from,onChange:Q=>de(Se=>({...Se,awaiting_from:Q.target.value})),style:{width:"100%",padding:"8px 12px",border:"1px solid #d1d5db",borderRadius:7,fontSize:13,marginBottom:12},children:[e.jsx("option",{value:"",children:"Unchanged"}),e.jsx("option",{value:"BANK",children:"Bank"}),e.jsx("option",{value:"STUDENT",children:"Student"}),e.jsx("option",{value:"NEXTHARA",children:"Nexthara"})]}),["SANCTIONED","DISBURSED"].includes(X.status)&&e.jsxs(e.Fragment,{children:[e.jsx("label",{style:{display:"block",fontSize:12,fontWeight:600,color:"#374151",marginBottom:4},children:"Sanction Amount ()"}),e.jsx("input",{type:"number",value:X.sanction_amount_paise?X.sanction_amount_paise/100:"",onChange:Q=>de(Se=>({...Se,sanction_amount_paise:Q.target.value?parseFloat(Q.target.value)*100:""})),style:{width:"100%",padding:"8px 12px",border:"1px solid #d1d5db",borderRadius:7,fontSize:13,marginBottom:12,boxSizing:"border-box"},placeholder:"e.g. 1500000"}),e.jsx("label",{style:{display:"block",fontSize:12,fontWeight:600,color:"#374151",marginBottom:4},children:"ROI (%)"}),e.jsx("input",{type:"number",step:"0.01",value:X.roi_final,onChange:Q=>de(Se=>({...Se,roi_final:Q.target.value})),style:{width:"100%",padding:"8px 12px",border:"1px solid #d1d5db",borderRadius:7,fontSize:13,marginBottom:12,boxSizing:"border-box"},placeholder:"e.g. 10.5"})]}),X.status==="REJECTED"&&e.jsxs(e.Fragment,{children:[e.jsx("label",{style:{display:"block",fontSize:12,fontWeight:600,color:"#374151",marginBottom:4},children:"Rejection Reason"}),e.jsx("input",{value:X.rejection_reason,onChange:Q=>de(Se=>({...Se,rejection_reason:Q.target.value})),style:{width:"100%",padding:"8px 12px",border:"1px solid #d1d5db",borderRadius:7,fontSize:13,marginBottom:12,boxSizing:"border-box"},placeholder:"Reason for rejection"})]}),e.jsx("label",{style:{display:"block",fontSize:12,fontWeight:600,color:"#374151",marginBottom:4},children:"Notes (optional)"}),e.jsx("textarea",{value:X.notes,onChange:Q=>de(Se=>({...Se,notes:Q.target.value})),style:{width:"100%",padding:"8px 12px",border:"1px solid #d1d5db",borderRadius:7,fontSize:13,minHeight:70,resize:"vertical",boxSizing:"border-box",marginBottom:20},placeholder:"Any notes..."}),e.jsxs("div",{style:{display:"flex",gap:10,justifyContent:"flex-end"},children:[e.jsx("button",{onClick:()=>w(!1),style:{padding:"8px 16px",background:"#f3f4f6",border:"none",borderRadius:7,fontSize:13,cursor:"pointer"},children:"Cancel"}),e.jsx("button",{onClick:V,disabled:me||!X.status,style:{padding:"8px 20px",background:"#0d7377",color:"#fff",border:"none",borderRadius:7,fontSize:13,fontWeight:700,cursor:"pointer",opacity:me?.7:1},children:me?"Saving...":"Update Status"})]})]})}),A&&e.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.5)",zIndex:100,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsxs("div",{style:{background:"#fff",borderRadius:12,padding:28,width:440,boxShadow:"0 20px 60px rgba(0,0,0,0.3)"},children:[e.jsx("div",{style:{fontSize:16,fontWeight:800,color:"#111827",marginBottom:20},children:"Raise Query"}),e.jsx("label",{style:{display:"block",fontSize:12,fontWeight:600,color:"#374151",marginBottom:4},children:"Title *"}),e.jsx("input",{value:oe.title,onChange:Q=>ve(Se=>({...Se,title:Q.target.value})),style:{width:"100%",padding:"8px 12px",border:"1px solid #d1d5db",borderRadius:7,fontSize:13,marginBottom:14,boxSizing:"border-box"},placeholder:"e.g. ITR document clarification"}),e.jsx("label",{style:{display:"block",fontSize:12,fontWeight:600,color:"#374151",marginBottom:4},children:"Message *"}),e.jsx("textarea",{value:oe.message,onChange:Q=>ve(Se=>({...Se,message:Q.target.value})),style:{width:"100%",padding:"8px 12px",border:"1px solid #d1d5db",borderRadius:7,fontSize:13,minHeight:100,resize:"vertical",boxSizing:"border-box",marginBottom:20},placeholder:"Describe the issue or query..."}),e.jsxs("div",{style:{display:"flex",gap:10,justifyContent:"flex-end"},children:[e.jsx("button",{onClick:()=>N(!1),style:{padding:"8px 16px",background:"#f3f4f6",border:"none",borderRadius:7,fontSize:13,cursor:"pointer"},children:"Cancel"}),e.jsx("button",{onClick:q,disabled:me||!oe.title||!oe.message,style:{padding:"8px 20px",background:"#0d7377",color:"#fff",border:"none",borderRadius:7,fontSize:13,fontWeight:700,cursor:"pointer",opacity:me?.7:1},children:me?"Sending...":"Raise Query"})]})]})}),W&&e.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.5)",zIndex:100,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsxs("div",{style:{background:"#fff",borderRadius:12,padding:28,width:420,boxShadow:"0 20px 60px rgba(0,0,0,0.3)"},children:[e.jsx("div",{style:{fontSize:16,fontWeight:800,color:"#111827",marginBottom:20},children:"Upload Proof Document"}),e.jsx("label",{style:{display:"block",fontSize:12,fontWeight:600,color:"#374151",marginBottom:4},children:"Proof Type *"}),e.jsx("select",{value:J.proof_type,onChange:Q=>O(Se=>({...Se,proof_type:Q.target.value})),style:{width:"100%",padding:"8px 12px",border:"1px solid #d1d5db",borderRadius:7,fontSize:13,marginBottom:14},children:My.map(Q=>e.jsx("option",{value:Q,children:Q.replace(/_/g," ")},Q))}),e.jsx("label",{style:{display:"block",fontSize:12,fontWeight:600,color:"#374151",marginBottom:4},children:"File URL *"}),e.jsx("input",{value:J.file_url,onChange:Q=>O(Se=>({...Se,file_url:Q.target.value})),style:{width:"100%",padding:"8px 12px",border:"1px solid #d1d5db",borderRadius:7,fontSize:13,marginBottom:14,boxSizing:"border-box"},placeholder:"https://..."}),e.jsx("label",{style:{display:"block",fontSize:12,fontWeight:600,color:"#374151",marginBottom:4},children:"Notes"}),e.jsx("input",{value:J.notes,onChange:Q=>O(Se=>({...Se,notes:Q.target.value})),style:{width:"100%",padding:"8px 12px",border:"1px solid #d1d5db",borderRadius:7,fontSize:13,marginBottom:20,boxSizing:"border-box"},placeholder:"Optional notes..."}),e.jsxs("div",{style:{display:"flex",gap:10,justifyContent:"flex-end"},children:[e.jsx("button",{onClick:()=>F(!1),style:{padding:"8px 16px",background:"#f3f4f6",border:"none",borderRadius:7,fontSize:13,cursor:"pointer"},children:"Cancel"}),e.jsx("button",{onClick:Je,disabled:me||!J.file_url,style:{padding:"8px 20px",background:"#7c3aed",color:"#fff",border:"none",borderRadius:7,fontSize:13,fontWeight:700,cursor:"pointer",opacity:me?.7:1},children:me?"Uploading...":"Upload Proof"})]})]})}),Z&&e.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.5)",zIndex:100,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsxs("div",{style:{background:"#fff",borderRadius:12,padding:28,width:420,boxShadow:"0 20px 60px rgba(0,0,0,0.3)"},children:[e.jsx("div",{style:{fontSize:16,fontWeight:800,color:"#111827",marginBottom:20},children:"Review Document"}),e.jsx("label",{style:{display:"block",fontSize:12,fontWeight:600,color:"#374151",marginBottom:4},children:"Document Code *"}),e.jsx("input",{value:Z.doc_code,onChange:Q=>ce(Se=>({...Se,doc_code:Q.target.value})),style:{width:"100%",padding:"8px 12px",border:"1px solid #d1d5db",borderRadius:7,fontSize:13,marginBottom:14,boxSizing:"border-box",fontFamily:"monospace"},placeholder:"e.g. PASSPORT, ITR, OFFER_LETTER"}),e.jsx("label",{style:{display:"block",fontSize:12,fontWeight:600,color:"#374151",marginBottom:4},children:"Action *"}),e.jsxs("select",{value:U.action,onChange:Q=>ae(Se=>({...Se,action:Q.target.value})),style:{width:"100%",padding:"8px 12px",border:"1px solid #d1d5db",borderRadius:7,fontSize:13,marginBottom:14},children:[e.jsx("option",{value:"VERIFIED",children:"Verified"}),e.jsx("option",{value:"REJECTED",children:"Rejected"})]}),U.action==="REJECTED"&&e.jsxs(e.Fragment,{children:[e.jsx("label",{style:{display:"block",fontSize:12,fontWeight:600,color:"#374151",marginBottom:4},children:"Rejection Reason *"}),e.jsxs("select",{value:U.rejection_reason_code,onChange:Q=>ae(Se=>({...Se,rejection_reason_code:Q.target.value})),style:{width:"100%",padding:"8px 12px",border:"1px solid #d1d5db",borderRadius:7,fontSize:13,marginBottom:14},children:[e.jsx("option",{value:"",children:"Select reason"}),k.map(Q=>e.jsx("option",{value:Q.code,children:Q.label},Q.code))]})]}),e.jsx("label",{style:{display:"block",fontSize:12,fontWeight:600,color:"#374151",marginBottom:4},children:"Note (optional)"}),e.jsx("input",{value:U.rejection_note,onChange:Q=>ae(Se=>({...Se,rejection_note:Q.target.value})),style:{width:"100%",padding:"8px 12px",border:"1px solid #d1d5db",borderRadius:7,fontSize:13,marginBottom:20,boxSizing:"border-box"},placeholder:"Additional note..."}),e.jsxs("div",{style:{display:"flex",gap:10,justifyContent:"flex-end"},children:[e.jsx("button",{onClick:()=>ce(null),style:{padding:"8px 16px",background:"#f3f4f6",border:"none",borderRadius:7,fontSize:13,cursor:"pointer"},children:"Cancel"}),e.jsx("button",{onClick:Xe,disabled:me||!Z.doc_code,style:{padding:"8px 20px",background:U.action==="REJECTED"?"#ef4444":"#10b981",color:"#fff",border:"none",borderRadius:7,fontSize:13,fontWeight:700,cursor:"pointer",opacity:me?.7:1},children:me?"Saving...":U.action==="REJECTED"?"Mark Rejected":"Mark Verified"})]})]})})]})}const rf={SUPER_ADMIN:"National Head",REGION_HEAD:"Region Head",BRANCH_MANAGER:"Branch Manager",OFFICER:"Officer"},of={SUPER_ADMIN:[{key:"performance",icon:"fa-chart-bar",label:"Dashboard"},{key:"applications",icon:"fa-file-alt",label:"Applications"},{key:"analytics",icon:"fa-chart-line",label:"Analytics"},{key:"setup",icon:"fa-cog",label:"Bank Setup"},{key:"branches",icon:"fa-sitemap",label:"Branches"},{key:"users",icon:"fa-users",label:"Users"},{key:"announcements",icon:"fa-bullhorn",label:"Announcements"}],REGION_HEAD:[{key:"performance",icon:"fa-chart-bar",label:"Dashboard"},{key:"applications",icon:"fa-file-alt",label:"Applications"},{key:"analytics",icon:"fa-chart-line",label:"Analytics"},{key:"branches",icon:"fa-sitemap",label:"Branches"},{key:"announcements",icon:"fa-bullhorn",label:"Announcements"}],BRANCH_MANAGER:[{key:"performance",icon:"fa-chart-bar",label:"Dashboard"},{key:"applications",icon:"fa-file-alt",label:"Applications"},{key:"users",icon:"fa-users",label:"Officers"},{key:"announcements",icon:"fa-bullhorn",label:"Announcements"}],OFFICER:[{key:"performance",icon:"fa-chart-bar",label:"Dashboard"},{key:"applications",icon:"fa-file-alt",label:"Applications"},{key:"announcements",icon:"fa-bullhorn",label:"Announcements"}]};function Vy(){var y;const{user:s,logout:i}=ks(),[r,o]=u.useState("performance"),[d,f]=u.useState(!1),[p,x]=u.useState(null),m=(s==null?void 0:s.role)||"OFFICER",v=s==null?void 0:s.bank_id,g=of[m]||of.OFFICER,b=d?60:220;return e.jsx(e.Fragment,{children:e.jsxs("div",{style:{display:"flex",height:"100vh",overflow:"hidden",fontFamily:"Roboto, sans-serif",background:"#f0f2f5"},children:[e.jsxs("aside",{style:{width:b,minWidth:b,background:"linear-gradient(180deg, #0d7377 0%, #14a085 100%)",display:"flex",flexDirection:"column",transition:"width 0.2s",overflow:"hidden",boxShadow:"2px 0 8px rgba(0,0,0,0.15)",zIndex:10},children:[e.jsxs("div",{style:{padding:"12px 14px",borderBottom:"1px solid rgba(255,255,255,0.15)",display:"flex",alignItems:"center",gap:10,minHeight:64},children:[d?e.jsx("div",{style:{width:32,height:32,borderRadius:6,background:"rgba(255,255,255,0.2)",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:e.jsx("i",{className:"fas fa-building",style:{color:"#fff",fontSize:14}})}):e.jsxs("div",{style:{flex:1,overflow:"hidden"},children:[e.jsx(ai,{height:28,dark:!0}),e.jsx("div",{style:{fontSize:10,color:"rgba(255,255,255,0.65)",letterSpacing:.5,marginTop:3},children:(s==null?void 0:s.bank_name)||"Bank Partner Portal"})]}),e.jsx("button",{onClick:()=>f(j=>!j),style:{marginLeft:"auto",background:"none",border:"none",color:"rgba(255,255,255,0.7)",cursor:"pointer",fontSize:14,flexShrink:0},children:e.jsx("i",{className:`fas fa-chevron-${d?"right":"left"}`})})]}),e.jsx("nav",{style:{flex:1,padding:"8px 0",overflowY:"auto"},children:g.map(j=>e.jsxs("div",{onClick:()=>{o(j.key),j.key!=="applications"&&x(null)},title:d?j.label:"",style:{display:"flex",alignItems:"center",gap:12,padding:d?"12px 0":"11px 16px",justifyContent:d?"center":"flex-start",cursor:"pointer",borderLeft:"3px solid transparent",background:r===j.key?"rgba(255,255,255,0.15)":"transparent",borderLeftColor:r===j.key?"#fff":"transparent",color:r===j.key?"#fff":"rgba(255,255,255,0.75)",fontSize:13,transition:"all 0.15s",whiteSpace:"nowrap"},children:[e.jsx("i",{className:`fas ${j.icon}`,style:{width:18,textAlign:"center",fontSize:15}}),!d&&j.label]},j.key))}),!d&&e.jsxs("div",{style:{padding:"12px 16px",borderTop:"1px solid rgba(255,255,255,0.15)"},children:[e.jsx("div",{style:{fontSize:12,fontWeight:600,color:"#fff",marginBottom:2,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:s==null?void 0:s.name}),e.jsx("div",{style:{fontSize:11,color:"rgba(255,255,255,0.65)",marginBottom:10},children:rf[m]||m}),e.jsxs("button",{onClick:i,style:{fontSize:12,color:"rgba(255,255,255,0.7)",background:"rgba(255,255,255,0.1)",border:"1px solid rgba(255,255,255,0.2)",borderRadius:6,padding:"5px 12px",cursor:"pointer",width:"100%"},children:[e.jsx("i",{className:"fas fa-sign-out-alt",style:{marginRight:6}})," Logout"]})]})]}),e.jsxs("div",{style:{flex:1,overflow:"hidden",display:"flex",flexDirection:"column"},children:[e.jsxs("div",{style:{background:"#fff",borderBottom:"1px solid #e5e7eb",padding:"12px 24px",display:"flex",alignItems:"center",justifyContent:"space-between",flexShrink:0},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:16,fontWeight:700,color:"#0d7377"},children:((y=g.find(j=>j.key===r))==null?void 0:y.label)||"Dashboard"}),e.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:["Nexthara Bank Partner Portal  ",s==null?void 0:s.bank_name]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[e.jsx("div",{style:{fontSize:12,background:"#e0f2f1",color:"#0d7377",padding:"4px 12px",borderRadius:20,fontWeight:600},children:rf[m]||m}),e.jsx("div",{style:{width:34,height:34,borderRadius:"50%",background:"#0d7377",display:"flex",alignItems:"center",justifyContent:"center",color:"#fff",fontWeight:700,fontSize:14},children:((s==null?void 0:s.name)||"U")[0].toUpperCase()})]})]}),e.jsxs("div",{style:{flex:1,overflow:"auto",padding:24},children:[r==="performance"&&e.jsx(Py,{bankId:v,bankRole:m,onOpenApp:j=>{x(j),o("applications")}}),r==="analytics"&&e.jsx(By,{bankId:v}),r==="applications"&&!p&&e.jsx(Wy,{bankId:v,bankRole:m,onOpenApp:j=>x(j)}),r==="applications"&&p&&e.jsx(Uy,{appId:p,bankId:v,bankRole:m,onBack:()=>x(null)}),r==="setup"&&e.jsx(Ay,{bankId:v}),r==="branches"&&e.jsx(Ty,{bankId:v,bankRole:m}),r==="users"&&e.jsx(zy,{bankId:v,bankRole:m}),r==="announcements"&&e.jsx(Ly,{bankId:v,bankRole:m})]})]})]})})}const df={DRAFT:"#78909c",LIVE:"#2e7d32",CLOSED:"#e65100",CANCELLED:"#c62828"};function fh({onSelectEvent:s,onCreateEvent:i}){const[r,o]=u.useState([]),[d,f]=u.useState(!0),[p,x]=u.useState({status:"",search:""}),[m,v]=u.useState(!1),[g,b]=u.useState(!1),[y,j]=u.useState({title:"",slug:"",description:"",event_start_at:"",event_end_at:"",venue_name:"",venue_address:"",capacity_total:600,ticket_types:[{name:"FREE",price_paise:0,max_quantity:550},{name:"VIP",price_paise:49900,max_quantity:50}]});u.useEffect(()=>{k()},[p]);async function k(){f(!0);try{const P={};p.status&&(P.status=p.status),p.search&&(P.search=p.search),o(await Ye.getEvents(P))}finally{f(!1)}}async function _(P){P.preventDefault(),b(!0);try{const w=await Ye.createEvent(y);v(!1),k(),w.id&&s&&s(w.id)}catch(w){alert(w.message)}finally{b(!1)}}function C(P){return P.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-|-$/g,"")}const L=r.reduce((P,w)=>P+(w.reg_count||0),0),D=r.reduce((P,w)=>P+(w.checkin_count||0),0),I=r.filter(P=>P.status==="LIVE").length;return e.jsxs("div",{style:{padding:"24px",background:"#f9fafb",minHeight:"100vh"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:24},children:[e.jsxs("div",{children:[e.jsx("h1",{style:{margin:0,fontSize:24,fontWeight:700,color:"#0f172a"},children:"Events"}),e.jsx("p",{style:{margin:"4px 0 0",color:"#64748b",fontSize:14},children:"Manage offline education loan & funding events"})]}),e.jsx("div",{style:{display:"flex",gap:12},children:e.jsxs("button",{onClick:()=>v(!0),style:{background:"#2563eb",color:"#fff",border:"none",borderRadius:8,padding:"10px 20px",fontWeight:600,cursor:"pointer",display:"flex",alignItems:"center",gap:8},children:[e.jsx("i",{className:"fas fa-plus"})," Create Event"]})})]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:16,marginBottom:24},children:[{label:"Total Events",value:r.length,icon:"fa-calendar-alt",color:"#2563eb"},{label:"Live Events",value:I,icon:"fa-broadcast-tower",color:"#059669"},{label:"Total Registrations",value:L,icon:"fa-users",color:"#7c3aed"},{label:"Total Check-ins",value:D,icon:"fa-check-circle",color:"#d97706"}].map(P=>e.jsx("div",{style:{background:"#fff",borderRadius:12,padding:20,boxShadow:"0 1px 4px rgba(0,0,0,0.06)"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:12,color:"#64748b",marginBottom:4},children:P.label}),e.jsx("div",{style:{fontSize:28,fontWeight:700,color:"#0f172a"},children:P.value.toLocaleString()})]}),e.jsx("div",{style:{background:P.color+"18",borderRadius:10,width:42,height:42,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx("i",{className:`fas ${P.icon}`,style:{color:P.color,fontSize:18}})})]})},P.label))}),e.jsxs("div",{style:{background:"#fff",borderRadius:12,padding:"16px 20px",marginBottom:16,boxShadow:"0 1px 4px rgba(0,0,0,0.06)",display:"flex",gap:16,alignItems:"center"},children:[e.jsx("input",{placeholder:"Search events...",value:p.search,onChange:P=>x(w=>({...w,search:P.target.value})),style:{flex:1,border:"1px solid #e2e8f0",borderRadius:8,padding:"8px 14px",fontSize:14,outline:"none"}}),e.jsxs("select",{value:p.status,onChange:P=>x(w=>({...w,status:P.target.value})),style:{border:"1px solid #e2e8f0",borderRadius:8,padding:"8px 14px",fontSize:14,outline:"none"},children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"DRAFT",children:"Draft"}),e.jsx("option",{value:"LIVE",children:"Live"}),e.jsx("option",{value:"CLOSED",children:"Closed"}),e.jsx("option",{value:"CANCELLED",children:"Cancelled"})]})]}),e.jsx("div",{style:{background:"#fff",borderRadius:12,boxShadow:"0 1px 4px rgba(0,0,0,0.06)",overflow:"hidden"},children:d?e.jsx("div",{style:{padding:48,textAlign:"center",color:"#94a3b8"},children:"Loading events..."}):r.length===0?e.jsxs("div",{style:{padding:64,textAlign:"center"},children:[e.jsx("i",{className:"fas fa-calendar-plus",style:{fontSize:48,color:"#cbd5e1",marginBottom:16}}),e.jsx("p",{style:{color:"#64748b",marginBottom:16},children:"No events yet. Create your first event!"}),e.jsx("button",{onClick:()=>v(!0),style:{background:"#2563eb",color:"#fff",border:"none",borderRadius:8,padding:"10px 20px",cursor:"pointer",fontWeight:600},children:"+ Create Event"})]}):e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsx("tr",{style:{background:"#f8fafc",borderBottom:"1px solid #e2e8f0"},children:["Event","Date","Venue","Capacity","Registered","Checked-in","Leads","Status",""].map(P=>e.jsx("th",{style:{padding:"12px 16px",textAlign:"left",fontSize:12,fontWeight:600,color:"#475569",textTransform:"uppercase",letterSpacing:"0.05em"},children:P},P))})}),e.jsx("tbody",{children:r.map(P=>e.jsxs("tr",{style:{borderBottom:"1px solid #f1f5f9",cursor:"pointer"},onClick:()=>s&&s(P.id),children:[e.jsxs("td",{style:{padding:"14px 16px"},children:[e.jsx("div",{style:{fontWeight:600,color:"#0f172a",fontSize:14},children:P.title}),e.jsx("div",{style:{fontSize:12,color:"#94a3b8",marginTop:2},children:P.slug})]}),e.jsx("td",{style:{padding:"14px 16px",fontSize:13,color:"#475569"},children:new Date(P.event_start_at).toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric"})}),e.jsx("td",{style:{padding:"14px 16px",fontSize:13,color:"#475569",maxWidth:160},children:e.jsx("div",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:P.venue_name})}),e.jsxs("td",{style:{padding:"14px 16px"},children:[e.jsxs("div",{style:{fontSize:13,color:"#475569"},children:[P.capacity_reserved,"/",P.capacity_total]}),e.jsx("div",{style:{height:4,background:"#e2e8f0",borderRadius:4,marginTop:4,width:80},children:e.jsx("div",{style:{height:4,background:"#2563eb",borderRadius:4,width:`${Math.min(100,P.capacity_reserved/P.capacity_total*100)}%`}})})]}),e.jsx("td",{style:{padding:"14px 16px",fontSize:13,fontWeight:600,color:"#0f172a"},children:P.reg_count||0}),e.jsx("td",{style:{padding:"14px 16px",fontSize:13,fontWeight:600,color:"#059669"},children:P.checkin_count||0}),e.jsx("td",{style:{padding:"14px 16px",fontSize:13,color:"#7c3aed"},children:P.leads_count||0}),e.jsx("td",{style:{padding:"14px 16px"},children:e.jsx("span",{style:{background:df[P.status]+"18",color:df[P.status],borderRadius:20,padding:"3px 10px",fontSize:12,fontWeight:600},children:P.status})}),e.jsx("td",{style:{padding:"14px 16px"},children:e.jsx("button",{onClick:w=>{w.stopPropagation(),s&&s(P.id)},style:{background:"#f1f5f9",border:"none",borderRadius:6,padding:"6px 12px",fontSize:13,cursor:"pointer",color:"#475569"},children:"Open "})})]},P.id))})]})}),m&&e.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.5)",zIndex:1e3,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsxs("div",{style:{background:"#fff",borderRadius:16,width:600,maxHeight:"90vh",overflowY:"auto",padding:32},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:24},children:[e.jsx("h2",{style:{margin:0,fontSize:20,fontWeight:700},children:"Create Event"}),e.jsx("button",{onClick:()=>v(!1),style:{background:"none",border:"none",fontSize:20,cursor:"pointer",color:"#94a3b8"},children:""})]}),e.jsxs("form",{onSubmit:_,children:[e.jsxs("div",{style:{display:"grid",gap:16},children:[e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:13,fontWeight:600,color:"#374151",display:"block",marginBottom:6},children:"Event Title *"}),e.jsx("input",{required:!0,value:y.title,onChange:P=>j(w=>({...w,title:P.target.value,slug:C(P.target.value)})),style:{width:"100%",border:"1px solid #e2e8f0",borderRadius:8,padding:"10px 14px",fontSize:14,boxSizing:"border-box"},placeholder:"Exclusive Education Loan & Student Funding Event"})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:13,fontWeight:600,color:"#374151",display:"block",marginBottom:6},children:"URL Slug *"}),e.jsx("input",{required:!0,value:y.slug,onChange:P=>j(w=>({...w,slug:P.target.value})),style:{width:"100%",border:"1px solid #e2e8f0",borderRadius:8,padding:"10px 14px",fontSize:14,boxSizing:"border-box"},placeholder:"edu-loan-event-mar-2026"})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:13,fontWeight:600,color:"#374151",display:"block",marginBottom:6},children:"Start Date & Time *"}),e.jsx("input",{required:!0,type:"datetime-local",value:y.event_start_at,onChange:P=>j(w=>({...w,event_start_at:P.target.value})),style:{width:"100%",border:"1px solid #e2e8f0",borderRadius:8,padding:"10px 14px",fontSize:14,boxSizing:"border-box"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:13,fontWeight:600,color:"#374151",display:"block",marginBottom:6},children:"End Date & Time *"}),e.jsx("input",{required:!0,type:"datetime-local",value:y.event_end_at,onChange:P=>j(w=>({...w,event_end_at:P.target.value})),style:{width:"100%",border:"1px solid #e2e8f0",borderRadius:8,padding:"10px 14px",fontSize:14,boxSizing:"border-box"}})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:13,fontWeight:600,color:"#374151",display:"block",marginBottom:6},children:"Venue Name *"}),e.jsx("input",{required:!0,value:y.venue_name,onChange:P=>j(w=>({...w,venue_name:P.target.value})),style:{width:"100%",border:"1px solid #e2e8f0",borderRadius:8,padding:"10px 14px",fontSize:14,boxSizing:"border-box"},placeholder:"Nexthara HQ Auditorium"})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:13,fontWeight:600,color:"#374151",display:"block",marginBottom:6},children:"Venue Address *"}),e.jsx("input",{required:!0,value:y.venue_address,onChange:P=>j(w=>({...w,venue_address:P.target.value})),style:{width:"100%",border:"1px solid #e2e8f0",borderRadius:8,padding:"10px 14px",fontSize:14,boxSizing:"border-box"},placeholder:"Kozhikode, Kerala"})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:13,fontWeight:600,color:"#374151",display:"block",marginBottom:6},children:"Total Capacity"}),e.jsx("input",{type:"number",value:y.capacity_total,min:1,onChange:P=>j(w=>({...w,capacity_total:parseInt(P.target.value)})),style:{width:"100%",border:"1px solid #e2e8f0",borderRadius:8,padding:"10px 14px",fontSize:14,boxSizing:"border-box"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:13,fontWeight:600,color:"#374151",display:"block",marginBottom:6},children:"Description"}),e.jsx("textarea",{value:y.description,onChange:P=>j(w=>({...w,description:P.target.value})),rows:3,style:{width:"100%",border:"1px solid #e2e8f0",borderRadius:8,padding:"10px 14px",fontSize:14,boxSizing:"border-box",resize:"vertical"},placeholder:"Event description..."})]})]}),e.jsxs("div",{style:{display:"flex",gap:12,marginTop:24,justifyContent:"flex-end"},children:[e.jsx("button",{type:"button",onClick:()=>v(!1),style:{border:"1px solid #e2e8f0",borderRadius:8,padding:"10px 20px",background:"#fff",cursor:"pointer",color:"#475569"},children:"Cancel"}),e.jsx("button",{type:"submit",disabled:g,style:{background:"#2563eb",color:"#fff",border:"none",borderRadius:8,padding:"10px 20px",fontWeight:600,cursor:"pointer"},children:g?"Creating...":"Create Event"})]})]})]})})]})}const Hy=["Overview","Registrations","Messaging","Check-in","Leads & Conversions","Settings"],kl={REGISTERED:"#2563eb",CONFIRMED:"#059669",CHECKED_IN:"#7c3aed",CANCELLED:"#dc2626",NO_SHOW:"#f59e0b",WAITLISTED:"#78909c"};function hh({eventId:s,onBack:i}){const[r,o]=u.useState("Overview"),[d,f]=u.useState(null),[p,x]=u.useState([]),[m,v]=u.useState([]),[g,b]=u.useState([]),[y,j]=u.useState([]),[k,_]=u.useState(!0),[C,L]=u.useState({status:"",search:""}),[D,I]=u.useState("all"),[P,w]=u.useState(!1),[A,N]=u.useState({template_name:"",channel:"WHATSAPP",audience_filter:{}}),[W,F]=u.useState(!1),[Z,ce]=u.useState(!1),[xe,z]=u.useState("");u.useEffect(()=>{s&&X()},[s]),u.useEffect(()=>{s&&r==="Registrations"&&de()},[r,C,s]),u.useEffect(()=>{s&&r==="Messaging"&&oe()},[r,s]),u.useEffect(()=>{s&&r==="Check-in"&&ve()},[r,s]),u.useEffect(()=>{s&&r==="Leads & Conversions"&&Y()},[r,D,s]);async function X(){_(!0);try{f(await Ye.getEvent(s))}finally{_(!1)}}async function de(){const V={};C.status&&(V.status=C.status),C.search&&(V.search=C.search),x(await Ye.getRegistrations(s,V))}async function oe(){v(await Ye.getMessages(s))}async function ve(){b(await Ye.getCheckins(s))}async function Y(){const V=D!=="all"?{intent:D}:{};j(await Ye.getLeadsConversions(s,V))}async function se(V){await Ye.updateEvent(s,{status:V}),X()}async function J(V){V.preventDefault(),F(!0);try{await Ye.sendMessage(s,A),w(!1),oe()}catch(q){alert(q.message)}finally{F(!1)}}async function O(){ce(!0);try{const V=await Ye.bulkConvertToLeads(s,{});alert(`${V.leads_created} leads created`),Y()}finally{ce(!1)}}async function U(V){try{const q=await Ye.checkin(s,{ticket_code:V,method:"MANUAL"});alert(` Checked in: ${q.registration.full_name}`),ve(),X()}catch(q){alert(q.message)}}if(k||!d)return e.jsx("div",{style:{padding:48,textAlign:"center",color:"#94a3b8"},children:"Loading event..."});const ae=d.stats||{},me=d.capacity_total-d.capacity_reserved,be=Math.min(100,d.capacity_reserved/d.capacity_total*100),je=`${window.location.origin}/event/${d.slug}`;return e.jsxs("div",{style:{padding:"24px",background:"#f9fafb",minHeight:"100vh"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:20},children:[e.jsxs("div",{children:[e.jsx("button",{onClick:i,style:{background:"none",border:"none",color:"#2563eb",cursor:"pointer",fontSize:14,padding:0,marginBottom:8},children:" Back to Events"}),e.jsx("h1",{style:{margin:0,fontSize:22,fontWeight:700,color:"#0f172a"},children:d.title}),e.jsxs("div",{style:{display:"flex",gap:16,marginTop:6,flexWrap:"wrap"},children:[e.jsxs("span",{style:{fontSize:13,color:"#64748b"},children:[e.jsx("i",{className:"fas fa-calendar",style:{marginRight:6}}),new Date(d.event_start_at).toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"})]}),e.jsxs("span",{style:{fontSize:13,color:"#64748b"},children:[e.jsx("i",{className:"fas fa-map-marker-alt",style:{marginRight:6}}),d.venue_name]}),e.jsx("span",{style:{background:d.status==="LIVE"?"#dcfce7":"#f1f5f9",color:d.status==="LIVE"?"#059669":"#475569",borderRadius:20,padding:"2px 10px",fontSize:12,fontWeight:600},children:d.status})]})]}),e.jsxs("div",{style:{display:"flex",gap:10},children:[e.jsxs("button",{onClick:()=>{navigator.clipboard.writeText(je),alert("Link copied!")},style:{border:"1px solid #e2e8f0",borderRadius:8,padding:"8px 16px",background:"#fff",cursor:"pointer",fontSize:13,color:"#475569"},children:[e.jsx("i",{className:"fas fa-link",style:{marginRight:6}})," Copy Reg Link"]}),e.jsxs("button",{onClick:()=>w(!0),style:{border:"1px solid #2563eb",borderRadius:8,padding:"8px 16px",background:"#fff",cursor:"pointer",fontSize:13,color:"#2563eb"},children:[e.jsx("i",{className:"fas fa-broadcast-tower",style:{marginRight:6}})," Send Broadcast"]}),d.status==="DRAFT"&&e.jsx("button",{onClick:()=>se("LIVE"),style:{background:"#059669",color:"#fff",border:"none",borderRadius:8,padding:"8px 16px",cursor:"pointer",fontSize:13,fontWeight:600},children:"Go Live"}),d.status==="LIVE"&&e.jsx("button",{onClick:()=>se("CLOSED"),style:{background:"#e65100",color:"#fff",border:"none",borderRadius:8,padding:"8px 16px",cursor:"pointer",fontSize:13,fontWeight:600},children:"Close Event"})]})]}),e.jsx("div",{style:{display:"flex",gap:2,marginBottom:20,background:"#fff",borderRadius:10,padding:4,boxShadow:"0 1px 4px rgba(0,0,0,0.06)",width:"fit-content"},children:Hy.map(V=>e.jsx("button",{onClick:()=>o(V),style:{border:"none",borderRadius:8,padding:"8px 16px",cursor:"pointer",fontSize:13,fontWeight:r===V?600:400,background:r===V?"#2563eb":"transparent",color:r===V?"#fff":"#64748b"},children:V},V))}),r==="Overview"&&e.jsxs("div",{children:[e.jsxs("div",{style:{background:"#fff",borderRadius:12,padding:20,marginBottom:16,boxShadow:"0 1px 4px rgba(0,0,0,0.06)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[e.jsx("span",{style:{fontSize:14,fontWeight:600,color:"#374151"},children:"Capacity"}),e.jsxs("span",{style:{fontSize:14,color:"#64748b"},children:[d.capacity_reserved,"/",d.capacity_total," seats (",me," left)"]})]}),e.jsx("div",{style:{height:10,background:"#e2e8f0",borderRadius:8},children:e.jsx("div",{style:{height:10,background:be>=90?"#dc2626":"#2563eb",borderRadius:8,width:`${be}%`,transition:"width 0.5s"}})})]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:16,marginBottom:16},children:[{label:"Registered",value:ae.registered||0,color:"#2563eb",icon:"fa-users"},{label:"Confirmed",value:ae.confirmed||0,color:"#059669",icon:"fa-check"},{label:"Checked-in",value:ae.checked_in||0,color:"#7c3aed",icon:"fa-sign-in-alt"},{label:"No-shows",value:ae.no_shows||0,color:"#f59e0b",icon:"fa-user-slash"},{label:"Leads Created",value:ae.leads_created||0,color:"#0891b2",icon:"fa-user-tag"},{label:"Cases Created",value:ae.cases_created||0,color:"#dc2626",icon:"fa-briefcase"}].map(V=>e.jsxs("div",{style:{background:"#fff",borderRadius:12,padding:18,boxShadow:"0 1px 4px rgba(0,0,0,0.06)",display:"flex",alignItems:"center",gap:16},children:[e.jsx("div",{style:{background:V.color+"18",borderRadius:10,width:44,height:44,display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:e.jsx("i",{className:`fas ${V.icon}`,style:{color:V.color,fontSize:18}})}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:12,color:"#64748b"},children:V.label}),e.jsx("div",{style:{fontSize:26,fontWeight:700,color:"#0f172a"},children:V.value})]})]},V.label))}),e.jsxs("div",{style:{background:"#fff",borderRadius:12,padding:20,boxShadow:"0 1px 4px rgba(0,0,0,0.06)"},children:[e.jsx("h3",{style:{margin:"0 0 16px",fontSize:15,fontWeight:600},children:"Event Details"}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[["Venue",d.venue_name],["Address",d.venue_address],["Start",new Date(d.event_start_at).toLocaleString("en-IN")],["End",new Date(d.event_end_at).toLocaleString("en-IN")],["Registration Link",je],["Slug",d.slug]].map(([V,q])=>e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:11,fontWeight:600,color:"#94a3b8",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:2},children:V}),e.jsx("div",{style:{fontSize:13,color:"#374151",wordBreak:"break-all"},children:q})]},V))}),d.description&&e.jsxs("div",{style:{marginTop:16,paddingTop:16,borderTop:"1px solid #f1f5f9"},children:[e.jsx("div",{style:{fontSize:11,fontWeight:600,color:"#94a3b8",textTransform:"uppercase",marginBottom:4},children:"Description"}),e.jsx("p",{style:{margin:0,fontSize:13,color:"#374151"},children:d.description})]})]})]}),r==="Registrations"&&e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",gap:12,marginBottom:16},children:[e.jsx("input",{placeholder:"Search name or phone...",value:C.search,onChange:V=>L(q=>({...q,search:V.target.value})),style:{flex:1,border:"1px solid #e2e8f0",borderRadius:8,padding:"8px 14px",fontSize:14}}),e.jsxs("select",{value:C.status,onChange:V=>L(q=>({...q,status:V.target.value})),style:{border:"1px solid #e2e8f0",borderRadius:8,padding:"8px 14px",fontSize:14},children:[e.jsx("option",{value:"",children:"All Status"}),["REGISTERED","CONFIRMED","CHECKED_IN","NO_SHOW","CANCELLED","WAITLISTED"].map(V=>e.jsx("option",{children:V},V))]}),e.jsxs("a",{href:Ye.exportCSV(s),target:"_blank",rel:"noreferrer",style:{border:"1px solid #e2e8f0",borderRadius:8,padding:"8px 16px",background:"#fff",cursor:"pointer",fontSize:13,color:"#475569",textDecoration:"none",display:"flex",alignItems:"center",gap:6},children:[e.jsx("i",{className:"fas fa-download"})," Export CSV"]})]}),e.jsx("div",{style:{background:"#fff",borderRadius:12,boxShadow:"0 1px 4px rgba(0,0,0,0.06)",overflow:"hidden"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsx("tr",{style:{background:"#f8fafc",borderBottom:"1px solid #e2e8f0"},children:["Name","Phone","Ticket Type","Status","Registered","Check-in","Source","Score","Actions"].map(V=>e.jsx("th",{style:{padding:"10px 14px",textAlign:"left",fontSize:11,fontWeight:600,color:"#475569",textTransform:"uppercase"},children:V},V))})}),e.jsxs("tbody",{children:[p.map(V=>e.jsxs("tr",{style:{borderBottom:"1px solid #f1f5f9"},children:[e.jsxs("td",{style:{padding:"12px 14px"},children:[e.jsx("div",{style:{fontWeight:600,fontSize:13},children:V.full_name}),e.jsx("div",{style:{fontSize:11,color:"#94a3b8"},children:V.ticket_code})]}),e.jsx("td",{style:{padding:"12px 14px",fontSize:13,color:"#475569"},children:V.phone_e164}),e.jsx("td",{style:{padding:"12px 14px",fontSize:12},children:e.jsx("span",{style:{background:V.ticket_type_name==="VIP"?"#fef3c7":"#f0f9ff",color:V.ticket_type_name==="VIP"?"#92400e":"#0369a1",borderRadius:12,padding:"2px 8px",fontWeight:600},children:V.ticket_type_name||"FREE"})}),e.jsx("td",{style:{padding:"12px 14px"},children:e.jsx("span",{style:{background:(kl[V.status]||"#78909c")+"18",color:kl[V.status]||"#78909c",borderRadius:12,padding:"2px 8px",fontSize:11,fontWeight:600},children:V.status})}),e.jsx("td",{style:{padding:"12px 14px",fontSize:12,color:"#64748b"},children:new Date(V.registered_at).toLocaleDateString("en-IN",{day:"numeric",month:"short"})}),e.jsx("td",{style:{padding:"12px 14px",fontSize:12,color:"#64748b"},children:V.checked_in_at?new Date(V.checked_in_at).toLocaleTimeString("en-IN",{hour:"2-digit",minute:"2-digit"}):""}),e.jsx("td",{style:{padding:"12px 14px"},children:e.jsx("span",{style:{fontSize:11,background:V.source==="META"?"#eff6ff":"#f0fdf4",color:V.source==="META"?"#1d4ed8":"#166534",borderRadius:10,padding:"2px 8px"},children:V.source})}),e.jsx("td",{style:{padding:"12px 14px"},children:e.jsx("span",{style:{fontWeight:700,color:(V.intent_score||0)>=80?"#dc2626":(V.intent_score||0)>=50?"#d97706":"#64748b",fontSize:13},children:V.intent_score||0})}),e.jsx("td",{style:{padding:"12px 14px"},children:e.jsxs("div",{style:{display:"flex",gap:6},children:[V.status!=="CHECKED_IN"&&V.status!=="CANCELLED"&&e.jsx("button",{onClick:()=>U(V.ticket_code),style:{border:"none",borderRadius:6,padding:"4px 10px",fontSize:11,cursor:"pointer",background:"#dcfce7",color:"#166534"},children:"Check In"}),!V.lead_id&&e.jsx("button",{onClick:async()=>{await Ye.convertRegistration(s,V.id,{}),de(),Y()},style:{border:"none",borderRadius:6,padding:"4px 10px",fontSize:11,cursor:"pointer",background:"#eff6ff",color:"#1d4ed8"},children:" Lead"})]})})]},V.id)),p.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:9,style:{padding:32,textAlign:"center",color:"#94a3b8"},children:"No registrations found"})})]})]})})]}),r==="Messaging"&&e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:16},children:[e.jsxs("div",{children:[e.jsx("h3",{style:{margin:0,fontSize:16,fontWeight:600},children:"Broadcast Messages"}),e.jsx("p",{style:{margin:"4px 0 0",fontSize:13,color:"#64748b"},children:"Send segmented WhatsApp messages to attendees"})]}),e.jsx("button",{onClick:()=>w(!0),style:{background:"#2563eb",color:"#fff",border:"none",borderRadius:8,padding:"10px 18px",cursor:"pointer",fontWeight:600,fontSize:14},children:"+ Send Broadcast"})]}),e.jsxs("div",{style:{background:"#fff",borderRadius:12,padding:20,marginBottom:16,boxShadow:"0 1px 4px rgba(0,0,0,0.06)"},children:[e.jsx("div",{style:{fontSize:13,fontWeight:600,marginBottom:12},children:"Segment Preview"}),e.jsx("div",{style:{display:"flex",gap:10,flexWrap:"wrap"},children:[{label:"All Registered",color:"#2563eb"},{label:"Not Confirmed",color:"#f59e0b"},{label:"Confirmed",color:"#059669"},{label:"Checked-in",color:"#7c3aed"},{label:"High Intent (80+)",color:"#dc2626"},{label:"Missing Docs",color:"#78909c"}].map(V=>e.jsx("span",{style:{background:V.color+"18",color:V.color,borderRadius:20,padding:"4px 14px",fontSize:13,fontWeight:500,cursor:"pointer"},children:V.label},V.label))})]}),e.jsxs("div",{style:{background:"#fff",borderRadius:12,padding:20,marginBottom:16,boxShadow:"0 1px 4px rgba(0,0,0,0.06)"},children:[e.jsx("div",{style:{fontSize:13,fontWeight:600,marginBottom:12},children:"Available Templates"}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(200px, 1fr))",gap:12},children:[{name:"nx_event_ticket",desc:"Ticket confirmation with QR"},{name:"nx_event_reminder_24h",desc:"24h before event reminder"},{name:"nx_event_reminder_3h",desc:"3h before event reminder"},{name:"nx_event_map",desc:"Venue directions / map"},{name:"nx_event_thanks_followup",desc:"Post-event follow-up"}].map(V=>e.jsxs("div",{style:{border:"1px solid #e2e8f0",borderRadius:8,padding:12},children:[e.jsx("div",{style:{fontFamily:"monospace",fontSize:12,color:"#2563eb",fontWeight:600},children:V.name}),e.jsx("div",{style:{fontSize:12,color:"#64748b",marginTop:4},children:V.desc})]},V.name))})]}),e.jsxs("div",{style:{background:"#fff",borderRadius:12,boxShadow:"0 1px 4px rgba(0,0,0,0.06)",overflow:"hidden"},children:[e.jsx("div",{style:{padding:"16px 20px",borderBottom:"1px solid #f1f5f9",fontWeight:600,fontSize:14},children:"Message History"}),m.length===0?e.jsx("div",{style:{padding:32,textAlign:"center",color:"#94a3b8"},children:"No messages sent yet"}):e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsx("tr",{style:{background:"#f8fafc"},children:["Template","Channel","Status","Recipients","Delivered","Sent At"].map(V=>e.jsx("th",{style:{padding:"10px 16px",textAlign:"left",fontSize:11,fontWeight:600,color:"#475569",textTransform:"uppercase"},children:V},V))})}),e.jsx("tbody",{children:m.map(V=>e.jsxs("tr",{style:{borderBottom:"1px solid #f1f5f9"},children:[e.jsx("td",{style:{padding:"12px 16px",fontFamily:"monospace",fontSize:12,color:"#2563eb"},children:V.template_name}),e.jsx("td",{style:{padding:"12px 16px",fontSize:12},children:V.channel}),e.jsx("td",{style:{padding:"12px 16px"},children:e.jsx("span",{style:{background:V.status==="SENT"?"#dcfce7":"#fef9c3",color:V.status==="SENT"?"#166534":"#854d0e",borderRadius:12,padding:"2px 8px",fontSize:11},children:V.status})}),e.jsx("td",{style:{padding:"12px 16px",fontSize:13},children:V.total_recipients||0}),e.jsx("td",{style:{padding:"12px 16px",fontSize:13},children:V.delivered||0}),e.jsx("td",{style:{padding:"12px 16px",fontSize:12,color:"#64748b"},children:V.sent_at?new Date(V.sent_at).toLocaleString("en-IN"):"Scheduled"})]},V.id))})]})]})]}),r==="Check-in"&&e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:20},children:[e.jsxs("div",{style:{background:"#fff",borderRadius:12,padding:24,boxShadow:"0 1px 4px rgba(0,0,0,0.06)"},children:[e.jsx("h3",{style:{margin:"0 0 16px",fontSize:16,fontWeight:600},children:"Manual Check-in"}),e.jsx("p",{style:{fontSize:13,color:"#64748b",marginBottom:16},children:"Enter Ticket ID or phone number to check in a student"}),e.jsx(Qy,{onCheckin:U})]}),e.jsxs("div",{style:{background:"#fff",borderRadius:12,padding:24,boxShadow:"0 1px 4px rgba(0,0,0,0.06)"},children:[e.jsx("h3",{style:{margin:"0 0 4px",fontSize:16,fontWeight:600},children:"Live Count"}),e.jsx("div",{style:{fontSize:40,fontWeight:800,color:"#2563eb",marginBottom:4},children:ae.checked_in||0}),e.jsxs("div",{style:{fontSize:13,color:"#64748b",marginBottom:20},children:["checked-in of ",ae.registered||0," registered"]}),e.jsx("div",{style:{height:8,background:"#e2e8f0",borderRadius:8},children:e.jsx("div",{style:{height:8,background:"#059669",borderRadius:8,width:`${ae.registered?Math.min(100,(ae.checked_in||0)/ae.registered*100):0}%`}})})]}),e.jsxs("div",{style:{gridColumn:"1 / -1",background:"#fff",borderRadius:12,boxShadow:"0 1px 4px rgba(0,0,0,0.06)",overflow:"hidden"},children:[e.jsxs("div",{style:{padding:"16px 20px",borderBottom:"1px solid #f1f5f9",display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{style:{fontWeight:600,fontSize:14},children:"Recent Check-ins"}),e.jsx("button",{onClick:ve,style:{background:"none",border:"none",color:"#2563eb",cursor:"pointer",fontSize:13},children:"Refresh"})]}),g.length===0?e.jsx("div",{style:{padding:32,textAlign:"center",color:"#94a3b8"},children:"No check-ins yet"}):e.jsx("div",{style:{maxHeight:400,overflowY:"auto"},children:g.map(V=>e.jsxs("div",{style:{padding:"12px 20px",borderBottom:"1px solid #f1f5f9",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsx("span",{style:{fontWeight:600,fontSize:14,color:"#0f172a"},children:V.full_name}),e.jsx("span",{style:{fontSize:12,color:"#64748b",marginLeft:12},children:V.ticket_code})]}),e.jsxs("div",{style:{display:"flex",gap:16,alignItems:"center"},children:[e.jsx("span",{style:{fontSize:12,color:"#64748b"},children:new Date(V.created_at).toLocaleTimeString("en-IN")}),e.jsx("span",{style:{fontSize:11,background:V.method==="QR_SCAN"?"#eff6ff":"#f0fdf4",color:V.method==="QR_SCAN"?"#1d4ed8":"#166534",borderRadius:10,padding:"2px 8px"},children:V.method})]})]},V.id))})]})]}),r==="Leads & Conversions"&&e.jsxs("div",{children:[e.jsxs("div",{style:{background:"#fff",borderRadius:12,padding:20,marginBottom:16,boxShadow:"0 1px 4px rgba(0,0,0,0.06)"},children:[e.jsx("div",{style:{fontWeight:600,fontSize:14,marginBottom:12},children:"Conversion Funnel"}),e.jsx("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[{label:"Registered",value:ae.registered||0,color:"#2563eb"},{label:"Checked-in",value:ae.checked_in||0,color:"#7c3aed"},{label:"Leads",value:ae.leads_created||0,color:"#059669"},{label:"Cases",value:ae.cases_created||0,color:"#dc2626"}].map((V,q)=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,flex:1},children:[e.jsxs("div",{style:{flex:1,background:V.color+"12",borderRadius:10,padding:"14px 16px",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:24,fontWeight:800,color:V.color},children:V.value}),e.jsx("div",{style:{fontSize:12,color:"#64748b",marginTop:2},children:V.label})]}),q<3&&e.jsx("div",{style:{fontSize:20,color:"#cbd5e1"},children:""})]},V.label))})]}),e.jsxs("div",{style:{display:"flex",gap:12,marginBottom:16},children:[e.jsx("button",{onClick:O,disabled:Z,style:{background:"#2563eb",color:"#fff",border:"none",borderRadius:8,padding:"10px 18px",cursor:"pointer",fontWeight:600,fontSize:14},children:Z?"Converting...":"Bulk Convert Checked-in  Leads"}),e.jsxs("select",{value:D,onChange:V=>I(V.target.value),style:{border:"1px solid #e2e8f0",borderRadius:8,padding:"10px 14px",fontSize:14},children:[e.jsx("option",{value:"all",children:"All Attendees"}),e.jsx("option",{value:"hot",children:"Hot (80+)"}),e.jsx("option",{value:"warm",children:"Warm (5079)"}),e.jsx("option",{value:"cold",children:"Cold (<50)"}),e.jsx("option",{value:"no_show",children:"No-show"}),e.jsx("option",{value:"docs_uploaded",children:"Docs Uploaded"})]})]}),e.jsx("div",{style:{background:"#fff",borderRadius:12,boxShadow:"0 1px 4px rgba(0,0,0,0.06)",overflow:"hidden"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsx("tr",{style:{background:"#f8fafc",borderBottom:"1px solid #e2e8f0"},children:["Name","Phone","Score","Status","Lead?","Case?","Owner","Convert"].map(V=>e.jsx("th",{style:{padding:"10px 14px",textAlign:"left",fontSize:11,fontWeight:600,color:"#475569",textTransform:"uppercase"},children:V},V))})}),e.jsxs("tbody",{children:[y.map(V=>e.jsxs("tr",{style:{borderBottom:"1px solid #f1f5f9"},children:[e.jsx("td",{style:{padding:"12px 14px",fontWeight:600,fontSize:13},children:V.full_name}),e.jsx("td",{style:{padding:"12px 14px",fontSize:13,color:"#475569"},children:V.phone_e164}),e.jsx("td",{style:{padding:"12px 14px"},children:e.jsx("span",{style:{fontWeight:700,color:(V.intent_score||0)>=80?"#dc2626":(V.intent_score||0)>=50?"#d97706":"#64748b"},children:V.intent_score||0})}),e.jsx("td",{style:{padding:"12px 14px"},children:e.jsx("span",{style:{background:(kl[V.status]||"#78909c")+"18",color:kl[V.status]||"#78909c",borderRadius:10,padding:"2px 8px",fontSize:11},children:V.status})}),e.jsx("td",{style:{padding:"12px 14px"},children:V.lead_id?e.jsx("span",{style:{color:"#059669",fontSize:13},children:""}):e.jsx("span",{style:{color:"#94a3b8",fontSize:13},children:""})}),e.jsx("td",{style:{padding:"12px 14px"},children:V.case_id?e.jsx("span",{style:{color:"#2563eb",fontSize:13},children:""}):e.jsx("span",{style:{color:"#94a3b8",fontSize:13},children:""})}),e.jsx("td",{style:{padding:"12px 14px",fontSize:12,color:"#64748b"},children:V.assigned_user_id||""}),e.jsx("td",{style:{padding:"12px 14px"},children:!V.lead_id&&e.jsx("button",{onClick:async()=>{await Ye.convertRegistration(s,V.id,{}),Y()},style:{border:"none",borderRadius:6,padding:"4px 10px",fontSize:11,cursor:"pointer",background:"#eff6ff",color:"#1d4ed8"},children:" Lead"})})]},V.id)),y.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:8,style:{padding:32,textAlign:"center",color:"#94a3b8"},children:"No attendees found"})})]})]})})]}),r==="Settings"&&e.jsx(Gy,{event:d,onSave:async V=>{await Ye.updateEvent(s,V),X()}}),P&&e.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.5)",zIndex:1e3,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsxs("div",{style:{background:"#fff",borderRadius:16,width:480,padding:28},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:20},children:[e.jsx("h3",{style:{margin:0,fontSize:18,fontWeight:700},children:"Send Broadcast"}),e.jsx("button",{onClick:()=>w(!1),style:{background:"none",border:"none",fontSize:20,cursor:"pointer",color:"#94a3b8"},children:""})]}),e.jsxs("form",{onSubmit:J,children:[e.jsxs("div",{style:{display:"grid",gap:14},children:[e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:13,fontWeight:600,display:"block",marginBottom:6},children:"Template Name *"}),e.jsxs("select",{required:!0,value:A.template_name,onChange:V=>N(q=>({...q,template_name:V.target.value})),style:{width:"100%",border:"1px solid #e2e8f0",borderRadius:8,padding:"10px 14px",fontSize:14},children:[e.jsx("option",{value:"",children:"Choose template..."}),["nx_event_ticket","nx_event_reminder_24h","nx_event_reminder_3h","nx_event_map","nx_event_thanks_followup"].map(V=>e.jsx("option",{children:V},V))]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:13,fontWeight:600,display:"block",marginBottom:6},children:"Audience Segment"}),e.jsxs("select",{onChange:V=>{const q=V.target.value;q==="all"?N(re=>({...re,audience_filter:{}})):q==="confirmed"?N(re=>({...re,audience_filter:{status:"CONFIRMED"}})):q==="registered"?N(re=>({...re,audience_filter:{status:"REGISTERED"}})):q==="high_intent"&&N(re=>({...re,audience_filter:{intent_min:70}}))},style:{width:"100%",border:"1px solid #e2e8f0",borderRadius:8,padding:"10px 14px",fontSize:14},children:[e.jsx("option",{value:"all",children:"All Registered"}),e.jsx("option",{value:"confirmed",children:"Confirmed Only"}),e.jsx("option",{value:"registered",children:"Registered Only"}),e.jsx("option",{value:"high_intent",children:"High Intent (70+)"})]})]})]}),e.jsxs("div",{style:{display:"flex",gap:12,marginTop:20,justifyContent:"flex-end"},children:[e.jsx("button",{type:"button",onClick:()=>w(!1),style:{border:"1px solid #e2e8f0",borderRadius:8,padding:"10px 20px",background:"#fff",cursor:"pointer",color:"#475569"},children:"Cancel"}),e.jsx("button",{type:"submit",disabled:W,style:{background:"#2563eb",color:"#fff",border:"none",borderRadius:8,padding:"10px 20px",fontWeight:600,cursor:"pointer"},children:W?"Sending...":"Send Now"})]})]})]})})]})}function Qy({onCheckin:s}){const[i,r]=u.useState("");return e.jsxs("div",{style:{display:"flex",gap:10},children:[e.jsx("input",{value:i,onChange:o=>r(o.target.value),placeholder:"Ticket ID or phone...",style:{flex:1,border:"1px solid #e2e8f0",borderRadius:8,padding:"10px 14px",fontSize:14},onKeyDown:o=>{o.key==="Enter"&&i&&(s(i),r(""))}}),e.jsx("button",{onClick:()=>{i&&(s(i),r(""))},style:{background:"#059669",color:"#fff",border:"none",borderRadius:8,padding:"10px 16px",cursor:"pointer",fontWeight:600},children:"Check In"})]})}function Gy({event:s,onSave:i}){var x,m;const[r,o]=u.useState({title:s.title,venue_name:s.venue_name,venue_address:s.venue_address,map_url:s.map_url||"",capacity_total:s.capacity_total,event_start_at:((x=s.event_start_at)==null?void 0:x.slice(0,16))||"",event_end_at:((m=s.event_end_at)==null?void 0:m.slice(0,16))||""}),[d,f]=u.useState(!1);async function p(v){v.preventDefault(),f(!0);try{await i(r),alert("Saved!")}finally{f(!1)}}return e.jsxs("div",{style:{background:"#fff",borderRadius:12,padding:24,boxShadow:"0 1px 4px rgba(0,0,0,0.06)"},children:[e.jsx("h3",{style:{margin:"0 0 20px",fontSize:16,fontWeight:600},children:"Event Settings"}),e.jsxs("form",{onSubmit:p,children:[e.jsxs("div",{style:{display:"grid",gap:16},children:[e.jsx(vs,{label:"Event Title",value:r.title,onChange:v=>o(g=>({...g,title:v}))}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[e.jsx(vs,{label:"Start",type:"datetime-local",value:r.event_start_at,onChange:v=>o(g=>({...g,event_start_at:v}))}),e.jsx(vs,{label:"End",type:"datetime-local",value:r.event_end_at,onChange:v=>o(g=>({...g,event_end_at:v}))})]}),e.jsx(vs,{label:"Venue Name",value:r.venue_name,onChange:v=>o(g=>({...g,venue_name:v}))}),e.jsx(vs,{label:"Venue Address",value:r.venue_address,onChange:v=>o(g=>({...g,venue_address:v}))}),e.jsx(vs,{label:"Map URL",value:r.map_url,onChange:v=>o(g=>({...g,map_url:v})),placeholder:"https://maps.google.com/..."}),e.jsx(vs,{label:"Total Capacity",type:"number",value:r.capacity_total,onChange:v=>o(g=>({...g,capacity_total:parseInt(v)}))})]}),e.jsx("button",{type:"submit",disabled:d,style:{marginTop:20,background:"#2563eb",color:"#fff",border:"none",borderRadius:8,padding:"10px 24px",fontWeight:600,cursor:"pointer"},children:d?"Saving...":"Save Settings"})]})]})}function vs({label:s,value:i,onChange:r,type:o="text",placeholder:d}){return e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:13,fontWeight:600,color:"#374151",display:"block",marginBottom:6},children:s}),e.jsx("input",{type:o,value:i,onChange:f=>r(f.target.value),placeholder:d,style:{width:"100%",border:"1px solid #e2e8f0",borderRadius:8,padding:"10px 14px",fontSize:14,boxSizing:"border-box"}})]})}const qy=["2024-09","2025-01","2025-05","2025-09","2026-01","2026-05","2026-09"],Jy=[{key:"all",label:"All",icon:"fa-layer-group",color:"#374151"},{key:"stage-1",label:"Pre-Login",icon:"fa-plug",color:"#78909c"},{key:"stage-2",label:"Login",icon:"fa-sign-in-alt",color:"#f9a825"},{key:"stage-3",label:"Docs",icon:"fa-file-alt",color:"#e65100"},{key:"stage-4",label:"Credit",icon:"fa-search-dollar",color:"#6a1b9a"},{key:"stage-5",label:"Decision",icon:"fa-gavel",color:"#2e7d32"},{key:"stage-6",label:"Post Sanction",icon:"fa-handshake",color:"#1565c0"},{key:"stage-7",label:"Closed",icon:"fa-flag-checkered",color:"#37474f"}],Ky=[{key:"await-Student",label:"Student",icon:"fa-user-graduate",color:"#f57f17"},{key:"await-Bank",label:"Bank",icon:"fa-university",color:"#1565c0"},{key:"await-Nexthara",label:"Nexthara",icon:"fa-building",color:"#78909c"}],Yy=[{key:"priority-Urgent",label:"Urgent",icon:"fa-exclamation-circle",color:"#e53935"},{key:"priority-High",label:"High",icon:"fa-arrow-up",color:"#ffa726"}],Zy=[{key:"sla-breach",label:"SLA Breach",icon:"fa-clock",color:"#e53935"},{key:"sla-warning",label:"SLA Warning",icon:"fa-exclamation-triangle",color:"#f57f17"}];function Nl({chipKey:s,label:i,icon:r,color:o,count:d,active:f,onClick:p}){return e.jsxs("button",{onClick:()=>p(s),style:{display:"inline-flex",alignItems:"center",gap:5,padding:"5px 11px",borderRadius:20,border:`1.5px solid ${f?o:"#e5e7eb"}`,background:f?o+"18":"#fff",color:f?o:"#4b5563",fontSize:12,fontWeight:f?700:500,cursor:"pointer",flexShrink:0,whiteSpace:"nowrap",transition:"all 0.12s"},children:[e.jsx("i",{className:`fas ${r}`,style:{fontSize:10}}),i,d!==void 0&&e.jsx("span",{style:{background:f?o:"#f3f4f6",color:f?"#fff":"#6b7280",borderRadius:10,padding:"1px 6px",fontSize:10,fontWeight:700,marginLeft:2},children:d})]})}function Lo(){return e.jsx("div",{style:{width:1,height:20,background:"#e5e7eb",flexShrink:0,alignSelf:"center"}})}function cf({activeFilter:s,onFilterChange:i,filters:r,onFiltersChange:o,refreshKey:d}){const[f,p]=u.useState(null);u.useEffect(()=>{Ae.getSidebarCounts().then(p).catch(()=>{})},[d]);const x=f||{},m=j=>o({...r,search:j.target.value}),v=j=>o({...r,status:j.target.value}),g=j=>o({...r,intake:j.target.value}),b=r.search||r.status||r.intake||s&&s!=="all",y=()=>{o({}),i("all")};return e.jsxs("div",{style:{position:"sticky",top:0,zIndex:20,background:"#f0f2f5",borderBottom:"1px solid #e5e7eb",paddingBottom:10,marginBottom:16},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:8,flexWrap:"wrap"},children:[e.jsxs("div",{style:{position:"relative",flexShrink:0},children:[e.jsx("i",{className:"fas fa-search",style:{position:"absolute",left:10,top:"50%",transform:"translateY(-50%)",color:"#9ca3af",fontSize:12}}),e.jsx("input",{type:"text",placeholder:"Search name, case ID, bank",value:r.search||"",onChange:m,style:{paddingLeft:30,paddingRight:10,paddingTop:7,paddingBottom:7,border:"1.5px solid #e5e7eb",borderRadius:8,fontSize:12,width:230,background:"#fff",outline:"none"}})]}),e.jsxs("select",{value:r.status||"",onChange:v,style:{padding:"7px 10px",border:"1.5px solid #e5e7eb",borderRadius:8,fontSize:12,background:"#fff",color:"#374151",cursor:"pointer"},children:[e.jsx("option",{value:"",children:"All Statuses"}),Object.entries(Rt).map(([j,k])=>e.jsx("option",{value:j,children:k.label},j))]}),e.jsxs("select",{value:r.intake||"",onChange:g,style:{padding:"7px 10px",border:"1.5px solid #e5e7eb",borderRadius:8,fontSize:12,background:"#fff",color:"#374151",cursor:"pointer"},children:[e.jsx("option",{value:"",children:"All Intakes"}),qy.map(j=>e.jsx("option",{value:j,children:j},j))]}),b&&e.jsxs("button",{onClick:y,style:{padding:"6px 12px",border:"1.5px solid #fca5a5",borderRadius:8,background:"#fef2f2",color:"#dc2626",fontSize:12,fontWeight:600,cursor:"pointer",display:"flex",alignItems:"center",gap:5,flexShrink:0},children:[e.jsx("i",{className:"fas fa-times",style:{fontSize:10}})," Clear all"]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,overflowX:"auto",paddingBottom:2},children:[Jy.map(j=>{var k;return e.jsx(Nl,{chipKey:j.key,label:j.label,icon:j.icon,color:j.color,count:j.key==="all"?x.all:(k=x.stages)==null?void 0:k[Number(j.key.split("-")[1])],active:s===j.key,onClick:i},j.key)}),e.jsx(Lo,{}),Ky.map(j=>e.jsx(Nl,{chipKey:j.key,label:j.label,icon:j.icon,color:j.color,count:j.key==="await-Student"?x.awaitStudent:j.key==="await-Bank"?x.awaitBank:x.awaitNexthara,active:s===j.key,onClick:i},j.key)),e.jsx(Lo,{}),Yy.map(j=>e.jsx(Nl,{chipKey:j.key,label:j.label,icon:j.icon,color:j.color,count:j.key==="priority-Urgent"?x.urgent:x.high,active:s===j.key,onClick:i},j.key)),e.jsx(Lo,{}),Zy.map(j=>e.jsx(Nl,{chipKey:j.key,label:j.label,icon:j.icon,color:j.color,count:j.key==="sla-breach"?x.slaBreach:x.slaWarning,active:s===j.key,onClick:i},j.key))]})]})}const Xy=[{key:"new_leads",label:"New Leads",icon:"fa-user-plus",color:"#1e88e5"},{key:"connected_pct",label:"Connected %",icon:"fa-phone-alt",color:"#43a047",suffix:"%"},{key:"cases_created",label:"Cases Created",icon:"fa-briefcase",color:"#7b1fa2"},{key:"sanction_pct",label:"Sanction Rate",icon:"fa-check-circle",color:"#00897b",suffix:"%"},{key:"sla_breaches",label:"SLA Breaches",icon:"fa-exclamation-triangle",color:"#e53935"},{key:"comms_failed",label:"Comms Failed",icon:"fa-times-circle",color:"#fb8c00"}];function e1({label:s,value:i,icon:r,color:o,suffix:d=""}){return e.jsxs("div",{style:{background:"#fff",borderRadius:10,padding:"16px 20px",boxShadow:"0 1px 6px rgba(0,0,0,0.08)",display:"flex",alignItems:"center",gap:16,minWidth:0},children:[e.jsx("div",{style:{width:44,height:44,borderRadius:10,background:o+"18",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:e.jsx("i",{className:`fas ${r}`,style:{color:o,fontSize:18}})}),e.jsxs("div",{style:{minWidth:0},children:[e.jsxs("div",{style:{fontSize:22,fontWeight:700,color:"#1a1d4d",lineHeight:1},children:[i??"",d]}),e.jsx("div",{style:{fontSize:12,color:"#6b7280",marginTop:3},children:s})]})]})}function Cl({title:s,icon:i,color:r,items:o,renderRow:d}){return e.jsxs("div",{style:{background:"#fff",borderRadius:10,padding:20,boxShadow:"0 1px 6px rgba(0,0,0,0.08)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:14},children:[e.jsx("i",{className:`fas ${i}`,style:{color:r,fontSize:14}}),e.jsx("span",{style:{fontSize:13,fontWeight:700,color:"#1a1d4d"},children:s}),e.jsx("span",{style:{marginLeft:"auto",fontSize:11,background:r+"18",color:r,padding:"2px 8px",borderRadius:10,fontWeight:600},children:o.length})]}),o.length===0?e.jsx("div",{style:{textAlign:"center",padding:"20px 0",color:"#9ca3af",fontSize:12},children:"All clear"}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:o.slice(0,5).map((f,p)=>e.jsx("div",{style:{fontSize:12,padding:"8px 10px",background:"#f9fafb",borderRadius:6,borderLeft:`3px solid ${r}`},children:d(f)},p))})]})}function t1(){const[s,i]=u.useState(null),[r,o]=u.useState(30),[d,f]=u.useState(!0);if(u.useEffect(()=>{f(!0),we.getDashboard(r).then(i).catch(()=>{}).finally(()=>f(!1))},[r]),d)return e.jsx("div",{style:{textAlign:"center",padding:60,color:"#6b7280"},children:e.jsx("i",{className:"fas fa-spinner fa-spin",style:{fontSize:24}})});if(!s)return e.jsx("div",{style:{textAlign:"center",padding:60,color:"#ef4444"},children:"Failed to load dashboard."});const{kpis:p,live_queues:x,bank_performance:m,staff_performance:v,campaign_mix:g}=s;return e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:24},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:20,fontWeight:700,color:"#1a1d4d"},children:"Master Brain Dashboard"}),e.jsx("div",{style:{fontSize:12,color:"#6b7280",marginTop:2},children:"Live operational overview  all engines"})]}),e.jsx("div",{style:{display:"flex",gap:8},children:[7,30,90].map(b=>e.jsxs("button",{onClick:()=>o(b),style:{padding:"6px 14px",borderRadius:6,border:"1px solid",fontSize:12,cursor:"pointer",fontWeight:r===b?700:400,background:r===b?"#1a1d4d":"#fff",color:r===b?"#fff":"#374151",borderColor:r===b?"#1a1d4d":"#d1d5db"},children:[b,"d"]},b))})]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(160px, 1fr))",gap:14},children:Xy.map(b=>e.jsx(e1,{label:b.label,value:p==null?void 0:p[b.key],icon:b.icon,color:b.color,suffix:b.suffix||""},b.key))}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:14,fontWeight:700,color:"#374151",marginBottom:12},children:"Live Queues"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(220px, 1fr))",gap:14},children:[e.jsx(Cl,{title:"Overdue Follow-ups",icon:"fa-clock",color:"#ef4444",items:(x==null?void 0:x.overdue_followups)||[],renderRow:b=>e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:600,color:"#1a1d4d",marginBottom:2},children:b.lead_name}),e.jsxs("div",{style:{color:"#ef4444"},children:[b.hours_overdue,"h overdue"]})]})}),e.jsx(Cl,{title:"Docs Pending >48h",icon:"fa-file-exclamation",color:"#f59e0b",items:(x==null?void 0:x.docs_pending)||[],renderRow:b=>e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:600,color:"#1a1d4d",marginBottom:2},children:b.student_name}),e.jsxs("div",{style:{color:"#f59e0b"},children:[b.hours_pending,"h  ",b.missing_docs," docs missing"]})]})}),e.jsx(Cl,{title:"Bank SLA Risk",icon:"fa-university",color:"#7c3aed",items:(x==null?void 0:x.sla_risk)||[],renderRow:b=>e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:600,color:"#1a1d4d",marginBottom:2},children:b.bank_name}),e.jsx("div",{style:{color:b.hours_left<0?"#ef4444":"#7c3aed"},children:b.hours_left<0?`${Math.abs(b.hours_left)}h breached`:`${b.hours_left}h left`})]})}),e.jsx(Cl,{title:"Message Failures",icon:"fa-times-circle",color:"#dc2626",items:(x==null?void 0:x.msg_failures)||[],renderRow:b=>e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:600,color:"#1a1d4d",marginBottom:2},children:b.recipient}),e.jsxs("div",{style:{color:"#dc2626"},children:[b.template,"  ",b.entity_type]})]})})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(360px, 1fr))",gap:20},children:[e.jsxs("div",{style:{background:"#fff",borderRadius:10,padding:20,boxShadow:"0 1px 6px rgba(0,0,0,0.08)",minWidth:0},children:[e.jsx("div",{style:{fontSize:13,fontWeight:700,color:"#1a1d4d",marginBottom:14},children:"Bank Performance"}),e.jsx("div",{style:{overflowX:"auto"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:12},children:[e.jsx("thead",{children:e.jsx("tr",{style:{background:"#f9fafb"},children:["Bank","Apps","Sanctioned","Rejected","SLA Breach","Rate%"].map(b=>e.jsx("th",{style:{padding:"6px 8px",textAlign:"left",color:"#6b7280",fontWeight:600},children:b},b))})}),e.jsxs("tbody",{children:[(m||[]).map((b,y)=>e.jsxs("tr",{style:{borderBottom:"1px solid #f3f4f6"},children:[e.jsx("td",{style:{padding:"8px",fontWeight:600,color:"#1a1d4d"},children:b.bank_name}),e.jsx("td",{style:{padding:"8px"},children:b.total_apps}),e.jsx("td",{style:{padding:"8px",color:"#16a34a"},children:b.sanctioned}),e.jsx("td",{style:{padding:"8px",color:"#dc2626"},children:b.rejected}),e.jsx("td",{style:{padding:"8px",color:b.sla_breaches>0?"#ef4444":"#6b7280"},children:b.sla_breaches}),e.jsxs("td",{style:{padding:"8px",fontWeight:600,color:"#7b1fa2"},children:[b.sanction_pct,"%"]})]},y)),(!m||m.length===0)&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,style:{padding:20,textAlign:"center",color:"#9ca3af"},children:"No data"})})]})]})})]}),e.jsxs("div",{style:{background:"#fff",borderRadius:10,padding:20,boxShadow:"0 1px 6px rgba(0,0,0,0.08)",minWidth:0},children:[e.jsx("div",{style:{fontSize:13,fontWeight:700,color:"#1a1d4d",marginBottom:14},children:"Staff Performance"}),e.jsx("div",{style:{overflowX:"auto"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:12},children:[e.jsx("thead",{children:e.jsx("tr",{style:{background:"#f9fafb"},children:["Name","Leads","Connected","Qualified","Cases"].map(b=>e.jsx("th",{style:{padding:"6px 8px",textAlign:"left",color:"#6b7280",fontWeight:600},children:b},b))})}),e.jsxs("tbody",{children:[(v||[]).map((b,y)=>e.jsxs("tr",{style:{borderBottom:"1px solid #f3f4f6"},children:[e.jsx("td",{style:{padding:"8px",fontWeight:600,color:"#1a1d4d"},children:b.name}),e.jsx("td",{style:{padding:"8px"},children:b.leads_assigned}),e.jsx("td",{style:{padding:"8px",color:"#1e88e5"},children:b.connected}),e.jsx("td",{style:{padding:"8px",color:"#7b1fa2"},children:b.qualified}),e.jsx("td",{style:{padding:"8px",fontWeight:600,color:"#00897b"},children:b.cases})]},y)),(!v||v.length===0)&&e.jsx("tr",{children:e.jsx("td",{colSpan:5,style:{padding:20,textAlign:"center",color:"#9ca3af"},children:"No data"})})]})]})})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(280px, 1fr))",gap:20},children:[e.jsxs("div",{style:{background:"#fff",borderRadius:10,padding:20,boxShadow:"0 1px 6px rgba(0,0,0,0.08)"},children:[e.jsx("div",{style:{fontSize:13,fontWeight:700,color:"#1a1d4d",marginBottom:14},children:"Lead Source Mix"}),((g==null?void 0:g.source_mix)||[]).map((b,y)=>{const j=((g==null?void 0:g.source_mix)||[]).reduce((C,L)=>C+L.leads,0),k=j>0?Math.round(b.leads*100/j):0,_=["#1e88e5","#43a047","#e53935","#fb8c00","#7b1fa2","#00897b","#795548","#546e7a"];return e.jsxs("div",{style:{marginBottom:10},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:12,marginBottom:4},children:[e.jsx("span",{style:{color:"#374151",fontWeight:500},children:b.source||"UNKNOWN"}),e.jsxs("span",{style:{color:"#6b7280"},children:[b.leads," (",k,"%)"]})]}),e.jsx("div",{style:{height:6,background:"#f3f4f6",borderRadius:3},children:e.jsx("div",{style:{height:6,background:_[y%_.length],borderRadius:3,width:`${k}%`}})})]},y)}),(!(g!=null&&g.source_mix)||g.source_mix.length===0)&&e.jsx("div",{style:{textAlign:"center",padding:20,color:"#9ca3af",fontSize:12},children:"No lead data"})]}),e.jsxs("div",{style:{background:"#fff",borderRadius:10,padding:20,boxShadow:"0 1px 6px rgba(0,0,0,0.08)",minWidth:0},children:[e.jsx("div",{style:{fontSize:13,fontWeight:700,color:"#1a1d4d",marginBottom:14},children:"Top Campaigns"}),e.jsx("div",{style:{overflowX:"auto"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:12},children:[e.jsx("thead",{children:e.jsx("tr",{style:{background:"#f9fafb"},children:["Campaign","Leads","Cases","Conv%"].map(b=>e.jsx("th",{style:{padding:"6px 8px",textAlign:"left",color:"#6b7280",fontWeight:600},children:b},b))})}),e.jsxs("tbody",{children:[((g==null?void 0:g.top_campaigns)||[]).map((b,y)=>e.jsxs("tr",{style:{borderBottom:"1px solid #f3f4f6"},children:[e.jsx("td",{style:{padding:"8px",color:"#1a1d4d",fontWeight:500},children:b.campaign_name||b.campaign_id||"N/A"}),e.jsx("td",{style:{padding:"8px"},children:b.leads}),e.jsx("td",{style:{padding:"8px",color:"#00897b"},children:b.cases}),e.jsxs("td",{style:{padding:"8px",fontWeight:600,color:"#7b1fa2"},children:[b.leads>0?Math.round(b.cases*100/b.leads):0,"%"]})]},y)),(!(g!=null&&g.top_campaigns)||g.top_campaigns.length===0)&&e.jsx("tr",{children:e.jsx("td",{colSpan:4,style:{padding:20,textAlign:"center",color:"#9ca3af"},children:"No campaign data"})})]})]})})]})]})]})}const n1=["LEAD","CASE","BANK_APP","EVENT"],s1=["ON_CREATE","ON_STAGE_CHANGE","TIME_BASED","SLA_BREACH"],uf={LEAD:"#1e88e5",CASE:"#7b1fa2",BANK_APP:"#00897b",EVENT:"#e53935"},ff={ON_CREATE:"#43a047",ON_STAGE_CHANGE:"#fb8c00",TIME_BASED:"#0288d1",SLA_BREACH:"#e53935"},hf={name:"",scope:"LEAD",trigger_type:"ON_CREATE",priority:0,conditions:"{}",actions:"[]"};function a1(){const[s,i]=u.useState([]),[r,o]=u.useState(!0),[d,f]=u.useState(!1),[p,x]=u.useState(null),[m,v]=u.useState(hf),[g,b]=u.useState(!1),y=()=>{o(!0),we.getAutomationRules().then(i).catch(()=>{}).finally(()=>o(!1))};u.useEffect(y,[]);const j=()=>{x(null),v(hf),f(!0)},k=D=>{x(D),v({name:D.name,scope:D.scope,trigger_type:D.trigger_type,priority:D.priority,conditions:JSON.stringify(D.conditions,null,2),actions:JSON.stringify(D.actions,null,2)}),f(!0)},_=async()=>{try{b(!0);const D={...m,conditions:JSON.parse(m.conditions||"{}"),actions:JSON.parse(m.actions||"[]"),priority:Number(m.priority)};p?(await we.updateAutomationRule(p.id,D),T.success("Rule updated")):(await we.createAutomationRule(D),T.success("Rule created")),f(!1),y()}catch(D){T.error(D.message||"Save failed")}finally{b(!1)}},C=async D=>{await we.updateAutomationRule(D.id,{is_active:!D.is_active}),y()},L=async D=>{confirm(`Delete rule "${D.name}"?`)&&(await we.deleteAutomationRule(D.id),T.success("Deleted"),y())};return e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:20},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:18,fontWeight:700,color:"#1a1d4d"},children:"Automation Rules"}),e.jsx("div",{style:{fontSize:12,color:"#6b7280",marginTop:2},children:"Configure trigger-based automation for leads, cases, and bank apps"})]}),e.jsxs("button",{onClick:j,style:{background:"#1a1d4d",color:"#fff",border:"none",borderRadius:8,padding:"9px 18px",fontSize:13,fontWeight:600,cursor:"pointer",display:"flex",alignItems:"center",gap:8},children:[e.jsx("i",{className:"fas fa-plus"})," New Rule"]})]}),r?e.jsx("div",{style:{textAlign:"center",padding:60},children:e.jsx("i",{className:"fas fa-spinner fa-spin"})}):e.jsx("div",{style:{background:"#fff",borderRadius:10,boxShadow:"0 1px 6px rgba(0,0,0,0.08)",overflow:"hidden",minWidth:0},children:e.jsx("div",{style:{overflowX:"auto"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:13},children:[e.jsx("thead",{children:e.jsx("tr",{style:{background:"#f9fafb",borderBottom:"1px solid #e5e7eb"},children:["ID","Name","Scope","Trigger","Priority","Status","Actions"].map(D=>e.jsx("th",{style:{padding:"10px 14px",textAlign:"left",fontWeight:600,color:"#374151",fontSize:12},children:D},D))})}),e.jsxs("tbody",{children:[s.map(D=>e.jsxs("tr",{style:{borderBottom:"1px solid #f3f4f6"},children:[e.jsx("td",{style:{padding:"10px 14px",color:"#6b7280",fontSize:11,fontFamily:"monospace"},children:D.id}),e.jsx("td",{style:{padding:"10px 14px",fontWeight:600,color:"#1a1d4d"},children:D.name}),e.jsx("td",{style:{padding:"10px 14px"},children:e.jsx("span",{style:{background:(uf[D.scope]||"#6b7280")+"18",color:uf[D.scope]||"#6b7280",padding:"3px 8px",borderRadius:10,fontSize:11,fontWeight:600},children:D.scope})}),e.jsx("td",{style:{padding:"10px 14px"},children:e.jsx("span",{style:{background:(ff[D.trigger_type]||"#6b7280")+"18",color:ff[D.trigger_type]||"#6b7280",padding:"3px 8px",borderRadius:10,fontSize:11,fontWeight:600},children:D.trigger_type})}),e.jsx("td",{style:{padding:"10px 14px",color:"#374151"},children:D.priority}),e.jsx("td",{style:{padding:"10px 14px"},children:e.jsx("button",{onClick:()=>C(D),style:{background:D.is_active?"#dcfce7":"#fee2e2",color:D.is_active?"#16a34a":"#dc2626",border:"none",borderRadius:6,padding:"4px 10px",fontSize:11,fontWeight:600,cursor:"pointer"},children:D.is_active?"Active":"Inactive"})}),e.jsx("td",{style:{padding:"10px 14px"},children:e.jsxs("div",{style:{display:"flex",gap:8},children:[e.jsx("button",{onClick:()=>k(D),style:{background:"#eff6ff",color:"#1e88e5",border:"none",borderRadius:6,padding:"5px 10px",cursor:"pointer",fontSize:12},children:e.jsx("i",{className:"fas fa-edit"})}),e.jsx("button",{onClick:()=>L(D),style:{background:"#fef2f2",color:"#dc2626",border:"none",borderRadius:6,padding:"5px 10px",cursor:"pointer",fontSize:12},children:e.jsx("i",{className:"fas fa-trash"})})]})})]},D.id)),s.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:7,style:{padding:40,textAlign:"center",color:"#9ca3af"},children:"No automation rules yet"})})]})]})})}),d&&e.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",zIndex:1e3,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsxs("div",{style:{background:"#fff",borderRadius:12,width:580,maxHeight:"90vh",overflowY:"auto",padding:28},children:[e.jsx("div",{style:{fontSize:16,fontWeight:700,color:"#1a1d4d",marginBottom:20},children:p?"Edit Rule":"New Automation Rule"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:14},children:[e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,fontWeight:600,color:"#374151",display:"block",marginBottom:4},children:"Name *"}),e.jsx("input",{value:m.name,onChange:D=>v(I=>({...I,name:D.target.value})),placeholder:"e.g. Auto-assign on new lead",style:{width:"100%",padding:"8px 10px",border:"1px solid #d1d5db",borderRadius:6,fontSize:13,boxSizing:"border-box"}})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 80px",gap:12},children:[e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,fontWeight:600,color:"#374151",display:"block",marginBottom:4},children:"Scope *"}),e.jsx("select",{value:m.scope,onChange:D=>v(I=>({...I,scope:D.target.value})),style:{width:"100%",padding:"8px 10px",border:"1px solid #d1d5db",borderRadius:6,fontSize:13},children:n1.map(D=>e.jsx("option",{children:D},D))})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,fontWeight:600,color:"#374151",display:"block",marginBottom:4},children:"Trigger *"}),e.jsx("select",{value:m.trigger_type,onChange:D=>v(I=>({...I,trigger_type:D.target.value})),style:{width:"100%",padding:"8px 10px",border:"1px solid #d1d5db",borderRadius:6,fontSize:13},children:s1.map(D=>e.jsx("option",{children:D},D))})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,fontWeight:600,color:"#374151",display:"block",marginBottom:4},children:"Priority"}),e.jsx("input",{type:"number",value:m.priority,onChange:D=>v(I=>({...I,priority:D.target.value})),style:{width:"100%",padding:"8px 10px",border:"1px solid #d1d5db",borderRadius:6,fontSize:13}})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,fontWeight:600,color:"#374151",display:"block",marginBottom:4},children:"Conditions (JSON)"}),e.jsx("textarea",{value:m.conditions,onChange:D=>v(I=>({...I,conditions:D.target.value})),rows:3,style:{width:"100%",padding:"8px 10px",border:"1px solid #d1d5db",borderRadius:6,fontSize:12,fontFamily:"monospace",boxSizing:"border-box",resize:"vertical"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,fontWeight:600,color:"#374151",display:"block",marginBottom:4},children:"Actions (JSON Array)"}),e.jsx("textarea",{value:m.actions,onChange:D=>v(I=>({...I,actions:D.target.value})),rows:4,style:{width:"100%",padding:"8px 10px",border:"1px solid #d1d5db",borderRadius:6,fontSize:12,fontFamily:"monospace",boxSizing:"border-box",resize:"vertical"}})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:10,marginTop:22},children:[e.jsx("button",{onClick:()=>f(!1),style:{padding:"8px 18px",border:"1px solid #d1d5db",borderRadius:7,background:"#fff",cursor:"pointer",fontSize:13},children:"Cancel"}),e.jsx("button",{onClick:_,disabled:g||!m.name,style:{padding:"8px 22px",border:"none",borderRadius:7,background:"#1a1d4d",color:"#fff",cursor:"pointer",fontSize:13,fontWeight:600,opacity:g||!m.name?.6:1},children:g?"Saving":"Save Rule"})]})]})})]})}const pf=["WELCOME","REMINDER","STATUS_UPDATE","DOCS_REQUEST","ESCALATION","CAMPAIGN"],xf=["WHATSAPP","EMAIL","SMS"],Io={WHATSAPP:"#25d366",EMAIL:"#1e88e5",SMS:"#fb8c00"},gf={name:"",category:"REMINDER",channel:"WHATSAPP",language:"en",body:"",variables_json:"[]"};function i1(){const[s,i]=u.useState([]),[r,o]=u.useState(!0),[d,f]=u.useState(""),[p,x]=u.useState(""),[m,v]=u.useState(!1),[g,b]=u.useState(null),[y,j]=u.useState(gf),[k,_]=u.useState(!1),C=()=>{o(!0);const A={};d&&(A.category=d),p&&(A.channel=p),we.getTemplates(A).then(i).catch(()=>{}).finally(()=>o(!1))};u.useEffect(C,[d,p]);const L=()=>{b(null),j(gf),v(!0)},D=A=>{b(A),j({name:A.name,category:A.category,channel:A.channel,language:A.language,body:A.body,variables_json:JSON.stringify(A.variables_json||[],null,2)}),v(!0)},I=async()=>{try{_(!0);const A={...y,variables_json:JSON.parse(y.variables_json||"[]")};g?(await we.updateTemplate(g.id,A),T.success("Template updated")):(await we.createTemplate(A),T.success("Template created")),v(!1),C()}catch(A){T.error(A.message||"Save failed")}finally{_(!1)}},P=async A=>{await we.updateTemplate(A.id,{is_active:!A.is_active}),C()},w=async A=>{confirm(`Delete template "${A.name}"?`)&&(await we.deleteTemplate(A.id),T.success("Deleted"),C())};return e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:20},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:18,fontWeight:700,color:"#1a1d4d"},children:"Message Templates"}),e.jsx("div",{style:{fontSize:12,color:"#6b7280",marginTop:2},children:"WhatsApp, Email, and SMS templates for all communication triggers"})]}),e.jsxs("button",{onClick:L,style:{background:"#1a1d4d",color:"#fff",border:"none",borderRadius:8,padding:"9px 18px",fontSize:13,fontWeight:600,cursor:"pointer",display:"flex",alignItems:"center",gap:8},children:[e.jsx("i",{className:"fas fa-plus"})," New Template"]})]}),e.jsxs("div",{style:{display:"flex",gap:10,marginBottom:16},children:[e.jsxs("select",{value:d,onChange:A=>f(A.target.value),style:{padding:"7px 12px",border:"1px solid #d1d5db",borderRadius:7,fontSize:12,color:"#374151"},children:[e.jsx("option",{value:"",children:"All Categories"}),pf.map(A=>e.jsx("option",{children:A},A))]}),e.jsxs("select",{value:p,onChange:A=>x(A.target.value),style:{padding:"7px 12px",border:"1px solid #d1d5db",borderRadius:7,fontSize:12,color:"#374151"},children:[e.jsx("option",{value:"",children:"All Channels"}),xf.map(A=>e.jsx("option",{children:A},A))]})]}),r?e.jsx("div",{style:{textAlign:"center",padding:60},children:e.jsx("i",{className:"fas fa-spinner fa-spin"})}):e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(340px, 1fr))",gap:16},children:[s.map(A=>{var N;return e.jsxs("div",{style:{background:"#fff",borderRadius:10,padding:18,boxShadow:"0 1px 6px rgba(0,0,0,0.08)",borderTop:`3px solid ${Io[A.channel]||"#6b7280"}`},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:8},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:13,fontWeight:700,color:"#1a1d4d"},children:A.name}),e.jsxs("div",{style:{display:"flex",gap:6,marginTop:5},children:[e.jsx("span",{style:{background:(Io[A.channel]||"#6b7280")+"18",color:Io[A.channel]||"#6b7280",padding:"2px 7px",borderRadius:8,fontSize:10,fontWeight:700},children:A.channel}),e.jsx("span",{style:{background:"#f3f4f6",color:"#374151",padding:"2px 7px",borderRadius:8,fontSize:10,fontWeight:600},children:A.category}),e.jsx("span",{style:{background:"#f3f4f6",color:"#374151",padding:"2px 7px",borderRadius:8,fontSize:10},children:(N=A.language)==null?void 0:N.toUpperCase()})]})]}),e.jsxs("div",{style:{display:"flex",gap:6},children:[e.jsx("button",{onClick:()=>D(A),style:{background:"#eff6ff",color:"#1e88e5",border:"none",borderRadius:5,padding:"5px 8px",cursor:"pointer",fontSize:11},children:e.jsx("i",{className:"fas fa-edit"})}),e.jsx("button",{onClick:()=>w(A),style:{background:"#fef2f2",color:"#dc2626",border:"none",borderRadius:5,padding:"5px 8px",cursor:"pointer",fontSize:11},children:e.jsx("i",{className:"fas fa-trash"})})]})]}),e.jsx("div",{style:{fontSize:12,color:"#4b5563",background:"#f9fafb",borderRadius:6,padding:"8px 10px",maxHeight:72,overflow:"hidden",whiteSpace:"pre-wrap",lineHeight:1.5},children:A.body}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:10},children:[e.jsx("div",{style:{fontSize:11,color:"#9ca3af",fontFamily:"monospace"},children:A.id}),e.jsx("button",{onClick:()=>P(A),style:{background:A.is_active?"#dcfce7":"#fee2e2",color:A.is_active?"#16a34a":"#dc2626",border:"none",borderRadius:5,padding:"3px 8px",fontSize:10,fontWeight:600,cursor:"pointer"},children:A.is_active?"Active":"Inactive"})]})]},A.id)}),s.length===0&&e.jsx("div",{style:{gridColumn:"1/-1",textAlign:"center",padding:40,color:"#9ca3af"},children:"No templates found"})]}),m&&e.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",zIndex:1e3,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsxs("div",{style:{background:"#fff",borderRadius:12,width:560,maxHeight:"90vh",overflowY:"auto",padding:28},children:[e.jsx("div",{style:{fontSize:16,fontWeight:700,color:"#1a1d4d",marginBottom:20},children:g?"Edit Template":"New Message Template"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:14},children:[e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,fontWeight:600,color:"#374151",display:"block",marginBottom:4},children:"Name *"}),e.jsx("input",{value:y.name,onChange:A=>j(N=>({...N,name:A.target.value})),placeholder:"e.g. Docs Reminder - WhatsApp",style:{width:"100%",padding:"8px 10px",border:"1px solid #d1d5db",borderRadius:6,fontSize:13,boxSizing:"border-box"}})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 80px",gap:12},children:[e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,fontWeight:600,color:"#374151",display:"block",marginBottom:4},children:"Category"}),e.jsx("select",{value:y.category,onChange:A=>j(N=>({...N,category:A.target.value})),style:{width:"100%",padding:"8px 10px",border:"1px solid #d1d5db",borderRadius:6,fontSize:13},children:pf.map(A=>e.jsx("option",{children:A},A))})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,fontWeight:600,color:"#374151",display:"block",marginBottom:4},children:"Channel"}),e.jsx("select",{value:y.channel,onChange:A=>j(N=>({...N,channel:A.target.value})),style:{width:"100%",padding:"8px 10px",border:"1px solid #d1d5db",borderRadius:6,fontSize:13},children:xf.map(A=>e.jsx("option",{children:A},A))})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,fontWeight:600,color:"#374151",display:"block",marginBottom:4},children:"Language"}),e.jsx("input",{value:y.language,onChange:A=>j(N=>({...N,language:A.target.value})),style:{width:"100%",padding:"8px 10px",border:"1px solid #d1d5db",borderRadius:6,fontSize:13}})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,fontWeight:600,color:"#374151",display:"block",marginBottom:4},children:"Body *"}),e.jsx("textarea",{value:y.body,onChange:A=>j(N=>({...N,body:A.target.value})),rows:5,placeholder:"Hi {{student_name}}, your documents for {{university}} are required...",style:{width:"100%",padding:"8px 10px",border:"1px solid #d1d5db",borderRadius:6,fontSize:13,boxSizing:"border-box",resize:"vertical"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,fontWeight:600,color:"#374151",display:"block",marginBottom:4},children:"Variables (JSON Array)"}),e.jsx("textarea",{value:y.variables_json,onChange:A=>j(N=>({...N,variables_json:A.target.value})),rows:2,placeholder:'["student_name", "university"]',style:{width:"100%",padding:"8px 10px",border:"1px solid #d1d5db",borderRadius:6,fontSize:12,fontFamily:"monospace",boxSizing:"border-box"}})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:10,marginTop:22},children:[e.jsx("button",{onClick:()=>v(!1),style:{padding:"8px 18px",border:"1px solid #d1d5db",borderRadius:7,background:"#fff",cursor:"pointer",fontSize:13},children:"Cancel"}),e.jsx("button",{onClick:I,disabled:k||!y.name||!y.body,style:{padding:"8px 22px",border:"none",borderRadius:7,background:"#1a1d4d",color:"#fff",cursor:"pointer",fontSize:13,fontWeight:600,opacity:k||!y.name||!y.body?.6:1},children:k?"Saving":"Save Template"})]})]})})]})}const l1=[{key:"universities",label:"Universities",icon:"fa-university"},{key:"courses",label:"Courses",icon:"fa-book"},{key:"countries",label:"Countries",icon:"fa-globe"},{key:"documents",label:"Documents",icon:"fa-file-alt"},{key:"stages",label:"Stage Master",icon:"fa-stream"},{key:"loss-reasons",label:"Loss Reasons",icon:"fa-times-circle"}];function aa({columns:s,rows:i,onEdit:r,onDelete:o,idKey:d="id",nameKey:f="name"}){return e.jsx("div",{style:{background:"#fff",borderRadius:10,boxShadow:"0 1px 6px rgba(0,0,0,0.08)",overflow:"hidden",minWidth:0},children:e.jsx("div",{style:{overflowX:"auto"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:13},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{background:"#f9fafb"},children:[s.map(p=>e.jsx("th",{style:{padding:"9px 14px",textAlign:"left",fontWeight:600,color:"#374151",fontSize:12},children:p.label},p.key)),e.jsx("th",{style:{padding:"9px 14px",width:90}})]})}),e.jsxs("tbody",{children:[i.map((p,x)=>e.jsxs("tr",{style:{borderBottom:"1px solid #f3f4f6"},children:[s.map(m=>e.jsx("td",{style:{padding:"9px 14px",color:m.bold?"#1a1d4d":"#4b5563",fontWeight:m.bold?600:400},children:m.render?m.render(p[m.key],p):p[m.key]??""},m.key)),e.jsx("td",{style:{padding:"9px 14px"},children:e.jsxs("div",{style:{display:"flex",gap:6},children:[e.jsx("button",{onClick:()=>r(p),style:{background:"#eff6ff",color:"#1e88e5",border:"none",borderRadius:5,padding:"4px 8px",cursor:"pointer",fontSize:11},children:e.jsx("i",{className:"fas fa-edit"})}),e.jsx("button",{onClick:()=>o(p),style:{background:"#fef2f2",color:"#dc2626",border:"none",borderRadius:5,padding:"4px 8px",cursor:"pointer",fontSize:11},children:e.jsx("i",{className:"fas fa-trash"})})]})})]},p[d]||x)),i.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:s.length+1,style:{padding:32,textAlign:"center",color:"#9ca3af"},children:"No records"})})]})]})})})}function ia({v:s}){return e.jsx("span",{style:{background:s?"#dcfce7":"#fee2e2",color:s?"#16a34a":"#dc2626",padding:"2px 7px",borderRadius:8,fontSize:11,fontWeight:600},children:s?"Active":"Inactive"})}function r1(){const[s,i]=u.useState([]),[r,o]=u.useState({name:"",country:""}),[d,f]=u.useState(null),[p,x]=u.useState(!1),m=()=>we.getUniversities().then(i).catch(()=>{});u.useEffect(m,[]);const v=async()=>{try{d?(await we.updateUniversity(d.id,r),T.success("Updated")):(await we.createUniversity(r),T.success("Created")),x(!1),f(null),o({name:"",country:""}),m()}catch(y){T.error(y.message)}},g=async y=>{confirm(`Delete "${y.name}"?`)&&(await we.deleteUniversity(y.id),T.success("Deleted"),m())},b=y=>{f(y),o({name:y.name,country:y.country||""}),x(!0)};return e.jsxs("div",{children:[e.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:14},children:e.jsxs("button",{onClick:()=>{f(null),o({name:"",country:""}),x(!0)},style:{background:"#1a1d4d",color:"#fff",border:"none",borderRadius:7,padding:"7px 16px",fontSize:12,fontWeight:600,cursor:"pointer"},children:[e.jsx("i",{className:"fas fa-plus",style:{marginRight:6}}),"Add"]})}),p&&e.jsxs("div",{style:{background:"#f9fafb",borderRadius:8,padding:16,marginBottom:16,display:"flex",gap:12,alignItems:"flex-end"},children:[e.jsxs("div",{style:{flex:2},children:[e.jsx("label",{style:{fontSize:11,fontWeight:600,color:"#374151",display:"block",marginBottom:4},children:"University Name *"}),e.jsx("input",{value:r.name,onChange:y=>o(j=>({...j,name:y.target.value})),style:{width:"100%",padding:"7px 10px",border:"1px solid #d1d5db",borderRadius:6,fontSize:12,boxSizing:"border-box"}})]}),e.jsxs("div",{style:{flex:1},children:[e.jsx("label",{style:{fontSize:11,fontWeight:600,color:"#374151",display:"block",marginBottom:4},children:"Country"}),e.jsx("input",{value:r.country,onChange:y=>o(j=>({...j,country:y.target.value})),style:{width:"100%",padding:"7px 10px",border:"1px solid #d1d5db",borderRadius:6,fontSize:12,boxSizing:"border-box"}})]}),e.jsx("button",{onClick:v,disabled:!r.name,style:{padding:"7px 16px",border:"none",borderRadius:6,background:"#1a1d4d",color:"#fff",cursor:"pointer",fontSize:12,fontWeight:600},children:"Save"}),e.jsx("button",{onClick:()=>x(!1),style:{padding:"7px 12px",border:"1px solid #d1d5db",borderRadius:6,background:"#fff",cursor:"pointer",fontSize:12},children:"Cancel"})]}),e.jsx(aa,{columns:[{key:"name",label:"University",bold:!0},{key:"country",label:"Country"},{key:"is_active",label:"Status",render:y=>e.jsx(ia,{v:y})}],rows:s,onEdit:b,onDelete:g})]})}function o1(){const[s,i]=u.useState([]),[r,o]=u.useState({name:""}),[d,f]=u.useState(null),[p,x]=u.useState(!1),m=()=>we.getCourses().then(i).catch(()=>{});u.useEffect(m,[]);const v=async()=>{try{d?(await we.updateCourse(d.id,r),T.success("Updated")):(await we.createCourse(r),T.success("Created")),x(!1),f(null),o({name:""}),m()}catch(y){T.error(y.message)}},g=async y=>{confirm(`Delete "${y.name}"?`)&&(await we.deleteCourse(y.id),T.success("Deleted"),m())},b=y=>{f(y),o({name:y.name}),x(!0)};return e.jsxs("div",{children:[e.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:14},children:e.jsxs("button",{onClick:()=>{f(null),o({name:""}),x(!0)},style:{background:"#1a1d4d",color:"#fff",border:"none",borderRadius:7,padding:"7px 16px",fontSize:12,fontWeight:600,cursor:"pointer"},children:[e.jsx("i",{className:"fas fa-plus",style:{marginRight:6}}),"Add"]})}),p&&e.jsxs("div",{style:{background:"#f9fafb",borderRadius:8,padding:16,marginBottom:16,display:"flex",gap:12,alignItems:"flex-end"},children:[e.jsxs("div",{style:{flex:1},children:[e.jsx("label",{style:{fontSize:11,fontWeight:600,color:"#374151",display:"block",marginBottom:4},children:"Course Name *"}),e.jsx("input",{value:r.name,onChange:y=>o(j=>({...j,name:y.target.value})),style:{width:"100%",padding:"7px 10px",border:"1px solid #d1d5db",borderRadius:6,fontSize:12,boxSizing:"border-box"}})]}),e.jsx("button",{onClick:v,disabled:!r.name,style:{padding:"7px 16px",border:"none",borderRadius:6,background:"#1a1d4d",color:"#fff",cursor:"pointer",fontSize:12,fontWeight:600},children:"Save"}),e.jsx("button",{onClick:()=>x(!1),style:{padding:"7px 12px",border:"1px solid #d1d5db",borderRadius:6,background:"#fff",cursor:"pointer",fontSize:12},children:"Cancel"})]}),e.jsx(aa,{columns:[{key:"name",label:"Course Name",bold:!0},{key:"is_active",label:"Status",render:y=>e.jsx(ia,{v:y})}],rows:s,onEdit:b,onDelete:g})]})}function d1(){const[s,i]=u.useState([]),[r,o]=u.useState({name:"",code:""}),[d,f]=u.useState(null),[p,x]=u.useState(!1),m=()=>we.getCountries().then(i).catch(()=>{});u.useEffect(m,[]);const v=async()=>{try{d?(await we.updateCountry(d.id,r),T.success("Updated")):(await we.createCountry(r),T.success("Created")),x(!1),f(null),o({name:"",code:""}),m()}catch(y){T.error(y.message)}},g=async y=>{confirm(`Delete "${y.name}"?`)&&(await we.deleteCountry(y.id),T.success("Deleted"),m())},b=y=>{f(y),o({name:y.name,code:y.code||""}),x(!0)};return e.jsxs("div",{children:[e.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:14},children:e.jsxs("button",{onClick:()=>{f(null),o({name:"",code:""}),x(!0)},style:{background:"#1a1d4d",color:"#fff",border:"none",borderRadius:7,padding:"7px 16px",fontSize:12,fontWeight:600,cursor:"pointer"},children:[e.jsx("i",{className:"fas fa-plus",style:{marginRight:6}}),"Add"]})}),p&&e.jsxs("div",{style:{background:"#f9fafb",borderRadius:8,padding:16,marginBottom:16,display:"flex",gap:12,alignItems:"flex-end"},children:[e.jsxs("div",{style:{flex:2},children:[e.jsx("label",{style:{fontSize:11,fontWeight:600,color:"#374151",display:"block",marginBottom:4},children:"Country Name *"}),e.jsx("input",{value:r.name,onChange:y=>o(j=>({...j,name:y.target.value})),style:{width:"100%",padding:"7px 10px",border:"1px solid #d1d5db",borderRadius:6,fontSize:12,boxSizing:"border-box"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:11,fontWeight:600,color:"#374151",display:"block",marginBottom:4},children:"ISO Code"}),e.jsx("input",{value:r.code,onChange:y=>o(j=>({...j,code:y.target.value})),placeholder:"e.g. GB",style:{width:80,padding:"7px 10px",border:"1px solid #d1d5db",borderRadius:6,fontSize:12}})]}),e.jsx("button",{onClick:v,disabled:!r.name,style:{padding:"7px 16px",border:"none",borderRadius:6,background:"#1a1d4d",color:"#fff",cursor:"pointer",fontSize:12,fontWeight:600},children:"Save"}),e.jsx("button",{onClick:()=>x(!1),style:{padding:"7px 12px",border:"1px solid #d1d5db",borderRadius:6,background:"#fff",cursor:"pointer",fontSize:12},children:"Cancel"})]}),e.jsx(aa,{columns:[{key:"name",label:"Country",bold:!0},{key:"code",label:"ISO Code"},{key:"is_active",label:"Status",render:y=>e.jsx(ia,{v:y})}],rows:s,onEdit:b,onDelete:g})]})}function c1(){const[s,i]=u.useState([]),[r,o]=u.useState({document_name:"",doc_code:"",category:"STUDENT",mandatory:!0,sort_order:0}),[d,f]=u.useState(null),[p,x]=u.useState(!1),m=()=>we.getDocumentMaster().then(i).catch(()=>{});u.useEffect(m,[]);const v=async()=>{try{d?(await we.updateDocument(d.id,r),T.success("Updated")):(await we.createDocument(r),T.success("Created")),x(!1),f(null),m()}catch(y){T.error(y.message)}},g=async y=>{confirm(`Delete "${y.document_name}"?`)&&(await we.deleteDocument(y.id),T.success("Deleted"),m())},b=y=>{f(y),o({document_name:y.document_name,doc_code:y.doc_code,category:y.category,mandatory:!!y.mandatory,sort_order:y.sort_order}),x(!0)};return e.jsxs("div",{children:[e.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:14},children:e.jsxs("button",{onClick:()=>{f(null),o({document_name:"",doc_code:"",category:"STUDENT",mandatory:!0,sort_order:0}),x(!0)},style:{background:"#1a1d4d",color:"#fff",border:"none",borderRadius:7,padding:"7px 16px",fontSize:12,fontWeight:600,cursor:"pointer"},children:[e.jsx("i",{className:"fas fa-plus",style:{marginRight:6}}),"Add"]})}),p&&e.jsxs("div",{style:{background:"#f9fafb",borderRadius:8,padding:16,marginBottom:16,display:"flex",gap:10,alignItems:"flex-end",flexWrap:"wrap"},children:[e.jsxs("div",{style:{flex:2,minWidth:160},children:[e.jsx("label",{style:{fontSize:11,fontWeight:600,color:"#374151",display:"block",marginBottom:4},children:"Document Name *"}),e.jsx("input",{value:r.document_name,onChange:y=>o(j=>({...j,document_name:y.target.value})),style:{width:"100%",padding:"7px 10px",border:"1px solid #d1d5db",borderRadius:6,fontSize:12,boxSizing:"border-box"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:11,fontWeight:600,color:"#374151",display:"block",marginBottom:4},children:"Code *"}),e.jsx("input",{value:r.doc_code,onChange:y=>o(j=>({...j,doc_code:y.target.value})),style:{width:100,padding:"7px 10px",border:"1px solid #d1d5db",borderRadius:6,fontSize:12}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:11,fontWeight:600,color:"#374151",display:"block",marginBottom:4},children:"Category"}),e.jsx("select",{value:r.category,onChange:y=>o(j=>({...j,category:y.target.value})),style:{padding:"7px 10px",border:"1px solid #d1d5db",borderRadius:6,fontSize:12},children:["STUDENT","CO_APPLICANT","PROPERTY","BANK"].map(y=>e.jsx("option",{children:y},y))})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[e.jsx("input",{type:"checkbox",checked:r.mandatory,onChange:y=>o(j=>({...j,mandatory:y.target.checked})),id:"mandatory"}),e.jsx("label",{htmlFor:"mandatory",style:{fontSize:12,color:"#374151"},children:"Mandatory"})]}),e.jsx("button",{onClick:v,disabled:!r.document_name||!r.doc_code,style:{padding:"7px 16px",border:"none",borderRadius:6,background:"#1a1d4d",color:"#fff",cursor:"pointer",fontSize:12,fontWeight:600},children:"Save"}),e.jsx("button",{onClick:()=>x(!1),style:{padding:"7px 12px",border:"1px solid #d1d5db",borderRadius:6,background:"#fff",cursor:"pointer",fontSize:12},children:"Cancel"})]}),e.jsx(aa,{columns:[{key:"document_name",label:"Document Name",bold:!0},{key:"doc_code",label:"Code"},{key:"category",label:"Category"},{key:"mandatory",label:"Mandatory",render:y=>e.jsx(ia,{v:y})},{key:"sort_order",label:"Order"}],rows:s,onEdit:b,onDelete:g})]})}function u1(){const[s,i]=u.useState([]),[r,o]=u.useState(""),d=()=>we.getStageMaster(r?{scope:r}:{}).then(i).catch(()=>{});u.useEffect(d,[r]);const f=async p=>{confirm(`Delete stage "${p.stage_key}"?`)&&(await we.deleteStage(p.id),T.success("Deleted"),d())};return e.jsxs("div",{children:[e.jsx("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:14},children:e.jsxs("select",{value:r,onChange:p=>o(p.target.value),style:{padding:"6px 10px",border:"1px solid #d1d5db",borderRadius:6,fontSize:12},children:[e.jsx("option",{value:"",children:"All Scopes"}),["LEAD","CASE","BANK_APP"].map(p=>e.jsx("option",{children:p},p))]})}),e.jsx(aa,{columns:[{key:"scope",label:"Scope"},{key:"stage_key",label:"Stage Key",bold:!0},{key:"label",label:"Label"},{key:"sort_order",label:"Order"},{key:"is_active",label:"Status",render:p=>e.jsx(ia,{v:p})}],rows:s,onEdit:()=>{},onDelete:f})]})}function f1(){const[s,i]=u.useState([]),[r,o]=u.useState({scope:"LEAD",reason_code:"",label:""}),[d,f]=u.useState(null),[p,x]=u.useState(!1),m=()=>we.getLossReasons().then(i).catch(()=>{});u.useEffect(m,[]);const v=async()=>{try{d?(await we.updateLossReason(d.id,{label:r.label}),T.success("Updated")):(await we.createLossReason(r),T.success("Created")),x(!1),f(null),o({scope:"LEAD",reason_code:"",label:""}),m()}catch(y){T.error(y.message)}},g=async y=>{confirm(`Delete "${y.label}"?`)&&(await we.deleteLossReason(y.id),T.success("Deleted"),m())},b=y=>{f(y),o({scope:y.scope,reason_code:y.reason_code,label:y.label}),x(!0)};return e.jsxs("div",{children:[e.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:14},children:e.jsxs("button",{onClick:()=>{f(null),o({scope:"LEAD",reason_code:"",label:""}),x(!0)},style:{background:"#1a1d4d",color:"#fff",border:"none",borderRadius:7,padding:"7px 16px",fontSize:12,fontWeight:600,cursor:"pointer"},children:[e.jsx("i",{className:"fas fa-plus",style:{marginRight:6}}),"Add"]})}),p&&e.jsxs("div",{style:{background:"#f9fafb",borderRadius:8,padding:16,marginBottom:16,display:"flex",gap:12,alignItems:"flex-end"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:11,fontWeight:600,color:"#374151",display:"block",marginBottom:4},children:"Scope"}),e.jsx("select",{value:r.scope,onChange:y=>o(j=>({...j,scope:y.target.value})),disabled:!!d,style:{padding:"7px 10px",border:"1px solid #d1d5db",borderRadius:6,fontSize:12},children:["LEAD","CASE","BANK_APP"].map(y=>e.jsx("option",{children:y},y))})]}),e.jsxs("div",{style:{flex:1},children:[e.jsx("label",{style:{fontSize:11,fontWeight:600,color:"#374151",display:"block",marginBottom:4},children:"Reason Code *"}),e.jsx("input",{value:r.reason_code,onChange:y=>o(j=>({...j,reason_code:y.target.value})),disabled:!!d,style:{width:"100%",padding:"7px 10px",border:"1px solid #d1d5db",borderRadius:6,fontSize:12,boxSizing:"border-box"}})]}),e.jsxs("div",{style:{flex:2},children:[e.jsx("label",{style:{fontSize:11,fontWeight:600,color:"#374151",display:"block",marginBottom:4},children:"Label *"}),e.jsx("input",{value:r.label,onChange:y=>o(j=>({...j,label:y.target.value})),style:{width:"100%",padding:"7px 10px",border:"1px solid #d1d5db",borderRadius:6,fontSize:12,boxSizing:"border-box"}})]}),e.jsx("button",{onClick:v,disabled:!r.reason_code||!r.label,style:{padding:"7px 16px",border:"none",borderRadius:6,background:"#1a1d4d",color:"#fff",cursor:"pointer",fontSize:12,fontWeight:600},children:"Save"}),e.jsx("button",{onClick:()=>x(!1),style:{padding:"7px 12px",border:"1px solid #d1d5db",borderRadius:6,background:"#fff",cursor:"pointer",fontSize:12},children:"Cancel"})]}),e.jsx(aa,{columns:[{key:"scope",label:"Scope"},{key:"reason_code",label:"Code",bold:!0},{key:"label",label:"Label"},{key:"is_active",label:"Status",render:y=>e.jsx(ia,{v:y})}],rows:s,onEdit:b,onDelete:g})]})}const h1={universities:r1,courses:o1,countries:d1,documents:c1,stages:u1,"loss-reasons":f1};function p1(){const[s,i]=u.useState("universities"),r=h1[s];return e.jsxs("div",{children:[e.jsxs("div",{style:{marginBottom:20},children:[e.jsx("div",{style:{fontSize:18,fontWeight:700,color:"#1a1d4d"},children:"Master Data"}),e.jsx("div",{style:{fontSize:12,color:"#6b7280",marginTop:2},children:"Manage universities, courses, countries, documents, stages, and loss reasons"})]}),e.jsx("div",{style:{display:"flex",gap:4,borderBottom:"2px solid #e5e7eb",marginBottom:20},children:l1.map(o=>e.jsxs("button",{onClick:()=>i(o.key),style:{padding:"9px 16px",border:"none",background:"none",cursor:"pointer",fontSize:12,fontWeight:600,color:s===o.key?"#1a1d4d":"#6b7280",borderBottom:`2px solid ${s===o.key?"#1a1d4d":"transparent"}`,marginBottom:-2,display:"flex",alignItems:"center",gap:6},children:[e.jsx("i",{className:`fas ${o.icon}`})," ",o.label]},o.key))}),e.jsx(r,{})]})}const x1=[{key:"leads",label:"Leads",icon:"fa-funnel-dollar"},{key:"cases",label:"Cases",icon:"fa-briefcase"},{key:"banks",label:"Banks",icon:"fa-university"},{key:"staff",label:"Staff",icon:"fa-users"},{key:"campaigns",label:"Campaigns",icon:"fa-bullhorn"}];function Yn({label:s,value:i,color:r="#1a1d4d",suffix:o=""}){return e.jsxs("div",{style:{background:"#fff",borderRadius:10,padding:"16px 20px",boxShadow:"0 1px 6px rgba(0,0,0,0.08)"},children:[e.jsxs("div",{style:{fontSize:22,fontWeight:700,color:r},children:[i??"",o]}),e.jsx("div",{style:{fontSize:12,color:"#6b7280",marginTop:3},children:s})]})}function Zn({columns:s,rows:i,emptyMsg:r="No data"}){return e.jsx("div",{style:{background:"#fff",borderRadius:10,boxShadow:"0 1px 6px rgba(0,0,0,0.08)",overflow:"hidden",minWidth:0},children:e.jsx("div",{style:{overflowX:"auto"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:12,minWidth:"max-content"},children:[e.jsx("thead",{children:e.jsx("tr",{style:{background:"#f9fafb"},children:s.map(o=>e.jsx("th",{style:{padding:"9px 12px",textAlign:"left",fontWeight:600,color:"#374151"},children:o.label},o.key))})}),e.jsxs("tbody",{children:[(i||[]).map((o,d)=>e.jsx("tr",{style:{borderBottom:"1px solid #f3f4f6"},children:s.map(f=>e.jsx("td",{style:{padding:"8px 12px",color:f.bold?"#1a1d4d":"#4b5563",fontWeight:f.bold?600:400},children:f.render?f.render(o[f.key],o):o[f.key]??""},f.key))},d)),(!i||i.length===0)&&e.jsx("tr",{children:e.jsx("td",{colSpan:s.length,style:{padding:28,textAlign:"center",color:"#9ca3af"},children:r})})]})]})})})}function g1({days:s}){var d;const[i,r]=u.useState(null);if(u.useEffect(()=>{we.getLeadReport(s).then(r).catch(()=>{})},[s]),!i)return e.jsx("div",{style:{textAlign:"center",padding:40},children:e.jsx("i",{className:"fas fa-spinner fa-spin"})});const o=(i.funnel||[]).reduce((f,p)=>f+p.count,0);return e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:20},children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(140px, 1fr))",gap:14},children:[e.jsx(Yn,{label:"Total Leads",value:o,color:"#1e88e5"}),e.jsx(Yn,{label:"Converted to Case",value:((d=(i.funnel||[]).find(f=>f.stage==="CASE_CREATED"))==null?void 0:d.count)||0,color:"#00897b"}),e.jsx(Yn,{label:"Dropped / Lost",value:(i.funnel||[]).filter(f=>["DROPPED","LOST","DUPLICATE"].includes(f.stage)).reduce((f,p)=>f+p.count,0),color:"#e53935"}),e.jsx(Yn,{label:"Campaigns",value:(i.top_campaigns||[]).length,color:"#7b1fa2"})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:20},children:[e.jsx(Zn,{columns:[{key:"source",label:"Source",bold:!0},{key:"total",label:"Leads"},{key:"converted",label:"Converted",render:f=>e.jsx("span",{style:{color:"#16a34a",fontWeight:600},children:f})},{key:"total",label:"Conv%",render:(f,p)=>e.jsxs("span",{style:{color:"#7b1fa2",fontWeight:600},children:[f>0?Math.round(p.converted*100/f):0,"%"]})}],rows:i.by_source}),e.jsx(Zn,{columns:[{key:"stage",label:"Stage",bold:!0},{key:"count",label:"Count",render:f=>e.jsx("span",{style:{fontWeight:700,color:"#1a1d4d"},children:f})}],rows:i.funnel})]}),e.jsx(Zn,{columns:[{key:"campaign_name",label:"Campaign",bold:!0,render:(f,p)=>f||p.meta_campaign_id||"N/A"},{key:"leads",label:"Leads"},{key:"cases",label:"Cases",render:f=>e.jsx("span",{style:{color:"#00897b",fontWeight:600},children:f})},{key:"leads",label:"Conv%",render:(f,p)=>f>0?Math.round(p.cases*100/f)+"%":"0%"}],rows:i.top_campaigns})]})}function m1({days:s}){const[i,r]=u.useState(null);if(u.useEffect(()=>{we.getCaseReport(s).then(r).catch(()=>{})},[s]),!i)return e.jsx("div",{style:{textAlign:"center",padding:40},children:e.jsx("i",{className:"fas fa-spinner fa-spin"})});const{summary:o={}}=i;return e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:20},children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(140px, 1fr))",gap:14},children:[e.jsx(Yn,{label:"Total Cases",value:o.total,color:"#1e88e5"}),e.jsx(Yn,{label:"Sanctioned",value:o.sanctioned,color:"#00897b"}),e.jsx(Yn,{label:"Disbursed",value:o.disbursed,color:"#43a047"}),e.jsx(Yn,{label:"Rejected",value:o.rejected,color:"#e53935"})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:20},children:[e.jsx(Zn,{columns:[{key:"bank",label:"Bank",bold:!0},{key:"apps",label:"Applications"},{key:"sanctioned",label:"Sanctioned",render:d=>e.jsx("span",{style:{color:"#16a34a",fontWeight:600},children:d})},{key:"apps",label:"Rate",render:(d,f)=>d>0?Math.round(f.sanctioned*100/d)+"%":"0%"}],rows:i.by_bank}),e.jsx(Zn,{columns:[{key:"status",label:"Status",bold:!0},{key:"count",label:"Count",render:d=>e.jsx("span",{style:{fontWeight:700,color:"#1a1d4d"},children:d})}],rows:i.by_status})]})]})}function y1(){const[s,i]=u.useState(null);return u.useEffect(()=>{we.getBankReport().then(i).catch(()=>{})},[]),s?e.jsx(Zn,{columns:[{key:"name",label:"Bank",bold:!0},{key:"total_apps",label:"Total Apps"},{key:"sanctioned",label:"Sanctioned",render:r=>e.jsx("span",{style:{color:"#16a34a",fontWeight:600},children:r})},{key:"rejected",label:"Rejected",render:r=>e.jsx("span",{style:{color:"#dc2626",fontWeight:600},children:r})},{key:"disbursed",label:"Disbursed",render:r=>e.jsx("span",{style:{color:"#43a047",fontWeight:600},children:r})},{key:"sla_breaches",label:"SLA Breaches",render:r=>e.jsx("span",{style:{color:r>0?"#ef4444":"#6b7280",fontWeight:r>0?700:400},children:r})},{key:"avg_days_to_sanction",label:"Avg Days",render:r=>r?`${r}d`:""}],rows:s.banks}):e.jsx("div",{style:{textAlign:"center",padding:40},children:e.jsx("i",{className:"fas fa-spinner fa-spin"})})}function v1({days:s}){const[i,r]=u.useState(null);return u.useEffect(()=>{we.getStaffReport(s).then(r).catch(()=>{})},[s]),i?e.jsx(Zn,{columns:[{key:"name",label:"Staff",bold:!0},{key:"role",label:"Role"},{key:"leads_assigned",label:"Leads Assigned"},{key:"connected",label:"Connected",render:o=>e.jsx("span",{style:{color:"#1e88e5",fontWeight:600},children:o})},{key:"qualified",label:"Qualified",render:o=>e.jsx("span",{style:{color:"#7b1fa2",fontWeight:600},children:o})},{key:"cases_created",label:"Cases",render:o=>e.jsx("span",{style:{color:"#00897b",fontWeight:700},children:o})},{key:"leads_assigned",label:"Conv%",render:(o,d)=>o>0?Math.round(d.cases_created*100/o)+"%":"0%"}],rows:i.staff}):e.jsx("div",{style:{textAlign:"center",padding:40},children:e.jsx("i",{className:"fas fa-spinner fa-spin"})})}function b1({days:s}){const[i,r]=u.useState(null);return u.useEffect(()=>{we.getCampaignReport(s).then(r).catch(()=>{})},[s]),i?e.jsx(Zn,{columns:[{key:"campaign_name",label:"Campaign",bold:!0,render:(o,d)=>o||d.meta_campaign_id||"N/A"},{key:"source",label:"Source"},{key:"leads",label:"Leads"},{key:"cases",label:"Cases",render:o=>e.jsx("span",{style:{color:"#00897b",fontWeight:600},children:o})},{key:"lost",label:"Lost",render:o=>e.jsx("span",{style:{color:"#dc2626"},children:o})},{key:"avg_intent",label:"Avg Intent",render:o=>o?`${o}`:""},{key:"leads",label:"Conv%",render:(o,d)=>o>0?Math.round(d.cases*100/o)+"%":"0%"}],rows:i.campaigns}):e.jsx("div",{style:{textAlign:"center",padding:40},children:e.jsx("i",{className:"fas fa-spinner fa-spin"})})}const j1={leads:g1,cases:m1,banks:y1,staff:v1,campaigns:b1};function S1(){const[s,i]=u.useState("leads"),[r,o]=u.useState(30),d=j1[s];return e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:20},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:18,fontWeight:700,color:"#1a1d4d"},children:"Reports & Analytics"}),e.jsx("div",{style:{fontSize:12,color:"#6b7280",marginTop:2},children:"Comprehensive reporting across all modules"})]}),s!=="banks"&&e.jsx("div",{style:{display:"flex",gap:8},children:[7,30,90].map(f=>e.jsxs("button",{onClick:()=>o(f),style:{padding:"6px 14px",borderRadius:6,border:"1px solid",fontSize:12,cursor:"pointer",fontWeight:r===f?700:400,background:r===f?"#1a1d4d":"#fff",color:r===f?"#fff":"#374151",borderColor:r===f?"#1a1d4d":"#d1d5db"},children:[f,"d"]},f))})]}),e.jsx("div",{style:{display:"flex",gap:4,borderBottom:"2px solid #e5e7eb",marginBottom:20},children:x1.map(f=>e.jsxs("button",{onClick:()=>i(f.key),style:{padding:"9px 16px",border:"none",background:"none",cursor:"pointer",fontSize:12,fontWeight:600,color:s===f.key?"#1a1d4d":"#6b7280",borderBottom:`2px solid ${s===f.key?"#1a1d4d":"transparent"}`,marginBottom:-2,display:"flex",alignItems:"center",gap:6},children:[e.jsx("i",{className:`fas ${f.icon}`})," ",f.label]},f.key))}),e.jsx(d,{days:r})]})}const mf={WHATSAPP:"#25d366",EMAIL:"#1e88e5",SMS:"#fb8c00"};function k1(){var m,v;const[s,i]=u.useState(null),[r,o]=u.useState(!0);if(u.useEffect(()=>{we.getComms().then(i).catch(()=>{}).finally(()=>o(!1))},[]),r)return e.jsx("div",{style:{textAlign:"center",padding:60},children:e.jsx("i",{className:"fas fa-spinner fa-spin",style:{fontSize:24}})});if(!s)return e.jsx("div",{style:{textAlign:"center",padding:60,color:"#ef4444"},children:"Failed to load comms data."});const d=(s.summary||[]).reduce((g,b)=>g+b.count,0),f=((m=(s.summary||[]).find(g=>g.status==="DELIVERED"))==null?void 0:m.count)||0,p=((v=(s.summary||[]).find(g=>g.status==="FAILED"))==null?void 0:v.count)||0,x=d>0?Math.round(f*100/d):0;return e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:24},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:18,fontWeight:700,color:"#1a1d4d"},children:"Communications Dashboard"}),e.jsx("div",{style:{fontSize:12,color:"#6b7280",marginTop:2},children:"Message delivery rates, failures, and template performance"})]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(140px, 1fr))",gap:14},children:[{label:"Total Messages",value:d,color:"#1e88e5"},{label:"Delivered",value:f,color:"#16a34a"},{label:"Failed",value:p,color:"#dc2626"},{label:"Delivery Rate",value:`${x}%`,color:"#7b1fa2"}].map(g=>e.jsxs("div",{style:{background:"#fff",borderRadius:10,padding:"16px 20px",boxShadow:"0 1px 6px rgba(0,0,0,0.08)"},children:[e.jsx("div",{style:{fontSize:24,fontWeight:700,color:g.color},children:g.value}),e.jsx("div",{style:{fontSize:12,color:"#6b7280",marginTop:3},children:g.label})]},g.label))}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))",gap:20},children:[e.jsxs("div",{style:{background:"#fff",borderRadius:10,padding:20,boxShadow:"0 1px 6px rgba(0,0,0,0.08)",minWidth:0},children:[e.jsx("div",{style:{fontSize:13,fontWeight:700,color:"#1a1d4d",marginBottom:16},children:"By Channel"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[(s.by_channel||[]).map(g=>{const b=g.total>0?Math.round(g.delivered*100/g.total):0,y=mf[g.channel]||"#6b7280";return e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:12,marginBottom:5},children:[e.jsx("span",{style:{fontWeight:700,color:y},children:g.channel}),e.jsxs("span",{style:{color:"#6b7280"},children:[g.delivered,"/",g.total," (",b,"%)  ",e.jsxs("span",{style:{color:"#dc2626"},children:[g.failed," failed"]})]})]}),e.jsx("div",{style:{height:8,background:"#f3f4f6",borderRadius:4},children:e.jsx("div",{style:{height:8,background:y,borderRadius:4,width:`${b}%`,transition:"width 0.6s"}})})]},g.channel)}),(!s.by_channel||s.by_channel.length===0)&&e.jsx("div",{style:{textAlign:"center",padding:20,color:"#9ca3af",fontSize:12},children:"No channel data"})]})]}),e.jsxs("div",{style:{background:"#fff",borderRadius:10,padding:20,boxShadow:"0 1px 6px rgba(0,0,0,0.08)",minWidth:0},children:[e.jsx("div",{style:{fontSize:13,fontWeight:700,color:"#1a1d4d",marginBottom:14},children:"Template Performance"}),e.jsx("div",{style:{overflowX:"auto"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:12},children:[e.jsx("thead",{children:e.jsx("tr",{style:{background:"#f9fafb"},children:["Template","Sent","Delivered","Rate"].map(g=>e.jsx("th",{style:{padding:"6px 8px",textAlign:"left",color:"#6b7280",fontWeight:600},children:g},g))})}),e.jsxs("tbody",{children:[(s.template_stats||[]).map((g,b)=>e.jsxs("tr",{style:{borderBottom:"1px solid #f3f4f6"},children:[e.jsx("td",{style:{padding:"7px 8px",fontWeight:600,color:"#1a1d4d"},children:g.template_name}),e.jsx("td",{style:{padding:"7px 8px"},children:g.sent}),e.jsx("td",{style:{padding:"7px 8px",color:"#16a34a"},children:g.delivered}),e.jsxs("td",{style:{padding:"7px 8px",fontWeight:700,color:"#7b1fa2"},children:[g.sent>0?Math.round(g.delivered*100/g.sent):0,"%"]})]},b)),(!s.template_stats||s.template_stats.length===0)&&e.jsx("tr",{children:e.jsx("td",{colSpan:4,style:{padding:20,textAlign:"center",color:"#9ca3af"},children:"No template data"})})]})]})})]})]}),e.jsxs("div",{style:{background:"#fff",borderRadius:10,padding:20,boxShadow:"0 1px 6px rgba(0,0,0,0.08)",minWidth:0},children:[e.jsxs("div",{style:{fontSize:13,fontWeight:700,color:"#1a1d4d",marginBottom:14,display:"flex",alignItems:"center",gap:8},children:[e.jsx("i",{className:"fas fa-times-circle",style:{color:"#dc2626"}})," Recent Failures",e.jsx("span",{style:{background:"#fee2e2",color:"#dc2626",fontSize:11,fontWeight:600,padding:"2px 8px",borderRadius:10},children:(s.recent_failed||[]).length})]}),e.jsx("div",{style:{overflowX:"auto"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:12},children:[e.jsx("thead",{children:e.jsx("tr",{style:{background:"#f9fafb"},children:["Recipient","Entity Type","Template","Channel","Time"].map(g=>e.jsx("th",{style:{padding:"6px 10px",textAlign:"left",color:"#6b7280",fontWeight:600},children:g},g))})}),e.jsxs("tbody",{children:[(s.recent_failed||[]).map((g,b)=>e.jsxs("tr",{style:{borderBottom:"1px solid #f3f4f6"},children:[e.jsx("td",{style:{padding:"7px 10px",fontWeight:600,color:"#1a1d4d"},children:g.recipient}),e.jsx("td",{style:{padding:"7px 10px",color:"#374151"},children:g.entity_type}),e.jsx("td",{style:{padding:"7px 10px",color:"#374151"},children:g.template_name||""}),e.jsx("td",{style:{padding:"7px 10px"},children:e.jsx("span",{style:{color:mf[g.channel]||"#6b7280",fontWeight:600,fontSize:11},children:g.channel||""})}),e.jsx("td",{style:{padding:"7px 10px",color:"#6b7280"},children:g.created_at?new Date(g.created_at).toLocaleString():""})]},b)),(!s.recent_failed||s.recent_failed.length===0)&&e.jsx("tr",{children:e.jsx("td",{colSpan:5,style:{padding:28,textAlign:"center",color:"#9ca3af"},children:"No recent failures"})})]})]})})]})]})}const yf={ACTIVE:"#16a34a",INACTIVE:"#6b7280",SUSPENDED:"#dc2626",TRIAL:"#d97706"};function N1(){var b;const[s,i]=u.useState(null),[r,o]=u.useState(!0),[d,f]=u.useState("");u.useEffect(()=>{we.getOrgs().then(i).catch(()=>{}).finally(()=>o(!1))},[]);const p=((s==null?void 0:s.orgs)||[]).filter(y=>{var j;return!d||((j=y.name)==null?void 0:j.toLowerCase().includes(d.toLowerCase()))}),x=((b=s==null?void 0:s.orgs)==null?void 0:b.length)||0,m=((s==null?void 0:s.orgs)||[]).filter(y=>y.status==="ACTIVE").length,v=((s==null?void 0:s.orgs)||[]).reduce((y,j)=>y+(j.user_count||0),0),g=((s==null?void 0:s.orgs)||[]).reduce((y,j)=>y+(j.lead_count||0),0);return e.jsxs("div",{children:[e.jsxs("div",{style:{marginBottom:20},children:[e.jsx("div",{style:{fontSize:18,fontWeight:700,color:"#1a1d4d"},children:"Agent Organizations"}),e.jsx("div",{style:{fontSize:12,color:"#6b7280",marginTop:2},children:"Overview of all registered agent organizations (B2B partners)"})]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(160px, 1fr))",gap:14,marginBottom:24},children:[{label:"Total Organizations",value:x,color:"#1e88e5",icon:"fa-building"},{label:"Active",value:m,color:"#16a34a",icon:"fa-check-circle"},{label:"Total Users",value:v,color:"#7b1fa2",icon:"fa-users"},{label:"Total Leads",value:g,color:"#00897b",icon:"fa-funnel-dollar"}].map(y=>e.jsxs("div",{style:{background:"#fff",borderRadius:10,padding:"16px 20px",boxShadow:"0 1px 6px rgba(0,0,0,0.08)",display:"flex",alignItems:"center",gap:14},children:[e.jsx("div",{style:{width:40,height:40,borderRadius:8,background:y.color+"18",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:e.jsx("i",{className:`fas ${y.icon}`,style:{color:y.color,fontSize:16}})}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:20,fontWeight:700,color:y.color},children:y.value}),e.jsx("div",{style:{fontSize:11,color:"#6b7280"},children:y.label})]})]},y.label))}),e.jsx("div",{style:{marginBottom:16},children:e.jsx("input",{value:d,onChange:y=>f(y.target.value),placeholder:"Search organizations",style:{padding:"8px 12px",border:"1px solid #d1d5db",borderRadius:7,fontSize:13,width:280}})}),r?e.jsx("div",{style:{textAlign:"center",padding:60},children:e.jsx("i",{className:"fas fa-spinner fa-spin",style:{fontSize:24}})}):e.jsx("div",{style:{background:"#fff",borderRadius:10,boxShadow:"0 1px 6px rgba(0,0,0,0.08)",overflow:"hidden",minWidth:0},children:e.jsx("div",{style:{overflowX:"auto"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:13},children:[e.jsx("thead",{children:e.jsx("tr",{style:{background:"#f9fafb"},children:["Organization","Status","Plan","Users","Leads","ID"].map(y=>e.jsx("th",{style:{padding:"10px 14px",textAlign:"left",fontWeight:600,color:"#374151",fontSize:12},children:y},y))})}),e.jsxs("tbody",{children:[p.map(y=>e.jsxs("tr",{style:{borderBottom:"1px solid #f3f4f6"},children:[e.jsx("td",{style:{padding:"10px 14px",fontWeight:700,color:"#1a1d4d"},children:y.name}),e.jsx("td",{style:{padding:"10px 14px"},children:e.jsx("span",{style:{background:(yf[y.status]||"#6b7280")+"18",color:yf[y.status]||"#6b7280",padding:"3px 9px",borderRadius:10,fontSize:11,fontWeight:600},children:y.status||"UNKNOWN"})}),e.jsx("td",{style:{padding:"10px 14px",color:"#374151"},children:y.plan_id||""}),e.jsx("td",{style:{padding:"10px 14px",color:"#7b1fa2",fontWeight:600},children:y.user_count||0}),e.jsx("td",{style:{padding:"10px 14px",color:"#00897b",fontWeight:600},children:y.lead_count||0}),e.jsx("td",{style:{padding:"10px 14px",color:"#9ca3af",fontSize:11,fontFamily:"monospace"},children:y.id})]},y.id)),p.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,style:{padding:40,textAlign:"center",color:"#9ca3af"},children:d?"No organizations match your search":"No organizations registered yet"})})]})]})})})]})}const C1=[{label:"Automation & Messaging",icon:"fa-robot",color:"#7b1fa2",settings:[{key:"enable_auto_whatsapp",label:"Auto WhatsApp Messages",description:"Send WhatsApp notifications automatically on status changes",type:"toggle"},{key:"enable_auto_case_from_event",label:"Auto Case from Event",description:"Automatically create a case when an event registration converts",type:"toggle"},{key:"enable_admission_auto_sync",label:"Admission Auto Sync",description:"Sync leads automatically from the Admission CRM integration",type:"toggle"},{key:"enable_bank_auto_pack",label:"Auto Bank Pack Generation",description:"Automatically generate document packs when all docs are received",type:"toggle"}]},{label:"SLA & Escalations",icon:"fa-exclamation-triangle",color:"#e53935",settings:[{key:"enable_sla_escalation",label:"SLA Escalation Engine",description:"Trigger escalation alerts when SLA deadlines are breached",type:"toggle"}]},{label:"Reports & Notifications",icon:"fa-envelope",color:"#1e88e5",settings:[{key:"daily_report_email",label:"Daily Report Email",description:"Email address to receive the daily performance summary",type:"email"},{key:"escalation_l1_email",label:"Escalation L1 Email",description:"First-level escalation recipient (team lead / manager)",type:"email"},{key:"escalation_l2_email",label:"Escalation L2 Email",description:"Second-level escalation recipient (senior manager)",type:"email"},{key:"escalation_l3_email",label:"Escalation L3 Email",description:"Third-level escalation recipient (director / CXO)",type:"email"}]}];function _1({label:s,description:i,value:r,onChange:o,accentColor:d}){return e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"14px 0",borderBottom:"1px solid #f3f4f6"},children:[e.jsxs("div",{style:{flex:1,paddingRight:24},children:[e.jsx("div",{style:{fontSize:13,fontWeight:600,color:"#1a1d4d"},children:s}),e.jsx("div",{style:{fontSize:11,color:"#6b7280",marginTop:2},children:i})]}),e.jsx("div",{onClick:()=>o(!r),style:{width:46,height:26,borderRadius:13,cursor:"pointer",flexShrink:0,background:r?d||"#1a1d4d":"#d1d5db",position:"relative",transition:"background 0.2s"},children:e.jsx("div",{style:{position:"absolute",top:3,width:20,height:20,borderRadius:"50%",background:"#fff",transition:"left 0.2s",left:r?23:3,boxShadow:"0 1px 4px rgba(0,0,0,0.25)"}})})]})}function w1({label:s,description:i,value:r,onChange:o}){return e.jsxs("div",{style:{padding:"14px 0",borderBottom:"1px solid #f3f4f6"},children:[e.jsx("div",{style:{fontSize:13,fontWeight:600,color:"#1a1d4d",marginBottom:2},children:s}),e.jsx("div",{style:{fontSize:11,color:"#6b7280",marginBottom:8},children:i}),e.jsx("input",{type:"email",value:r||"",onChange:d=>o(d.target.value),placeholder:"email@example.com",style:{width:"100%",maxWidth:360,padding:"8px 10px",border:"1px solid #d1d5db",borderRadius:7,fontSize:13,boxSizing:"border-box",outline:"none"}})]})}function E1(){const[s,i]=u.useState({}),[r,o]=u.useState(!0),[d,f]=u.useState(!1),[p,x]=u.useState({});u.useEffect(()=>{we.getSettings().then(j=>i(j)).catch(()=>{}).finally(()=>o(!1))},[]);const m=(j,k)=>{const _=j in p?p[j]:s[j];return k==="toggle"?_==="true"||_===!0||_===1:_||""},v=(j,k,_)=>{const C=_==="toggle"?k?"true":"false":k;x(L=>({...L,[j]:C}))},g=async()=>{if(Object.keys(p).length)try{f(!0),await we.updateSettings(p),i(j=>({...j,...p})),x({}),T.success("Settings saved")}catch(j){T.error(j.message||"Save failed")}finally{f(!1)}},b=()=>x({}),y=Object.keys(p).length>0;return r?e.jsxs("div",{style:{textAlign:"center",padding:60,color:"#6b7280"},children:[e.jsx("i",{className:"fas fa-spinner fa-spin",style:{fontSize:22}}),e.jsx("div",{style:{marginTop:10,fontSize:13},children:"Loading settings"})]}):e.jsxs("div",{style:{maxWidth:700},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:24},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:18,fontWeight:700,color:"#1a1d4d"},children:"System Settings"}),e.jsx("div",{style:{fontSize:12,color:"#6b7280",marginTop:2},children:"Configure automation, escalation, and notification preferences"})]}),y&&e.jsx("button",{onClick:g,disabled:d,style:{background:"#1a1d4d",color:"#fff",border:"none",borderRadius:8,padding:"9px 20px",fontSize:13,fontWeight:600,cursor:"pointer",display:"flex",alignItems:"center",gap:8,opacity:d?.7:1},children:d?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-spinner fa-spin"})," Saving"]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-save"})," Save Changes"]})})]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:16},children:C1.map(j=>e.jsxs("div",{style:{background:"#fff",borderRadius:12,padding:"20px 24px",boxShadow:"0 1px 6px rgba(0,0,0,0.07)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:16,paddingBottom:12,borderBottom:"2px solid #f3f4f6"},children:[e.jsx("div",{style:{width:30,height:30,borderRadius:7,background:j.color+"18",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx("i",{className:`fas ${j.icon}`,style:{color:j.color,fontSize:13}})}),e.jsx("div",{style:{fontSize:14,fontWeight:700,color:"#1a1d4d"},children:j.label})]}),j.settings.map(k=>k.type==="toggle"?e.jsx(_1,{label:k.label,description:k.description,value:m(k.key,"toggle"),onChange:_=>v(k.key,_,"toggle"),accentColor:j.color},k.key):e.jsx(w1,{label:k.label,description:k.description,value:m(k.key,"email"),onChange:_=>v(k.key,_,"email")},k.key))]},j.label))}),y&&e.jsxs("div",{style:{position:"sticky",bottom:16,marginTop:16,background:"#1a1d4d",borderRadius:10,padding:"12px 20px",display:"flex",alignItems:"center",justifyContent:"space-between",boxShadow:"0 4px 20px rgba(0,0,0,0.25)"},children:[e.jsxs("span",{style:{fontSize:13,color:"rgba(255,255,255,0.85)"},children:[e.jsx("i",{className:"fas fa-circle",style:{color:"#fbbf24",fontSize:8,marginRight:8,verticalAlign:"middle"}}),Object.keys(p).length," unsaved change",Object.keys(p).length!==1?"s":""]}),e.jsxs("div",{style:{display:"flex",gap:10},children:[e.jsx("button",{onClick:b,style:{padding:"7px 16px",border:"1px solid rgba(255,255,255,0.3)",borderRadius:7,background:"transparent",color:"rgba(255,255,255,0.7)",cursor:"pointer",fontSize:12},children:"Discard"}),e.jsx("button",{onClick:g,disabled:d,style:{padding:"7px 18px",border:"none",borderRadius:7,background:"#4fc3f7",color:"#1a1d4d",cursor:"pointer",fontSize:12,fontWeight:700},children:d?"Saving":"Save Now"})]})]})]})}const ph=[{label:"Operations",items:[{key:"master-dashboard",label:"Master Dashboard",icon:"fa-tachometer-alt"},{key:"leads",label:"Leads",icon:"fa-funnel-dollar"},{key:"events",label:"Events",icon:"fa-calendar-alt"},{key:"cases",label:"Cases",icon:"fa-briefcase"},{key:"pipeline",label:"Pipeline",icon:"fa-stream"}]},{label:"Intelligence",items:[{key:"reports",label:"Reports",icon:"fa-chart-bar"},{key:"comms",label:"Communications",icon:"fa-envelope"},{key:"lead-analytics",label:"Lead Analytics",icon:"fa-chart-line"}]},{label:"Management",items:[{key:"users",label:"Users",icon:"fa-users"},{key:"orgs",label:"Organizations",icon:"fa-building"}]},{label:"System",items:[{key:"automations",label:"Automations",icon:"fa-robot"},{key:"templates",label:"Templates",icon:"fa-file-alt"},{key:"masters",label:"Master Data",icon:"fa-database"},{key:"settings",label:"Settings",icon:"fa-cog"}]}],R1=ph.flatMap(s=>s.items);function A1(){var ve;const{user:s,logout:i}=ks(),[r,o]=u.useState("master-dashboard"),[d,f]=u.useState(!0),[p,x]=u.useState(null),[m,v]=u.useState(null),[g,b]=u.useState(null),[y,j]=u.useState(!1),[k,_]=u.useState("all"),[C,L]=u.useState({}),[D,I]=u.useState(null),[P,w]=u.useState(0),[A,N]=u.useState(1),[W,F]=u.useState(1),[Z,ce]=u.useState(0),xe=u.useCallback(()=>ce(Y=>Y+1),[]),z=u.useCallback(()=>{const Y={page:A,limit:30};return C.search&&(Y.search=C.search),C.status&&(Y.status=C.status),C.intake&&(Y.intake=C.intake),k.startsWith("stage-")?Y.stage=k.split("-")[1]:k.startsWith("await-")?Y.awaiting=k.split("-")[1]:k.startsWith("priority-")?Y.priority=k.split("-")[1]:k.startsWith("sla-")&&(Y.sla=k.split("-")[1]),Y},[C,k,A]),X=["cases","pipeline"];u.useEffect(()=>{if(!X.includes(r))return;const Y=z();Ae.getApplications(Y).then(se=>{I(se.data),w(se.total),F(se.pages)}).catch(()=>{})},[z,Z,r]);const de=Y=>{o(Y),v(null),["events","events-analytics"].includes(Y)||b(null),["cases","pipeline"].includes(Y)&&(_("all"),L({}),N(1),xe())},oe=d?240:64;return e.jsxs(e.Fragment,{children:[e.jsx(Ya,{position:"bottom-right",toastOptions:{duration:3e3,style:{background:"#1a1d4d",color:"#fff",fontSize:13,borderRadius:8}}}),e.jsxs("div",{style:{display:"flex",height:"100vh",overflow:"hidden",fontFamily:"Roboto, sans-serif",background:"#f0f2f5"},children:[e.jsxs("aside",{style:{width:oe,minWidth:oe,flexShrink:0,background:"linear-gradient(180deg, #1a1d4d 0%, #0d1033 100%)",display:"flex",flexDirection:"column",transition:"width 0.2s",overflow:"hidden",boxShadow:"2px 0 8px rgba(0,0,0,0.2)",zIndex:10},children:[e.jsxs("div",{style:{padding:"12px 14px",borderBottom:"1px solid rgba(255,255,255,0.1)",display:"flex",alignItems:"center",gap:10,minHeight:60,flexShrink:0},children:[d?e.jsxs("div",{style:{flex:1,overflow:"hidden"},children:[e.jsx(ai,{height:26,dark:!0}),e.jsx("div",{style:{fontSize:9,color:"rgba(255,255,255,0.45)",letterSpacing:.5,marginTop:3,textTransform:"uppercase"},children:"Master Admin"})]}):e.jsx("div",{style:{width:32,height:32,borderRadius:6,background:"rgba(255,255,255,0.12)",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,fontWeight:700,color:"#fff",fontSize:14},children:"N"}),e.jsx("button",{onClick:()=>f(Y=>!Y),style:{background:"none",border:"none",color:"rgba(255,255,255,0.5)",cursor:"pointer",fontSize:13,flexShrink:0,padding:4},children:e.jsx("i",{className:`fas fa-chevron-${d?"left":"right"}`})})]}),e.jsx("nav",{style:{flex:1,padding:"8px 0",overflowY:"auto"},children:ph.map(Y=>e.jsxs("div",{children:[d&&e.jsx("div",{style:{padding:"10px 16px 4px",fontSize:9,fontWeight:700,color:"rgba(255,255,255,0.35)",letterSpacing:1,textTransform:"uppercase"},children:Y.label}),Y.items.map(se=>{const J=r===se.key||se.key==="events"&&r==="events-analytics"||se.key==="lead-analytics"&&r==="leads-analytics";return e.jsxs("div",{onClick:()=>de(se.key),title:d?"":se.label,style:{display:"flex",alignItems:"center",gap:10,padding:d?"10px 16px":"10px 0",justifyContent:d?"flex-start":"center",cursor:"pointer",background:J?"rgba(255,255,255,0.12)":"transparent",borderLeft:`3px solid ${J?"#4fc3f7":"transparent"}`,color:J?"#fff":"rgba(255,255,255,0.65)",fontSize:13,transition:"all 0.12s",whiteSpace:"nowrap"},children:[e.jsx("i",{className:`fas ${se.icon}`,style:{width:18,textAlign:"center",fontSize:14,flexShrink:0,color:J?"#4fc3f7":"inherit"}}),d&&e.jsx("span",{style:{fontWeight:J?600:400},children:se.label})]},se.key)})]},Y.label))}),e.jsxs("div",{style:{borderTop:"1px solid rgba(255,255,255,0.1)",padding:"10px 0",flexShrink:0},children:[d&&e.jsxs("div",{style:{padding:"6px 16px 8px"},children:[e.jsx("div",{style:{fontSize:12,fontWeight:600,color:"rgba(255,255,255,0.9)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:(s==null?void 0:s.name)||"Super Admin"}),e.jsx("div",{style:{fontSize:10,color:"rgba(255,255,255,0.4)",marginTop:1},children:"Super Admin"})]}),e.jsxs("div",{onClick:i,title:"Logout",style:{display:"flex",alignItems:"center",gap:10,cursor:"pointer",padding:d?"8px 16px":"8px 0",justifyContent:d?"flex-start":"center",color:"#ef9a9a",fontSize:13},children:[e.jsx("i",{className:"fas fa-sign-out-alt",style:{width:18,textAlign:"center",fontSize:14}}),d&&e.jsx("span",{children:"Logout"})]})]})]}),e.jsxs("div",{style:{flex:1,overflow:"hidden",display:"flex",flexDirection:"column"},children:[e.jsxs("div",{style:{background:"#fff",borderBottom:"1px solid #e5e7eb",padding:"0 24px",display:"flex",alignItems:"center",justifyContent:"space-between",height:56,flexShrink:0},children:[e.jsx("div",{style:{fontSize:15,fontWeight:700,color:"#1a1d4d"},children:((ve=R1.find(Y=>Y.key===r))==null?void 0:ve.label)||"Master Admin"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[(r==="cases"||r==="pipeline")&&e.jsxs("button",{className:"btn btn-primary",onClick:()=>j(!0),style:{fontSize:12,padding:"6px 14px"},children:[e.jsx("i",{className:"fas fa-plus",style:{marginRight:6}})," New Application"]}),e.jsx("div",{style:{width:34,height:34,borderRadius:"50%",background:"#1a1d4d",display:"flex",alignItems:"center",justifyContent:"center",color:"#fff",fontWeight:700,fontSize:13},children:((s==null?void 0:s.name)||"A")[0].toUpperCase()}),e.jsx("span",{style:{fontSize:13,color:"#374151",fontWeight:500},children:s==null?void 0:s.name})]})]}),e.jsxs("div",{style:{flex:1,overflowY:"auto",overflowX:"hidden",padding:24,background:"#f0f2f5",minWidth:0},children:[r==="master-dashboard"&&e.jsx(t1,{}),r==="leads"&&e.jsx(th,{onOpenLead:Y=>v(Y)}),r==="lead-analytics"&&e.jsx(sh,{}),r==="events"&&!g&&e.jsx(fh,{onSelectEvent:Y=>b(Y)}),r==="events"&&g&&e.jsx(hh,{eventId:g,onBack:()=>b(null)}),r==="cases"&&e.jsxs(e.Fragment,{children:[e.jsx(Vf,{refreshKey:Z}),e.jsx(cf,{activeFilter:k,onFilterChange:Y=>{_(Y),N(1),xe()},filters:C,onFiltersChange:Y=>{L(Y),N(1)},refreshKey:Z}),e.jsx(Za,{applications:D,total:P,page:A,pages:W,onPageChange:N,onSelectApp:x})]}),r==="pipeline"&&e.jsxs(e.Fragment,{children:[e.jsx(Mo,{refreshKey:Z}),e.jsx(cf,{activeFilter:k,onFilterChange:Y=>{_(Y),N(1),xe()},filters:C,onFiltersChange:Y=>{L(Y),N(1)},refreshKey:Z}),e.jsx(Za,{applications:D,total:P,page:A,pages:W,onPageChange:N,onSelectApp:x})]}),r==="users"&&e.jsx(Xf,{}),r==="reports"&&e.jsx(S1,{}),r==="comms"&&e.jsx(k1,{}),r==="orgs"&&e.jsx(N1,{}),r==="automations"&&e.jsx(a1,{}),r==="templates"&&e.jsx(i1,{}),r==="masters"&&e.jsx(p1,{}),r==="settings"&&e.jsx(E1,{})]})]}),p&&e.jsx(Yf,{appId:p,onClose:()=>x(null),onUpdated:()=>{x(null),xe()}}),m&&e.jsx(nh,{leadId:m,onClose:()=>v(null),onOpenCase:Y=>{v(null),x(Y),de("cases")}}),y&&e.jsx(Zf,{onClose:()=>j(!1),onCreated:xe})]})]})}const T1=[{key:"7",label:"Last 7 days"},{key:"30",label:"Last 30 days"},{key:"0",label:"All Time"}];function z1({onOpenApp:s}){const[i,r]=u.useState(null),[o,d]=u.useState(null),[f,p]=u.useState(null),[x,m]=u.useState("30");function v(){Ae.getStats().then(r).catch(()=>{}),Ae.getSidebarCounts().then(d).catch(()=>{}),g("30")}function g(j){const k={awaiting:"Bank",limit:10,sort_by:"sla_days",sort_dir:"desc"};j!=="0"&&(k.days_ago=j),Ae.getApplications(k).then(_=>p(_.data)).catch(()=>{})}u.useEffect(()=>{v()},[]);function b(j){m(j),g(j)}const y=i&&o?[{label:"Total Assigned",value:i.total,cls:"blue",icon:"fa-folder-open",footer:"All cases assigned to you"},{label:"Awaiting Bank Action",value:i.awaitingBank,cls:"amber",icon:"fa-clock",footer:"Requires your response"},{label:"Awaiting Student",value:i.awaitingStudent,cls:"green",icon:"fa-user-graduate",footer:"Student to provide docs"},{label:"Sanctioned",value:i.sanctioned,cls:"green",icon:"fa-check-circle",footer:`${i.total?(i.sanctioned/i.total*100).toFixed(1):0}% conversion`},{label:"Rejected",value:i.rejected,cls:"red",icon:"fa-times-circle",footer:`${i.total?(i.rejected/i.total*100).toFixed(1):0}% rejection rate`},{label:"SLA Risk",value:o.slaWarning,cls:"amber",icon:"fa-exclamation-triangle",footer:"70% of SLA limit reached"},{label:"SLA Breach",value:o.slaBreach,cls:"purple",icon:"fa-fire",footer:"Exceeded SLA  escalate now"}]:null;return e.jsxs("div",{children:[e.jsxs("div",{className:"page-header",children:[e.jsxs("div",{children:[e.jsx("h2",{children:"Bank Dashboard"}),e.jsx("div",{className:"subtitle",children:"Your assigned applications at a glance"})]}),e.jsxs("button",{className:"btn btn-outline",onClick:v,children:[e.jsx("i",{className:"fas fa-sync-alt"})," Refresh"]})]}),e.jsx("div",{className:"bank-kpi-grid",children:y?y.map(j=>e.jsxs("div",{className:`kpi-card ${j.cls}`,children:[e.jsx("div",{className:"kpi-label",children:j.label}),e.jsx("div",{className:"kpi-value",children:j.value??""}),e.jsxs("div",{className:"kpi-footer neutral",children:[e.jsx("i",{className:`fas ${j.icon}`})," ",j.footer]})]},j.label)):Array(7).fill(0).map((j,k)=>e.jsx("div",{className:"kpi-card blue",style:{opacity:.4},children:"Loading..."},k))}),e.jsxs("div",{className:"card",style:{marginTop:20,padding:0,overflow:"hidden"},children:[e.jsxs("div",{className:"table-header",style:{padding:"16px 20px"},children:[e.jsxs("h3",{children:[e.jsx("i",{className:"fas fa-tasks",style:{marginRight:8,color:"var(--sbi-accent)"}})," Work Queue  Pending Bank Action"]}),e.jsx("div",{style:{display:"flex",gap:6,alignItems:"center"},children:T1.map(j=>e.jsx("button",{className:`bank-chip${x===j.key?" active":""}`,style:{padding:"3px 10px",fontSize:12},onClick:()=>b(j.key),children:j.label},j.key))})]}),f?e.jsxs("table",{className:"app-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Case ID"}),e.jsx("th",{children:"Student"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Awaiting"}),e.jsx("th",{children:"SLA"}),e.jsx("th",{children:"Updated"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:f.length===0?e.jsx("tr",{children:e.jsxs("td",{colSpan:7,style:{textAlign:"center",padding:32,color:"#999"},children:[e.jsx("i",{className:"fas fa-check-circle",style:{fontSize:24,display:"block",marginBottom:8,color:"var(--status-green)"}}),"All caught up  no pending bank actions!"]})}):f.map(j=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("span",{className:"app-id",onClick:()=>s(j.id),children:j.id})}),e.jsxs("td",{children:[e.jsx("div",{className:"student-name",children:j.student_name}),e.jsx("div",{className:"student-sub",children:j.course}),j.student_phone&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4,fontSize:11,color:"var(--text-muted)",marginTop:2},children:[e.jsx("i",{className:"fas fa-phone",style:{fontSize:10}}),j.student_phone,e.jsx("button",{style:{background:"none",border:"none",cursor:"pointer",padding:0,color:"var(--text-muted)",fontSize:10},onClick:()=>{navigator.clipboard.writeText(j.student_phone),T.success("Phone copied")},children:e.jsx("i",{className:"fas fa-copy"})})]})]}),e.jsx("td",{children:e.jsx(Ht,{status:j.status})}),e.jsx("td",{children:e.jsx(Nn,{awaiting:j.awaiting_from})}),e.jsx("td",{children:e.jsx(Qt,{days:j.sla_days,awaiting:j.awaiting_from,status:j.status})}),e.jsx("td",{style:{fontSize:12,color:"var(--text-muted)"},children:dt(j.updated_at)}),e.jsx("td",{children:e.jsxs("button",{className:"btn btn-sm btn-primary",onClick:()=>s(j.id),children:["Open ",e.jsx("i",{className:"fas fa-arrow-right",style:{marginLeft:4}})]})})]},j.id))})]}):e.jsx("div",{style:{padding:40,textAlign:"center",color:"#999"},children:"Loading..."})]})]})}const D1=[{key:"all",label:"All"},{key:"await-Bank",label:"Awaiting Bank"},{key:"await-Student",label:"Awaiting Student"},{key:"stage-1",label:"Pre-Login"},{key:"stage-2",label:"Login Stage"},{key:"stage-3",label:"Doc Verification"},{key:"stage-4",label:"Credit Review"},{key:"stage-5",label:"Decision"},{key:"stage-6",label:"Post Sanction"},{key:"stage-7",label:"Closed"}];function L1(s,i,r){const o={page:r,limit:30};return i.search&&(o.search=i.search),i.status&&(o.status=i.status),i.awaiting&&(o.awaiting=i.awaiting),i.priority&&(o.priority=i.priority),i.sla&&(o.sla=i.sla),i.country&&(o.country=i.country),s.startsWith("stage-")?o.stage=s.split("-")[1]:s.startsWith("await-")&&(o.awaiting=s.split("-")[1]),o}async function I1(s){const i=localStorage.getItem("nexthara_token"),r=T.loading("Fetching documents");try{const f=(await(await fetch(`/api/applications/${s}/documents`,{headers:{Authorization:`Bearer ${i}`}})).json()).filter(p=>p.file_path);if(f.length===0){T.error("No uploaded files for this case",{id:r});return}T.success(`Downloading ${f.length} file${f.length!==1?"s":""}`,{id:r});for(const p of f){const x=`/api/applications/${s}/documents/${p.id}/file?download=1`,m=await fetch(x,{headers:{Authorization:`Bearer ${i}`}});if(m.ok){const v=await m.blob(),g=document.createElement("a");g.href=URL.createObjectURL(v),g.download=p.doc_name||"document",document.body.appendChild(g),g.click(),document.body.removeChild(g),await new Promise(b=>setTimeout(b,400))}}}catch{T.error("Download failed",{id:r})}}function P1({app:s,onOpenApp:i}){const[r,o]=u.useState(!1),d=u.useRef(null);return u.useEffect(()=>{function f(p){d.current&&!d.current.contains(p.target)&&o(!1)}return document.addEventListener("mousedown",f),()=>document.removeEventListener("mousedown",f)},[]),e.jsxs("div",{ref:d,style:{position:"relative"},children:[e.jsx("button",{className:"btn btn-sm btn-outline",style:{padding:"4px 8px"},onClick:()=>o(f=>!f),children:e.jsx("i",{className:"fas fa-ellipsis-v"})}),r&&e.jsxs("div",{style:{position:"absolute",right:0,top:"100%",zIndex:200,background:"#fff",border:"1px solid var(--border-color)",borderRadius:6,boxShadow:"0 4px 12px rgba(0,0,0,0.12)",minWidth:170,marginTop:4},children:[e.jsxs("div",{className:"row-menu-item",onClick:()=>{i(s.id),o(!1)},children:[e.jsx("i",{className:"fas fa-arrow-right"})," Open Case"]}),e.jsxs("div",{className:"row-menu-item",onClick:()=>{i(s.id),o(!1)},children:[e.jsx("i",{className:"fas fa-question-circle",style:{color:"#e65100"}})," Raise Query"]}),e.jsxs("div",{className:"row-menu-item",onClick:()=>{i(s.id),o(!1)},children:[e.jsx("i",{className:"fas fa-edit",style:{color:"var(--sbi-accent)"}})," Update Status"]}),e.jsxs("div",{className:"row-menu-item",onClick:()=>{I1(s.id),o(!1)},children:[e.jsx("i",{className:"fas fa-file-archive"})," Download Pack"]})]})]})}function B1({onOpenApp:s}){const[i,r]=u.useState("all"),[o,d]=u.useState({}),[f,p]=u.useState(1),[x,m]=u.useState(null),[v,g]=u.useState(0),[b,y]=u.useState(1),j=u.useCallback(()=>{const C=L1(i,o,f);Ae.getApplications(C).then(L=>{m(L.data),g(L.total),y(L.pages)}).catch(()=>{})},[i,o,f]);u.useEffect(()=>{j()},[j]);const k=C=>{r(C),d({}),p(1)},_=(C,L)=>{d(D=>({...D,[C]:L})),p(1)};return e.jsxs("div",{children:[e.jsxs("div",{className:"page-header",children:[e.jsxs("div",{children:[e.jsx("h2",{children:"Applications"}),e.jsx("div",{className:"subtitle",children:"All cases assigned to your bank"})]}),e.jsxs("button",{className:"btn btn-outline",onClick:j,children:[e.jsx("i",{className:"fas fa-sync-alt"})," Refresh"]})]}),e.jsx("div",{className:"bank-chip-filters",children:D1.map(C=>e.jsx("button",{className:`bank-chip ${i===C.key?"active":""}`,onClick:()=>k(C.key),children:C.label},C.key))}),e.jsxs("div",{className:"filter-bar",style:{marginTop:8},children:[e.jsxs("div",{className:"search-box",children:[e.jsx("i",{className:"fas fa-search"}),e.jsx("input",{type:"text",placeholder:"Search by name, case ID, phone, email...",value:o.search||"",onChange:C=>_("search",C.target.value)})]}),e.jsxs("select",{className:"filter-select",value:o.status||"",onChange:C=>_("status",C.target.value),children:[e.jsx("option",{value:"",children:"All Statuses"}),Object.entries(Rt).map(([C,L])=>e.jsx("option",{value:C,children:L.label},C))]}),e.jsxs("select",{className:"filter-select",value:o.awaiting||"",onChange:C=>_("awaiting",C.target.value),children:[e.jsx("option",{value:"",children:"All Awaiting"}),e.jsx("option",{value:"Bank",children:"Bank"}),e.jsx("option",{value:"Student",children:"Student"}),e.jsx("option",{value:"Nexthara",children:"Nexthara"})]}),e.jsxs("select",{className:"filter-select",value:o.priority||"",onChange:C=>_("priority",C.target.value),children:[e.jsx("option",{value:"",children:"All Priorities"}),e.jsx("option",{value:"Urgent",children:"Urgent"}),e.jsx("option",{value:"High",children:"High"}),e.jsx("option",{value:"Normal",children:"Normal"})]}),e.jsxs("select",{className:"filter-select",value:o.sla||"",onChange:C=>_("sla",C.target.value),children:[e.jsx("option",{value:"",children:"All SLA"}),e.jsx("option",{value:"warning",children:"SLA Risk"}),e.jsx("option",{value:"breach",children:"SLA Breach"})]})]}),e.jsxs("div",{className:"table-container",style:{marginTop:8},children:[e.jsxs("div",{className:"table-header",children:[e.jsx("h3",{children:"Cases"}),e.jsxs("span",{className:"results-count",children:["Showing ",(x==null?void 0:x.length)??0," of ",v]})]}),e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Case ID"}),e.jsx("th",{children:"Student"}),e.jsx("th",{children:"University / Country"}),e.jsx("th",{children:"Loan Amt"}),e.jsx("th",{children:"Main Status"}),e.jsx("th",{children:"Sub Status"}),e.jsx("th",{children:"Awaiting"}),e.jsx("th",{children:"SLA"}),e.jsx("th",{children:"Updated"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:x?x.length===0?e.jsx("tr",{children:e.jsxs("td",{colSpan:10,style:{textAlign:"center",padding:40,color:"#999"},children:[e.jsx("i",{className:"fas fa-inbox",style:{fontSize:24,display:"block",marginBottom:10}}),"No applications found"]})}):x.map(C=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("span",{className:"app-id",onClick:()=>s(C.id),children:C.id})}),e.jsxs("td",{children:[e.jsx("div",{className:"student-name",children:C.student_name}),e.jsx("div",{className:"student-sub",style:{fontSize:11,color:"var(--text-muted)"},children:C.student_email}),C.student_phone&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4,fontSize:11,color:"var(--text-muted)",marginTop:2},children:[e.jsx("i",{className:"fas fa-phone",style:{fontSize:10}}),C.student_phone,e.jsx("button",{style:{background:"none",border:"none",cursor:"pointer",padding:0,color:"var(--text-muted)",fontSize:10},title:"Copy phone",onClick:()=>{navigator.clipboard.writeText(C.student_phone),T.success("Phone copied")},children:e.jsx("i",{className:"fas fa-copy"})})]})]}),e.jsxs("td",{children:[e.jsx("div",{style:{fontSize:13},children:C.university}),C.country&&e.jsxs("div",{style:{fontSize:11,color:"var(--text-muted)",marginTop:2},children:[e.jsx("i",{className:"fas fa-globe",style:{marginRight:3}}),C.country]})]}),e.jsx("td",{style:{fontSize:13},children:C.sanction_amount?ct(C.sanction_amount):C.loan_amount_requested?ct(C.loan_amount_requested):""}),e.jsx("td",{children:e.jsx(Ht,{status:C.status})}),e.jsx("td",{style:{fontSize:12,color:"var(--text-secondary)",maxWidth:120},children:e.jsx("span",{title:C.sub_status,style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"block"},children:C.sub_status||""})}),e.jsx("td",{children:e.jsx(Nn,{awaiting:C.awaiting_from})}),e.jsx("td",{children:e.jsx(Qt,{days:C.sla_days,awaiting:C.awaiting_from,status:C.status})}),e.jsx("td",{style:{fontSize:12,color:"var(--text-muted)"},children:dt(C.updated_at)}),e.jsx("td",{children:e.jsx(P1,{app:C,onOpenApp:s})})]},C.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:10,style:{textAlign:"center",padding:40,color:"#999"},children:"Loading..."})})})]}),b>1&&e.jsxs("div",{className:"pagination",children:[e.jsxs("div",{className:"info",children:["Page ",f," of ",b," (",v," total)"]}),e.jsxs("div",{className:"pagination-btns",children:[e.jsx("button",{onClick:()=>p(C=>C-1),disabled:f<=1,children:e.jsx("i",{className:"fas fa-chevron-left"})}),Array.from({length:Math.min(b,5)},(C,L)=>L+1).map(C=>e.jsx("button",{className:f===C?"active":"",onClick:()=>p(C),children:C},C)),e.jsx("button",{onClick:()=>p(C=>C+1),disabled:f>=b,children:e.jsx("i",{className:"fas fa-chevron-right"})})]})]})]})]})}const vf=["Missing Documents","Clarification Required","Additional Information Needed","Income Verification","Collateral Query","Co-applicant Details"],O1=["ITR (2 years)","Bank Statement (6 months)","Salary Slips (3 months)","Passport Copy","Offer Letter / Admission Letter","CIBIL Report","Collateral Documents","Co-applicant KYC","Property Valuation Report","Employment Proof"],bf=["Sanction Letter","Rejection Note / Screenshot","Agreement Signed Proof","Disbursement Proof"],jf=["CLOSED","DROPPED","EXPIRED","REJECTED","LOGIN_REJECTED"],W1=["SANCTIONED","REJECTED","DISBURSED","AGREEMENT_SIGNED"],$1=["Admission Docs","Student KYC","Co-applicant Docs","Financial Docs","Other"],M1=["All","Status","Query","Docs","Proof"];function F1({appId:s,onClose:i,onUpdated:r}){var Es,Rs;const[o,d]=u.useState(null),[f,p]=u.useState(!0),[x,m]=u.useState("summary"),[v,g]=u.useState(null),[b,y]=u.useState({}),[j,k]=u.useState(!1),[_,C]=u.useState(vf[0]),[L,D]=u.useState([]),[I,P]=u.useState(""),[w,A]=u.useState(""),[N,W]=u.useState(!1),[F,Z]=u.useState(bf[0]),[ce,xe]=u.useState(""),[z,X]=u.useState(null),[de,oe]=u.useState(!1),[ve,Y]=u.useState("Admission Docs"),[se,J]=u.useState(null),[O,U]=u.useState(!1),[ae,me]=u.useState(null),[be,je]=u.useState(""),[V,q]=u.useState(null),[re,Je]=u.useState(!1),[Xe,jt]=u.useState({name:"",relation:"",phone:"",email:"",income:"",employment_type:""}),[mt,es]=u.useState(!1),[lt,sn]=u.useState("All"),Pt=u.useCallback(()=>{p(!0),Ae.getApplication(s).then(R=>{d(R),y({status:R.status,sub_status:R.sub_status,awaiting_from:R.awaiting_from,priority:R.priority,student_phone:R.student_phone||"",country:R.country||"",intake:R.intake||"",loan_amount_requested:R.loan_amount_requested||"",collateral:R.collateral||"NA",loan_type:R.loan_type||"NA",bank_application_ref:R.bank_application_ref||"",sanction_amount:R.sanction_amount||"",roi:R.roi||"",tenure:R.tenure||"",processing_fee:R.processing_fee||"",margin_percent:R.margin_percent||"",sanction_accepted_date:R.sanction_accepted_date||"",agreement_date:R.agreement_date||"",disbursement_request_date:R.disbursement_request_date||"",disbursed_amount:R.disbursed_amount||"",disbursement_mode:R.disbursement_mode||"University",rejection_reason:R.rejection_reason||"",relook_possible:R.relook_possible||"No",close_reason:R.close_reason||"",notes:""}),p(!1)}).catch(()=>p(!1))},[s]),Q=u.useCallback(()=>{U(!0),bt.getDocuments(s).then(J).catch(()=>J([])).finally(()=>U(!1))},[s]),Se=u.useCallback(()=>{_o.getCoApplicants(s).then(q).catch(()=>q([]))},[s]);u.useEffect(()=>{s&&(Pt(),Q(),Se())},[s,Pt,Q,Se]);const Oe=R=>{const ie=Rt[R];y(Me=>({...Me,status:R,awaiting_from:(ie==null?void 0:ie.awaiting)!=="Closed"?ie==null?void 0:ie.awaiting:Me.awaiting_from,sub_status:bs[R]?bs[R][0]:"-"}))};async function Tt(){if(jf.includes(b.status)&&!b.close_reason&&!o.close_reason){T.error("Please enter a close/rejection reason");return}k(!0);try{const R={...b};R.sanction_amount&&(R.sanction_amount=Number(R.sanction_amount)),R.roi&&(R.roi=Number(R.roi)),R.tenure&&(R.tenure=Number(R.tenure)),R.processing_fee&&(R.processing_fee=Number(R.processing_fee)),R.margin_percent&&(R.margin_percent=Number(R.margin_percent)),R.disbursed_amount&&(R.disbursed_amount=Number(R.disbursed_amount)),R.loan_amount_requested&&(R.loan_amount_requested=Number(R.loan_amount_requested)),await Ae.updateApplication(s,R),T.success(`Case ${s} updated`),g(null),Pt(),r==null||r()}catch(R){T.error(R.message||"Update failed")}k(!1)}async function an(){if(!I.trim()){T.error("Please add remarks");return}W(!0);const R=`[QUERY] Type: ${_}${L.length?" | Docs: "+L.join(", "):""}${w?" | Due: "+w:""} | Remarks: ${I}`;try{await Ae.updateApplication(s,{status:"QUERY_RAISED",awaiting_from:"Student",notes:R}),T.success("Query raised  status set to Query Raised"),g(null),P(""),D([]),A(""),Pt(),r==null||r()}catch(ie){T.error(ie.message||"Failed to raise query")}W(!1)}async function ln(){oe(!0);try{z&&await bt.uploadFile(s,z,{doc_name:F,doc_category:"Other",owner:"Staff",label:ce||""}),await Ae.updateApplication(s,{notes:`[PROOF] ${F}${ce?"  "+ce:""}${z?" (file uploaded)":""}`,last_update_source:"Portal"}),T.success(z?"Proof uploaded and recorded":"Proof recorded successfully"),g(null),xe(""),X(null),Pt(),Q()}catch(R){T.error(R.message||"Failed to upload proof")}oe(!1)}async function ts(){if(!se||se.length===0){T.error("No documents for this case");return}const R=se.filter(ut=>ut.file_path);if(R.length===0){T.error("No uploaded files  documents have no attached files");return}const ie=localStorage.getItem("nexthara_token"),Me=T.loading(`Downloading ${R.length} file${R.length!==1?"s":""}`);let Gt=0;for(const ut of R)try{const Cn=bt.fileUrl(s,ut.id,!0),as=await fetch(Cn,{headers:{Authorization:`Bearer ${ie}`}});if(as.ok){const oa=await as.blob(),_n=document.createElement("a");_n.href=URL.createObjectURL(oa),_n.download=ut.doc_name||"document",document.body.appendChild(_n),_n.click(),document.body.removeChild(_n),Gt++,await new Promise(is=>setTimeout(is,400))}}catch{}T.success(`Downloaded ${Gt} file${Gt!==1?"s":""}`,{id:Me})}async function li(R){if(!R.file_path){T.error("No file attached to this document");return}const ie=localStorage.getItem("nexthara_token"),Me=bt.fileUrl(s,R.id,!1);try{const Gt=await fetch(Me,{headers:{Authorization:`Bearer ${ie}`}});if(!Gt.ok)throw new Error("File not found");const ut=await Gt.blob(),Cn=URL.createObjectURL(ut);window.open(Cn,"_blank")}catch{T.error("Could not open file")}}async function Ns(R,ie,Me){try{await bt.updateDocument(s,R,{status:ie,remarks:Me}),T.success(`Document marked as ${ie}`),Q()}catch{T.error("Update failed")}}async function la(){if(!be.trim()){T.error("Please enter a reason");return}await Ns(ae,"Invalid",be),me(null),je("")}async function Cs(){if(!Xe.name.trim()){T.error("Name is required");return}es(!0);try{await _o.addCoApplicant(s,{...Xe,income:Xe.income?Number(Xe.income):null}),T.success("Co-applicant added"),Je(!1),jt({name:"",relation:"",phone:"",email:"",income:"",employment_type:""}),Se()}catch{T.error("Failed to add co-applicant")}es(!1)}async function ri(R){try{await _o.deleteCoApplicant(s,R),T.success("Co-applicant removed"),Se()}catch{T.error("Failed to remove co-applicant")}}function ns(R){D(ie=>ie.includes(R)?ie.filter(Me=>Me!==R):[...ie,R])}const ss=W1.includes(b.status),Pl=["SANCTIONED","CONDITIONAL_SANCTION"].includes(b.status),oi=["LOGIN_REJECTED","REJECTED"].includes(b.status),di=b.status==="DISBURSED",Bl=jf.includes(b.status),_s=((Es=o==null?void 0:o.history)==null?void 0:Es.filter(R=>{if(lt==="All")return!0;const ie=(R.entry_type||"status").toLowerCase();return lt==="Status"?ie==="status":lt==="Query"?ie==="query"||(R.notes||"").includes("[QUERY]"):lt==="Docs"?ie==="docs"||(R.notes||"").includes("[DOC]"):lt==="Proof"?ie==="proof"||(R.notes||"").includes("[PROOF]"):!0}))||[],ws=se?se.filter(R=>R.doc_category===ve):[];function ra(R){const ie=R==="Verified"?"green":R==="Received"?"blue":R==="Invalid"?"red":"grey";return e.jsx("span",{className:`badge badge-${ie}`,children:R})}return e.jsx("div",{className:"modal-overlay show",onClick:R=>R.target===R.currentTarget&&i(),children:e.jsxs("div",{className:"modal bank-modal",children:[e.jsxs("div",{className:"bank-modal-header",children:[e.jsxs("div",{className:"bank-modal-header-left",children:[e.jsx("div",{className:"bank-case-id",children:s}),o&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bank-student-name",children:o.student_name}),e.jsx("span",{className:"bank-header-sep",children:""}),e.jsxs("span",{className:"bank-header-email",title:"Copy email",onClick:()=>{navigator.clipboard.writeText(o.student_email),T.success("Email copied")},children:[e.jsx("i",{className:"fas fa-envelope",style:{marginRight:4}}),o.student_email,e.jsx("i",{className:"fas fa-copy",style:{marginLeft:6,opacity:.5}})]}),o.student_phone&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"bank-header-sep",children:""}),e.jsxs("span",{className:"bank-header-email",title:"Copy phone",onClick:()=>{navigator.clipboard.writeText(o.student_phone),T.success("Phone copied")},children:[e.jsx("i",{className:"fas fa-phone",style:{marginRight:4}}),o.student_phone,e.jsx("i",{className:"fas fa-copy",style:{marginLeft:6,opacity:.5}})]})]})]})]}),e.jsxs("div",{className:"bank-modal-header-right",children:[e.jsxs("button",{className:"btn btn-sm btn-outline",onClick:ts,children:[e.jsx("i",{className:"fas fa-file-archive"})," Download Pack"]}),e.jsxs("button",{className:"btn btn-sm btn-outline",style:{color:"#e65100",borderColor:"#e65100"},onClick:()=>g("raise-query"),children:[e.jsx("i",{className:"fas fa-question-circle"})," Raise Query"]}),e.jsxs("button",{className:"btn btn-sm btn-primary",onClick:()=>{g("update-status"),m("status")},children:[e.jsx("i",{className:"fas fa-edit"})," Update Status"]}),e.jsxs("button",{className:"btn btn-sm btn-outline",onClick:()=>g("upload-proof"),children:[e.jsx("i",{className:"fas fa-upload"})," Upload Proof"]}),e.jsx("button",{className:"modal-close",onClick:i,children:e.jsx("i",{className:"fas fa-times"})})]})]}),o&&e.jsxs("div",{className:"bank-status-bar",children:[e.jsx(Ht,{status:o.status}),e.jsx(Nn,{awaiting:o.awaiting_from}),e.jsx(Qt,{days:o.sla_days,awaiting:o.awaiting_from,status:o.status}),o.bank_application_ref&&e.jsxs("span",{className:"bank-ref-tag",children:["Ref: ",o.bank_application_ref]}),e.jsx("div",{className:"bank-tabs",style:{marginLeft:"auto"},children:[["summary","Summary"],["documents","Documents"],["co-applicants","Co-applicants"],["status","Update Status"],["timeline","Timeline"],["followup","Follow-up"]].map(([R,ie])=>e.jsx("button",{className:`bank-tab ${x===R&&!v?"active":""}`,onClick:()=>{m(R),g(null)},children:ie},R))})]}),e.jsx("div",{className:"modal-body bank-modal-body",children:f?e.jsxs("div",{style:{textAlign:"center",padding:60,color:"#999"},children:[e.jsx("i",{className:"fas fa-spinner fa-spin",style:{fontSize:28}}),e.jsx("p",{style:{marginTop:12},children:"Loading case..."})]}):o?e.jsxs(e.Fragment,{children:[v==="raise-query"&&e.jsxs("div",{className:"bank-panel",children:[e.jsxs("div",{className:"bank-panel-header",children:[e.jsxs("h4",{children:[e.jsx("i",{className:"fas fa-question-circle",style:{marginRight:8,color:"#e65100"}})," Raise Query / Request Documents"]}),e.jsxs("button",{className:"btn btn-sm btn-outline",onClick:()=>g(null),children:[e.jsx("i",{className:"fas fa-arrow-left"})," Back"]})]}),e.jsxs("div",{className:"bank-panel-note",children:["After sending, status will auto-update to ",e.jsx("strong",{children:"Query Raised"})," and awaiting will be set to ",e.jsx("strong",{children:"Student"}),"."]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Query Type"}),e.jsx("select",{className:"form-control",value:_,onChange:R=>C(R.target.value),children:vf.map(R=>e.jsx("option",{value:R,children:R},R))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Due Date (optional)"}),e.jsx("input",{type:"date",className:"form-control",value:w,onChange:R=>A(R.target.value)})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Documents Required (multi-select)"}),e.jsx("div",{className:"bank-doc-checklist",children:O1.map(R=>e.jsxs("label",{className:"bank-doc-check-item",children:[e.jsx("input",{type:"checkbox",checked:L.includes(R),onChange:()=>ns(R)}),e.jsx("span",{children:R})]},R))})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{className:"form-label",children:["Remarks ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsx("textarea",{className:"form-control",rows:3,placeholder:"Describe what's needed and why...",value:I,onChange:R=>P(R.target.value)})]}),e.jsxs("div",{className:"form-actions",children:[e.jsx("button",{className:"btn btn-outline",onClick:()=>g(null),children:"Cancel"}),e.jsxs("button",{className:"btn btn-primary",onClick:an,disabled:N,children:[e.jsx("i",{className:`fas ${N?"fa-spinner fa-spin":"fa-paper-plane"}`}),N?"Sending...":"Send Query"]})]})]}),v==="upload-proof"&&e.jsxs("div",{className:"bank-panel",children:[e.jsxs("div",{className:"bank-panel-header",children:[e.jsxs("h4",{children:[e.jsx("i",{className:"fas fa-upload",style:{marginRight:8,color:"var(--sbi-accent)"}})," Upload Proof"]}),e.jsxs("button",{className:"btn btn-sm btn-outline",onClick:()=>g(null),children:[e.jsx("i",{className:"fas fa-arrow-left"})," Back"]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Proof Type"}),e.jsx("select",{className:"form-control",value:F,onChange:R=>Z(R.target.value),children:bf.map(R=>e.jsx("option",{value:R,children:R},R))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"File Upload"}),e.jsxs("div",{className:"bank-file-upload",style:z?{borderColor:"#2e7d32",background:"#f0fdf4"}:{},children:[e.jsx("i",{className:`fas ${z?"fa-check-circle":"fa-cloud-upload-alt"}`,style:z?{color:"#2e7d32"}:{}}),e.jsx("span",{children:z?z.name:"Click to upload or drag & drop"}),e.jsx("small",{children:"PDF, JPG, PNG  max 10MB"}),e.jsx("input",{type:"file",accept:".pdf,.jpg,.jpeg,.png",style:{position:"absolute",inset:0,opacity:0,cursor:"pointer"},onChange:R=>{var Me;const ie=(Me=R.target.files)==null?void 0:Me[0];ie&&X(ie)}})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Remarks"}),e.jsx("textarea",{className:"form-control",rows:2,placeholder:"Any additional remarks...",value:ce,onChange:R=>xe(R.target.value)})]}),e.jsxs("div",{className:"form-actions",children:[e.jsx("button",{className:"btn btn-outline",onClick:()=>g(null),children:"Cancel"}),e.jsxs("button",{className:"btn btn-primary",onClick:ln,disabled:de,children:[e.jsx("i",{className:`fas ${de?"fa-spinner fa-spin":"fa-upload"}`}),de?"Uploading...":"Upload"]})]})]}),(v==="update-status"||x==="status"&&!v)&&v!=="raise-query"&&v!=="upload-proof"&&e.jsxs("div",{className:"bank-panel",children:[e.jsxs("div",{className:"bank-panel-header",children:[e.jsxs("h4",{children:[e.jsx("i",{className:"fas fa-edit",style:{marginRight:8,color:"var(--sbi-accent)"}})," Update Status"]}),v&&e.jsxs("button",{className:"btn btn-sm btn-outline",onClick:()=>g(null),children:[e.jsx("i",{className:"fas fa-arrow-left"})," Back"]})]}),ss&&e.jsxs("div",{className:"bank-panel-warning",children:[e.jsx("i",{className:"fas fa-shield-alt"}),e.jsx("strong",{children:"Guardrail:"})," Status ",e.jsx("strong",{children:(Rs=Rt[b.status])==null?void 0:Rs.label})," requires proof or Nexthara confirmation."]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Main Status"}),e.jsx("select",{className:"form-control",value:b.status,onChange:R=>Oe(R.target.value),children:Object.entries(Rt).map(([R,ie])=>e.jsx("option",{value:R,children:ie.label},R))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Sub Status"}),e.jsx("select",{className:"form-control",value:b.sub_status,onChange:R=>y(ie=>({...ie,sub_status:R.target.value})),children:bs[b.status]?bs[b.status].map(R=>e.jsx("option",{value:R,children:R},R)):e.jsx("option",{value:"-",children:"-"})})]})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Awaiting From"}),e.jsxs("select",{className:"form-control",value:b.awaiting_from,onChange:R=>y(ie=>({...ie,awaiting_from:R.target.value})),children:[e.jsx("option",{children:"Student"}),e.jsx("option",{children:"Bank"}),e.jsx("option",{children:"Nexthara"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Priority"}),e.jsxs("select",{className:"form-control",value:b.priority,onChange:R=>y(ie=>({...ie,priority:R.target.value})),children:[e.jsx("option",{children:"Normal"}),e.jsx("option",{children:"High"}),e.jsx("option",{children:"Urgent"})]})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Bank Application Ref"}),e.jsx("input",{className:"form-control",value:b.bank_application_ref,onChange:R=>y(ie=>({...ie,bank_application_ref:R.target.value})),placeholder:"e.g. SBI-OCAS-00112"})]}),Pl&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Sanction Amount ()"}),e.jsx("input",{type:"number",className:"form-control",value:b.sanction_amount,onChange:R=>y(ie=>({...ie,sanction_amount:R.target.value})),placeholder:"e.g. 2500000"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"ROI (%)"}),e.jsx("input",{type:"text",className:"form-control",value:b.roi,onChange:R=>y(ie=>({...ie,roi:R.target.value})),placeholder:"e.g. 9.5"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Tenure (months)"}),e.jsx("input",{type:"number",className:"form-control",value:b.tenure,onChange:R=>y(ie=>({...ie,tenure:R.target.value})),placeholder:"e.g. 36"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Processing Fee (%)"}),e.jsx("input",{type:"text",className:"form-control",value:b.processing_fee,onChange:R=>y(ie=>({...ie,processing_fee:R.target.value})),placeholder:"e.g. 1.0"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Margin (%)"}),e.jsx("input",{type:"number",className:"form-control",value:b.margin_percent,onChange:R=>y(ie=>({...ie,margin_percent:R.target.value})),placeholder:"e.g. 15"})]})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Sanction Accepted Date"}),e.jsx("input",{type:"date",className:"form-control",value:b.sanction_accepted_date,onChange:R=>y(ie=>({...ie,sanction_accepted_date:R.target.value}))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Agreement Date"}),e.jsx("input",{type:"date",className:"form-control",value:b.agreement_date,onChange:R=>y(ie=>({...ie,agreement_date:R.target.value}))})]})]})]}),oi&&e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Rejection Reason"}),e.jsx("input",{className:"form-control",value:b.rejection_reason,onChange:R=>y(ie=>({...ie,rejection_reason:R.target.value})),placeholder:"Reason"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Relook Possible?"}),e.jsxs("select",{className:"form-control",value:b.relook_possible,onChange:R=>y(ie=>({...ie,relook_possible:R.target.value})),children:[e.jsx("option",{children:"No"}),e.jsx("option",{children:"Yes"})]})]})]}),di&&e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Disbursed Amount ()"}),e.jsx("input",{type:"number",className:"form-control",value:b.disbursed_amount,onChange:R=>y(ie=>({...ie,disbursed_amount:R.target.value})),placeholder:"Amount"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Disbursement Mode"}),e.jsxs("select",{className:"form-control",value:b.disbursement_mode,onChange:R=>y(ie=>({...ie,disbursement_mode:R.target.value})),children:[e.jsx("option",{children:"University"}),e.jsx("option",{children:"Student Account"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Disbursement Request Date"}),e.jsx("input",{type:"date",className:"form-control",value:b.disbursement_request_date,onChange:R=>y(ie=>({...ie,disbursement_request_date:R.target.value}))})]})]}),Bl&&e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{className:"form-label",children:["Close / Drop Reason ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsx("input",{className:"form-control",value:b.close_reason,onChange:R=>y(ie=>({...ie,close_reason:R.target.value})),placeholder:"Reason for closing/dropping this case (required)"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Remarks / Notes"}),e.jsx("textarea",{className:"form-control",rows:3,placeholder:"Add any notes...",value:b.notes,onChange:R=>y(ie=>({...ie,notes:R.target.value}))})]}),e.jsxs("div",{className:"form-actions",children:[e.jsx("button",{className:"btn btn-outline",onClick:()=>{g(null),m("summary")},children:"Cancel"}),e.jsxs("button",{className:"btn btn-primary",onClick:Tt,disabled:j,children:[e.jsx("i",{className:`fas ${j?"fa-spinner fa-spin":"fa-save"}`})," ",j?"Saving...":"Update Status"]})]})]}),ae&&e.jsxs("div",{className:"bank-panel",style:{border:"2px solid #d32f2f"},children:[e.jsx("div",{className:"bank-panel-header",children:e.jsxs("h4",{style:{color:"#d32f2f"},children:[e.jsx("i",{className:"fas fa-times-circle",style:{marginRight:8}})," Mark Document Invalid"]})}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{className:"form-label",children:["Reason for invalidity ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsx("input",{className:"form-control",value:be,onChange:R=>je(R.target.value),placeholder:"e.g. Blurred, Expired, Incorrect document"})]}),e.jsxs("div",{className:"form-actions",children:[e.jsx("button",{className:"btn btn-outline",onClick:()=>{me(null),je("")},children:"Cancel"}),e.jsx("button",{className:"btn btn-outline",style:{color:"#d32f2f",borderColor:"#d32f2f"},onClick:la,children:"Confirm Invalid"})]})]}),x==="summary"&&!v&&!ae&&e.jsxs("div",{children:[e.jsxs("div",{className:"bank-summary-section",children:[e.jsxs("div",{className:"bank-summary-section-title",children:[e.jsx("i",{className:"fas fa-user-graduate"})," Student & Education"]}),e.jsxs("div",{className:"bank-summary-grid",children:[e.jsxs("div",{children:[e.jsx("label",{children:"Student Name"}),e.jsx("div",{children:o.student_name})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Email"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[o.student_email,e.jsx("button",{className:"btn-icon",style:{width:24,height:24,fontSize:11},onClick:()=>{navigator.clipboard.writeText(o.student_email),T.success("Copied")},title:"Copy email",children:e.jsx("i",{className:"fas fa-copy"})})]})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Phone"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[o.student_phone||"",o.student_phone&&e.jsx("button",{className:"btn-icon",style:{width:24,height:24,fontSize:11},onClick:()=>{navigator.clipboard.writeText(o.student_phone),T.success("Phone copied")},title:"Copy phone",children:e.jsx("i",{className:"fas fa-copy"})})]})]}),e.jsxs("div",{children:[e.jsx("label",{children:"University"}),e.jsx("div",{children:o.university})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Course"}),e.jsx("div",{children:o.course})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Country"}),e.jsx("div",{children:o.country||""})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Intake"}),e.jsx("div",{children:o.intake||""})]})]})]}),e.jsxs("div",{className:"bank-summary-section",children:[e.jsxs("div",{className:"bank-summary-section-title",children:[e.jsx("i",{className:"fas fa-rupee-sign"})," Loan Details"]}),e.jsxs("div",{className:"bank-summary-grid",children:[e.jsxs("div",{children:[e.jsx("label",{children:"Bank"}),e.jsx("div",{children:o.bank})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Loan Amount Requested"}),e.jsx("div",{children:o.loan_amount_requested?ct(o.loan_amount_requested):""})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Collateral"}),e.jsx("div",{children:o.collateral||""})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Loan Type"}),e.jsx("div",{children:o.loan_type||""})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Bank Application Ref"}),e.jsx("div",{children:o.bank_application_ref||""})]}),o.sanction_amount&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{children:"Sanctioned Amount"}),e.jsx("div",{style:{fontWeight:600,color:"var(--status-green)"},children:ct(o.sanction_amount)})]}),e.jsxs("div",{children:[e.jsx("label",{children:"ROI"}),e.jsx("div",{children:o.roi?`${o.roi}%`:""})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Tenure"}),e.jsx("div",{children:o.tenure?`${o.tenure} months`:""})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Processing Fee"}),e.jsx("div",{children:o.processing_fee?`${o.processing_fee}%`:""})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Margin"}),e.jsx("div",{children:o.margin_percent?`${o.margin_percent}%`:""})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Sanction Accepted"}),e.jsx("div",{children:o.sanction_accepted_date?dt(o.sanction_accepted_date):""})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Agreement Date"}),e.jsx("div",{children:o.agreement_date?dt(o.agreement_date):""})]})]}),o.disbursed_amount&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{children:"Disbursed Amount"}),e.jsx("div",{style:{fontWeight:600,color:"var(--sbi-accent)"},children:ct(o.disbursed_amount)})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Disbursement Mode"}),e.jsx("div",{children:o.disbursement_mode})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Disbursement Request Date"}),e.jsx("div",{children:o.disbursement_request_date?dt(o.disbursement_request_date):""})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Disbursed Date"}),e.jsx("div",{children:o.disbursed_date?dt(o.disbursed_date):""})]})]}),o.close_reason&&e.jsxs("div",{style:{gridColumn:"1 / -1"},children:[e.jsx("label",{children:"Close/Drop Reason"}),e.jsx("div",{style:{color:"#d32f2f"},children:o.close_reason})]})]})]}),e.jsxs("div",{className:"bank-summary-section",children:[e.jsxs("div",{className:"bank-summary-section-title",children:[e.jsx("i",{className:"fas fa-info-circle"})," Status Snapshot"]}),e.jsxs("div",{className:"bank-summary-grid",children:[e.jsxs("div",{children:[e.jsx("label",{children:"Current Status"}),e.jsx("div",{children:e.jsx(Ht,{status:o.status})})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Sub Status"}),e.jsx("div",{children:o.sub_status||""})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Awaiting From"}),e.jsx("div",{children:e.jsx(Nn,{awaiting:o.awaiting_from})})]}),e.jsxs("div",{children:[e.jsx("label",{children:"SLA Timer"}),e.jsxs("div",{children:[e.jsx(Qt,{days:o.sla_days,awaiting:o.awaiting_from,status:o.status})," ",e.jsxs("span",{style:{fontSize:12,color:"var(--text-muted)"},children:["(",o.sla_days,"d)"]})]})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Priority"}),e.jsx("div",{children:o.priority})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Last Updated"}),e.jsx("div",{style:{fontSize:13,color:"var(--text-muted)"},children:na(o.updated_at)})]})]})]})]}),x==="documents"&&!v&&!ae&&e.jsxs("div",{children:[e.jsx("div",{className:"bank-doc-tab-nav",children:$1.map(R=>e.jsx("button",{className:`bank-doc-tab ${ve===R?"active":""}`,onClick:()=>Y(R),children:R},R))}),O?e.jsxs("div",{style:{padding:40,textAlign:"center",color:"#999"},children:[e.jsx("i",{className:"fas fa-spinner fa-spin"})," Loading documents..."]}):e.jsxs("div",{style:{marginTop:12},children:[ws.length===0?e.jsxs("div",{className:"bank-doc-placeholder",children:[e.jsx("i",{className:"fas fa-file-alt",style:{fontSize:36,color:"var(--border-color)",marginBottom:12}}),e.jsxs("div",{style:{color:"var(--text-muted)",fontSize:13},children:["No documents in ",ve," yet"]})]}):e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Document"}),e.jsx("th",{children:"Owner"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Uploaded By"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:ws.map(R=>e.jsxs("tr",{children:[e.jsx("td",{style:{fontWeight:500,fontSize:13},children:R.doc_name}),e.jsx("td",{style:{fontSize:12,color:"var(--text-secondary)"},children:R.owner}),e.jsx("td",{children:ra(R.status)}),e.jsx("td",{style:{fontSize:12,color:"var(--text-muted)"},children:R.uploaded_by||""}),e.jsx("td",{style:{fontSize:12,color:"var(--text-muted)"},children:R.uploaded_at?dt(R.uploaded_at):""}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",gap:4},children:[e.jsx("button",{className:"btn btn-sm btn-outline",onClick:()=>li(R),title:"View",children:e.jsx("i",{className:"fas fa-eye"})}),R.status!=="Verified"&&e.jsx("button",{className:"btn btn-sm btn-outline",style:{color:"#2e7d32",borderColor:"#2e7d32"},onClick:()=>Ns(R.id,"Verified",null),title:"Mark Verified",children:e.jsx("i",{className:"fas fa-check"})}),R.status!=="Received"&&R.status!=="Verified"&&e.jsx("button",{className:"btn btn-sm btn-outline",style:{color:"#1565c0",borderColor:"#1565c0"},onClick:()=>Ns(R.id,"Received",null),title:"Mark Received",children:e.jsx("i",{className:"fas fa-inbox"})}),R.status!=="Invalid"&&e.jsx("button",{className:"btn btn-sm btn-outline",style:{color:"#d32f2f",borderColor:"#d32f2f"},onClick:()=>{me(R.id),g(null)},title:"Mark Invalid",children:e.jsx("i",{className:"fas fa-times"})})]})})]},R.id))})]}),e.jsx("div",{style:{marginTop:16,paddingTop:12,borderTop:"1px solid var(--border-color)",display:"flex",gap:10},children:e.jsxs("button",{className:"btn btn-outline btn-sm",onClick:ts,children:[e.jsx("i",{className:"fas fa-file-archive"})," Download All Files"]})})]})]}),x==="co-applicants"&&!v&&!ae&&e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[e.jsxs("h4",{style:{margin:0},children:[e.jsx("i",{className:"fas fa-users",style:{marginRight:8,color:"var(--sbi-accent)"}})," Co-Applicants"]}),e.jsxs("button",{className:"btn btn-sm btn-outline",onClick:()=>Je(R=>!R),children:[e.jsx("i",{className:`fas fa-${re?"minus":"plus"}`})," ",re?"Cancel":"Add Co-applicant"]})]}),re&&e.jsxs("div",{className:"bank-panel",style:{marginBottom:16},children:[e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{className:"form-label",children:["Name ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsx("input",{className:"form-control",value:Xe.name,onChange:R=>jt(ie=>({...ie,name:R.target.value})),placeholder:"Full name"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Relation"}),e.jsxs("select",{className:"form-control",value:Xe.relation,onChange:R=>jt(ie=>({...ie,relation:R.target.value})),children:[e.jsx("option",{value:"",children:"Select"}),["Father","Mother","Spouse","Sibling","Guardian","Other"].map(R=>e.jsx("option",{value:R,children:R},R))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Phone"}),e.jsx("input",{className:"form-control",value:Xe.phone,onChange:R=>jt(ie=>({...ie,phone:R.target.value})),placeholder:"Phone number"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Email"}),e.jsx("input",{className:"form-control",type:"email",value:Xe.email,onChange:R=>jt(ie=>({...ie,email:R.target.value})),placeholder:"Email address"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Annual Income ()"}),e.jsx("input",{type:"number",className:"form-control",value:Xe.income,onChange:R=>jt(ie=>({...ie,income:R.target.value})),placeholder:"e.g. 800000"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Employment"}),e.jsxs("select",{className:"form-control",value:Xe.employment_type,onChange:R=>jt(ie=>({...ie,employment_type:R.target.value})),children:[e.jsx("option",{value:"",children:"Select"}),["Salaried","Self-Employed","Business Owner","Retired"].map(R=>e.jsx("option",{value:R,children:R},R))]})]})]}),e.jsx("div",{className:"form-actions",children:e.jsxs("button",{className:"btn btn-primary",onClick:Cs,disabled:mt,children:[e.jsx("i",{className:`fas ${mt?"fa-spinner fa-spin":"fa-save"}`})," ",mt?"Saving...":"Add"]})})]}),V?V.length===0?e.jsxs("div",{style:{padding:40,textAlign:"center",color:"#999"},children:[e.jsx("i",{className:"fas fa-user-plus",style:{fontSize:28,display:"block",marginBottom:8}}),"No co-applicants added yet"]}):e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Relation"}),e.jsx("th",{children:"Phone"}),e.jsx("th",{children:"Email"}),e.jsx("th",{children:"Income"}),e.jsx("th",{children:"Employment"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:V.map(R=>e.jsxs("tr",{children:[e.jsx("td",{style:{fontWeight:500},children:R.name}),e.jsx("td",{style:{fontSize:13},children:R.relation||""}),e.jsx("td",{style:{fontSize:13},children:R.phone||""}),e.jsx("td",{style:{fontSize:13},children:R.email||""}),e.jsx("td",{style:{fontSize:13},children:R.income?ct(R.income):""}),e.jsx("td",{style:{fontSize:13},children:R.employment_type||""}),e.jsx("td",{children:e.jsx("button",{className:"btn btn-sm btn-outline",style:{color:"#d32f2f",borderColor:"#d32f2f"},onClick:()=>ri(R.id),title:"Remove",children:e.jsx("i",{className:"fas fa-trash"})})})]},R.id))})]}):e.jsx("div",{style:{padding:40,textAlign:"center",color:"#999"},children:"Loading..."})]}),x==="followup"&&!v&&!ae&&e.jsxs("div",{style:{paddingTop:8},children:[o.awaiting_from==="Bank"&&e.jsxs("div",{style:{background:"#fce4ec",border:"1px solid #f48fb1",borderRadius:8,padding:"10px 16px",marginBottom:16,display:"flex",alignItems:"center",gap:10},children:[e.jsx("i",{className:"fas fa-exclamation-circle",style:{color:"#c62828",fontSize:18}}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:600,fontSize:13,color:"#c62828"},children:"Pending from Bank"}),e.jsx("div",{style:{fontSize:12,color:"#546e7a"},children:"This case is currently waiting on the bank for action. Please update or respond."})]})]}),e.jsx(Jf,{appId:s,app:o})]}),x==="timeline"&&!v&&!ae&&e.jsxs("div",{style:{paddingTop:8},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:16},children:[e.jsxs("h4",{style:{margin:0},children:[e.jsx("i",{className:"fas fa-history",style:{marginRight:8}})," Activity Timeline"]}),e.jsx("div",{style:{display:"flex",gap:6},children:M1.map(R=>e.jsx("button",{className:`bank-chip${lt===R?" active":""}`,style:{padding:"4px 12px",fontSize:12},onClick:()=>sn(R),children:R},R))})]}),_s.length===0?e.jsx("div",{style:{color:"var(--text-muted)",textAlign:"center",padding:32},children:"No history entries for this filter"}):_s.map((R,ie)=>{const Me=Rt[R.status],Gt=ie===0&&lt==="All",ut=R.entry_type||"status",Cn=ut==="query"?"fa-question-circle":ut==="proof"?"fa-upload":ut==="docs"?"fa-file-alt":Gt?"fa-circle":"fa-check",as=ut==="query"?"amber":ut==="proof"?"blue":ut==="docs"?"grey":(Me==null?void 0:Me.color)||"grey";return e.jsxs("div",{className:"timeline-item",children:[e.jsx("div",{className:`timeline-dot ${as}`,children:e.jsx("i",{className:`fas ${Cn}`})}),e.jsxs("div",{className:"timeline-content",children:[e.jsx("div",{className:"title",children:(Me==null?void 0:Me.label)||R.status}),e.jsxs("div",{className:"subtitle",children:[R.notes||""," ",R.sub_status&&R.sub_status!=="-"?`(${R.sub_status})`:""]}),e.jsxs("div",{className:"time",children:[e.jsx("i",{className:"fas fa-clock"})," ",na(R.created_at),"  ",R.changed_by,R.awaiting_from&&R.awaiting_from!=="Closed"&&e.jsxs("span",{style:{marginLeft:8,color:"var(--text-muted)"},children:[" ",R.awaiting_from]})]})]})]},R.id)})]})]}):e.jsx("div",{style:{textAlign:"center",padding:60,color:"#999"},children:"Application not found"})})]})})}function U1({onOpenApp:s}){const[i,r]=u.useState(null);function o(){Ae.getApplications({status:"QUERY_RAISED",limit:50}).then(d=>r(d.data)).catch(()=>{})}return u.useEffect(()=>{o()},[]),e.jsxs("div",{children:[e.jsxs("div",{className:"page-header",children:[e.jsxs("div",{children:[e.jsx("h2",{children:"Queries"}),e.jsx("div",{className:"subtitle",children:"Cases with open queries awaiting student response"})]}),e.jsxs("button",{className:"btn btn-outline",onClick:o,children:[e.jsx("i",{className:"fas fa-sync-alt"})," Refresh"]})]}),e.jsxs("div",{className:"table-container",children:[e.jsxs("div",{className:"table-header",children:[e.jsx("h3",{children:"Open Queries"}),e.jsx("span",{className:"results-count",children:i?`${i.length} cases`:"..."})]}),e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Case ID"}),e.jsx("th",{children:"Student"}),e.jsx("th",{children:"University"}),e.jsx("th",{children:"Sub Status / Docs Requested"}),e.jsx("th",{children:"SLA"}),e.jsx("th",{children:"Date Updated"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:i?i.length===0?e.jsx("tr",{children:e.jsxs("td",{colSpan:7,style:{textAlign:"center",padding:40,color:"#999"},children:[e.jsx("i",{className:"fas fa-check-circle",style:{fontSize:24,display:"block",marginBottom:8,color:"var(--status-green)"}}),"No open queries"]})}):i.map(d=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("span",{className:"app-id",onClick:()=>s(d.id),children:d.id})}),e.jsxs("td",{children:[e.jsx("div",{className:"student-name",children:d.student_name}),e.jsx("div",{className:"student-sub",children:d.student_email}),d.student_phone&&e.jsxs("div",{style:{fontSize:11,color:"var(--text-muted)",marginTop:2},children:[e.jsx("i",{className:"fas fa-phone",style:{marginRight:3,fontSize:10}}),d.student_phone]})]}),e.jsx("td",{style:{fontSize:13},children:d.university}),e.jsx("td",{style:{fontSize:12,color:"var(--text-secondary)",maxWidth:200},children:d.sub_status||""}),e.jsx("td",{children:e.jsx(Qt,{days:d.sla_days,awaiting:d.awaiting_from,status:d.status})}),e.jsx("td",{style:{fontSize:12,color:"var(--text-muted)"},children:dt(d.updated_at)}),e.jsx("td",{children:e.jsxs("button",{className:"btn btn-sm btn-outline",onClick:()=>s(d.id),children:["Open ",e.jsx("i",{className:"fas fa-arrow-right",style:{marginLeft:4}})]})})]},d.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:7,style:{textAlign:"center",padding:40,color:"#999"},children:"Loading..."})})})]})]})]})}function V1(s){const i=o=>o||"",r=o=>o?`${Number(o).toLocaleString("en-IN")}`:"";return`<!DOCTYPE html>
<html><head><title>Sanction Letter  ${s.id}</title>
<style>
  body { font-family: Arial, sans-serif; max-width: 800px; margin: 40px auto; padding: 40px; font-size: 14px; color: #212121; }
  .letterhead { text-align: center; border-bottom: 3px double #1a237e; padding-bottom: 20px; margin-bottom: 30px; }
  .bank-name { font-size: 22px; font-weight: 900; color: #1a237e; }
  .bank-sub { color: #666; font-size: 12px; margin-top: 4px; }
  .date-line { text-align: right; margin-bottom: 20px; color: #555; font-size: 13px; }
  .subject { font-weight: bold; margin: 24px 0 16px; text-decoration: underline; font-size: 15px; }
  .body-text { line-height: 1.8; margin: 12px 0; font-size: 14px; }
  table { width: 100%; border-collapse: collapse; margin: 20px 0; }
  td { padding: 10px 14px; border: 1px solid #e0e0e0; font-size: 13px; }
  td:first-child { background: #f5f7ff; font-weight: 600; width: 42%; color: #1a237e; }
  .sig { margin-top: 60px; }
  .footer { margin-top: 40px; border-top: 1px solid #e0e0e0; padding-top: 10px; font-size: 11px; color: #aaa; text-align: center; }
  @media print { body { margin: 0; } }
</style></head>
<body>
<div class="letterhead">
  <div class="bank-name">${i(s.bank)}</div>
  <div class="bank-sub">Education Loan Division  Nexthara Managed Portfolio</div>
</div>
<div class="date-line">Date: ${new Date().toLocaleDateString("en-IN",{day:"numeric",month:"long",year:"numeric"})}</div>
<div>To,<br><strong>${i(s.student_name)}</strong><br>${i(s.student_email)}</div>
<div class="subject">Subject: Sanction of Education Loan  Ref: ${s.bank_application_ref||s.id}</div>
<div class="body-text">Dear ${i(s.student_name)},</div>
<div class="body-text">We are pleased to inform you that your Education Loan application has been <strong>sanctioned</strong>. Please find the details below:</div>
<table>
  <tr><td>Applicant Name</td><td>${i(s.student_name)}</td></tr>
  <tr><td>University / Institution</td><td>${i(s.university)}</td></tr>
  <tr><td>Course</td><td>${i(s.course)}</td></tr>
  <tr><td>Country</td><td>${i(s.country)}</td></tr>
  <tr><td>Intake</td><td>${i(s.intake)}</td></tr>
  <tr><td>Loan Amount Sanctioned</td><td><strong>${r(s.sanction_amount)}</strong></td></tr>
  <tr><td>Rate of Interest (p.a.)</td><td>${s.roi?s.roi+"%":""}</td></tr>
  <tr><td>Tenure</td><td>${s.tenure?s.tenure+" months":""}</td></tr>
  <tr><td>Processing Fee</td><td>${s.processing_fee?s.processing_fee+"%":""}</td></tr>
  <tr><td>Margin Money</td><td>${s.margin_percent?s.margin_percent+"%":""}</td></tr>
  <tr><td>Collateral</td><td>${i(s.collateral)}</td></tr>
  <tr><td>Bank Application Reference</td><td>${i(s.bank_application_ref)}</td></tr>
  <tr><td>Sanction Status</td><td><strong>${(s.status||"").replace(/_/g," ")}</strong></td></tr>
</table>
<div class="body-text">This sanction is subject to the following conditions:
  <ol>
    <li>Submission of all required original documents within 15 days</li>
    <li>Execution of Loan Agreement within 30 days of this letter</li>
    <li>Verification and mortgage of collateral security (if applicable)</li>
    <li>Compliance with all applicable terms and conditions of the bank</li>
  </ol>
</div>
<div class="body-text">Please visit your nearest branch or contact your loan officer to complete the documentation process. For queries, contact Nexthara at support@nexthara.in.</div>
<div class="sig">
  <p>Yours Faithfully,</p><br><br>
  <p>________________________________</p>
  <p><strong>Authorised Signatory</strong></p>
  <p>${i(s.bank)}  Education Loan Division</p>
</div>
<div class="footer">This is a computer-generated document. Processed via Nexthara Dashboard. Case ID: ${s.id}. Confidential.</div>
</body></html>`}function H1(s){if(!s.sanction_amount){T.error("No sanction amount on record for this case");return}const i=V1(s),r=window.open("","_blank","width=900,height=700");if(!r){T.error("Please allow popups to generate sanction letter");return}r.document.write(i),r.document.close(),r.focus(),setTimeout(()=>r.print(),400)}const Q1=["SANCTIONED","CONDITIONAL_SANCTION","SANCTION_ACCEPTED"];function G1(s){return s==="SANCTION_ACCEPTED"||s==="AGREEMENT_SIGNED"?{text:"Yes",cls:"green"}:s==="SANCTIONED"||s==="CONDITIONAL_SANCTION"?{text:"Pending",cls:"amber"}:{text:"No",cls:"red"}}function q1(s){return s==="SANCTIONED"?"Awaiting student acceptance of sanction letter":s==="CONDITIONAL_SANCTION"?"Student to fulfil conditions and accept":s==="SANCTION_ACCEPTED"?"Proceed to agreement signing":""}function J1({onOpenApp:s}){const[i,r]=u.useState(null);function o(){Ae.getApplications({stage:5,limit:50}).then(d=>{const f=d.data.filter(p=>Q1.includes(p.status));r(f)}).catch(()=>{})}return u.useEffect(()=>{o()},[]),e.jsxs("div",{children:[e.jsxs("div",{className:"page-header",children:[e.jsxs("div",{children:[e.jsx("h2",{children:"Sanctions"}),e.jsx("div",{className:"subtitle",children:"Sanctioned cases and next steps"})]}),e.jsxs("button",{className:"btn btn-outline",onClick:o,children:[e.jsx("i",{className:"fas fa-sync-alt"})," Refresh"]})]}),e.jsxs("div",{className:"table-container",children:[e.jsxs("div",{className:"table-header",children:[e.jsx("h3",{children:"Sanctioned Applications"}),e.jsx("span",{className:"results-count",children:i?`${i.length} cases`:"..."})]}),e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Case ID"}),e.jsx("th",{children:"Student"}),e.jsx("th",{children:"University"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Sanction Amount"}),e.jsx("th",{children:"ROI / Tenure"}),e.jsx("th",{children:"Sanctioned Date"}),e.jsx("th",{children:"Student Accepted?"}),e.jsx("th",{children:"Next Step"}),e.jsx("th",{children:"SLA"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:i?i.length===0?e.jsx("tr",{children:e.jsxs("td",{colSpan:11,style:{textAlign:"center",padding:40,color:"#999"},children:[e.jsx("i",{className:"fas fa-inbox",style:{fontSize:24,display:"block",marginBottom:8}}),"No sanctioned applications yet"]})}):i.map(d=>{const f=G1(d.status);return e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("span",{className:"app-id",onClick:()=>s(d.id),children:d.id})}),e.jsxs("td",{children:[e.jsx("div",{className:"student-name",children:d.student_name}),e.jsx("div",{className:"student-sub",children:d.student_email})]}),e.jsx("td",{style:{fontSize:13},children:d.university}),e.jsx("td",{children:e.jsx(Ht,{status:d.status})}),e.jsx("td",{style:{fontWeight:600,color:"var(--status-green)"},children:d.sanction_amount?ct(d.sanction_amount):""}),e.jsxs("td",{style:{fontSize:12},children:[d.roi?`${d.roi}%`:""," ",d.tenure?`/ ${d.tenure}m`:""]}),e.jsx("td",{style:{fontSize:12,color:"var(--text-muted)"},children:dt(d.updated_at)}),e.jsx("td",{children:e.jsx("span",{className:`badge badge-${f.cls}`,children:f.text})}),e.jsx("td",{style:{fontSize:12,color:"var(--text-secondary)",maxWidth:180},children:q1(d.status)}),e.jsx("td",{children:e.jsx(Qt,{days:d.sla_days,awaiting:d.awaiting_from,status:d.status})}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",gap:4},children:[e.jsx("button",{className:"btn btn-sm btn-outline",onClick:()=>H1(d),title:"Download sanction letter",children:e.jsx("i",{className:"fas fa-file-download"})}),e.jsxs("button",{className:"btn btn-sm btn-primary",onClick:()=>s(d.id),children:["Open ",e.jsx("i",{className:"fas fa-arrow-right",style:{marginLeft:4}})]})]})})]},d.id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:11,style:{textAlign:"center",padding:40,color:"#999"},children:"Loading..."})})})]})]})]})}function K1({onOpenApp:s}){const[i,r]=u.useState(null);function o(){Ae.getApplications({stage:6,limit:50}).then(d=>r(d.data)).catch(()=>{})}return u.useEffect(()=>{o()},[]),e.jsxs("div",{children:[e.jsxs("div",{className:"page-header",children:[e.jsxs("div",{children:[e.jsx("h2",{children:"Disbursements"}),e.jsx("div",{className:"subtitle",children:"Post-sanction agreement & disbursement tracking"})]}),e.jsxs("button",{className:"btn btn-outline",onClick:o,children:[e.jsx("i",{className:"fas fa-sync-alt"})," Refresh"]})]}),e.jsxs("div",{className:"table-container",children:[e.jsxs("div",{className:"table-header",children:[e.jsx("h3",{children:"Post Sanction Cases"}),e.jsx("span",{className:"results-count",children:i?`${i.length} cases`:"..."})]}),e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Case ID"}),e.jsx("th",{children:"Student"}),e.jsx("th",{children:"University"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Sanction Amt"}),e.jsx("th",{children:"Agreement Date"}),e.jsx("th",{children:"Disb. Request"}),e.jsx("th",{children:"Disbursed Amt"}),e.jsx("th",{children:"Disbursed Date"}),e.jsx("th",{children:"Mode"}),e.jsx("th",{children:"SLA"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:i?i.length===0?e.jsx("tr",{children:e.jsxs("td",{colSpan:12,style:{textAlign:"center",padding:40,color:"#999"},children:[e.jsx("i",{className:"fas fa-inbox",style:{fontSize:24,display:"block",marginBottom:8}}),"No post-sanction applications"]})}):i.map(d=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("span",{className:"app-id",onClick:()=>s(d.id),children:d.id})}),e.jsxs("td",{children:[e.jsx("div",{className:"student-name",children:d.student_name}),e.jsx("div",{className:"student-sub",children:d.student_email})]}),e.jsx("td",{style:{fontSize:13},children:d.university}),e.jsx("td",{children:e.jsx(Ht,{status:d.status})}),e.jsx("td",{style:{fontSize:13,fontWeight:600,color:"var(--status-green)"},children:d.sanction_amount?ct(d.sanction_amount):""}),e.jsx("td",{style:{fontSize:12,color:"var(--text-muted)"},children:d.agreement_date?dt(d.agreement_date):""}),e.jsx("td",{style:{fontSize:12,color:"var(--text-muted)"},children:d.disbursement_request_date?dt(d.disbursement_request_date):""}),e.jsx("td",{style:{fontWeight:600,color:"var(--sbi-accent)"},children:d.disbursed_amount?ct(d.disbursed_amount):""}),e.jsx("td",{style:{fontSize:12,color:"var(--text-muted)"},children:d.disbursed_date?dt(d.disbursed_date):""}),e.jsx("td",{style:{fontSize:12},children:d.disbursement_mode||""}),e.jsx("td",{children:e.jsx(Qt,{days:d.sla_days,awaiting:d.awaiting_from,status:d.status})}),e.jsx("td",{children:e.jsxs("button",{className:"btn btn-sm btn-outline",onClick:()=>s(d.id),children:["Open ",e.jsx("i",{className:"fas fa-arrow-right",style:{marginLeft:4}})]})})]},d.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:12,style:{textAlign:"center",padding:40,color:"#999"},children:"Loading..."})})})]})]})]})}function Y1(){const[s,i]=u.useState(null),[r,o]=u.useState(null),[d,f]=u.useState(null);function p(){Ae.getStats().then(i).catch(()=>{}),Ae.getPipeline().then(o).catch(()=>{}),Ae.getApplications({limit:200}).then(m=>f(m.data)).catch(()=>{})}u.useEffect(()=>{p()},[]);const x=d?(()=>{const m={};let v=0,g=0,b=0;for(const y of d)m[y.status]=(m[y.status]||0)+1,y.sanction_amount&&(v+=y.sanction_amount),y.disbursed_amount&&(g+=y.disbursed_amount),y.loan_amount_requested&&(b+=y.loan_amount_requested);return{statusCounts:m,totalSanctioned:v,totalDisbursed:g,totalRequested:b}})():null;return e.jsxs("div",{children:[e.jsxs("div",{className:"page-header",children:[e.jsxs("div",{children:[e.jsx("h2",{children:"Reports & Analytics"}),e.jsx("div",{className:"subtitle",children:"Portfolio summary and performance metrics"})]}),e.jsxs("button",{className:"btn btn-outline",onClick:p,children:[e.jsx("i",{className:"fas fa-sync-alt"})," Refresh"]})]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:12,marginBottom:24},children:[{label:"Total Applications",value:(s==null?void 0:s.total)??"",icon:"fa-folder-open",cls:"blue"},{label:"Total Sanctioned",value:(s==null?void 0:s.sanctioned)??"",icon:"fa-check-circle",cls:"green"},{label:"Total Rejected",value:(s==null?void 0:s.rejected)??"",icon:"fa-times-circle",cls:"red"},{label:"SLA Breaches",value:(s==null?void 0:s.slaBreach)??"",icon:"fa-fire",cls:"purple"}].map(m=>e.jsxs("div",{className:`kpi-card ${m.cls}`,children:[e.jsx("div",{className:"kpi-label",children:m.label}),e.jsx("div",{className:"kpi-value",children:m.value})]},m.label))}),x&&e.jsxs("div",{className:"card",style:{padding:20,marginBottom:24},children:[e.jsxs("div",{className:"bank-summary-section-title",style:{marginBottom:16},children:[e.jsx("i",{className:"fas fa-rupee-sign",style:{marginRight:8}})," Financial Summary"]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:16},children:[e.jsxs("div",{style:{textAlign:"center",padding:"16px",background:"var(--bg-secondary)",borderRadius:8},children:[e.jsx("div",{style:{fontSize:12,color:"var(--text-muted)",marginBottom:4},children:"Total Loan Amount Requested"}),e.jsx("div",{style:{fontSize:20,fontWeight:700,color:"var(--sbi-accent)"},children:ct(x.totalRequested)})]}),e.jsxs("div",{style:{textAlign:"center",padding:"16px",background:"var(--bg-secondary)",borderRadius:8},children:[e.jsx("div",{style:{fontSize:12,color:"var(--text-muted)",marginBottom:4},children:"Total Amount Sanctioned"}),e.jsx("div",{style:{fontSize:20,fontWeight:700,color:"var(--status-green)"},children:ct(x.totalSanctioned)})]}),e.jsxs("div",{style:{textAlign:"center",padding:"16px",background:"var(--bg-secondary)",borderRadius:8},children:[e.jsx("div",{style:{fontSize:12,color:"var(--text-muted)",marginBottom:4},children:"Total Amount Disbursed"}),e.jsx("div",{style:{fontSize:20,fontWeight:700,color:"#1565c0"},children:ct(x.totalDisbursed)})]})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16,marginBottom:24},children:[e.jsxs("div",{className:"card",style:{padding:20},children:[e.jsxs("div",{className:"bank-summary-section-title",style:{marginBottom:16},children:[e.jsx("i",{className:"fas fa-stream",style:{marginRight:8}})," Pipeline Stage Breakdown"]}),r?e.jsx("div",{children:Object.entries(r).map(([m,v])=>{const g=s!=null&&s.total?Math.round(v.count/s.total*100):0;return e.jsxs("div",{style:{marginBottom:12},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:13,marginBottom:4},children:[e.jsxs("span",{style:{color:"var(--text-secondary)"},children:["Stage ",m,": ",v.label]}),e.jsxs("span",{style:{fontWeight:600},children:[v.count," ",e.jsxs("span",{style:{color:"var(--text-muted)",fontWeight:400},children:["(",g,"%)"]})]})]}),e.jsx("div",{style:{height:6,background:"var(--border-color)",borderRadius:3,overflow:"hidden"},children:e.jsx("div",{style:{height:"100%",width:`${g}%`,background:"var(--sbi-accent)",borderRadius:3,transition:"width 0.4s"}})})]},m)})}):e.jsx("div",{style:{color:"#999",textAlign:"center",padding:20},children:"Loading..."})]}),e.jsxs("div",{className:"card",style:{padding:20},children:[e.jsxs("div",{className:"bank-summary-section-title",style:{marginBottom:16},children:[e.jsx("i",{className:"fas fa-chart-pie",style:{marginRight:8}})," Status Breakdown"]}),x?e.jsx("div",{style:{maxHeight:280,overflowY:"auto"},children:Object.entries(x.statusCounts).sort(([,m],[,v])=>v-m).map(([m,v])=>{const g=Rt[m],b=d?Math.round(v/d.length*100):0;return e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:8},children:[e.jsx("span",{style:{fontSize:12,color:"var(--text-secondary)",minWidth:150},children:(g==null?void 0:g.label)||m}),e.jsx("div",{style:{flex:1,height:6,background:"var(--border-color)",borderRadius:3,overflow:"hidden"},children:e.jsx("div",{style:{height:"100%",width:`${b}%`,background:"var(--sbi-accent)",borderRadius:3}})}),e.jsx("span",{style:{fontSize:12,fontWeight:600,minWidth:40,textAlign:"right"},children:v})]},m)})}):e.jsx("div",{style:{color:"#999",textAlign:"center",padding:20},children:"Loading..."})]})]}),e.jsxs("div",{className:"card",style:{padding:20},children:[e.jsxs("div",{className:"bank-summary-section-title",style:{marginBottom:16},children:[e.jsx("i",{className:"fas fa-heartbeat",style:{marginRight:8}})," SLA Health"]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:16},children:[{label:"On Track",count:d?d.filter(m=>m.sla_days<=2&&m.awaiting_from!=="Closed").length:"",cls:"green",icon:"fa-check-circle"},{label:"At Risk (70% SLA)",count:(s==null?void 0:s.slaWarning)??"",cls:"amber",icon:"fa-exclamation-triangle"},{label:"Breached SLA",count:(s==null?void 0:s.slaBreach)??"",cls:"red",icon:"fa-fire"}].map(m=>e.jsxs("div",{style:{textAlign:"center",padding:16,background:"var(--bg-secondary)",borderRadius:8},children:[e.jsx("div",{style:{fontSize:24,marginBottom:4},children:e.jsx("i",{className:`fas ${m.icon}`,style:{color:m.cls==="green"?"var(--status-green)":m.cls==="amber"?"#ff8f00":"#d32f2f"}})}),e.jsx("div",{style:{fontSize:22,fontWeight:700},children:m.count}),e.jsx("div",{style:{fontSize:12,color:"var(--text-muted)"},children:m.label})]},m.label))})]})]})}function Z1({eventId:s,onBack:i}){const[r,o]=u.useState(null),[d,f]=u.useState(null),[p,x]=u.useState(!0),[m,v]=u.useState(s?"event":"overview");return u.useEffect(()=>{m==="event"&&s?Ye.getEventAnalytics(s).then(o).finally(()=>x(!1)):Ye.getOverviewAnalytics().then(f).finally(()=>x(!1))},[m,s]),p?e.jsx("div",{style:{padding:48,textAlign:"center",color:"#94a3b8"},children:"Loading analytics..."}):m==="event"&&r?e.jsx(X1,{data:r,onBack:i}):d?e.jsxs("div",{style:{padding:24,background:"#f9fafb",minHeight:"100vh"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:24},children:[e.jsxs("div",{children:[e.jsx("h1",{style:{margin:0,fontSize:22,fontWeight:700,color:"#0f172a"},children:"Events Analytics"}),e.jsx("p",{style:{margin:"4px 0 0",fontSize:13,color:"#64748b"},children:"Compare events, measure ROI, see what works"})]}),i&&e.jsx("button",{onClick:i,style:{background:"none",border:"1px solid #e2e8f0",borderRadius:8,padding:"8px 16px",cursor:"pointer",color:"#475569",fontSize:13},children:" Back"})]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(5, 1fr)",gap:14,marginBottom:24},children:[{label:"Total Events",value:d.totalEvents,color:"#2563eb",icon:"fa-calendar-alt"},{label:"Registrations",value:d.totalRegs,color:"#7c3aed",icon:"fa-users"},{label:"Check-ins",value:d.totalCheckins,color:"#059669",icon:"fa-sign-in-alt"},{label:"Leads Created",value:d.totalLeads,color:"#0891b2",icon:"fa-user-tag"},{label:"Cases Created",value:d.totalCases,color:"#dc2626",icon:"fa-briefcase"}].map(g=>e.jsxs("div",{style:{background:"#fff",borderRadius:12,padding:18,boxShadow:"0 1px 4px rgba(0,0,0,0.06)",display:"flex",alignItems:"center",gap:14},children:[e.jsx("div",{style:{background:g.color+"18",borderRadius:10,width:40,height:40,display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:e.jsx("i",{className:`fas ${g.icon}`,style:{color:g.color,fontSize:16}})}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:11,color:"#64748b",marginBottom:2},children:g.label}),e.jsx("div",{style:{fontSize:22,fontWeight:800,color:"#0f172a"},children:(g.value||0).toLocaleString()})]})]},g.label))}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16,marginBottom:16},children:[e.jsxs("div",{style:{background:"#fff",borderRadius:12,padding:20,boxShadow:"0 1px 4px rgba(0,0,0,0.06)"},children:[e.jsx("div",{style:{fontWeight:600,fontSize:14,marginBottom:16},children:"Registration Source Breakdown"}),(d.sourceBreakdown||[]).map(g=>{const b=(d.sourceBreakdown||[]).reduce((j,k)=>j+k.count,0),y=b?Math.round(g.count/b*100):0;return e.jsxs("div",{style:{marginBottom:12},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:4},children:[e.jsx("span",{style:{fontSize:13,color:"#374151",fontWeight:500},children:g.source}),e.jsxs("span",{style:{fontSize:13,color:"#64748b"},children:[g.count," (",y,"%)"]})]}),e.jsx("div",{style:{height:8,background:"#f1f5f9",borderRadius:8},children:e.jsx("div",{style:{height:8,background:g.source==="META"?"#2563eb":g.source==="LINK"?"#059669":"#7c3aed",borderRadius:8,width:`${y}%`}})})]},g.source)}),(d.sourceBreakdown||[]).length===0&&e.jsx("div",{style:{color:"#94a3b8",fontSize:13},children:"No data yet"})]}),e.jsxs("div",{style:{background:"#fff",borderRadius:12,padding:20,boxShadow:"0 1px 4px rgba(0,0,0,0.06)"},children:[e.jsx("div",{style:{fontWeight:600,fontSize:14,marginBottom:12},children:"Campaign Performance Table"}),e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:13},children:[e.jsx("thead",{children:e.jsx("tr",{style:{background:"#f8fafc"},children:["Campaign","Leads","Regs","Checked-in","Cases"].map(g=>e.jsx("th",{style:{padding:"8px 10px",textAlign:"left",fontSize:11,fontWeight:600,color:"#64748b",textTransform:"uppercase"},children:g},g))})}),e.jsx("tbody",{children:e.jsx("tr",{children:e.jsx("td",{colSpan:5,style:{padding:"24px",textAlign:"center",color:"#94a3b8"},children:"Link Meta campaigns to see ROI"})})})]})]})]}),e.jsxs("div",{style:{background:"#fff",borderRadius:12,boxShadow:"0 1px 4px rgba(0,0,0,0.06)",overflow:"hidden"},children:[e.jsx("div",{style:{padding:"16px 20px",borderBottom:"1px solid #f1f5f9",fontWeight:600,fontSize:14},children:"Event Performance"}),e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsx("tr",{style:{background:"#f8fafc",borderBottom:"1px solid #e2e8f0"},children:["Event","Date","Reg","Confirmed","Checked-in","No-show%","Leads","Cases"].map(g=>e.jsx("th",{style:{padding:"10px 14px",textAlign:"left",fontSize:11,fontWeight:600,color:"#475569",textTransform:"uppercase"},children:g},g))})}),e.jsxs("tbody",{children:[(d.eventPerf||[]).map(g=>{const b=g.registrations>0?Math.round((1-g.checked_in/Math.max(g.confirmed||g.registrations,1))*100):0;return e.jsxs("tr",{style:{borderBottom:"1px solid #f1f5f9"},children:[e.jsx("td",{style:{padding:"12px 14px",fontWeight:600,fontSize:13},children:e.jsx("div",{style:{maxWidth:200,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:g.title})}),e.jsx("td",{style:{padding:"12px 14px",fontSize:12,color:"#64748b"},children:new Date(g.event_start_at).toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric"})}),e.jsx("td",{style:{padding:"12px 14px",fontSize:13},children:g.registrations||0}),e.jsx("td",{style:{padding:"12px 14px",fontSize:13},children:g.confirmed||0}),e.jsx("td",{style:{padding:"12px 14px",fontSize:13,color:"#059669",fontWeight:600},children:g.checked_in||0}),e.jsxs("td",{style:{padding:"12px 14px",fontSize:13,color:b>40?"#dc2626":"#64748b"},children:[b,"%"]}),e.jsx("td",{style:{padding:"12px 14px",fontSize:13,color:"#7c3aed"},children:g.leads||0}),e.jsx("td",{style:{padding:"12px 14px",fontSize:13,color:"#2563eb"},children:g.cases||0})]},g.id)}),(d.eventPerf||[]).length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:8,style:{padding:32,textAlign:"center",color:"#94a3b8"},children:"No events yet"})})]})]})]})]}):null}function X1({data:s,onBack:i}){const{event:r,kpis:o,funnel:d,sourceBreakdown:f,ticketBreakdown:p,intentBreakdown:x,campaignBreakdown:m}=s;return e.jsxs("div",{style:{padding:24,background:"#f9fafb",minHeight:"100vh"},children:[e.jsxs("div",{style:{marginBottom:20},children:[i&&e.jsx("button",{onClick:i,style:{background:"none",border:"none",color:"#2563eb",cursor:"pointer",fontSize:14,padding:0,marginBottom:8},children:" Back"}),e.jsxs("h1",{style:{margin:0,fontSize:20,fontWeight:700,color:"#0f172a"},children:[r==null?void 0:r.title,"  Analytics"]}),e.jsxs("div",{style:{fontSize:13,color:"#64748b",marginTop:4},children:[r&&new Date(r.event_start_at).toLocaleDateString("en-IN",{day:"numeric",month:"long",year:"numeric"}),"  ",r==null?void 0:r.venue_name]})]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:14,marginBottom:20},children:[{label:"Registered",value:(o==null?void 0:o.registered)||0,color:"#2563eb"},{label:"Checked-in",value:(o==null?void 0:o.checked_in)||0,color:"#7c3aed"},{label:"Leads",value:(o==null?void 0:o.leads_created)||0,color:"#059669"},{label:"Cases",value:(o==null?void 0:o.cases_created)||0,color:"#dc2626"}].map(v=>e.jsxs("div",{style:{background:"#fff",borderRadius:12,padding:18,boxShadow:"0 1px 4px rgba(0,0,0,0.06)",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:28,fontWeight:800,color:v.color},children:v.value}),e.jsx("div",{style:{fontSize:12,color:"#64748b",marginTop:4},children:v.label})]},v.label))}),e.jsxs("div",{style:{background:"#fff",borderRadius:12,padding:20,marginBottom:16,boxShadow:"0 1px 4px rgba(0,0,0,0.06)"},children:[e.jsx("div",{style:{fontWeight:600,fontSize:14,marginBottom:14},children:"Conversion Funnel"}),e.jsx("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[{label:"Registered",value:(d==null?void 0:d.registered)||0,color:"#2563eb"},{label:"Confirmed",value:(d==null?void 0:d.confirmed)||0,color:"#059669"},{label:"Checked-in",value:(d==null?void 0:d.checked_in)||0,color:"#7c3aed"},{label:"Leads",value:(d==null?void 0:d.leads)||0,color:"#0891b2"},{label:"Cases",value:(d==null?void 0:d.cases)||0,color:"#dc2626"}].map((v,g)=>{const b=(d==null?void 0:d.registered)>0?Math.round(v.value/d.registered*100):0;return e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,flex:1},children:[e.jsxs("div",{style:{flex:1,background:v.color+"12",borderRadius:10,padding:"12px",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:22,fontWeight:800,color:v.color},children:v.value}),e.jsx("div",{style:{fontSize:11,color:"#64748b",marginTop:2},children:v.label}),e.jsxs("div",{style:{fontSize:11,color:v.color,fontWeight:600},children:[b,"%"]})]}),g<4&&e.jsx("div",{style:{fontSize:18,color:"#cbd5e1",flexShrink:0},children:""})]},v.label)})})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:16},children:[e.jsxs("div",{style:{background:"#fff",borderRadius:12,padding:18,boxShadow:"0 1px 4px rgba(0,0,0,0.06)"},children:[e.jsx("div",{style:{fontWeight:600,fontSize:14,marginBottom:12},children:"Source Breakdown"}),(f||[]).map(v=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"6px 0",borderBottom:"1px solid #f1f5f9",fontSize:13},children:[e.jsx("span",{style:{color:"#374151"},children:v.source}),e.jsx("span",{style:{fontWeight:600,color:"#0f172a"},children:v.count})]},v.source)),(f||[]).length===0&&e.jsx("div",{style:{color:"#94a3b8",fontSize:13},children:"No data"})]}),e.jsxs("div",{style:{background:"#fff",borderRadius:12,padding:18,boxShadow:"0 1px 4px rgba(0,0,0,0.06)"},children:[e.jsx("div",{style:{fontWeight:600,fontSize:14,marginBottom:12},children:"Ticket Type Breakdown"}),(p||[]).map(v=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"6px 0",borderBottom:"1px solid #f1f5f9",fontSize:13},children:[e.jsx("span",{style:{color:"#374151"},children:v.name}),e.jsx("span",{style:{fontWeight:600,color:"#0f172a"},children:v.count})]},v.name)),(p||[]).length===0&&e.jsx("div",{style:{color:"#94a3b8",fontSize:13},children:"No data"})]}),e.jsxs("div",{style:{background:"#fff",borderRadius:12,padding:18,boxShadow:"0 1px 4px rgba(0,0,0,0.06)"},children:[e.jsx("div",{style:{fontWeight:600,fontSize:14,marginBottom:12},children:"Intent Score"}),[{label:"Hot (80+)",value:(x==null?void 0:x.hot)||0,color:"#dc2626"},{label:"Warm (5079)",value:(x==null?void 0:x.warm)||0,color:"#d97706"},{label:"Cold (<50)",value:(x==null?void 0:x.cold)||0,color:"#64748b"}].map(v=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"6px 0",borderBottom:"1px solid #f1f5f9",fontSize:13},children:[e.jsx("span",{style:{color:v.color,fontWeight:600},children:v.label}),e.jsx("span",{style:{fontWeight:600,color:"#0f172a"},children:v.value})]},v.label))]})]}),(m||[]).length>0&&e.jsxs("div",{style:{background:"#fff",borderRadius:12,padding:20,marginTop:16,boxShadow:"0 1px 4px rgba(0,0,0,0.06)"},children:[e.jsx("div",{style:{fontWeight:600,fontSize:14,marginBottom:12},children:"Meta Campaign Breakdown"}),e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:13},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{textAlign:"left",padding:"8px 0",color:"#475569",fontSize:11,textTransform:"uppercase"},children:"Campaign ID"}),e.jsx("th",{style:{textAlign:"right",padding:"8px 0",color:"#475569",fontSize:11,textTransform:"uppercase"},children:"Registrations"})]})}),e.jsx("tbody",{children:m.map(v=>e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"8px 0",fontFamily:"monospace",color:"#374151"},children:v.meta_campaign_id}),e.jsx("td",{style:{padding:"8px 0",textAlign:"right",fontWeight:600},children:v.count})]},v.meta_campaign_id))})]})]})]})}function e0(){var I,P,w;const{slug:s}=zf(),[i,r]=u.useState(null),[o,d]=u.useState(!0),[f,p]=u.useState(!1),[x,m]=u.useState(null),[v,g]=u.useState(""),[b,y]=u.useState({full_name:"",phone_e164:"",email:"",ticket_type:"FREE",answers:{country:"",loan_amount_range:"",university:""}});u.useEffect(()=>{Ye.getPublicEvent(s).then(A=>{A.error?g(A.error):r(A)}).catch(()=>g("Event not found")).finally(()=>d(!1))},[s]);async function j(A){A.preventDefault(),p(!0),g("");try{const N=await Ye.registerForEvent(s,{...b,utm:{source:new URLSearchParams(window.location.search).get("utm_source"),campaign:new URLSearchParams(window.location.search).get("utm_campaign"),medium:new URLSearchParams(window.location.search).get("utm_medium")}});if(N.error){g(N.error);return}m(N)}catch(N){g(N.message||"Registration failed")}finally{p(!1)}}if(o)return e.jsx("div",{style:{minHeight:"100vh",background:"#F9FAFB",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx("div",{style:{color:"#64748b",fontSize:16},children:"Loading event..."})});if(v&&!i)return e.jsx("div",{style:{minHeight:"100vh",background:"#F9FAFB",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{style:{fontSize:48,marginBottom:16},children:""}),e.jsx("h2",{style:{color:"#0f172a"},children:"Event Not Found"}),e.jsx("p",{style:{color:"#64748b"},children:v})]})});if(x)return e.jsx("div",{style:{minHeight:"100vh",background:"#F9FAFB",display:"flex",alignItems:"center",justifyContent:"center",padding:20},children:e.jsxs("div",{style:{background:"#fff",borderRadius:20,padding:40,maxWidth:480,width:"100%",textAlign:"center",boxShadow:"0 4px 24px rgba(0,0,0,0.08)"},children:[e.jsx("div",{style:{background:"#DCFCE7",borderRadius:"50%",width:72,height:72,display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 20px",fontSize:36},children:""}),e.jsx("h2",{style:{margin:"0 0 8px",fontSize:22,fontWeight:700,color:"#0f172a"},children:"Registration Successful!"}),e.jsxs("p",{style:{color:"#64748b",margin:"0 0 24px"},children:["Hi ",b.full_name,", your ticket is confirmed."]}),x.status==="WAITLISTED"?e.jsx("div",{style:{background:"#fef9c3",borderRadius:12,padding:16,marginBottom:24},children:e.jsx("p",{style:{margin:0,color:"#854d0e",fontSize:14},children:"You're on the waitlist. We'll notify you if a spot opens!"})}):e.jsxs("div",{style:{background:"#f0fdf4",border:"2px solid #CBD5E1",borderRadius:16,padding:20,marginBottom:24},children:[e.jsx("div",{style:{fontSize:13,color:"#64748b",marginBottom:8},children:"Your Ticket ID"}),e.jsx("div",{style:{fontFamily:"monospace",fontSize:22,fontWeight:800,color:"#0f172a",letterSpacing:2},children:x.ticket_code}),e.jsx("div",{style:{fontSize:12,color:"#64748b",marginTop:8},children:"Show this at entry  Check WhatsApp for your QR ticket"})]}),e.jsxs("div",{style:{background:"#eff6ff",borderRadius:12,padding:16,marginBottom:24,textAlign:"left"},children:[e.jsx("div",{style:{fontSize:13,fontWeight:600,color:"#1e40af",marginBottom:10},children:" Event Details"}),e.jsxs("div",{style:{fontSize:13,color:"#374151",display:"grid",gap:6},children:[e.jsxs("div",{children:[" ",i==null?void 0:i.venue_name,", ",i==null?void 0:i.venue_address]}),e.jsxs("div",{children:[" ",i?new Date(i.event_start_at).toLocaleString("en-IN",{day:"numeric",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"}):""]})]})]}),e.jsxs("div",{style:{display:"flex",gap:12,flexDirection:"column"},children:[e.jsx("button",{onClick:()=>window.open(`/ticket/${x.ticket_code}`,"_blank"),style:{background:"#2563EB",color:"#fff",border:"none",borderRadius:12,padding:"14px",fontWeight:700,fontSize:15,cursor:"pointer"},children:"View My Ticket"}),(i==null?void 0:i.map_url)&&e.jsx("a",{href:i.map_url,target:"_blank",rel:"noreferrer",style:{color:"#2563eb",fontSize:14,textDecoration:"none",textAlign:"center"},children:" Get Directions"})]})]})});(I=i==null?void 0:i.ticket_types)==null||I.find(A=>A.name==="FREE"),(P=i==null?void 0:i.ticket_types)==null||P.find(A=>A.name==="VIP");const _=((i==null?void 0:i.spots_left)||0)<=0,C=i?new Date(i.event_start_at):null,L=C?C.toLocaleDateString("en-IN",{weekday:"long",day:"numeric",month:"long",year:"numeric"}):"",D=C?C.toLocaleTimeString("en-IN",{hour:"2-digit",minute:"2-digit",hour12:!0}):"";return e.jsxs("div",{style:{minHeight:"100vh",background:"#F9FAFB",fontFamily:"system-ui, -apple-system, sans-serif"},children:[e.jsx("div",{style:{background:"linear-gradient(135deg, #2563EB 0%, #1D4ED8 100%)",color:"#fff",padding:"48px 20px 32px"},children:e.jsxs("div",{style:{maxWidth:520,margin:"0 auto",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:12,fontWeight:600,letterSpacing:"0.15em",opacity:.8,marginBottom:12,textTransform:"uppercase"},children:"Nexthara Future  Exclusive Event"}),e.jsx("h1",{style:{margin:"0 0 16px",fontSize:28,fontWeight:800,lineHeight:1.2},children:i==null?void 0:i.title}),e.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:20,flexWrap:"wrap",fontSize:14,opacity:.9},children:[e.jsxs("span",{children:[" ",L]}),e.jsxs("span",{children:[" ",D]}),e.jsxs("span",{children:[" ",i==null?void 0:i.venue_name]})]}),_&&e.jsx("div",{style:{marginTop:16,background:"rgba(255,255,255,0.2)",borderRadius:10,padding:"8px 16px",fontSize:13},children:" Event is full  you'll be added to the waitlist"})]})}),e.jsx("div",{style:{background:"#fff",borderBottom:"1px solid #e2e8f0"},children:e.jsx("div",{style:{maxWidth:520,margin:"0 auto",padding:"20px",display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:12},children:[{icon:"",label:"Free Loan Eligibility Check"},{icon:"",label:"On-spot Document Review"},{icon:"",label:"Bank Process Guidance"},{icon:"",label:"Scholarship Insights"}].map(A=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,fontSize:13,color:"#374151"},children:[e.jsx("span",{style:{fontSize:20},children:A.icon}),e.jsx("span",{children:A.label})]},A.label))})}),e.jsx("div",{style:{maxWidth:520,margin:"0 auto",padding:"24px 20px"},children:e.jsxs("div",{style:{background:"#fff",borderRadius:16,padding:28,boxShadow:"0 4px 24px rgba(0,0,0,0.06)"},children:[e.jsx("h2",{style:{margin:"0 0 4px",fontSize:20,fontWeight:700,color:"#0F172A"},children:"Book Your Ticket"}),e.jsx("p",{style:{margin:"0 0 24px",fontSize:13,color:"#64748b"},children:" Limited seats. First come, first served."}),v&&e.jsx("div",{style:{background:"#fef2f2",border:"1px solid #fecaca",borderRadius:10,padding:"12px 16px",marginBottom:16,color:"#dc2626",fontSize:14},children:v}),e.jsx("form",{onSubmit:j,children:e.jsxs("div",{style:{display:"grid",gap:16},children:[e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:13,fontWeight:600,color:"#374151",display:"block",marginBottom:6},children:"Full Name *"}),e.jsx("input",{required:!0,value:b.full_name,onChange:A=>y(N=>({...N,full_name:A.target.value})),placeholder:"Your full name",style:{width:"100%",border:"1px solid #E5E7EB",borderRadius:10,padding:"12px 16px",fontSize:15,boxSizing:"border-box",outline:"none"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:13,fontWeight:600,color:"#374151",display:"block",marginBottom:6},children:"Phone Number (+91) *"}),e.jsx("input",{required:!0,value:b.phone_e164,onChange:A=>y(N=>({...N,phone_e164:A.target.value})),placeholder:"9876543210",type:"tel",style:{width:"100%",border:"1px solid #E5E7EB",borderRadius:10,padding:"12px 16px",fontSize:15,boxSizing:"border-box",outline:"none"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:13,fontWeight:600,color:"#374151",display:"block",marginBottom:6},children:"Email (optional)"}),e.jsx("input",{type:"email",value:b.email,onChange:A=>y(N=>({...N,email:A.target.value})),placeholder:"you@email.com",style:{width:"100%",border:"1px solid #E5E7EB",borderRadius:10,padding:"12px 16px",fontSize:15,boxSizing:"border-box",outline:"none"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:13,fontWeight:600,color:"#374151",display:"block",marginBottom:6},children:"Country Interested In"}),e.jsxs("select",{value:b.answers.country,onChange:A=>y(N=>({...N,answers:{...N.answers,country:A.target.value}})),style:{width:"100%",border:"1px solid #E5E7EB",borderRadius:10,padding:"12px 16px",fontSize:15,boxSizing:"border-box",outline:"none"},children:[e.jsx("option",{value:"",children:"Select country..."}),["UK","Germany","Canada","Australia","USA","Other"].map(A=>e.jsx("option",{value:A,children:A},A))]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:13,fontWeight:600,color:"#374151",display:"block",marginBottom:6},children:"Expected Loan Amount"}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:8},children:["<10L","10-20L","20-30L","30L+"].map(A=>e.jsxs("label",{style:{border:`2px solid ${b.answers.loan_amount_range===A?"#2563eb":"#e2e8f0"}`,borderRadius:10,padding:"10px 6px",textAlign:"center",cursor:"pointer",fontSize:13,fontWeight:500,background:b.answers.loan_amount_range===A?"#eff6ff":"#fff",color:b.answers.loan_amount_range===A?"#2563eb":"#374151",transition:"all 0.15s"},children:[e.jsx("input",{type:"radio",name:"loan_range",value:A,checked:b.answers.loan_amount_range===A,onChange:N=>y(W=>({...W,answers:{...W.answers,loan_amount_range:N.target.value}})),style:{display:"none"}}),A]},A))})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:13,fontWeight:600,color:"#374151",display:"block",marginBottom:6},children:"University (optional)"}),e.jsx("input",{value:b.answers.university,onChange:A=>y(N=>({...N,answers:{...N.answers,university:A.target.value}})),placeholder:"University name",style:{width:"100%",border:"1px solid #E5E7EB",borderRadius:10,padding:"12px 16px",fontSize:15,boxSizing:"border-box",outline:"none"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:13,fontWeight:600,color:"#374151",display:"block",marginBottom:10},children:"Ticket Type"}),e.jsx("div",{style:{display:"grid",gap:10},children:(w=i==null?void 0:i.ticket_types)==null?void 0:w.map(A=>e.jsxs("label",{style:{border:`2px solid ${b.ticket_type===A.name?"#2563eb":"#e2e8f0"}`,borderRadius:12,padding:"14px 16px",cursor:"pointer",background:b.ticket_type===A.name?"#eff6ff":"#fff",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[e.jsx("input",{type:"radio",name:"ticket_type",value:A.name,checked:b.ticket_type===A.name,onChange:N=>y(W=>({...W,ticket_type:N.target.value}))}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:700,fontSize:15,color:"#0f172a"},children:A.name}),A.benefits&&e.jsx("div",{style:{fontSize:12,color:"#64748b",marginTop:2},children:A.benefits})]})]}),e.jsx("div",{style:{fontWeight:700,fontSize:15,color:A.price_paise>0?"#dc2626":"#059669"},children:A.price_paise>0?`${(A.price_paise/100).toFixed(0)}`:"FREE"})]},A.id))})]}),e.jsx("button",{type:"submit",disabled:f,style:{background:"#2563EB",color:"#fff",border:"none",borderRadius:12,padding:"15px",fontWeight:700,fontSize:16,cursor:"pointer",marginTop:4,transition:"background 0.15s"},onMouseOver:A=>A.target.style.background="#1D4ED8",onMouseOut:A=>A.target.style.background="#2563EB",children:f?"Registering...":_?" Join Waitlist":" Confirm Registration"}),e.jsx("p",{style:{margin:0,fontSize:12,color:"#94a3b8",textAlign:"center"},children:"You will receive your ticket on WhatsApp instantly"})]})})]})})]})}function t0(){const{code:s}=zf(),[i,r]=u.useState(null),[o,d]=u.useState(!0),[f,p]=u.useState(""),x=u.useRef(null);if(u.useEffect(()=>{Ye.getTicket(s).then(D=>{D.error?p(D.error):r(D)}).catch(()=>p("Ticket not found")).finally(()=>d(!1))},[s]),u.useEffect(()=>{i&&x.current},[i]),o)return e.jsx("div",{style:{minHeight:"100vh",background:"#F9FAFB",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx("div",{style:{color:"#64748b"},children:"Loading ticket..."})});if(f||!i)return e.jsx("div",{style:{minHeight:"100vh",background:"#F9FAFB",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{style:{fontSize:48,marginBottom:12},children:""}),e.jsx("h2",{style:{color:"#0f172a"},children:"Ticket Not Found"}),e.jsx("p",{style:{color:"#64748b"},children:f||"This ticket does not exist."})]})});const m=new Date(i.event_start_at),v=m.toLocaleDateString("en-IN",{weekday:"long",day:"numeric",month:"long",year:"numeric"}),g=m.toLocaleTimeString("en-IN",{hour:"2-digit",minute:"2-digit",hour12:!0}),b=`https://api.qrserver.com/v1/create-qr-code/?size=250x250&data=${encodeURIComponent(i.qr_payload||i.ticket_code)}`,y=i.status==="CHECKED_IN",j=i.status==="CANCELLED",k=m.toISOString().replace(/[-:]/g,"").replace(/\.\d{3}/,""),_=new Date(i.event_end_at).toISOString().replace(/[-:]/g,"").replace(/\.\d{3}/,""),C=`https://calendar.google.com/calendar/render?action=TEMPLATE&text=${encodeURIComponent(i.title)}&dates=${k}/${_}&location=${encodeURIComponent(i.venue_address)}&details=${encodeURIComponent("Ticket: "+i.ticket_code)}`,L=`https://wa.me/?text=${encodeURIComponent(`My ticket for ${i.title}:
Date: ${v}
Venue: ${i.venue_name}
Ticket: ${i.ticket_code}`)}`;return e.jsx("div",{style:{minHeight:"100vh",background:"#F9FAFB",fontFamily:"system-ui, -apple-system, sans-serif",padding:"20px 16px"},children:e.jsxs("div",{style:{maxWidth:420,margin:"0 auto"},children:[y&&e.jsxs("div",{style:{background:"#dcfce7",borderRadius:12,padding:"14px 20px",marginBottom:20,display:"flex",alignItems:"center",gap:12},children:[e.jsx("span",{style:{fontSize:24},children:""}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:700,color:"#166534",fontSize:15},children:"Already Checked In"}),e.jsx("div",{style:{fontSize:12,color:"#15803d"},children:i.checked_in_at?`at ${new Date(i.checked_in_at).toLocaleTimeString("en-IN")}`:""})]})]}),j&&e.jsx("div",{style:{background:"#fef2f2",borderRadius:12,padding:"14px 20px",marginBottom:20},children:e.jsx("div",{style:{fontWeight:700,color:"#dc2626"},children:" Ticket Cancelled"})}),e.jsxs("div",{style:{background:"#fff",borderRadius:20,overflow:"hidden",boxShadow:"0 8px 40px rgba(37, 99, 235, 0.15)",border:"1px solid #EFF6FF"},children:[e.jsx("div",{style:{height:6,background:"linear-gradient(90deg, #2563EB 0%, #1D4ED8 100%)"}}),e.jsxs("div",{style:{background:"linear-gradient(135deg, #2563EB 0%, #1D4ED8 100%)",padding:"20px 24px"},children:[e.jsx("div",{style:{fontSize:11,fontWeight:700,letterSpacing:"0.15em",color:"rgba(255,255,255,0.7)",textTransform:"uppercase",marginBottom:4},children:"Nexthara Future  Event Ticket"}),e.jsx("div",{style:{fontSize:18,fontWeight:800,color:"#fff",lineHeight:1.3},children:i.title}),i.ticket_type_name&&e.jsxs("span",{style:{marginTop:8,display:"inline-block",background:i.ticket_type_name==="VIP"?"#f59e0b":"rgba(255,255,255,0.2)",color:"#fff",borderRadius:20,padding:"2px 12px",fontSize:12,fontWeight:700},children:[i.ticket_type_name," TICKET"]})]}),e.jsx("div",{style:{padding:"20px 24px",borderBottom:"2px dashed #e2e8f0"},children:e.jsxs("div",{style:{display:"grid",gap:12},children:[e.jsx(_l,{icon:"",label:"Name",value:i.full_name}),e.jsx(_l,{icon:"",label:"Date",value:v}),e.jsx(_l,{icon:"",label:"Time",value:g}),e.jsx(_l,{icon:"",label:"Venue",value:`${i.venue_name}, ${i.venue_address}`})]})}),e.jsxs("div",{style:{padding:"24px",display:"flex",flexDirection:"column",alignItems:"center"},children:[e.jsx("div",{style:{background:"#EFF6FF",border:"2px solid #CBD5E1",borderRadius:16,padding:16,marginBottom:16},children:e.jsx("img",{src:b,alt:`QR Code for ${i.ticket_code}`,style:{width:200,height:200,display:"block",borderRadius:8},onError:D=>{D.target.style.display="none"}})}),e.jsx("div",{style:{fontFamily:"monospace",fontSize:16,fontWeight:800,color:"#0f172a",letterSpacing:2,marginBottom:8},children:i.ticket_code}),e.jsx("div",{style:{fontSize:12,color:"#94a3b8",textAlign:"center"},children:"Show this QR code at the entry gate"})]})]}),e.jsxs("div",{style:{display:"grid",gap:12,marginTop:20},children:[e.jsx("a",{href:C,target:"_blank",rel:"noreferrer",style:{background:"#fff",border:"1px solid #e2e8f0",borderRadius:12,padding:14,textAlign:"center",textDecoration:"none",color:"#374151",fontSize:14,fontWeight:600,display:"flex",alignItems:"center",justifyContent:"center",gap:8},children:" Add to Calendar"}),i.map_url&&e.jsx("a",{href:i.map_url,target:"_blank",rel:"noreferrer",style:{background:"#fff",border:"1px solid #e2e8f0",borderRadius:12,padding:14,textAlign:"center",textDecoration:"none",color:"#374151",fontSize:14,fontWeight:600,display:"flex",alignItems:"center",justifyContent:"center",gap:8},children:" Get Directions"}),e.jsx("a",{href:L,target:"_blank",rel:"noreferrer",style:{background:"#25d366",border:"none",borderRadius:12,padding:14,textAlign:"center",textDecoration:"none",color:"#fff",fontSize:14,fontWeight:700,display:"flex",alignItems:"center",justifyContent:"center",gap:8},children:"Share on WhatsApp"})]}),e.jsx("p",{style:{textAlign:"center",color:"#94a3b8",fontSize:12,marginTop:20},children:"Nexthara Future  Education Loan & Student Funding"})]})})}function _l({icon:s,label:i,value:r}){return e.jsxs("div",{style:{display:"flex",gap:12,alignItems:"flex-start"},children:[e.jsx("span",{style:{fontSize:18,flexShrink:0,marginTop:1},children:s}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:11,fontWeight:600,color:"#94a3b8",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:2},children:i}),e.jsx("div",{style:{fontSize:14,color:"#0f172a",fontWeight:500},children:r})]})]})}function n0(){const{login:s,agentLogin:i,bankAdminLogin:r,logout:o}=ks(),[d,f]=u.useState("staff"),[p,x]=u.useState("admin"),[m,v]=u.useState(""),[g,b]=u.useState(""),[y,j]=u.useState(!1),[k,_]=u.useState(""),[C,L]=u.useState(!1);async function D(w){w.preventDefault(),_(""),L(!0);try{if(d==="agent")await i(m,g);else if(d==="bank"){if(p==="admin")await r(m,g);else if((await s(m,g)).role!=="bank_user")throw o(),new Error("This account is not a Bank Staff account.")}else if((await s(m,g)).role==="bank_user")throw o(),new Error("Bank users should log in via the Bank Login tab.")}catch(A){_(A.message||"Invalid email or password")}finally{L(!1)}}const I={staff:{accent:"#1a237e",label:"Staff Login",heading:"Sign in",sub:"Secure access for lender updates & document review"},bank:{accent:"#0d7377",label:"Bank Login",heading:"Bank Portal",sub:p==="admin"?"Login as National Head, Region Head, Branch Manager or Officer":"Login as Bank Staff member"},agent:{accent:"#2563EB",label:"Agent Login",heading:"Agent Portal",sub:"Access your organization's loan pipeline & commissions"}},P=I[d];return e.jsx("div",{className:"login-page",children:e.jsxs("div",{className:"login-card",children:[e.jsx("div",{className:"login-brand",style:{justifyContent:"center",marginBottom:24},children:e.jsx(ai,{height:44,dark:!1})}),e.jsx("div",{style:{display:"flex",background:"#f1f5f9",borderRadius:8,padding:4,marginBottom:20,gap:2},children:["staff","bank","agent"].map(w=>e.jsx("button",{type:"button",onClick:()=>{f(w),_(""),v(""),b("")},style:{flex:1,padding:"7px 0",border:"none",borderRadius:6,cursor:"pointer",fontWeight:600,fontSize:12,background:d===w?I[w].accent:"transparent",color:d===w?"#fff":"#64748b",transition:"all 0.15s"},children:I[w].label},w))}),e.jsx("h2",{className:"login-heading",style:{marginTop:0},children:P.heading}),e.jsx("p",{className:"login-subheading",children:P.sub}),d==="bank"&&e.jsx("div",{style:{display:"flex",gap:10,marginBottom:18},children:[{value:"admin",label:"Admin",desc:"SUPER_ADMIN / Region Head / Branch Manager / Officer",icon:"fa-user-shield"},{value:"staff",label:"Bank Staff",desc:"Bank staff member account",icon:"fa-user-tie"}].map(w=>e.jsxs("label",{onClick:()=>{x(w.value),_("")},style:{flex:1,display:"flex",alignItems:"flex-start",gap:10,padding:"10px 12px",border:`2px solid ${p===w.value?"#0d7377":"#e2e8f0"}`,borderRadius:8,cursor:"pointer",background:p===w.value?"#f0fdfa":"#fff",transition:"all 0.15s"},children:[e.jsx("input",{type:"radio",name:"bankUserType",value:w.value,checked:p===w.value,onChange:()=>{x(w.value),_("")},style:{marginTop:2,accentColor:"#0d7377"}}),e.jsxs("div",{children:[e.jsxs("div",{style:{fontSize:13,fontWeight:700,color:p===w.value?"#0d7377":"#374151",display:"flex",alignItems:"center",gap:6},children:[e.jsx("i",{className:`fas ${w.icon}`,style:{fontSize:12}})," ",w.label]}),e.jsx("div",{style:{fontSize:10,color:"#6b7280",marginTop:2},children:w.desc})]})]},w.value))}),e.jsxs("form",{onSubmit:D,className:"login-form",children:[e.jsx("div",{className:"login-form-group",children:e.jsx("input",{type:"email",className:"login-input",placeholder:"Email address",value:m,onChange:w=>v(w.target.value),required:!0,autoComplete:"email",autoFocus:!0})}),e.jsxs("div",{className:"login-form-group login-password-group",children:[e.jsx("input",{type:y?"text":"password",className:"login-input",placeholder:"Password",value:g,onChange:w=>b(w.target.value),required:!0,autoComplete:"current-password"}),e.jsx("button",{type:"button",className:"login-password-toggle",onClick:()=>j(w=>!w),tabIndex:-1,children:e.jsx("i",{className:`fas ${y?"fa-eye-slash":"fa-eye"}`})})]}),k&&e.jsx("div",{className:"login-error",children:k}),e.jsx("button",{type:"submit",className:"login-btn",disabled:C,style:{background:P.accent},children:C?"Signing in...":"Sign in"})]}),e.jsx("div",{className:"login-footer",children:" 2026 Nexthara  All rights reserved"})]})})}function s0(){const{isAuthenticated:s,loading:i,logout:r,user:o}=ks(),[d,f]=u.useState("leads"),[p,x]=u.useState(null),[m,v]=u.useState(null),[g,b]=u.useState(null),[y,j]=u.useState("all"),[k,_]=u.useState({}),[C,L]=u.useState(null),[D,I]=u.useState(0),[P,w]=u.useState(1),[A,N]=u.useState(1),[W,F]=u.useState(!1),[Z,ce]=u.useState(0),xe=u.useCallback(()=>ce(U=>U+1),[]),z=["dashboard","applications","queries","sanctions","disbursements","reports"];u.useEffect(()=>{(o==null?void 0:o.role)==="bank_user"&&!z.includes(d)&&f("dashboard")},[o]),u.useEffect(()=>{const U=()=>r();return window.addEventListener("nexthara_logout",U),()=>window.removeEventListener("nexthara_logout",U)},[r]);const X=u.useCallback(()=>{const U={page:P,limit:30};return k.search&&(U.search=k.search),k.status&&(U.status=k.status),k.awaiting&&(U.awaiting=k.awaiting),k.priority&&(U.priority=k.priority),k.intake&&(U.intake=k.intake),k.sla&&(U.sla=k.sla),y.startsWith("stage-")?U.stage=y.split("-")[1]:y.startsWith("await-")?U.awaiting=y.split("-")[1]:y.startsWith("priority-")?U.priority=y.split("-")[1]:y.startsWith("sla-")&&(U.sla=y.split("-")[1]),U},[k,y,P]),de=["dashboard","applications","pipeline"];u.useEffect(()=>{if(!s||(o==null?void 0:o.role)==="bank_user"||!de.includes(d))return;const U=X();Ae.getApplications(U).then(ae=>{L(ae.data),I(ae.total),N(ae.pages)}).catch(()=>{})},[X,Z,s,d,o]);const oe=U=>{_(U),w(1)},ve=U=>{j(U),_({}),w(1)},Y=U=>{f(U),v(null),U!=="events"&&U!=="events-analytics"&&b(null),["dashboard","applications"].includes(U)&&(j("all"),_({}),w(1),xe())};if(i)return null;const se=window.location.pathname;if(se.startsWith("/event/")||se.startsWith("/ticket/"))return e.jsxs(ig,{children:[e.jsx(Bo,{path:"/event/:slug",element:e.jsx(e0,{})}),e.jsx(Bo,{path:"/ticket/:code",element:e.jsx(t0,{})})]});if(!s)return e.jsx(n0,{});if((o==null?void 0:o.role)==="super_admin")return e.jsx(A1,{});if((o==null?void 0:o.portal)==="bank_admin")return e.jsxs(e.Fragment,{children:[e.jsx(Ya,{position:"bottom-right",toastOptions:{duration:3e3,style:{background:"#0d7377",color:"#fff",fontSize:13,borderRadius:8}}}),e.jsx(Vy,{})]});if((o==null?void 0:o.portal)==="agent")return e.jsxs(e.Fragment,{children:[e.jsx(Ya,{position:"bottom-right",toastOptions:{duration:3e3,style:{background:"#1e3a5f",color:"#fff",fontSize:13,borderRadius:8}}}),e.jsx(Ey,{})]});if((o==null?void 0:o.role)==="bank_user")return e.jsxs(e.Fragment,{children:[e.jsx(Ya,{position:"bottom-right",toastOptions:{duration:3e3,style:{background:"#1b5e20",color:"#fff",fontSize:13,borderRadius:8}}}),e.jsx(Uu,{activeView:d,onViewChange:Y}),e.jsx("div",{className:"main-wrapper",children:e.jsxs("main",{className:"content content-full",style:{paddingTop:24},children:[d==="dashboard"&&e.jsx(z1,{onOpenApp:x}),d==="applications"&&e.jsx(B1,{onOpenApp:x}),d==="queries"&&e.jsx(U1,{onOpenApp:x}),d==="sanctions"&&e.jsx(J1,{onOpenApp:x}),d==="disbursements"&&e.jsx(K1,{onOpenApp:x}),d==="reports"&&e.jsx(Y1,{})]})}),p&&e.jsx(F1,{appId:p,onClose:()=>x(null),onUpdated:()=>x(null)})]});const J=["leads","leads-analytics"].includes(d),O=["events","events-analytics"].includes(d);return e.jsxs(e.Fragment,{children:[e.jsx(Ya,{position:"bottom-right",toastOptions:{duration:3e3,style:{background:"#1b5e20",color:"#fff",fontSize:13,borderRadius:8}}}),e.jsx(Uu,{activeView:d,onViewChange:Y}),e.jsxs("div",{className:"main-wrapper",children:[!J&&!O&&d!=="users"&&e.jsx(Xg,{activeFilter:y,onFilterChange:ve,refreshKey:Z}),e.jsxs("main",{className:`content${d==="users"||J||O?" content-full":""}`,children:[d==="events"&&!g&&e.jsx(fh,{onSelectEvent:U=>b(U)}),d==="events"&&g&&e.jsx(hh,{eventId:g,onBack:()=>b(null)}),d==="events-analytics"&&e.jsx(Z1,{eventId:g,onBack:()=>Y("events")}),d==="leads"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"breadcrumb",children:[e.jsx("a",{href:"#",onClick:U=>{U.preventDefault(),Y("leads")},children:"Home"}),e.jsx("i",{className:"fas fa-chevron-right",style:{fontSize:10}})," Lead Management Panel"]}),e.jsx(th,{onOpenLead:U=>v(U)})]}),d==="leads-analytics"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"breadcrumb",children:[e.jsx("a",{href:"#",onClick:U=>{U.preventDefault(),Y("leads")},children:"Leads"}),e.jsx("i",{className:"fas fa-chevron-right",style:{fontSize:10}})," Analytics"]}),e.jsx(sh,{})]}),d==="users"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"breadcrumb",children:[e.jsx("a",{href:"#",onClick:U=>{U.preventDefault(),Y("dashboard")},children:"Home"}),e.jsx("i",{className:"fas fa-chevron-right",style:{fontSize:10}})," User Management"]}),e.jsx(Xf,{})]}),d==="dashboard"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"breadcrumb",children:[e.jsx("a",{href:"#",onClick:U=>{U.preventDefault(),Y("dashboard")},children:"Home"}),e.jsx("i",{className:"fas fa-chevron-right",style:{fontSize:10}})," Dashboard"]}),e.jsxs("div",{className:"page-header",children:[e.jsxs("div",{children:[e.jsx("h2",{children:"Application Dashboard"}),e.jsx("div",{className:"subtitle",children:"Overview of all bank application statuses across lenders"})]}),e.jsxs("div",{className:"header-actions",children:[e.jsxs("button",{className:"btn btn-outline",onClick:xe,children:[e.jsx("i",{className:"fas fa-sync-alt"})," Refresh"]}),e.jsxs("button",{className:"btn btn-primary",onClick:()=>F(!0),children:[e.jsx("i",{className:"fas fa-plus"})," New Application"]})]})]}),e.jsx(Vf,{refreshKey:Z}),e.jsx(Mo,{refreshKey:Z}),e.jsx(Hu,{filters:k,onFilterChange:oe}),e.jsx(Za,{applications:C,total:D,page:P,pages:A,onPageChange:w,onSelectApp:x})]}),d==="applications"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"breadcrumb",children:[e.jsx("a",{href:"#",onClick:U=>{U.preventDefault(),Y("dashboard")},children:"Home"}),e.jsx("i",{className:"fas fa-chevron-right",style:{fontSize:10}})," All Applications"]}),e.jsxs("div",{className:"page-header",children:[e.jsxs("div",{children:[e.jsx("h2",{children:"All Applications"}),e.jsx("div",{className:"subtitle",children:"Complete list of bank applications"})]}),e.jsxs("div",{className:"header-actions",children:[e.jsxs("button",{className:"btn btn-outline",onClick:xe,children:[e.jsx("i",{className:"fas fa-sync-alt"})," Refresh"]}),e.jsxs("button",{className:"btn btn-primary",onClick:()=>F(!0),children:[e.jsx("i",{className:"fas fa-plus"})," New Application"]})]})]}),e.jsx(Hu,{filters:k,onFilterChange:oe}),e.jsx(Za,{applications:C,total:D,page:P,pages:A,onPageChange:w,onSelectApp:x})]}),d==="pipeline"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"breadcrumb",children:[e.jsx("a",{href:"#",onClick:U=>{U.preventDefault(),Y("dashboard")},children:"Home"}),e.jsx("i",{className:"fas fa-chevron-right",style:{fontSize:10}})," Pipeline View"]}),e.jsx("div",{className:"page-header",children:e.jsxs("div",{children:[e.jsx("h2",{children:"Application Pipeline"}),e.jsx("div",{className:"subtitle",children:"Stage-wise breakdown of all applications"})]})}),e.jsx(Mo,{refreshKey:Z}),e.jsx("div",{style:{marginBottom:16},children:e.jsx(a0,{activeFilter:y,onFilterChange:ve})}),e.jsx(Za,{applications:C,total:D,page:P,pages:A,onPageChange:w,onSelectApp:x})]})]})]}),p&&e.jsx(Yf,{appId:p,onClose:()=>x(null),onUpdated:()=>{x(null),xe()}}),m&&e.jsx(nh,{leadId:m,onClose:()=>v(null),onOpenCase:U=>{v(null),x(U),Y("applications")}}),W&&e.jsx(Zf,{onClose:()=>F(!1),onCreated:xe})]})}function a0({activeFilter:s,onFilterChange:i}){const r=[{key:"all",label:"All"},{key:"stage-1",label:"Stage 1: Pre-Login"},{key:"stage-2",label:"Stage 2: Login"},{key:"stage-3",label:"Stage 3: Docs"},{key:"stage-4",label:"Stage 4: Credit"},{key:"stage-5",label:"Stage 5: Decision"},{key:"stage-6",label:"Stage 6: Post Sanction"},{key:"stage-7",label:"Stage 7: Closed"}];return e.jsx("div",{className:"stage-tabs",children:r.map(o=>e.jsx("div",{className:`stage-tab ${s===o.key?"active":""}`,onClick:()=>i(o.key),children:o.label},o.key))})}yx.createRoot(document.getElementById("root")).render(e.jsx(og,{children:e.jsx(Kg,{children:e.jsx(s0,{})})}));
